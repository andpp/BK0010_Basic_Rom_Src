       1                                	.TITLE	INOUT
       2                                ;	.ENABLE	LC
       3                                	;
       4                                	; ###################
       5                                	; #                 #
       6                                	; #   BASIC - VVU   #
       7                                	; #    BK - 0010    #
       8                                	; #                 #
       9                                	; ###################
      10                                	;
      11                                	; ИСПОЛНИТЕЛЬ: ВЦКП ВГУ
      12                                	; ВИЛЬНЮС,1985
      13                                	;
      14                                	; ======================
      15                                	; ****БЛОК НАСТРОИКИ****
      16                                	; ======================
      17                                	;
      18 000000                         	BK0010=0
      19 000001                         	EL60=1
      20 000002                         	NC80=2
      21 000003                         	SM4=3	;RAFOS
      22 000004                         	MDS=4	;MDS RAFOS
      23 010000                         	RAM=10000
      24 120000                         	ROM=120000
      25 040000                         	MVIDEO=40000
      26 000000                         	NORM=0
      27 000001                         	KLAS=1
      28                                ;
      29 000000                         	MASINA=BK0010
      30 120000                         	MEMTYP=ROM
      31 000000                         	KONTYP=NORM
      32                                ;
      33                                	; ===========================
      34                                	; ****СИСТЕМНЫЕ КОНСТАНТЫ****
      35                                	; ===========================
      36                                	;
      37 000004                         	BREAKW==4	;АДРЕС ВЕКТОРА ПРЕРЫВАНИЙ ПО КЛАВИШЕ "СТОП"
      38 000010                                 ILCODV=10
      39 000034                                 TRAPV=34	;АДРЕС ВЕКТОРА ПРЕРЫВАНИЙ ПО ИНСТРУКЦИИ TRAP
      40 000100                         	TIMER==100	;АДРЕС ВЕКТОРА ПРЕРЫВАНИЙ ТАЙМЕРА
      41 000176                                 $DRVX=176	;КООРДИНАТА X
      42 000200                                 $DRVY=200	;КООРДИНАТА Y
      43 000105                                 TSTKEY=105	;АДРЕС ПРИЗНАКА НАЖАТИЯ НА КЛАВИШУ
      44 000264                                 MSTART==264	;СТАРТОВЫЙ АДРЕС МАССИВА
      45 000266                                 MLEN=266	;ДЛИНА МАССИВА
      46 000320                                 MAG==320	;АДРЕС БЛОКА ПАРАМЕТРОВ МАГНИТОФОНА
      47 000360                                 IRPSV=360	;АДРЕС ВЕКТОРА ПРЕРЫВАНИЙ ИРПС
      48 176560                                 IRPSRG=176560	;АДРЕС РЕГИСТРА ИРПС
      49 160000                                 AUSROM=160000	;АДРЕС ПЕРЕХОДА НА ПОЛЬЗОВАТЕЛЬСКОЕ БИС ПЗУ
      50 177714                                 ARPORT=177714	;АДРЕС РЕГИСТРА ПРОГРАММИРУЕМОГО ПОРТА
      51 177716                         	ASPORT=177716	;adres registra sistemnogo porta
      52                                	;
      53                                	; ============================
      54                                	; ****СИСТЕМНЫЕ ПЕРЕМЕННЫЕ****
      55                                	; ============================
      56                                	;
      57                                	.ASECT
      58 002000                         	.=2000
      59                                ;
      60                                STACK::
      61 002000                         LYGIS::	.BLKW	1	;РЕЖИМ РАБОТЫ СИСТЕМЫ
      62 002002                         TXEND::	.BLKW	1	;МЕТКА КОНЦА ТЕКСТА И НАЧАЛА ОБ'ЕКТНОГО КОДА
      63 002004                         STRREG::.BLKW	1	;МЕТКА НАЧАЛА ОБЛАСТИ СТРОК
      64 002006                         STRSIZ::.BLKW	1	;УКАЗАТЕЛЬ ДЛИНЫ ОБЛАСТИ СТРОК
      65 002010                         FREBEG::.BLKW	1	;МЕТКА СВОБОДНОЙ ЧАСТИ ОБЛАСТИ СТРОК
      66 002012                         FRELEN::.BLKW	1	;ТЕКУЩАЯ ДЛИНА СВОБОДНОЙ ЧАСТИ ОБЛАСТИ СТРОК
      67 002014                         ENDCOD::.BLKW	1	;МЕТКА НАЧАЛА СВОБОДНОЙ ОБЛАСТИ
      68                                			;И КОНЦА ОБ'ЕКТНОГО КОДА
      69 002016                         CIKL::	.BLKW	1	;metka na~ala steka ciklow
      70 002020                         LIMIT::	.BLKW	1	;ukazatelx wer{iny steka podprogramm
      71 002022                         LENT::	.BLKW	1	;МЕТКА НАЧАЛА ТАБЛИЦЫ ИМЕН
      72 002024                         TABTOP::.BLKW	1	;МЕТКА КОНЦА ТАБЛИЦ СВЯЗИ И ИМЕН
      73 002026                         FCB::	.BLKW	1	;МЕТКА НАЧАЛА ОБЛАСТИ ФАЙЛОВ И ТАБЛИЦЫ СВЯЗИ
      74 002030                         HIMEM::	.BLKW	1	;УКАЗАТЕЛЬ ВЕРХНЕГО АДРЕСА, ДОСТУПНОГО БЕЙСИКУ
      75 002032                         ERRS::	.BLKW	1	;ПРИЗНАК ЗАПРЕТА ВЫПОЛНЕНИЯ ПРОГРАММЫ
      76 002034                         TYPE::	.BLKW	1	;ТИП КОМПИЛИРУЕМОГО ВЫРАЖЕНИЯ
      77 002036                         DATBEG::.BLKW	1	;ukazatelx na~ala bufera DATA
      78 002040                         DATPTR::.BLKW	1	;teku}ij ukazatelx bufera DATA
      79 002042                         DATINP::.BLKW	1	;flag READ/INPUT
      80 002044                         NUMBER::.BLKW	1	;НОМЕР КОМПИЛИРУЕМОЙ СТРОКИ
      81 002046                         ADRHLT::.BLKW	1	;АДРЕС ОСТАНОВА ПРОГРАММЫ
      82 002050                         TRFLAG::.BLKW	1	;ФЛАГ РЕЖИМА ТРАССИРОВКИ
      83 002052                         AUTOON::.BLKW	1	;ФЛАГ РЕЖИМА AUTO
      84 002054                         AUINC::	.BLKW	1	;AUTO ПРИРАЩЕНИЕ
      85 002056                         CURLIN::.BLKW	1	;УКАЗАТЕЛЬ ТЕКУЩЕЙ СТРОКИ
      86 002060                         III::	.BLKW	4	;РАБОЧИЕ ЯЧЕЙКИ ФУНКЦИИ RND
      87 002070                         RNDSAV::.BLKW	4	;ТЕКУЩЕЕ ЗНАЧЕНИЕ RND
      88                                ;MAXFIL::.BLKW	1	;maksimalxnoe koli~estwo fajlow dannyh
      89 002100                         USRTAB::.BLKW	10.	;ТАБЛИЦА АДРЕССОВ USR
      90                                ;APRL::	.BLKW	15	;tablica neqwnogo opredeleniq tipow
      91 002124                         PNTSAV::.BLKW	1	;rabo~aq q~ejka {aga
      92 002126                         PFACT::	.BLKW	2	;ukazatelx bloka parametrow dlq FN
      93 002132                         TMP::	.BLKW	1	;ukazatelx wremennyh deskriptorow
      94 002134                         SAVJMP::.BLKW	1	;adres koda wypolnqemoj programmy
      95 002136                         LPTPOS::.BLKB	1	;s~et~ik golowki printera
      96 002137    000                  	.EVEN
      97                                ;
      98 000000                         	.IF	EQ,MASINA-BK0010
      99 002140                         FNKSTR::.BLKB	170.	;БУФЕР ТЕКСТОВ ФУНКЦИОНАЛЬНЫХ КЛАВИШ
     100 002412                         $SCRT:	.BLKW	1	;rabo~aq peremennaq DRAW
     101 002414                         .BLKB	400	;БУФЕР ВВОДА
     102 177777                         	.IF	EQ,KONTYP-KLAS
     103                                COPPNT:	.BLKW	1	;ukazatelx ozu |krana dlq COPY
     104                                EKRHUK:	.BLKW	1	;adres dopoln. podpr.
     105                                        .ENDC
     106                                ;
     107                                        .IFF
     108                                TABX::	.BLKB	1		;НО. ПОЗИЦИИ КУРСОРА
     109                                TABY::	.BLKB	1		;НО. СТРОКИ КУРСОРА
     110                                SIIKP::	.BLKB	1		;ПРИЗНАК ЗАПИСИ КОДА ИЗ КЛАВИАТУРЫ
     111                                RLPOZ::	.BLKB	1		;ПРИЗНАК РУС. ЛАТ.
     112                                SAUG::	.BLKW	4		;ХРАНЕНИЕ ВЕКТОРА ПРЕРЫВАНИЯ КЛАВИАТУРЫ
     113                                                                ;И КОМАНД ПЕРЕЗАПУСКА СИСТЕМЫ
     114                                        .IFTF
     115 003014                         WRITE::	.BLKW	1	;adres drajwera ustrojstwa wne{nej pamqti
     116 003016                         IODEV:: .BLKW	1	;НОМЕР ТЕКУЩЕГО ФАЙЛА
     117 003020                         INK::	.BLKW	1	;БУФЕР INKEY
     118                                BUF::	
     119 003022                         BUFOUT::.BLKB	30	;БУФЕР ВЫВОДА
     120 003052                         TEXT::	.BLKW	1	;ОБЛАСТЬ ПРОГРАММЫ ПОЛЗОВАТЕЛЯ
     121                                	;
     122                                	; ====================
     123                                	; ****ПУСК СИСТЕМЫ****
     124                                	; ====================
     125                                	;
     126                                	.GLOBL	MONIT,TRAP,CLRTXT,BC,CASCII,BLOCKN,FNDBUF,NEXDBL,NEXJMP
     127                                	.GLOBL	TOINT,$B93,$B95,ID,SI,DI,$DMUL$,SETST,CAS,JMP,DFNRET
     128                                	.GLOBL	LNUM
     129 120000                         	.=MEMTYP
     130                                START::
     131                                	.IFT
     132 000000                         	.IF	EQ,MEMTYP-ROM
     133 120000 012701  100000          	MOV	#100000,R1	;CHECK SUM
     134 120004 012703  000003          	MOV	#3,R3
     135 120010 012702  010000          4$:	MOV	#10000,R2
     136 120014 005000                  	CLR	R0
     137 120016 062100                  3$:	ADD	(R1)+,R0
     138 120020 005500                  	ADC	R0
     139 120022 077203                  	SOB	R2,3$
     140 120024 020027  177777          	CMP	R0,#177777
     141 120030 001401                  	BEQ	2$
     142 120032 000207                  	RETURN
     143 120034 077313                  2$:	SOB	R3,4$
     144                                	.ENDC
     145                                ;
     146                                	.IFTF
     147 120036 012706  002000          	MOV	#STACK,SP
     148                                	.IFF
     149                                	MOV	AVPK,SAUG
     150                                	MOV	AVPK+2,SAUG+2
     151                                	MOV	0,SAUG+4
     152                                	MOV	2,SAUG+6
     153                                	.IFTF
     154 000000                         	.IF	EQ,MEMTYP-ROM
     155 120042 012767  040000  002030' 	MOV	#MVIDEO,HIMEM
     156                                	.IFF
     157                                	MOV	#MEMTYP,HIMEM
     158                                	.ENDC
     159 120050 005067  002050'         	CLR	TRFLAG
     160 120054 105067  002136'         	CLRB	LPTPOS
     161 120060 012767  000310  002006' 	MOV	#200.,STRSIZ
     162 120066 012700  002054          	MOV	#AUINC,R0
     163 120072 012720  000012          	MOV	#12,(0)+
     164 120076 012720  000012          	MOV	#12,(0)+
     165 120102 010001                  	MOV	R0,R1
     166 120104 012720  040101          	MOV	#40101,(0)+
     167 120110 012720  044122          	MOV	#44122,(0)+
     168 120114 012720  037502          	MOV	#37502,(0)+
     169 120120 012720  052125          	MOV	#52125,(0)+
     170                                	.REPT	4
     171                                	MOV	(1)+,(0)+
     172                                	.ENDR
       1 120124 012120                  	MOV	(1)+,(0)+
       1 120126 012120                  	MOV	(1)+,(0)+
       1 120130 012120                  	MOV	(1)+,(0)+
       1 120132 012120                  	MOV	(1)+,(0)+
     173                                ;	MOV	#1,(R0)+	;MAXFIL <- 1
     174 120134 012701  000012          	MOV	#10.,R1
     175 120140 012720  124300          1$:	MOV	#NOUSR,(0)+	;НЕОПРЕДЕЛЕННЫЕ ФУНКЦИИ USR
     176 120144 077103                  	SOB	R1,1$
     177                                .IFT
     178 120146 012737  000004  002412  	MOV	#4,@#$SCRT	;SENAS DRAW
     179                                ; 	MOV	#2000,@#$SCRT
     180                                ;
     181                                .IFTF
     182                                ;	MOV	#15,R1		;neqwnyj tip
     183                                ;5$:	MOV	#2004,(R0)+
     184                                ;	SOB	R1,5$
     185                                ;
     186                                ;	CLR	(R0)+		;STOPAR
     187 120154 005067  002124'         	CLR	PNTSAV
     188 120160 004767  120542'         	CALL	MIDM		;ИНИЦИАЛИЗАЦИЯ УСТРОЙСТВ
     189 120164 004767  134420'         	CALL	CLRTXT
     190                                	.IFT
     191 120170 004767  120606'         	CALL	KINIT		;ИНИЦИАЛИЗАЦИЯ КЛЮЧЕЙ
     192                                 .IFTF
     193 120174 000521                          BR	SETV
     194 120176 000000                  SUM1::	.WORD	0
     195                                        .IFF
     196                                INIT:	MOV	#STACK,SP
     197                                        JSR	R2,SEPAP
     198                                        CALL	MIDM
     199                                        BR	SETV
     200                                        .IFTF
     201                                ;
     202 120200 005767  002000'         CTRLC:	TST	LYGIS
     203 120204 100413                          BMI	BREAK
     204 120206 012706  002000                  MOV	#STACK,SP
     205 120212 012700  000012                  MOV	#12,R0
     206 120216 004767  122522'                 CALL	ISV
     207 120222 000167  133754'                 JMP	MONIT+4
     208                                ;
     209                                ;
     210 120226    012     363     364  WSTOP::	.BYTE	12,363,364,357,360,12
         120231    357     360     012  
     211                                ;
     212 120234 012737  125070  000004  BREAK::	MOV	#IRPS2-10,@#BREAKW
     213 120242 005037  177660                  CLR	@#177660
     214 120246 005067  003016'                 CLR	IODEV
     215                                .IFT
     216 120252 104034                          EMT	34
     217 120254 032700  000400                  BIT	#400,R0
     218 120260 001405                          BEQ	1$
     219 120262 012700  000225                  MOV	#225,R0
     220 120266 104016                          EMT	16
     221 120270 004767  120760'                 CALL	ISVSS
     222                                .IFTF
     223 120274 012701  120226          1$:	MOV	#WSTOP,R1
     224 120300 012702  000005                  MOV	#5,R2
     225 120304 004767  122560'                 CALL	ISVEIL
     226 120310 005767  002000'                 TST	LYGIS
     227 120314 002041                          BGE	2$
     228 120316 005767  002134'                 TST	SAVJMP
     229 120322 001404                          BEQ	3$
     230 120324 016704  002134'                 MOV	SAVJMP,R4
     231 120330 005067  002134'                 CLR	SAVJMP
     232 120334 020467  002004'         3$:	CMP	R4,STRREG
     233 120340 101027                          BHI	2$
     234 120342 021627  156616                  CMP	@SP,#NEXDBL-20
     235 120346 001416                          BEQ	10$
     236 120350 021627  155510                  CMP	@SP,#NEXJMP+22
     237 120354 001413                          BEQ	10$
     238 120356 021627  155562                  CMP	@SP,#JMP+2
     239 120362 001410                          BEQ	10$
     240 120364 021627  155736                  CMP	@SP,#DFNRET-14
     241 120370 103406                          BLO	11$
     242 120372 021627  155750                  CMP	@SP,#DFNRET-2
     243 120376 101003                          BHI	11$
     244 120400 001401                          BEQ	10$
     245 120402 005724                          TST	(4)+
     246 120404 005724                  10$:	TST	(4)+
     247 120406 004767  155070'         11$:	CALL	LNUM
     248 120412 014467  002046'                 MOV	-(4),ADRHLT
     249 120416 000404                          BR	4$
     250 120420 012700  000012          2$:	MOV	#12,R0
     251 120424 004767  122522'                 CALL	ISV
     252 120430 004267  124022'         4$:	JSR	R2,SEPAP
     253 120434 005067  002000'                 CLR	LYGIS
     254 120440 005037  000102          SETV:	CLR	@#TIMER+2		;УСТАНОВКА ВЕКТОРОВ ПРЕРЫВАНИЙ
     255 120444 012737  125070  000100  	MOV	#IRPS2-10,@#TIMER	;TAIMERIS DARBUI SU PRINTERIU
     256 120452 012737  125070  000004  	MOV	#IRPS2-10,@#BREAKW
     257 120460 005037  000006          	CLR	@#BREAKW+2
     258 120464 012767  146404  000034' 	MOV	#TRAP,TRAPV
     259 120472 005067  000036'         	CLR	TRAPV+2
     260 120476 012737  125070  000010  	MOV	#IRPS2-10,@#ILCODV
     261 120504 005037  000012          	CLR	@#ILCODV+2
     262                                .IFF
     263                                	MOV	#137,@#0
     264                                	MOV	#INIT,@#2
     265                                ;
     266                                .IFT
     267 177777                         .IF	EQ	KONTYP-KLAS
     268                                .IFTF
     269 120510 005037  176564          	CLR	@#IRPSRG+4
     270                                .IFT
     271                                	MOV	#IRPS1,@#IRPSW
     272                                	CLR	@#IRPSW+2
     273                                	BIS	#100,@#IRPSRG
     274                                	CLR	EKRHUK
     275                                .IFF
     276 120514 005037  176560          	CLR	@#IRPSRG
     277                                .ENDC
     278                                .IFTF
     279 120520 012737  120540  000010  	MOV	#SYSERR,@#ILCODV
     280 120526 012737  120234  000004  SYS1:	MOV	#BREAK,@#BREAKW
     281 120534 000167  133754'         	JMP	STAR 		;ПЕРЕХОД НА БЭЙСИК-МОНИТОР
     282 120540 104463                  SYSERR:	TRAP	51.
     283                                ;
     284                                ;
     285                                	; =========================
     286                                	; ****БЛОК ВВОДА-ВЫВОДА****
     287                                	; =========================
     288                                	;
     289                                	; ------------------------------------
     290                                	; ####КОНСТАНТЫ БЛОКА ВВОДА-ВЫВОДА####
     291                                	; ------------------------------------
     292                                	;
     293                                	.IFF
     294                                	.IF	EQ,MASINA-MDS
     295                                	TIMER=177546	;АДРЕС CSR ТАЙМЕРА
     296                                	.ENDC
     297                                	ARSK=177560	;АДРЕС РСК
     298                                	ARDK=177562		;АДРЕС РДК
     299                                	ARSTV=177564		;АДРЕС РСТВ
     300                                	ARDTV=177566		;АДРЕС РДТВ
     301                                	AVPK=60		;АДРЕС ВЕКТОРА ПРЕР. КЛ.
     302                                ;
     303                                	.IFT
     304 177662                         	ARDK=177662		;adres rdk bk0010
     305                                	;
     306                                	; ---------------------------------------
     307                                	; ## ИНИЦИАЛИЗАЦИЯ БЛОКА ВВОДА-ВЫВОДА ###
     308                                	; ---------------------------------------
     309                                	;
     310                                MIDM:
     311 000000                         .IF	EQ,MEMTYP-ROM
     312 120542 000005                  	RESET
     313 120544 104014                  	EMT	14
     314                                .IFF
     315                                	CLR	@#260
     316                                	EMT	34
     317                                	ASR	R0
     318                                	BCS	1$
     319                                .ENDC
     320 120546 012700  000233           	MOV	#233,R0
     321 120552 104016                  	EMT	16
     322 120554 012700  000236          1$:	MOV	#236,R0
     323 120560 104016                  	EMT	16
     324 120562 012700  003022          	MOV	#BUF,R0
     325 120566 012720  005012          2$:	MOV	#5012,(0)+
     326 120572 020027  003052          	CMP	R0,#TEXT
     327 120576 103773                  	BLO	2$
     328 120600 005067  003016'         	CLR	IODEV
     329 120604 000207                  	RETURN
     330                                ;
     331 120606 012701  002140          KINIT:	MOV	#FNKSTR,R1
     332 120612 012702  120660          	MOV	#KEYTXT,R2
     333 120616 005003                  	CLR	R3
     334 120620 005203                  2$:	INC	R3
     335 120622 010104                  	MOV	R1,R4
     336 120624 010300                  	MOV	R3,R0
     337 120626 104012                  	EMT	12
     338 120630 111205                  	MOVB	@R2,R5
     339 120632 005205                  	INC	R5
     340 120634 112224                  1$:	MOVB	(R2)+,(R4)+
     341 120636 077502                  	SOB	R5,1$
     342 120640 062701  000021          	ADD	#17.,R1
     343 120644 020327  000012          	CMP	R3,#10.
     344 120650 103763                  	BLO	2$
     345 120652 004767  120760'         	CALL	ISVSS
     346 120656 000207                  	RETURN
     347 120660    006     103     117  KEYTXT:	.ASCII	<6>/COLOR /<5>/AUTO /<5>/GOTO /<5>/LIST /<4>/RUN/<12>
         120663    114     117     122  
         120666    040     005     101  
         120671    125     124     117  
         120674    040     005     107  
         120677    117     124     117  
         120702    040     005     114  
         120705    111     123     124  
         120710    040     004     122  
         120713    125     116     012  
     348 120716    012     103     117  	.ASCII	<12>/COLOR 1,0/<12><6>/CLOAD"/<5>/CONT/<12><2>/./<12>
         120721    114     117     122  
         120724    040     061     054  
         120727    060     012     006  
         120732    103     114     117  
         120735    101     104     042  
         120740    005     103     117  
         120743    116     124     012  
         120746    002     056     012  
     349 120751    005     014     122  	.ASCII	<5><14>/RUN/<12>
         120754    125     116     012  
     350 120757    000                  	.EVEN
     351                                ;
     352 120760 012700  000236          ISVSS::	MOV	#236,R0
     353 120764 104016                  	EMT	16
     354 120766 012703  002140          	MOV	#FNKSTR,R3
     355 120772 005001                  	CLR	R1
     356 120774 010305                  4$:	MOV	R3,R5
     357 120776 112502                  	MOVB	(R5)+,R2
     358 121000 012700  000040          	MOV	#' ,R0
     359 121004 005302                  3$:	DEC	R2
     360 121006 100404                  	BMI	5$
     361 121010 122725  000040          	CMPB	#' ,(R5)+
     362 121014 002373                  	BGE	3$
     363 121016 114500                  	MOVB	-(R5),R0
     364 121020 104022                  5$:	EMT	22
     365 121022 062703  000021          	ADD	#17.,R3
     366 121026 005201                  	INC	R1
     367 121030 020127  000012          	CMP	R1,#10.
     368 121034 002757                  	BLT	4$
     369 121036 112700  000040          	MOVB	#' ,R0
     370 121042 104022                  	EMT	22
     371 121044 005201                  	INC	R1
     372 121046 104022                  	EMT	22
     373 121050 000207                  	RETURN
     374                                ;
     375                                	.IFF
     376                                MIDM:
     377                                	.IF	EQ,MASINA-MDS
     378                                	CLR	TIMER
     379                                	.ENDC
     380                                	RESET
     381                                	MOV	#12,BUF+6
     382                                	MOV	#IVS,AVPK
     383                                	BIS	#100,ARSK
     384                                	CLR	IODEV
     385                                	RTS	PC
     386                                	;
     387                                	.IFTF
     388                                	;
     389                                	; -------------------
     390                                	; ## ЧТЕНИЕ СТРОКИ ##
     391                                	; -------------------
     392                                	;
     393                                	.IFT
     394 121052 010046                  IVEIL::	MOV	R0,-(SP)		;СОХРАНЕНИЕ РЕГИСТРОВ
     395 121054 010246                  	MOV	R2,-(SP)
     396 121056 010346                  	MOV	R3,-(SP)
     397 121060 010546                  	MOV	R5,-(SP)
     398 121062 104026                  SBRALL:	EMT	26
     399 121064 010146                  	MOV	R1,-(SP)
     400 121066 012701  003022          SBROS:	MOV	#BUF,R1		;АДРЕС СТРОКИ
     401 121072 010103                  	MOV	R1,R3
     402 121074 012702  000400          	MOV	#400,R2		;ДЛИНА СТРОКИ
     403 121100 010246                  	MOV	R2,-(SP)
     404 121102 104006                  PIJ::	EMT	6		;ЧТЕНИЕ ОЧЕРЕДНОГО СИМВОЛА
     405 121104 110005                  	MOVB	R0,R5
     406 121106 002062                  	BGE	5$
     407 121110 120027  000211          	CMPB	R0,#211
     408 121114 001436                  	BEQ	55$
     409 110000                         .IF	EQ,MEMTYP-RAM
     410                                	CMPB	R0,#214
     411                                	BEQ	PIJ
     412                                .ENDC
     413 121116 120027  000240          	CMPB	R0,#240
     414 121122 002042                  	BGE	14$
     415 121124 120027  000233          	CMPB	R0,#233
     416 121130 002030                  	BGE	55$
     417 121132 120027  000231          	CMPB	R0,#231
     418 121136 001002                  	BNE	153$
     419 121140 000167  121620'         	JMP	26$
     420 121144 120027  000225          153$:	CMPB	R0,#225
     421 121150 003354                  	BGT	PIJ
     422 121152 001012                  	BNE	12$
     423 121154 104016                  13$:	EMT	16
     424 121156 104006                  	EMT	6
     425 121160 120027  000225          	CMPB	R0,#225
     426 121164 001373                  	BNE	13$
     427 121166 104016                  	EMT	16
     428 121170 022626                  	CMP	(SP)+,(SP)+
     429 121172 004767  120760'         	CALL	ISVSS
     430 121176 000731                  	BR	SBRALL
     431 121200 120027  000220          12$:	CMPB	R0,#220
     432 121204 001002                  	BNE	55$
     433 121206 004767  123132'         	CALL	STEP
     434 121212 104016                  55$:	EMT	16
     435 121214 120527  000236          	CMPB	R5,#236
     436 121220 001330                  	BNE	PIJ
     437 121222 004767  120760'         	CALL	ISVSS
     438 121226 000725                  	BR	PIJ
     439 121230 020103                  14$:	CMP	R1,R3		;ЗАПИСЬ ОЧЕРЕДНОГО СИМВОЛА
     440 121232 001402                  	BEQ	17$
     441 121234 005202                  	INC	R2
     442 121236 005303                  	DEC	R3
     443 121240 110021                  17$:	MOVB	R0,(R1)+
     444 121242 005203                  16$:	INC	R3
     445                                15$:				;wywod na |kran
     446 177777                         .IF	EQ,KONTYP-KLAS
     447                                	CALL	ISV
     448                                .IFF
     449 121244 104016                  	EMT	16
     450                                .ENDC
     451 121246 005302                  	DEC	R2
     452 121250 001314                  	BNE	PIJ
     453 121252 104431                  47$:	TRAP	25.		;СЛИШКОМ ДЛИННАЯ СТРОКА
     454 121254 120027  000177          5$:	CMPB	R0,#177
     455 121260 001003                  	BNE	155$
     456 121262 112700  000026          	MOVB	#26,R0
     457 121266 000554                  	BR	26$
     458 121270 120027  000003          155$:	CMPB	R0,#3
     459 121274 001002                  	BNE	20$
     460 121276 000167  120200'         	JMP	CTRLC
     461 121302 120027  000040          20$:	CMPB	R0,#40
     462 121306 002350                  	BGE	14$
     463 121310 120027  000007          	CMPB	R0,#7
     464 121314 001736                  	BEQ	55$
     465 121316 120027  000010          	CMPB	R0,#10
     466 121322 001453                  	BEQ	2$
     467 121324 120027  000012          	CMPB	R0,#12
     468 121330 001536                  	BEQ	3$
     469 121332 120027  000014          	CMPB	R0,#14
     470 121336 001422                  	BEQ	4$
     471 121340 162705  000023          	SUB	#23,R5
     472 121344 002656                  	BLT	PIJ
     473 121346 006305                  	ASL	R5
     474 121350 060507                  	ADD	R5,PC
     475 121352 000502                  	BR	21$
     476 121354 000453                  	BR	51$
     477 121356 000651                  	BR	PIJ
     478 121360 000517                  	BR	26$
     479 121362 000544                  	BR	27$
     480 121364 000412                  	BR	6$
     481 121366 000436                  	BR	7$
     482 121370 000553                  	BR	132$
     483 121372 000555                  	BR	133$
     484 121374 000557                  	BR	134$
     485 121376 000562                  	BR	135$
     486 121400 000565                  	BR	136$
     487 121402 000570                  	BR	137$
     488 121404 104016                  4$:	EMT	16		;ОЧИСТКА
     489 121406 005726                  	TST	(SP)+
     490 121410 000626                  	BR	SBROS
     491 121412 020216                  6$:	CMP	R2,@SP		;АНУЛИРОВАНИЕ СИМВОЛА
     492 121414 001413                  	BEQ	152$
     493 121416 020103                  	CMP	R1,R3
     494 121420 001004                  	BNE	1$
     495 121422 005301                  	DEC	R1
     496 121424 005303                  	DEC	R3
     497 121426 005202                  	INC	R2
     498 121430 000404                  	BR	151$
     499 121432 022701  003022          1$:	CMP	#BUF,R1
     500 121436 001402                  	BEQ	152$
     501 121440 105741                  	TSTB	-(R1)
     502 121442 104016                  151$:	EMT	16
     503 121444 112700  000026          152$:	MOVB	#26,R0
     504 121450 000463                  	BR	26$
     505 121452 022701  003022          2$:	CMP	#BUF,R1		;  <---
     506 121456 001611                  	BEQ	PIJ
     507 121460 005301                  	DEC	R1
     508 121462 000653                  	BR	55$
     509 121464 020103                  7$:	CMP	R1,R3		;  --->
     510 121466 001403                  	BEQ	11$
     511 121470 005201                  	INC	R1
     512 121472 005202                  	INC	R2
     513 121474 000663                  	BR	15$
     514 121476 112721  000040          11$:	MOVB	#40,(R1)+
     515 121502 000657                  	BR	16$
     516 121504 112700  000031          51$:	MOVB	#31,R0		;gorizontalxnaq tabulqciq
     517 121510 020103                  	CMP	R1,R3
     518 121512 103405                  	BLO	52$
     519 121514 112700  000040          	MOVB	#40,R0
     520 121520 005203                  	INC	R3
     521 121522 005302                  	DEC	R2
     522 121524 003652                  	BLE	47$
     523 121526 005201                  52$:	INC	R1
     524 121530 104016                  	EMT	16
     525 121532 010146                  	MOV	R1,-(SP)
     526 121534 010246                  	MOV	R2,-(SP)
     527 121536 104026                  	EMT	26
     528 121540 010105                  	MOV	R1,R5
     529 121542 012602                  	MOV	(SP)+,R2
     530 121544 012601                  	MOV	(SP)+,R1
     531 121546 032705  000007          	BIT	#7,R5
     532 121552 001354                  	BNE	51$
     533 121554 000167  121102'         	JMP	PIJ
     534 121560 020327  003022          21$:	CMP	R3,#BUF
     535 121564 001005                  	BNE	49$
     536 121566 005767  002000'         	TST	LYGIS
     537 121572 100402                  	BMI	49$
     538 121574 000167  140170'         	JMP	BC
     539 121600 112700  000010          49$:	MOVB	#10,R0			;wozwrat stroki
     540 121604 022701  003022          41$:	CMP	#BUF,R1
     541 121610 001567                  	BEQ	48$
     542 121612 104016                  	EMT	16
     543 121614 005301                  	DEC	R1
     544 121616 000772                  	BR	41$
     545 121620 020103                  26$:	CMP	R1,R3		;СМЫКАНИЕ СТРОКИ
     546 121622 001562                  	BEQ	48$
     547 121624 000563                  	BR	42$
     548 121626 020301                  3$:	CMP	R3,R1			;konec ~teniq stroki
     549 121630 001410                  	BEQ	53$
     550 121632 024646                  	CMP	-(SP),-(SP)
     551 121634 004767  122360'         	CALL	PELING
     552                                40$:
     553 177777                         .IF	EQ,KONTYP-KLAS
     554                                	CALL	ISV
     555                                .IFF
     556 121640 104016                  	EMT	16
     557                                .IFTF
     558 121642 005305                  	DEC	R5
     559 121644 002375                  	BGE	40$
     560 121646 022626                  	CMP	(SP)+,(SP)+
     561 121650 000401                  	BR	54$
     562                                53$:
     563                                .IFT
     564                                	CALL	ISV
     565                                .IFF
     566 121652 104016                  	EMT	16
     567                                .ENDC
     568 121654 110023                  54$:	MOVB	R0,(R3)+
     569 121656 010301                  	MOV	R3,R1
     570 121660 022626                  	CMP	(SP)+,(SP)+
     571 121662 012605                  	MOV	(SP)+,R5
     572 121664 012603                  	MOV	(SP)+,R3
     573 121666 012602                  	MOV	(SP)+,R2
     574 121670 012600                  	MOV	(SP)+,R0
     575 121672 000207                  	RTS	PC
     576 121674 020103                  27$:	CMP	R1,R3		;РАЗМЫКАНИЕ СТРОКИ
     577 121676 001534                  	BEQ	48$
     578 121700 010305                  	MOV	R3,R5
     579 121702 114565  000001          31$:	MOVB	-(R5),1(R5)
     580 121706 020501                  	CMP	R5,R1
     581 121710 101374                  	BHI	31$
     582 121712 112711  000040          	MOVB	#40,@R1
     583 121716 000526                  	BR	42$
     584 121720 004567  122472'         132$:	JSR	R5,RSSE
     585 121724 000436                  	BR	142$
     586 121726 004567  122472'         133$:	JSR	R5,RSSE
     587 121732 000440                  	BR	143$
     588 121734 004567  122472'         134$:	JSR	R5,RSSE
     589 121740 005301                  	DEC	R1
     590 121742 000427                  	BR	142$
     591 121744 004567  122472'         135$:	JSR	R5,RSSE
     592 121750 005201                  	INC	R1
     593 121752 000423                  	BR	142$
     594 121754 004567  122472'         136$:	JSR	R5,RSSE
     595 121760 005201                  	INC	R1
     596 121762 000424                  	BR	143$
     597 121764 004567  122472'         137$:	JSR	R5,RSSE
     598 121770 005301                  	DEC	R1
     599 121772 000420                  	BR	143$
     600 121774 104016                  43$:	EMT	16
     601 121776 005305                  	DEC	R5
     602 122000 002406                  	BLT	44$
     603 122002 112700  000012          	MOVB	#12,R0
     604 122006 104016                  	EMT	16
     605 122010 112700  000231          	MOVB	#231,R0
     606 122014 000767                  	BR	43$
     607 122016 010103                  44$:	MOV	R1,R3
     608 122020 000450                  	BR	33$
     609 122022 160001                  142$:	SUB	R0,R1
     610 122024 020127  003022          	CMP	R1,#BUF
     611 122030 103404                  	BLO	140$
     612 122032 000406                  	BR	141$
     613 122034 060001                  143$:	ADD	R0,R1
     614 122036 020103                  	CMP	R1,R3
     615 122040 101403                  	BLOS	141$
     616 122042 012601                  140$:	MOV	(SP)+,R1
     617 122044 012600                  	MOV	(SP)+,R0
     618 122046 000450                  	BR	48$
     619 122050 005726                  141$:	TST	(SP)+
     620 122052 012600                  	MOV	(SP)+,R0
     621 122054 104016                  	EMT	16
     622 122056 000444                  	BR	48$
     623 122060 104016                  34$:	EMT	16		;smykanie stroki
     624 122062 005305                  	DEC	R5
     625 122064 002416                  	BLT	45$
     626 122066 112700  000012          	MOVB	#12,R0
     627 122072 104016                  	EMT	16
     628 122074 112700  000010          	MOVB	#10,R0
     629 122100 104016                  	EMT	16
     630 122102 066616  000002          	ADD	2(SP),@SP
     631 122106 117600  000000          	MOVB	@(SP),R0
     632 122112 104016                  	EMT	16
     633 122114 112700  000026          	MOVB	#26,R0
     634 122120 000757                  	BR	34$
     635 122122 010105                  45$:	MOV	R1,R5
     636 122124 005205                  	INC	R5
     637 122126 112565  177776          30$:	MOVB	(R5)+,-2(R5)
     638 122132 020503                  	CMP	R5,R3
     639 122134 103774                  	BLO	30$
     640 122136 005202                  	INC	R2
     641 122140 005303                  	DEC	R3
     642 122142 010146                  33$:	MOV	R1,-(SP)
     643 122144 010246                  	MOV	R2,-(SP)
     644 122146 116601  000010          	MOVB	10(SP),R1
     645 122152 116602  000011          	MOVB	11(SP),R2
     646 122156 104024                  	EMT	24
     647 122160 012602                  	MOV	(SP)+,R2
     648 122162 012601                  	MOV	(SP)+,R1
     649 122164 062706  000006          	ADD	#6,SP
     650 122170 000167  121102'         48$:	JMP	PIJ
     651 122174 005046                  42$:	CLR	-(SP)
     652 122176 005046                  	CLR	-(SP)
     653 122200 004767  122360'         	CALL	PELING
     654 122204 012746  003022          	MOV	#BUF,-(SP)
     655 122210 166616  000010          	SUB	10(SP),@SP
     656 122214 005366  000004          32$:	DEC	4(SP)
     657 122220 002403                  	BLT	37$
     658 122222 066616  000002          	ADD	2(SP),@SP
     659 122226 000772                  	BR	32$
     660 122230 010146                  37$:	MOV	R1,-(SP)
     661 122232 010246                  	MOV	R2,-(SP)
     662 122234 104026                  	EMT	26
     663 122236 110166  000010          	MOVB	R1,10(SP)
     664 122242 110266  000011          	MOVB	R2,11(SP)
     665 122246 012602                  	MOV	(SP)+,R2
     666 122250 012601                  	MOV	(SP)+,R1
     667 122252 032700  000001          	BIT	#1,R0
     668 122256 001700                  	BEQ	34$
     669 122260 105700                  	TSTB	R0
     670 122262 100644                  	BMI	43$
     671 122264 104016                  	EMT	16
     672 122266 005305                  36$:	DEC	R5
     673 122270 002427                  	BLT	35$
     674 122272 001012                  	BNE	128$
     675 122274 010146                  	MOV	R1,-(SP)
     676 122276 010246                  	MOV	R2,-(SP)
     677 122300 104026                  	EMT	26
     678 122302 020227  000027          	CMP	R2,#27
     679 122306 001002                  	BNE	129$
     680 122310 105366  000011          	DECB	11(SP)
     681 122314 012602                  129$:	MOV	(SP)+,R2
     682 122316 012601                  	MOV	(SP)+,R1
     683 122320 066616  000002          128$:	ADD	2(SP),@SP
     684 122324 112700  000012          	MOVB	#12,R0
     685 122330 104016                  	EMT	16
     686 122332 112700  000027          	MOVB	#27,R0
     687 122336 104016                  	EMT	16
     688 122340 117600  000000          	MOVB	@(SP),R0
     689 122344 104016                  	EMT	16
     690 122346 000747                  	BR	36$
     691 122350 005203                  35$:	INC	R3
     692 122352 005302                  	DEC	R2
     693 122354 003272                  	BGT	33$
     694 122356 104431                  	TRAP	31
     695                                	;
     696 122360 010046                  PELING:	MOV	R0,-(SP)
     697 122362 010146                  	MOV	R1,-(SP)
     698 122364 010346                  	MOV	R3,-(SP)
     699 122366 162701  003022          	SUB	#BUF,R1
     700 122372 162703  003022          	SUB	#BUF,R3
     701 122376 066601  000016          	ADD	16(SP),R1
     702 122402 066603  000016          	ADD	16(SP),R3
     703 122406 005201                  	INC	R1
     704 122410 004767  122500'         	CALL	SSE
     705 122414 005005                  	CLR	R5
     706 122416 160003                  9$:	SUB	R0,R3
     707 122420 002410                  	BLT	4$
     708 122422 001402                  	BEQ	6$
     709 122424 005205                  	INC	R5
     710 122426 000773                  	BR	9$
     711 122430 122766  000027  000004  6$:	CMPB	#27,4(SP)
     712 122436 001001                  	BNE	4$
     713 122440 005205                  	INC	R5
     714 122442 160001                  4$:	SUB	R0,R1
     715 122444 003404                  	BLE	5$
     716 122446 005266  000012          	INC	12(SP)
     717 122452 005305                  	DEC	R5
     718 122454 000772                  	BR	4$
     719 122456 010066  000010          5$:	MOV	R0,10(SP)
     720 122462 012603                  	MOV	(SP)+,R3
     721 122464 012601                  	MOV	(SP)+,R1
     722 122466 012600                  	MOV	(SP)+,R0
     723 122470 000207                  	RTS	PC
     724                                ;
     725 122472 010016                  RSSE:	MOV	R0,(SP)
     726 122474 010146                  	MOV	R1,-(SP)
     727 122476 010546                  	MOV	R5,-(SP)
     728 122500 104034                  SSE:	EMT	34
     729 122502 006000                  	ROR	R0
     730 122504 103403                  	BCS	1$
     731 122506 012700  000100          	MOV	#100,R0
     732 122512 000207                  	RTS	PC
     733 122514 012700  000040          1$:	MOV	#40,R0
     734 122520 000207                  	RTS	PC
     735                                ;
     736                                	.IFF
     737                                	;
     738                                	; ----------------------
     739                                	; ----------------------
     740                                	; ВЫХОД : КОД В R0 (МЛ. БАИТ)
     741                                	;
     742                                IVS::	CLR	ARSK
     743                                	MOVB	ARDK,R0
     744                                	INCB	SIIKP
     745                                	CALL	ALRIC
     746                                	RTI
     747                                	;
     748                                	; --------------------
     749                                	; ### ВЫВОД СИМВОЛА ##
     750                                	; --------------------
     751                                	; ВХОД : КОД В R0 (МЛ. БАИТ)
     752                                	;
     753                                	.IFT
     754 122522 104016                  ISV::	EMT	16
     755 177777                         .IF	EQ,KONTYP-KLAS
     756                                	TST	EKRHUK
     757                                	BEQ	1$
     758                                	CALL	@EKRHUK
     759                                1$:
     760                                .ENDC
     761 122524 000207                  	RETURN
     762                                	.IFTF
     763 122526 005767  003016'         ISVTO::	TST	IODEV
     764 122532 001773                  	BEQ	ISV
     765 122534 012701  003022          	MOV	#BUFOUT,R1
     766 122540 012702  000001          	MOV	#1,R2
     767 122544 110011                  	MOVB	R0,@R1
     768                                	.IFF
     769                                	JMP	ISVEIL
     770                                	;
     771                                CRLF:	MOV	#15,R0
     772                                	CMPB	TABY,#27
     773                                	BEQ	ISV
     774                                	INCB	TABY
     775                                ;
     776                                ISV::	TSTB	ARSTV
     777                                	BPL	ISV
     778                                	MOVB	R0,ARDTV
     779                                	CMPB	R0,#12
     780                                	BEQ	CRLF
     781                                	CMPB	TABX,#117
     782                                	BNE	30$
     783                                	CMPB	TABY,#27
     784                                	BEQ	31$
     785                                	INCB	TABY
     786                                	BR	31$
     787                                30$:	INCB	TABX
     788                                	CMPB	R0,#15
     789                                	BNE	33$
     790                                31$:	CLRB	TABX
     791                                33$:	RTS	PC
     792                                	;
     793                                	; ---------------------
     794                                	; ### ЧТЕНИЕ СТРОКИ ###
     795                                	; ---------------------
     796                                	;
     797                                IVEIL::	MOV	R0,-(SP)		;СОХРАНЕНИЕ РЕГИСТРОВ
     798                                	MOV	R2,-(SP)
     799                                	MOV	R3,-(SP)
     800                                	MOV	R5,-(SP)
     801                                	MOVB	TABX,-(SP)
     802                                SBROS:	MOV	#BUF,R1		;АДРЕС СТРОКИ
     803                                	MOV	R1,R3
     804                                	MOV	#377,R2		;ДЛИНА СТРОКИ
     805                                	MOV	R2,-(SP)
     806                                PIJ::	CLRB	SIIKP		;РЕЗРЕШЕНИЕ ПРЕРЫВАНИЯ С КЛАВИАТУРЫ
     807                                	BIS	#100,ARSK
     808                                14$:	TSTB	SIIKP		;ЧТЕНИЕ ОЧЕРЕДНОГО СИМВОЛА
     809                                	BEQ	14$
     810                                	CMPB	R0,#40
     811                                	BGE	6$
     812                                	CMPB	R0,#11
     813                                	BNE	22$
     814                                	JMP	33$
     815                                22$:	CMPB	R0,#13
     816                                	BNE	21$
     817                                	JMP	15$
     818                                21$:	CMPB	R0,#3
     819                                	BNE	44$
     820                                	JMP	CTRLC
     821                                44$:	CMPB	R0,#14
     822                                	BEQ	1$
     823                                	CMPB	R0,#15
     824                                	BEQ	2$
     825                                	CMPB	R0,#16
     826                                	BEQ	3$
     827                                	CMPB	R0,#17
     828                                	BEQ	3$
     829                                	CMPB	R0,#23
     830                                	BEQ	27$
     831                                	CMPB	R0,#24
     832                                	BEQ	30$
     833                                	CMPB	R0,#25
     834                                	BEQ	8$
     835                                	CMPB	R0,#31
     836                                	BEQ	4$
     837                                	CMPB	R0,#32
     838                                	BEQ	5$
     839                                	CMPB	R0,#33
     840                                	BNE	PIJ
     841                                	BIS	#100,ARSK
     842                                	CALL	STEP
     843                                	BR	PIJ
     844                                6$:	CMPB	R0,#177
     845                                	BEQ	53$
     846                                	JMP	16$
     847                                53$:	CMP	R2,@SP		;АНУЛИРОВАНИЕ СИМВОЛА
     848                                	BEQ	PIJ
     849                                	CMP	R1,R3
     850                                	BNE	7$
     851                                	DEC	R1
     852                                	DEC	R3
     853                                	TST	(R2)+
     854                                	BR	11$
     855                                7$:	CMP	#BUF,R1
     856                                	BEQ	PIJ
     857                                	MOVB	#40,-(R1)
     858                                	INC	R2
     859                                11$:	MOVB	#32,R0
     860                                	DECB	TABX
     861                                	DECB	TABX
     862                                	CALL	ISV
     863                                	MOVB	#40,R0
     864                                	CALL	ISV
     865                                	MOVB	#32,R0
     866                                	BR	12$
     867                                1$:	CALL	ISV		;ОЧИСТКА
     868                                	CLRB	TABX
     869                                	CLRB	TABY
     870                                	TST	(SP)+
     871                                	BR	SBROS
     872                                2$:	MOVB	#12,R0		;КОНЕЦ ЧТЕНИЯ СТРОКИ
     873                                	MOV	R3,R1
     874                                	DEC	R2
     875                                	BEQ	24$
     876                                	MOVB	R0,(R1)+
     877                                	CALL	ISV		;ПО СИМВОЛУ ЗАВЕРШИТЕЛЮ
     878                                	BR	KCTSTR
     879                                3$:	DECB	TABX
     880                                	CALL	ISV		;РУС. ЛАТ.
     881                                	BR	PIJ
     882                                27$:	CMP	R1,R3		;РАЗМЫКАНИЕ СТРОКИ
     883                                	BEQ	PIJ
     884                                	MOV	R3,R5
     885                                31$:	MOVB	-(R5),1(R5)
     886                                	CMP	R5,R1
     887                                	BHI	31$
     888                                	MOVB	#40,@R1
     889                                	DECB	TABX
     890                                	BR	17$
     891                                30$:	CMP	R1,R3		;СМЫКАНИЕ СТРОКИ
     892                                	BEQ	18$
     893                                	MOV	R1,R5
     894                                	INC	R5
     895                                32$:	MOVB	(R5)+,-2(R5)
     896                                	CMP	R5,R3
     897                                	BLO	32$
     898                                	TST	(R2)+
     899                                	DEC	R3
     900                                	DECB	TABX
     901                                	CALL	KISV
     902                                	BR	23$
     903                                4$:	CMP	R1,R3		; --->
     904                                	BEQ	13$
     905                                	INC	R1
     906                                	INC	R2
     907                                	CALL	KISV
     908                                	BR	23$
     909                                13$:	MOVB	#40,R0
     910                                	MOVB	R0,(R1)+
     911                                	BR	17$
     912                                5$:	CMP	R2,@SP		; <---
     913                                	BEQ	18$
     914                                	CMP	#BUF,R1
     915                                	BEQ	18$
     916                                	DEC	R1
     917                                	INC	R2
     918                                12$:	DECB	TABX
     919                                	DECB	TABX
     920                                	CALL	KISV
     921                                	BR	23$
     922                                8$:	CMP	R3,#BUF		;wozwrat stroki
     923                                	BNE	180$
     924                                	JMP	BC
     925                                180$:	MOVB	#32,R0
     926                                9$:	CMP	R1,#BUF
     927                                	BEQ	23$
     928                                	DEC	TABX
     929                                	DEC	TABX
     930                                	CALL	KISV
     931                                	DEC	R1
     932                                	INC	R2
     933                                	BR	9$
     934                                15$:	DEC	TABX		;sbros konca stroki
     935                                	CALL	KISV
     936                                	MOV	R1,R3
     937                                26$:	JMP	PIJ
     938                                33$:	MOVB	#31,R0		;gorizontalxnaq tabulqciq
     939                                	CMP	R1,R3
     940                                	BLO	34$
     941                                	MOVB	#40,R0
     942                                	INC	R3
     943                                	DEC	R2
     944                                	BLE	24$
     945                                34$:	INC	R1
     946                                	CALL	KISV
     947                                	BITB	#111,TABX
     948                                	BNE	33$
     949                                	JMP	PIJ
     950                                16$:	CMP	R1,R3		;ЗАПИСЬ ОЧЕРЕДНОГО СИМВОЛА
     951                                	BEQ	25$
     952                                	INC	R2
     953                                	DEC	R3
     954                                25$:	MOVB	R0,(R1)+
     955                                17$:	INC	R3
     956                                	CALL	KISV
     957                                23$:	DEC	R2
     958                                	BEQ	24$
     959                                18$:	JMP	PIJ
     960                                24$:	CLRB	SIIKP
     961                                	BIS	#100,ARSK
     962                                	TRAP	31		;СЛИШКОМ ДЛИННАЯ СТРОКА
     963                                KCTSTR:	CMP	(SP)+,(SP)+
     964                                	MOV	(SP)+,R5
     965                                	MOV	(SP)+,R3
     966                                	MOV	(SP)+,R2
     967                                	MOV	(SP)+,R0
     968                                	CLRB	SIIKP
     969                                	BIS	#100,ARSK
     970                                	RTS	PC
     971                                KISV:	CALL	ISV		;ОТОБРАЖЕНИЕ ОЧЕРЕДНОГО СИМВОЛА
     972                                	TSTB	TABX
     973                                	BGE	21$
     974                                	DECB	TABY
     975                                	BLT	22$
     976                                	MOVB	#117,TABX
     977                                21$:	RTS	PC
     978                                22$:	MOVB	#27,TABY
     979                                	MOVB	#117,TABX
     980                                	RTS	PC
     981                                	;
     982                                	; --------------------------
     983                                	; ### ОТОБРАЖЕНИЕ СТРОКИ ###
     984                                	; --------------------------
     985                                	; ВХОД:	R1- АДРЕС СТРОКИ
     986                                	;		R2- ДЛИНА СТРОКИ (МЛ. БАИТ)
     987                                	;		  - СИМВОЛ ОГРАНИЧИТЕЛЬ (СТ. БАИТ)
     988                                	;
     989                                	.IFT
     990 122546 010346                  ISVETO::MOV	R3,-(SP)
     991 122550 016703  003016'         	MOV	IODEV,R3
     992 122554 001003                  	BNE	LP
     993 122556 012603                  	MOV	(SP)+,R3
     994                                ISVEIL::
     995 177777                         .IF	EQ,KONTYP-KLAS
     996                                	MOV	R1,-(SP)
     997                                	MOV	R2,-(SP)
     998                                .IFTF
     999 122560 104020                  	EMT	20
    1000                                .IFT
    1001                                	TST	EKRHUK
    1002                                	BEQ	3$
    1003                                	MOV	(SP)+,R2
    1004                                	MOV	(SP)+,R1
    1005                                	MOV	R0,-(SP)
    1006                                	MOV	R3,-(SP)
    1007                                	MOV	R2,R3
    1008                                	SWAB	R3
    1009                                	BIC	#177400,R2
    1010                                1$:	MOVB	(R1)+,R0
    1011                                	CALL	@EKRHUK
    1012                                	CMPB	R0,R3
    1013                                	BEQ	2$
    1014                                	SOB	R2,1$
    1015                                2$:	MOV	(SP)+,R3
    1016                                	MOV	(SP)+,R0
    1017                                .ENDC
    1018 122562 000207                  3$:	RETURN
    1019                                ;
    1020 122564 100123                  LP::	BPL	FILOUT
    1021 122566 010046                  	MOV	R0,-(SP)
    1022 122570 010546                  	MOV	R5,-(SP)
    1023 122572 010203                  	MOV	R2,R3
    1024 122574 000303                  	SWAB	R3
    1025 122576 042702  177400          	BIC	#177400,R2
    1026 122602 012705  177714          	MOV	#ARPORT,R5
    1027 122606 112700  000023          	MOVB	#23,R0
    1028 122612 004767  122766'         	CALL	LPISV
    1029 122616 112100                  1$:	MOVB	(1)+,R0
    1030 122620 120027  000037          	CMPB	R0,#37
    1031 122624 101406                  	BLOS	2$
    1032 122626 120027  000177          	CMPB	R0,#177
    1033 122632 103442                  	BLO	3$
    1034 122634 120027  000277          	CMPB	R0,#277
    1035 122640 101037                  	BHI	3$
    1036 122642 120027  000010          2$:	CMPB	R0,#10
    1037 122646 001425                  	BEQ	6$
    1038 122650 120027  000014          	CMPB	R0,#14
    1039 122654 001417                  	BEQ	8$
    1040 122656 120027  000015          	CMPB	R0,#15
    1041 122662 001414                  	BEQ	8$
    1042 122664 120027  000205          	CMPB	R0,#205
    1043 122670 001411                  	BEQ	8$
    1044 122672 120027  000012          	CMPB	R0,#12
    1045 122676 001022                  	BNE	9$
    1046 122700 112700  000015          	MOVB	#15,R0
    1047 122704 004767  122766'         	CALL	LPISV
    1048 122710 012700  000012          	MOV	#12,R0
    1049 122714 105067  002136'         8$:	CLRB	LPTPOS
    1050 122720 000411                  	BR	9$
    1051 122722 105367  002136'         6$:	DECB	LPTPOS
    1052 122726 003006                  	BGT	9$
    1053 122730 112767  000077  002136' 	MOVB	#77,LPTPOS
    1054 122736 000402                  	BR	9$
    1055 122740 105267  002136'         3$:	INCB	LPTPOS
    1056 122744 004767  122766'         9$:	CALL	LPISV
    1057 122750 120003                  	CMPB	R0,R3
    1058 122752 001401                  	BEQ	5$
    1059 122754 077260                  	SOB	R2,1$
    1060 122756 012605                  5$:	MOV	(SP)+,R5
    1061 122760 012600                  	MOV	(SP)+,R0
    1062 122762 012603                  	MOV	(SP)+,R3
    1063 122764 000207                  	RETURN
    1064                                ;
    1065 122766 042700  177000          LPISV:	BIC	#177000,R0
    1066 122772 052700  000400          	BIS	#400,R0
    1067 122776 032715  000400          2$:	BIT	#400,@R5
    1068 123002 001775                  	BEQ	2$
    1069 123004 010015                  	MOV	R0,@R5
    1070 123006 032715  000400          3$:	BIT	#400,@R5
    1071 123012 001375                  	BNE	3$
    1072 123014 005015                  	CLR	@R5
    1073 123016 126727  002136' 000100  	CMPB	LPTPOS,#100
    1074 123024 003402                  	BLE	1$
    1075 123026 105067  002136'         	CLRB	LPTPOS
    1076 123032 000207                  1$:	RETURN
    1077                                ;
    1078                                	.IFF
    1079                                ISVETO::
    1080                                ISVEIL::MOV	R0,-(SP)
    1081                                	MOV	R3,-(SP)
    1082                                	MOV	R2,R3		;ОТРАБОТКА ПРИЗНАКОВ КОНЦА СТРОКИ
    1083                                	SWAB	R3
    1084                                	CMPB	R3,#12
    1085                                	BNE	11$
    1086                                	MOVB	#15,R3
    1087                                11$:	BIC	#177400,R2
    1088                                	MOV	IODEV,R0
    1089                                	BNE	LP
    1090                                1$:	TSTB	@R1
    1091                                	BPL	2$
    1092                                	TSTB	RLPOZ		;КИРИЛИЦЫ
    1093                                	BNE	4$
    1094                                	INCB	RLPOZ
    1095                                	MOVB	#16,R0
    1096                                	CALL	ISV
    1097                                	DECB	TABX
    1098                                4$:	CLR	-(SP)
    1099                                	MOVB	(R1)+,@SP
    1100                                	SUB	#200,@SP
    1101                                	MOVB	@SP,R0
    1102                                	TST	(SP)+
    1103                                	BR	3$
    1104                                2$:	TSTB	RLPOZ
    1105                                	BEQ	5$
    1106                                	CLRB	RLPOZ
    1107                                	MOVB	#17,R0
    1108                                	CALL	ISV
    1109                                	DECB	TABX
    1110                                5$:	MOVB	(R1)+,R0
    1111                                3$:	CALL	ISV
    1112                                	CMPB	R0,R3
    1113                                	BEQ	ISVG
    1114                                	DEC	R2
    1115                                	BNE	1$
    1116                                ISVG:	CLRB	RLPOZ		;КОНЕЦ ВЫВОДА СТРОКИ
    1117                                	MOVB	#17,R0
    1118                                	CALL	ISV
    1119                                	DECB	TABX
    1120                                ENDLP:	MOV	(SP)+,R3
    1121                                	MOV	(SP)+,R0
    1122                                	RTS	PC
    1123                                ;
    1124                                LP:	BPL	FILOUT
    1125                                	MOVB	(R1)+,R0
    1126                                10$:	TST	@#177514
    1127                                	BMI	11$
    1128                                	TSTB	@#177514
    1129                                	BPL	10$
    1130                                	MOVB	R0,@#177516
    1131                                	CMPB	R0,#12
    1132                                	BNE	15$
    1133                                	MOV	#15,R0
    1134                                	BR	10$
    1135                                15$:	CMPB	R0,R3
    1136                                	BEQ	2$
    1137                                	DEC	R2
    1138                                	BNE	LP
    1139                                2$:	BR	ENDLP
    1140                                11$:	TRAP	23
    1141                                ;
    1142                                FILOUT:	CMP	(SP)+,(SP)+
    1143                                	MOV	R0,R3
    1144                                	.IFT
    1145 123034 005726                  FILOUT:	TST	(SP)+
    1146                                	.IFTF
    1147 123036 004767  162442'         	CALL	FNDBUF
    1148 123042 132720  000001          	BITB	#1,(R0)+
    1149 123046 001030                  	BNE	NOTOUT
    1150 123050 005003                  	CLR	R3
    1151 123052 151003                  	BISB	@R0,R3
    1152 123054 060003                  	ADD	R0,R3
    1153 123056 062703  000021          	ADD	#21,R3
    1154 123062 005302                  COPOUT::DEC	R2
    1155 123064 100420                  	BMI	NOSTEP
    1156 123066 112123                  	MOVB	(R1)+,(R3)+
    1157 123070 105210                  	INCB	@R0
    1158 123072 001373                  	BNE	COPOUT
    1159 123074 010146                  	MOV	R1,-(SP)
    1160 123076 005300                  	DEC	R0
    1161 123100 004767  140016'         	CALL	CASCII
    1162 123104 004767  140064'         	CALL	CAS
    1163 123110 004767  140140'         	CALL	BLOCKN
    1164 123114 012601                  	MOV	(SP)+,R1
    1165 123116 162703  000400          	SUB	#400,R3
    1166 123122 005200                  	INC	R0
    1167 123124 000756                  	BR	COPOUT
    1168 123126 000207                  NOSTEP:	RETURN
    1169 123130 104464                  NOTOUT:	TRAP	52.
    1170                                ; 
    1171                                .IFF
    1172                                ALRIC:	CMPB	R0,#20
    1173                                	BNE	1$
    1174                                	.IF	GE,MASINA-SM4
    1175                                	BIC	#0,177776
    1176                                	.IFF
    1177                                	MTPS	#0
    1178                                	.ENDC
    1179                                	TST	(SP)+
    1180                                	JMP	BREAK
    1181                                1$:	MOVB	@#ARDK,INK
    1182                                	MOVB	#100,ARSK
    1183                                	RTS	PC
    1184                                ;
    1185                                INKEY::	MOV	#INK,-(SP)
    1186                                	CLR	-(SP)
    1187                                	TSTB	SIIKP
    1188                                	BEQ	1$
    1189                                	INC	@SP
    1190                                	CLRB	SIIKP
    1191                                1$:	RETURN
    1192                                
    1193                                	.IFTF
    1194                                	.GLOBL	VYKDYT,STAR,HALT,EILUTE,KODTST,AGAUD,IFGAUD
    1195 123132 005767  002000'         STEP:	TST	LYGIS
    1196 123136 001373                  	BNE	NOSTEP
    1197 123140 020327  003022          	CMP	R3,#BUF
    1198 123144 001370                  	BNE	NOSTEP
    1199 123146 005767  002032'         	TST	ERRS
    1200 123152 001013                  	BNE	1$
    1201 123154 062706  000020          	ADD	#20,SP
    1202 123160 005467  002050'         	NEG	TRFLAG
    1203 123164 016704  002046'         	MOV	ADRHLT,R4
    1204 123170 001005                  	BNE	TRIN
    1205 123172 016704  002026'         	MOV	FCB,R4
    1206 123176 005724                  	TST	(R4)+
    1207 123200 000406                  	BR	STP2
    1208 123202 104421                  1$:	TRAP	17.
    1209 123204 012737  125070  000004  TRIN::	MOV	#IRPS2-10,@#BREAKW
    1210 123212 004767  155132'               	CALL	AGAUD
    1211 123216 005067  002052'         STP2:	CLR	AUTOON
    1212 123222 005067  002044'         	CLR	NUMBER
    1213 123226 024444                  	CMP	-(R4),-(R4)
    1214 123230 004067  135564'         	JSR	R0,SETST
    1215 123234 000402                  	BR	50$
    1216 123236 000167  120526'         	JMP 	SYS1
    1217 123242 022424                  50$:	CMP	(4)+,(4)+
    1218 123244 010402                  	MOV	R4,R2
    1219 123246 010400                  	MOV	R4,R0
    1220 123250 014000                  	MOV	-(0),R0
    1221 123252 004567  142152'         	JSR	R5,KODTST
    1222 123256 000463                  	BR	3$
    1223 123260 000411                  	BR	4$
    1224 123262 122710  000040          	CMPB	#40,@R0
    1225 123266 001003                  	BNE	21$
    1226 123270 004567  123656'         	JSR	R5,NEXPAP
    1227 123274 010204                  	MOV	R2,R4
    1228 123276 162704  000006          21$:	SUB	#6,R4
    1229 123302 000466                  	BR	32$
    1230 123304 010003                  4$:	MOV	R0,R3
    1231 123306 005203                  	INC	R3
    1232 123310 122327  000012          41$:	CMPB	(3)+,#12
    1233 123314 001433                  	BEQ	45$
    1234 123316 004267  142224'         42$:	JSR	R2,IFGAUD
    1235 123322 000430                  	BR	45$
    1236 123324 000771                  	BR	41$
    1237 123326 022705  000004              	CMP	#4,R5
    1238 123332 001003                  	BNE	47$
    1239 123334 004567  123656'         	JSR	R5,NEXPAP
    1240 123340 000766                  	BR	42$
    1241 123342 022705  000006          47$:	CMP	#6,R5
    1242 123346 001763                  	BEQ	42$
    1243 123350 010500                  	MOV	R5,R0
    1244 123352 104510                  48$:	TRAP	110
    1245 123354 000415                  	BR	43$
    1246 123356 104511                  	TRAP	111
    1247 123360 000401                  	BR	44$
    1248 123362 000755                  	BR	42$
    1249 123364 004567  123606'         44$:	JSR	R5,HCOR
    1250 123370 104512                  	TRAP	112
    1251 123372 122713  000054          	CMPB	#',,@R3
    1252 123376 001347                  	BNE	42$
    1253 123400 005203                  	INC	R3
    1254 123402 000763                  	BR	48$
    1255 123404 010204                  45$:	MOV	R2,R4
    1256 123406 000733                  	BR	21$
    1257 123410 022700  000002          43$:	CMP	#2,R0
    1258 123414 001340                  	BNE	42$
    1259 123416 004567  123556'         	JSR	R5,REPA
    1260 123422 000735                  	BR	42$
    1261 123424 000757                  	BR	44$
    1262 123426 122710  000074          3$:	CMPB	#74,@R0	;RESTORE
    1263 123432 001721                  	BEQ	21$
    1264 123434 005200                  	INC	R0
    1265 123436 010003                  	MOV	R0,R3
    1266 123440 104510                  	TRAP	110
    1267 123442 000403                  	BR	31$
    1268 123444 104511                  	TRAP	111
    1269 123446 000404                  	BR	32$
    1270 123450 000240                  	NOP
    1271 123452 004567  123556'         31$:	JSR	R5,REPA
    1272 123456 000402                  	BR	37$
    1273 123460 004567  123606'         32$:	JSR	R5,HCOR
    1274 123464 010204                  37$:	MOV	R2,R4
    1275 123466 010667  002124'             	MOV	SP,PNTSAV
    1276 123472 004767  135100'         	CALL	EILUTE
    1277 123476 005767  002050'         	TST	TRFLAG
    1278 123502 003415                  	BLE	2$
    1279 123504 112700  000133          	MOVB	#133,R0
    1280 123510 004767  122522'         	CALL	ISV
    1281 123514 052702  020000          	BIS	#20000,R2
    1282 123520 004767  122560'         	CALL	ISVEIL
    1283 123524 112700  000135          	MOVB	#135,R0
    1284 123530 004767  122522'         	CALL	ISV
    1285 123534 000402                  	BR	22$
    1286 123536 004767  122560'         2$:	CALL	ISVEIL
    1287 123542 014404                  22$:	MOV	-(4),R4
    1288 123544 012737  120234  000004  	MOV	#BREAK,@#BREAKW
    1289 123552 000167  136044'         	JMP	VYKDYT
    1290                                ;
    1291 123556 005726                  REPA:	TST	(SP)+
    1292 123560 026767  002022' 002020' 	CMP	LENT,LIMIT
    1293 123566 001406                  	BEQ	1$
    1294 123570 017704  002020'         	MOV	@LIMIT,R4
    1295 123574 004767  155132'         	CALL	AGAUD
    1296 123600 024444                  	CMP	-(4),-(4)
    1297 123602 005725                  	TST	(5)+
    1298 123604 010507                  1$:	MOV	R5,PC
    1299                                ;
    1300 123606 005726                  HCOR:	TST	(SP)+
    1301 123610 004067  135564'         	JSR	R0,SETST
    1302 123614 000401                  	BR	2$
    1303 123616 000416                  	BR	1$
    1304 123620 022424                  2$:	CMP	(4)+,(4)+
    1305 123622 020402                  	CMP	R4,R2
    1306 123624 001413                  	BEQ	1$
    1307 123626 020467  002024'         	CMP	R4,TABTOP
    1308 123632 103410                  	BLO	1$
    1309 123634 024444                  	CMP	-(4),-(4)
    1310 123636 011404                  	MOV	@R4,R4
    1311 123640 010446                  	MOV	R4,-(SP)
    1312 123642 011446                  	MOV	@R4,-(SP)
    1313 123644 005267  002044'         	INC	NUMBER
    1314 123650 012714  123752          	MOV	#STPEND,@R4
    1315 123654 010507                  1$:	MOV	R5,PC
    1316                                ;
    1317 123656 005767  002052'         NEXPAP:	TST	AUTOON
    1318 123662 001401                  	BEQ	1$
    1319 123664 000205                  	RTS	R5
    1320 123666 005726                  1$:	TST	(SP)+
    1321 123670 010567  002052'         	MOV	R5,AUTOON
    1322 123674 016701  002016'         	MOV	CIKL,R1
    1323 123700 020167  002020'         3$:	CMP	R1,LIMIT
    1324 123704 103020                  	BHIS	2$
    1325 123706 016104  000002          	MOV	2(1),R4
    1326 123712 004767  155132'         	CALL	AGAUD
    1327 123716 024444                  	CMP	-(4),-(4)
    1328 123720 004567  123606'         	JSR	R5,HCOR
    1329 123724 011100                  	MOV	@R1,R0
    1330 123726 062701  000010          	ADD	#10,R1
    1331 123732 014000                  	MOV	-(0),R0
    1332 123734 006100                  	ROL	R0
    1333 123736 100760                  	BMI	3$
    1334 123740 062701  000014          	ADD	#14,R1
    1335 123744 000755                  	BR	3$
    1336 123746 016707  002052'         2$:	MOV	AUTOON,PC
    1337                                ;
    1338 123752 012767  125070  000004' STPEND::MOV	#IRPS2-10,BREAKW
    1339 123760 004267  124022'         	JSR	R2,SEPAP
    1340 123764 005744                  	TST	-(R4)
    1341 123766 005767  002050'         	TST	TRFLAG
    1342 123772 003402                  	BLE	1$
    1343 123774 000167  123204'         	JMP	TRIN
    1344 124000 010467  002046'         1$:	MOV	R4,ADRHLT
    1345 124004 005467  002050'         	NEG	TRFLAG
    1346 124010 012767  120234  000004' 	MOV	#BREAK,BREAKW
    1347 124016 000167  133754'         	JMP	STAR
    1348                                ;
    1349 124022 005726                  SEPAP::	TST	(SP)+
    1350 124024 005267  002032'         	INC	ERRS
    1351 124030 005767  002124'         	TST	PNTSAV
    1352 124034 001407                  	BEQ	5$
    1353 124036 016706  002124'         	MOV	PNTSAV,SP
    1354 124042 005367  002044'         2$:	DEC	NUMBER
    1355 124046 002402                  	BLT	5$
    1356 124050 012636                  	MOV	(SP)+,@(SP)+
    1357 124052 000773                  	BR	2$
    1358 124054 005067  002124'         5$:	CLR	PNTSAV
    1359 124060 012706  002000          	MOV	#STACK,SP
    1360 124064 005067  002032'         	CLR	ERRS
    1361 124070 005067  002044'         	CLR	NUMBER
    1362 124074 010207                  	MOV	R2,PC
    1363                                ;
    1364                                	.IFT
    1365 124076 104034                  CURON::	EMT	34
    1366 124100 032700  040000          	BIT	#40000,R0
    1367 124104 001404                  	BEQ	C2
    1368 124106 012700  000232          C1:	MOV	#232,R0
    1369 124112 004767  122522'         	CALL	ISV
    1370 124116 000207                  C2:	RETURN
    1371                                ;
    1372 124120 104034                  CUROFF::EMT	34
    1373 124122 032700  040000          	BIT	#40000,R0
    1374 124126 001767                  	BEQ	C1
    1375 124130 000207                  	RETURN
    1376                                ;
    1377 124132 012746  003020          INKEY::	MOV	#INK,-(SP)
    1378 124136 005046                  	CLR	-(SP)
    1379 124140 105737  000105          	TSTB	@#TSTKEY
    1380 124144 001404                  	BEQ	1$
    1381 124146 104006                  	EMT	6
    1382 124150 110067  003020'         	MOVB	R0,INK
    1383 124154 005216                  	INC	@SP
    1384 124156 000134                  1$:	JMP	@(R4)+
    1385                                ;
    1386                                MAGNIT::
    1387 124160 104036                  	EMT	36
    1388 124162 000207                  	RETURN
    1389                                ;
    1390 000001                         .IF EQ,1
    1391                                SIGNAL::MOV	R2,R0
    1392                                	MOVB	#320,@#ASPORT
    1393                                1$:	SOB	R0,1$
    1394                                	MOV	R2,R0
    1395                                	MOVB	#220,@#ASPORT
    1396                                2$:	SOB	R0,2$
    1397                                	SOB	R1,SIGNAL
    1398                                	RETURN
    1399                                .ENDC
    1400                                ;
    1401 124164 012403                  USEROM::MOV	(4)+,R3
    1402 124166 010467  002134'         	MOV	R4,SAVJMP
    1403 124172 012700  000001          	MOV	#1,R0
    1404 124176 012737  124262  000004  	MOV	#NOROM,@#BREAKW
    1405 124204 110037  177717          NEXROM:	MOVB	R0,@#ASPORT+1
    1406 124210 006300                  	ASL	R0
    1407 124212 004737  160000          	CALL	@#AUSROM
    1408 124216 103423                  	BCS	ERROM
    1409 124220 004067  124226'         	JSR	R0,STATUSQ
    1410 124224 000134                  	JMP	@(R4)+
    1411                                ;
    1412 124226 005726                  STATUSQ:TST	(SP)+
    1413 124230 012737  120234  000004  	MOV	#BREAK,@#BREAKW
    1414 124236 112737  000200  177717  	MOVB	#200,@#ASPORT+1
    1415 124244 105037  177717          	CLRB	@#ASPORT+1
    1416 124250 016704  002134'         	MOV	SAVJMP,R4
    1417 124254 005067  002134'         	CLR	SAVJMP
    1418 124260 010007                  	MOV	R0,PC
    1419                                ;
    1420 124262 062706  000006          NOROM:	ADD	#6,SP
    1421 124266 020027  000010          ERROM:	CMP	R0,#10
    1422 124272 001344                  	BNE	NEXROM
    1423 124274 004067  124226'         	JSR	R0,STATUSQ
    1424                                ;
    1425                                	.IFF
    1426                                SIGNAL::MOV	#7,R0
    1427                                	CALL	ISV
    1428                                	RETURN
    1429                                ;
    1430                                USEROM::
    1431                                	.IFTF
    1432 124300 104405                  NOUSR:	TRAP	5
    1433                                ;
    1434 124302 104506                  ADDRMN::TRAP	106
    1435 124304 012700  000014          	MOV	#14,R0
    1436 124310 004767  122522'         	CALL	ISV
    1437                                ;
    1438                                	.IFT
    1439 124314 012706  001000          	MOV	#1000,SP
    1440 124320 000167  100274'         	JMP	100274
    1441                                ;
    1442                                	.IFF
    1443                                	.IF	EQ,MASINA-MDS
    1444                                	COM	TIMER
    1445                                	.ENDC
    1446                                	MOV	SAUG,AVPK
    1447                                	MOV	SAUG+2,AVPK+2
    1448                                	MOV	SAUG+4,0
    1449                                	MOV	SAUG+6,2
    1450                                	COM	ARSK
    1451                                	JMP	0
    1452                                ;
    1453                                	.IFTF
    1454 124324 005726                  LOC::	TST	(SP)+
    1455 124326 001003                  	BNE	1$
    1456 124330 004767  124120'         	CALL	CUROFF
    1457 124334 000134                  	JMP	@(R4)+
    1458 124336 004767  124076'         1$:	CALL	CURON
    1459 124342 000134                  	JMP	@(R4)+
    1460                                ;
    1461                                ZONA::
    1462                                	.IFT
    1463 124344 016703  003016'         	MOV	IODEV,R3
    1464 124350 002404                  	BLT	3$
    1465 124352 003006                  	BGT	4$
    1466 124354 104026                  	EMT	26
    1467 124356 010146                  	MOV	R1,-(SP)
    1468 124360 000406                  	BR	41$
    1469 124362 116746  002136'         3$:	MOVB	LPTPOS,-(SP)
    1470 124366 000403                  	BR	41$
    1471 124370 004767  162442'         4$:	CALL	FNDBUF
    1472 124374 111046                  	MOVB	@R0,-(SP)
    1473 124376 162716  000020          41$:	SUB	#20,@SP
    1474 124402 003375                  	BGT	41$
    1475 124404 001402                  	BEQ	42$
    1476 124406 005416                  	NEG	@SP
    1477 124410 000423                  	BR	SPC1
    1478 124412 012716  000020          42$:	MOV	#20,@SP
    1479 124416 000420                  	BR	SPC1
    1480                                ;
    1481                                	.IFF
    1482                                	MOV	#40,R0
    1483                                1$:	CALL	ISV
    1484                                	BITB	#17,TABX
    1485                                	BNE	1$
    1486                                2$:	JMP	@(R4)+
    1487                                ;
    1488                                	.IFT
    1489                                ;SPC::	CALL	TIKR
    1490                                ;	BR	SPC1
    1491 124420 004767  124502'         TAB::	CALL	TIKR
    1492 124424 016703  003016'         	MOV	IODEV,R3
    1493 124430 001411                  	BEQ	1$
    1494 124432 003003                  	BGT	2$
    1495 124434 116701  002136'         	MOVB	LPTPOS,R1
    1496 124440 000406                  	BR	3$
    1497 124442 004767  162442'         2$:	CALL	FNDBUF
    1498 124446 005001                  	CLR	R1
    1499 124450 151001                  	BISB	@R0,R1
    1500 124452 000401                  	BR	3$
    1501 124454 104026                  1$:	EMT	26
    1502 124456 160116                  3$:	SUB	R1,@SP
    1503 124460 012700  000040          SPC1:	MOV	#40,R0
    1504 124464 005316                  1$:	DEC	@SP
    1505 124466 002403                  	BLT	2$
    1506 124470 004767  122526'         	CALL	ISVTO
    1507 124474 000773                  	BR	1$
    1508 124476 005726                  2$:	TST	(SP)+
    1509 124500 000134                  	JMP	@(4)+
    1510                                ;
    1511 124502 105766  000003          TIKR:	TSTB	3(SP)
    1512 124506 001274                  	BNE	NOUSR
    1513 124510 000207                  	RETURN
    1514                                ;
    1515 124512 004767  124502'         AT::	CALL	TIKR
    1516 124516 012602                  	MOV	(SP)+,R2
    1517 124520 005767  003016'         	TST	IODEV
    1518 124524 001335                  	BNE	TAB
    1519 124526 004767  124502'          	CALL	TIKR
    1520 124532 012601                  	MOV	(SP)+,R1
    1521 124534 104024                  	EMT	24
    1522 124536 000134                  	JMP	@(R4)+
    1523                                ;
    1524 124540 022626                  DLOCX::	CMP	(SP)+,(SP)+
    1525 124542 005726                  SLOCX::	TST	(SP)+
    1526 124544 005726                  ILOCX::	TST	(SP)+
    1527 124546 104026                  LOCX::	EMT	26
    1528 124550 010146                  	MOV	R1,-(SP)
    1529 124552 000134                  	JMP	@(R4)+
    1530                                ;
    1531 124554 022626                  DLOCY::	CMP	(SP)+,(SP)+
    1532 124556 005726                  SLOCY::	TST	(SP)+
    1533 124560 005726                  ILOCY::	TST	(SP)+
    1534 124562 104026                  LOCY::	EMT	26
    1535 124564 010246                  	MOV	R2,-(SP)
    1536 124566 000134                  	JMP	@(R4)+
    1537                                ;
    1538 124570 012600                  $KEY::	MOV	(SP)+,R0
    1539 124572 020027  000020          	CMP	R0,#16.
    1540 124576 101402                  	BLOS	1$
    1541 124600 012700  000020          	MOV	#16.,R0
    1542 124604 012602                  1$:	MOV	(SP)+,R2
    1543 124606 012603                  	MOV	(SP)+,R3
    1544 124610 003633                  	BLE	NOUSR
    1545 124612 020327  000012          	CMP	R3,#10.
    1546 124616 003230                  	BGT	NOUSR
    1547 124620 012701  002117          	MOV	#FNKSTR-17.,R1
    1548 124624 062701  000021          2$:	ADD	#17.,R1
    1549 124630 077303                  	SOB	R3,2$
    1550 124632 110021                  	MOVB	R0,(R1)+
    1551 124634 003402                  	BLE	4$
    1552 124636 112221                  3$:	MOVB	(R2)+,(R1)+
    1553 124640 077002                  	SOB	R0,3$
    1554 124642 004767  120760'         4$:	CALL	ISVSS
    1555 124646 000134                  	JMP	@(R4)+
    1556                                ;
    1557 000001                         .IF EQ,1
    1558                                KEYISV::MOV	#FNKSTR,R3
    1559                                4$:	MOV	R3,R1
    1560                                	MOVB	(R1)+,R2
    1561                                	BEQ	1$
    1562                                3$:	MOVB	(R1)+,R0
    1563                                	CMPB	#' ,R0
    1564                                	BLE	2$
    1565                                	MOVB	#' ,R0
    1566                                2$:	CALL	ISV
    1567                                	SOB	R2,3$
    1568                                1$:	MOV	#12,R0
    1569                                	CALL	ISV
    1570                                	ADD	#17.,R3
    1571                                	CMP	R3,#FNKSTR+170.
    1572                                	BLO	4$
    1573                                	JMP	@(R4)+
    1574                                ;
    1575                                KEYON::
    1576                                	CALL	ISVSS
    1577                                	JMP	@(R4)+
    1578                                KEYOFF::MOV	@#214,R2
    1579                                	MOV	@#212,@#214
    1580                                	MOV	#236,R0
    1581                                	EMT	16
    1582                                	MOV	R2,@#214
    1583                                	JMP	@(R4)+
    1584                                ;
    1585                                .ENDC
    1586                                	.IFF
    1587                                AT::	MOV	(SP)+,R2
    1588                                1$:	SUB	#30,R2
    1589                                	BPL	1$
    1590                                	ADD	#30,R2
    1591                                	MOV	#15,R0
    1592                                	CLRB	TABX
    1593                                2$:	CALL	ISV
    1594                                	MOV	#35,R0
    1595                                	DECB	TABX
    1596                                	CMPB	R2,TABY
    1597                                	BEQ	TAB
    1598                                	BGT	3$
    1599                                	INCB	TABY
    1600                                	BR	2$
    1601                                3$:	DECB	TABY
    1602                                	DEC	R0
    1603                                	BR	2$
    1604                                TAB::	MOV	(SP)+,R1
    1605                                1$:	SUB	#120,R1
    1606                                	BPL	1$
    1607                                	ADD	#120,R1
    1608                                2$:	CMPB	R1,TABX
    1609                                	BEQ	3$
    1610                                	MOV	#40,R0
    1611                                	CALL	ISV
    1612                                	BR	2$
    1613                                3$:	JMP	@(R4)+
    1614                                ;
    1615                                IRPS::
    1616                                MAGNIT::MOVB	#2,1(1)
    1617                                CURON::
    1618                                CUROFF::RETURN
    1619                                ;
    1620                                RSP::	TST	-(SP)
    1621                                SPFORM::JMP	@(R4)+
    1622                                $PAINT::TST	(SP)+
    1623                                $KEY::	CMP	(SP)+,(SP)+
    1624                                	TST	(SP)+
    1625                                KEYON::
    1626                                KEYOFF::
    1627                                KEYISV::JMP	@(R4)+
    1628                                ;
    1629                                PUNKT::
    1630                                VEKT::	CMP	(SP)+,(SP)+
    1631                                COLR::
    1632                                COLF::	TST	(SP)+
    1633                                TRECIA::JMP	@(R4)+
    1634                                ;
    1635                                ;
    1636                                ;======================
    1637                                ;======================
    1638                                ;
    1639                                ;
    1640                                	.IFT
    1641 177777                         	.IF	EQ,KONTYP-KLAS
    1642                                IRPS1:
    1643                                	.GLOBL	GRBCOL,ASCCOD,ATSTAB
    1644                                ;
    1645                                	MOV	R0,-(SP)
    1646                                	MOVB	@#IRPSRG,R0
    1647                                	BIC	#1,R0
    1648                                	CMP	R0,#24
    1649                                	BHIS	1$
    1650                                	JMP	@LEN(R0)
    1651                                1$:	MOV	(SP)+,R0
    1652                                	RTI
    1653                                ;
    1654                                LEN:	.WORD	START
    1655                                	.WORD	0
    1656                                	.WORD	NET
    1657                                	.WORD	CLOAD1
    1658                                	.WORD	CSAVE1
    1659                                	.WORD	GR
    1660                                	.WORD	GR
    1661                                	.WORD	COPY
    1662                                	.WORD	GR
    1663                                	.WORD	SHO
    1664                                ;
    1665                                ST:	ADD	#6,SP
    1666                                	JMP	@#0
    1667                                ;
    1668                                CLOAD1:
    1669                                	MOV	FCB,TABTOP
    1670                                	MOV	FCB,CIKL
    1671                                	MOV	FCB,LIMIT
    1672                                	MOV	FCB,LENT
    1673                                	CLR	STRREG
    1674                                	MOV	#MAG,R0
    1675                                	MOV	#3,(R0)+
    1676                                	MOV	#TEXT,(R0)+
    1677                                	MOV	FCB,@R0
    1678                                	SUB	#TEXT,(R0)+
    1679                                	CALL	CAS1
    1680                                	MOV	#MAG+26,R3
    1681                                	MOV	(R3)+,R2
    1682                                	MOV	@R3,R0
    1683                                	MOV	#TEXT,R3
    1684                                	ADD	R3,R0
    1685                                	SUB	R2,R3
    1686                                	MOV	FCB,R2
    1687                                	MOV	R2,R4
    1688                                	SUB	-(R0),R4
    1689                                5$:	MOV	-(R0),-(R2)
    1690                                	MOV	-(R0),-(R2)
    1691                                	ADD	R3,@R2
    1692                                	MOV	-(R0),-(R2)
    1693                                	CMP	R2,R4
    1694                                	BHI	5$
    1695                                	MOV	R0,ENDCOD
    1696                                	MOV	R0,TXEND
    1697                                	MOV	R2,LENT
    1698                                	MOV	R2,LIMIT
    1699                                	MOV	R2,CIKL
    1700                                	MOV	R4,TABTOP
    1701                                	BR	ST
    1702                                ;
    1703                                CSAVE1:
    1704                                	MOV	#MAG,R0
    1705                                	MOV	#2,(R0)+
    1706                                	MOV	#TEXT,(R0)+
    1707                                	CALL	GRBCOL
    1708                                	MOV	R1,R5
    1709                                	MOV	TABTOP,R4
    1710                                	MOV	R5,@R0
    1711                                	SUB	#TEXT-2,(R0)+
    1712                                	MOV	@PC,ERRS
    1713                                7$:	MOV	(R4)+,(R5)+
    1714                                	CMP	R4,FCB
    1715                                	BLO	7$
    1716                                	MOV	R4,@R5
    1717                                	SUB	TABTOP,(R5)
    1718                                	MOV	#MAG,R1
    1719                                	ADD	(R5)+,4(R1)
    1720                                	CALL	IRPS
    1721                                	CALL	ATSTAB
    1722                                	BR	ST
    1723                                ;
    1724                                CAS1:	MOV	#MAG,R1
    1725                                	CALL	IRPS
    1726                                	RETURN
    1727                                .IFTF
    1728                                ;TRP:	MOV	#IRPS2-10,@#BREAKW
    1729                                ;	MOVB	#4,@#MAG+1
    1730                                ;	BR	IRPS2
    1731                                IRPS::
    1732                                .IFT
    1733                                	BIC	#100,@#IRPSRG
    1734                                .IFTF
    1735                                ;	MOV	#TRP,@#BREAKW
    1736 124650 052737  000100  177660  	BIS	#100,@#177660
    1737 124656 010046                  	MOV	R0,-(SP)
    1738 124660 010146                  	MOV	R1,-(SP)
    1739 124662 010246                  	MOV	R2,-(SP)
    1740 124664 010346                  	MOV	R3,-(SP)
    1741                                ;	MOV	R4,-(SP)
    1742 124666 010546                  	MOV	R5,-(SP)
    1743                                ;	MOV	SP,R4
    1744 124670 005005                  	CLR	R5
    1745 124672 113700  176562          	MOVB	@#IRPSRG+2,R0
    1746 124676 112100                  	MOVB	(R1)+,R0
    1747 124700 004767  125154'         	CALL	ISVT
    1748 124704 004767  125140'         	CALL	IVT
    1749 124710 010102                  	MOV	R1,R2
    1750 124712 062702  000005          	ADD	#5,R2
    1751 124716 012703  000012          	MOV	#12,R3
    1752 124722 112200                  1$:	MOVB	(R2)+,R0
    1753 124724 004767  125154'         	CALL	ISVT
    1754 124730 077304                  	SOB	R3,1$
    1755 124732 012703  000004          	MOV	#4,R3
    1756 124736 004767  125140'         	CALL	IVT
    1757 124742 110021                  	MOVB	R0,(R1)+
    1758 124744 001055                  	BNE	IRPS2
    1759 124746 126127  177776  000003  	CMPB	-2(R1),#3
    1760 124754 103425                  	BLO	6$		;BK->TT
    1761 124756 062702  000006          	ADD	#6,R2
    1762                                10$:	;CLR	@#MSTART	;TT->BK
    1763 124762 004767  125140'         	CALL	IVT
    1764 124766 110022                  	MOVB	R0,(R2)+
    1765 124770 077304                  	SOB	R3,10$
    1766 124772 014203                  	MOV	-(R2),R3
    1767                                ;	MOV	R3,@#MLEN
    1768 124774 001441                  	BEQ	IRPS2
    1769 124776 005711                  	TST	@R1
    1770 125000 001402                  	BEQ	11$
    1771 125002 011102                  	MOV	@R1,R2
    1772 125004 000403                  	BR	4$
    1773 125006 014202                  11$:	MOV	-(R2),R2
    1774 125010 010237  000264          	MOV	R2,@#MSTART
    1775 125014 004767  125140'         4$:	CALL	IVT
    1776 125020 110022                  	MOVB	R0,(R2)+
    1777 125022 060005                  	ADD	R0,R5
    1778 125024 077305                  	SOB	R3,4$
    1779 125026 000413                  	BR	3$
    1780                                ;
    1781 125030 112100                  6$:	MOVB	(R1)+,R0
    1782 125032 004767  125154'         	CALL	ISVT
    1783 125036 077304                  	SOB	R3,6$
    1784 125040 014103                  	MOV	-(R1),R3
    1785                                ;	BEQ	IRPS2
    1786 125042 014102                  	MOV	-(R1),R2
    1787 125044 112200                  7$:	MOVB	(R2)+,R0
    1788 125046 004767  125154'         	CALL	ISVT
    1789 125052 060005                  	ADD	R0,R5
    1790 125054 077305                  	SOB	R3,7$
    1791 125056 004767  125140'         3$:	CALL	IVT
    1792 125062 120005                  	CMPB	R0,R5
    1793 125064 001402                  	BEQ	12$
    1794 125066 112741  000002          	MOVB	#2,-(R1)
    1795 125072 010500                  12$:	MOV	R5,R0
    1796 125074 004767  125154'         	CALL	ISVT
    1797 125100 012702  000352          IRPS2::	MOV	#MAG+32,R2
    1798 125104 012701  000326          	MOV	#MAG+6,R1
    1799 125110 012703  000010          	MOV	#10,R3
    1800 125114 012122                  16$:	MOV	(R1)+,(R2)+
    1801 125116 077302                  	SOB	R3,16$
    1802                                ;	MOV	R4,SP
    1803 125120 012605                  	MOV	(SP)+,R5
    1804                                ;	MOV	(SP)+,R4
    1805 125122 012603                  	MOV	(SP)+,R3
    1806 125124 012602                  	MOV	(SP)+,R2
    1807 125126 012601                  	MOV	(SP)+,R1
    1808 125130 012600                  	MOV	(SP)+,R0
    1809 125132 005037  177660          	CLR	@#177660
    1810                                .IFT
    1811                                	BIS	#100,@#IRPSRG
    1812                                .IFTF
    1813 125136 000207                  	RETURN
    1814                                ;
    1815 125140 105737  176560          IVT:	TSTB	@#IRPSRG
    1816 125144 100375                  	BPL	IVT
    1817 125146 113700  176562          	MOVB	@#IRPSRG+2,R0
    1818 125152 000207                  	RETURN
    1819 125154 105737  176564          ISVT:	TSTB	@#IRPSRG+4
    1820 125160 100375                  	BPL	ISVT
    1821 125162 110037  176566          	MOVB	R0,@#IRPSRG+6
    1822 125166 000207                  	RETURN
    1823                                ;
    1824                                .IFT
    1825                                NET:	BIS	#100,@#177660
    1826                                SHO:	MOV	#TRTR,@#IRPSW
    1827                                	MOV	#ISVT,EKRHUK
    1828                                	BR	GR
    1829                                TRTR:
    1830                                	MOV	R0,-(SP)
    1831                                	MOVB	@#IRPSRG+2,R0
    1832                                	CMPB	R0,#6
    1833                                	BEQ	BG
    1834                                	MOVB	R0,@#104
    1835                                	MOVB	R0,@#105
    1836                                	MOV	@#TSTCHR,R0
    1837                                	BEQ	GR
    1838                                	CALL	@R0
    1839                                GR:	MOV	(SP)+,R0
    1840                                	RTI
    1841                                BG:	
    1842                                	CLR	@#IRPSRG+4
    1843                                	MOV	#IRPS1,@#IRPSW
    1844                                	BIC	#100,@#177660
    1845                                	CLR	EKRHUK
    1846                                	BR	GR
    1847                                COPY:	
    1848                                	MOV	#40000,COPPNT
    1849                                	MOV	#CPTR,@#IRPSW+4
    1850                                	BIS	#100,@#IRPSRG+4
    1851                                	MOVB	@#177664,@#IRPSRG+6
    1852                                	BR	SHO
    1853                                CPTR:	CMP	COPPNT,#40000
    1854                                	BLO	1$
    1855                                	MOVB	@COPPNT,@#IRPSRG+6
    1856                                2$:	INC	COPPNT
    1857                                	CMP	COPPNT,#100000
    1858                                	BLO	3$
    1859                                	MOV	#37777,COPPNT
    1860                                3$:	RTI
    1861                                1$:	MOVB	@#177664,@#IRPSRG+6
    1862                                	BR	2$
    1863                                .ENDC
    1864                                .IFT
    1865                                ;prodolvenie w drugom fajle!!!!
    1866                                
    1866                                
       1                                ;*******************************************************
       2                                ;*                                                     *
       3                                ;*      ПАКЕТ ГРАФИЧЕСКИХ ПРОГРАММ БЕЙСИК-ВИЛЬНЮС      *
       4                                ;*   РАЗРАБОТАН СОТРУДНИКАМИ ИПИ АН СССР И ВЦКП ВГУ    *
       5                                ;*                                                     *
       6                                ;*******************************************************
       7                                .GLOBL	STAND,SAND,IDIV,DAUG
       8                                ;
       9 125170 104405                  COLERR:	TRAP	5
      10 000000                         .IF	EQ,0
      11                                ;
      12 125172 013703  000214          COLF::	MOV	@#214,R3
      13 125176 012600                  	MOV	(SP)+,R0
      14 125200 001001                  	BNE	1$
      15 125202 022020                  	CMP	(R0)+,(R0)+
      16 125204 004767  125226'         1$:	CALL	TSTCOL
      17 125210 104016                  	EMT	16
      18 125212 012700  000235          	MOV	#235,R0
      19 125216 104016                  	EMT	16
      20                                ;
      21 125220 010337  000214          COLRET::MOV	R3,@#214
      22 125224 000134                  	JMP	@(R4)+
      23                                ;
      24 125226 020027  000004          TSTCOL:	CMP	R0,#4
      25 125232 101356                  	BHI	COLERR
      26 125234 062700  000220          	ADD	#220,R0
      27 125240 000207                  	RETURN
      28                                ;
      29 125242 013703  000214          COLR::	MOV	@#214,R3
      30 125246 012600                  	MOV	(SP)+,R0
      31 125250 001404                  	BEQ	1$
      32 125252 004767  125226'         	CALL	TSTCOL
      33 125256 104016                  	EMT	16
      34 125260 000134                  	JMP	@(R4)+
      35 125262 013737  000212  000214  1$:	MOV	@#212,@#214
      36 125270 000134                  	JMP	@(R4)+
      37                                ;
      38                                .IFF
      39                                COLF::	MOV	@#214,R3
      40                                	MOV	(SP)+,R0
      41                                	EMT	16
      42                                	MOV	#235,R0
      43                                	EMT	16
      44                                COLRET::MOV	R3,@#214
      45                                	JMP	@(R4)+
      46                                COLR::	MOV	@#214,R3
      47                                	MOV	(SP)+,R0
      48                                	EMT	16
      49                                	JMP	@(R4)+
      50                                .IFT
      51                                ;
      52 125272 013746  000176          CURCOR::MOV	@#176,-(SP)
      53 125276 013746  000200          	MOV	@#200,-(SP)
      54 125302 000134                  	JMP	@(R4)+
      55                                ;
      56 125304 063766  000176  000002  STP::	ADD	@#176,2(SP)
      57 125312 063716  000200          	ADD	@#200,@SP
      58 125316 000134                  	JMP	@(R4)+
      59                                ;
      60 125320 066666  000006  000002  LSTP::	ADD	6(SP),2(SP)
      61 125326 066616  000004          	ADD	4(SP),@SP
      62 125332 000134                  	JMP	@(R4)+
      63                                ;
      64 125334 011600                  SPFORM::MOV	@SP,R0
      65 125336 001407                  	BEQ	1$
      66                                ;
      67                                ;	CALL	TSTCOL
      68                                ;
      69 125340 020027  000004          	CMP	R0,#4
      70 125344 101311                  	BHI	COLERR
      71 125346 062700  000220          	ADD	#220,R0
      72                                ;
      73 125352 010016                  	MOV	R0,@SP
      74 125354 000134                  	JMP	@(R4)+
      75 125356 013716  000212          1$:	MOV	@#212,@SP
      76 125362 042716  177774          SPTOL:	BIC	#177774,@SP
      77 125366 162716  000224          	SUB	#224,@SP
      78 125372 005416                  	NEG	@SP
      79 125374 000134                  	JMP	@(R4)+
      80                                ;
      81 125376 013746  000214          RSP::	MOV	@#214,-(SP)
      82 125402 000767                  	BR	SPTOL
      83                                ;
      84 125404 011646                  VIDSP::	MOV	@SP,-(SP)
      85 125406 000134                  	JMP	@(R4)+
      86                                ;
      87                                ; .PAGE
      88                                .SBTTL	SET/RESET	SPECIFIED COLOR POINT SETTING/ERASING
      89                                
      90                                ;------------------------------------------------------------------------------
      91                                ; ПРОЦЕДУРА УСТАНОВКИ ЦВЕТА И ГАШЕНИЯ ТОЧКИ.
      92                                ; СТЕК НА ВХОДЕ:
      93                                ; 2(SP)		X-КООРДИНАТА;
      94                                ;  (SP)		Y;
      95                                ;------------------------------------------------------------------------------
      96                                
      97 125410 010700                  SET::	MOV	PC,R0
      98 125412 012602                  PNT:	MOV	(SP)+,R2
      99 125414 012601                  	MOV	(SP)+,R1
     100 125416 104030                  	EMT	30
     101 125420 000134                  	JMP	@(R4)+
     102                                ;
     103 125422 005000                  RESET::	CLR	R0
     104 125424 000772                  	BR	PNT
     105                                ;
     106                                ; .PAGE
     107                                .SBTTL	LSET	LINE'S SEGMENT DRAWING
     108                                
     109                                ;------------------------------------------------------------------------------
     110                                ; ПРОЦЕДУРА ВЫЧЕРЧИВАНИЯ ОТРЕЗКА ПРЯМОЙ МЕЖДУ ДВУМЯ ТОЧКАМИ (X1,Y1)-(X2,Y2).
     111                                ; СТЕК НА ВХОДЕ:
     112                                ;  6(SP)	X1;
     113                                ;  4(SP)	Y1;
     114                                ;  2(SP)	X2;
     115                                ;   (SP)	Y2;
     116                                ;------------------------------------------------------------------------------
     117                                
     118 125426 010700                  LSET::	MOV	PC,R0
     119 125430 016601  000006          	MOV	6(SP),R1
     120 125434 016602  000004          	MOV	4(SP),R2
     121 125440 104030                  	EMT	30
     122 125442 012602                  	MOV	(SP)+,R2
     123 125444 012601                  	MOV	(SP)+,R1
     124 125446 022626                  	CMP	(SP)+,(SP)+
     125 125450 104032                  	EMT	32
     126 125452 000134                  	JMP	@(R4)+
     127                                ;
     128                                ; .PAGE
     129                                .SBTTL	RECSET	RECTANGLE DRAWING
     130                                
     131                                ;------------------------------------------------------------------------------
     132                                ; ПРОЦЕДУРА ОТРИСОВКИ ПРЯМОУГОЛЬНИКА СО СТОРОНАМИ ПАРАЛЛЕЛЬНЫМИ СТОРОНАМ
     133                                ; ЭКРАНА И ДИАГОНАЛЬЮ НА ТОЧКАХ (X1,Y1), (X2,Y2)
     134                                ; СТЕК НА ВХОДЕ:
     135                                ;  6(SP)	X1;
     136                                ;  4(SP)	Y1;
     137                                ;  2(SP)	X2;
     138                                ;   (SP)	Y2;
     139                                ;------------------------------------------------------------------------------
     140                                
     141 125454 010700                  RECSET::MOV	PC,R0
     142 125456 011602                  	MOV	@SP,R2
     143 125460 016601  000002          	MOV	2(SP),R1
     144 125464 104030                  	EMT	30
     145 125466 016601  000006          	MOV	6(SP),R1
     146 125472 104032                  	EMT	32
     147 125474 016602  000004          	MOV	4(SP),R2
     148 125500 104032                  	EMT	32
     149 125502 016601  000002          	MOV	2(SP),R1
     150 125506 104032                  	EMT	32
     151 125510 012602                  	MOV	(SP)+,R2
     152 125512 104032                  	EMT	32
     153 125514 005726                  	TST	(SP)+
     154 125516 022626                  	CMP	(SP)+,(SP)+
     155 125520 000134                  	JMP	@(R4)+
     156                                ;
     157                                
     158                                ; .PAGE
     159                                .SBTTL	BOXSET FILLING RECTANGLE DRAWING
     160                                
     161                                ;------------------------------------------------------------------------------
     162                                ; ПРОЦЕДУРА ВЫЧЕРЧИВАНИЯ ЗАКРАШЕННОГО ПРЯМОУГОЛЬНИКА СО СТОРОНАМИ ПАРАЛЛЕЛЬНЫМИ
     163                                ; СТОРОНАМ ЭКРАНА И ДИАГОНАЛЬЮ НА ТОЧКАХ (X1,Y1), (X2,Y2).
     164                                ; СТЕК НА ВХОДЕ:
     165                                ;  6(SP)	X1;
     166                                ;  4(SP)	Y1;
     167                                ;  2(SP)	X2;
     168                                ;   (SP)	Y2;
     169                                ;------------------------------------------------------------------------------
     170                                
     171 125522 011602                  BOXSET::MOV	@SP,R2
     172 125524 016601  000004          	MOV	4(SP),R1
     173 125530 010100                  	MOV	R1,R0
     174 125532 020102                  	CMP	R1,R2
     175 125534 103002                  	BHIS	1$
     176 125536 010200                  	MOV	R2,R0
     177 125540 010102                  	MOV	R1,R2
     178 125542 160200                  1$:	SUB	R2,R0
     179 125544 005200                  	INC	R0
     180 125546 016601  000002          2$:	MOV	2(SP),R1
     181 125552 104030                  	EMT	30
     182 125554 016601  000006          	MOV	6(SP),R1
     183 125560 104032                  	EMT	32
     184 125562 005202                  	INC	R2
     185 125564 077010                  	SOB	R0,2$
     186 125566 012602                  	MOV	(SP)+,R2
     187 125570 012601                  	MOV	(SP)+,R1
     188 125572 005200                  	INC	R0
     189 125574 104030                  	EMT	30
     190 125576 022626                  	CMP	(SP)+,(SP)+
     191 125600 000134                  	JMP	@(R4)+
     192                                
     193                                ; .PAGE
     194                                .SBTTL	POINT	GETTING OF POINT COLOR
     195                                
     196                                ;------------------------------------------------------------------------------
     197                                ; ПРОЦЕДУРА ПОЛУЧЕНИЯ ЦВЕТА ТОЧКИ, ЗАДАННОЙ КООРДИНАТЫ.
     198                                ; СТЕК НА ВХОДЕ:
     199                                ; 2(SP)		X-КООРДИНАТА;
     200                                ;  (SP)		Y;
     201                                ; СТЕК НА ВЫХОДЕ:
     202                                ;  (SP)		КОД ЦВЕТА ТОЧКИ.
     203                                ;------------------------------------------------------------------------------
     204                                
     205                                POINT::
     206 125602 012602                  	MOV	(SP)+,R2	; Y
     207 125604 012601                  	MOV	(SP)+,R1	; X
     208 125606 012700  177777          	MOV	#-1,R0
     209 125612 020127  000377          	CMP	R1,#377
     210 125616 101007                  	BHI	1$
     211 125620 020227  000357          	CMP	R2,#239.
     212 125624 101004                  	BHI	1$
     213 125626 004767  126402'         	CALL	$COLOR
     214 125632 162700  000220          	SUB	#220,R0
     215 125636 010046                  1$:	MOV	R0,-(SP)	; ВОЗВРАЩАЕМЫЙ ЦВЕТ ТОЧКИ
     216 125640 000134                  	JMP	@(R4)+
     217                                ;
     218                                ;******************************************************************************
     219                                ; ИПИАН	СССР,	ОТДЕЛ 01,	СЕКТОР	130
     220                                ; ГРАФИЧЕСКИЕ МОДУЛИ ЯЗЫКА BASIC.
     221                                ;******************************************************************************
     222                                
     223                                .SBTTL	$BSCGRP	BASIC GRAPHIC
     224                                
     225                                .MACRO	PUSH	ARGS
     226                                .IRP	ARG,<ARGS>
     227                                	MOV	ARG,-(SP)
     228                                .ENDR
     229                                .ENDM
     230                                
     231                                .MACRO	POP	ARGS
     232                                .IRP	ARG,<ARGS>
     233                                	MOV	(SP)+,ARG
     234                                .ENDR
     235                                .ENDM
     236                                
     237                                ; .PAGE
     238                                .SBTTL	$PAINT	REGION FILLING
     239                                
     240                                ;------------------------------------------------------------------------------
     241                                ; ПРОЦЕДУРА ЗАКРАСКИ УКАЗАННЫМ ЦВЕТОМ ОБЛАСТИ С ГРАНИЦЕЙ ОПРЕДЕЛЕННОГО ЦВЕТА.
     242                                ; СТЕК НА ВХОДЕ:
     243                                ;  6(SP)	X-КООРДИНАТА ТОЧКИ;
     244                                ;  4(SP)	Y;
     245                                ;  2(SP)	КОД ЦВЕТА ОКРАСКИ;
     246                                ;   (SP)	КОД ЦВЕТА ГРАНИЦЫ;
     247                                ; РЕГИСТРЫ R4,R5 СОХРАНЯЮТСЯ.
     248                                ;------------------------------------------------------------------------------
     249                                
     250                                $PAINT::
     251                                	PUSH	<@#214,R4,R5>
       1                                .IRP	ARG,<@#214,R4,R5>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 125642 013746  000214          	MOV	@#214,-(SP)
       2 125646 010446                  	MOV	R4,-(SP)
       3 125650 010546                  	MOV	R5,-(SP)
     252 125652 010467  002134'         	MOV	R4,SAVJMP
     253 125656 016601  000014          	MOV	14(SP),R1	; X-КООРДИНАТА
     254 125662 016602  000012          	MOV	12(SP),R2	; Y
     255 125666 016600  000010          	MOV	10(SP),R0	; ЦВЕТ ОКРАСКИ
     256 125672 104016                  	EMT	16		; ПЕРЕДАЕМ ДРАЙВЕРУ
     257 125674 010004                  	MOV	R0,R4
     258 125676 016605  000006          	MOV	6(SP),R5	; ЦВЕТ ГРАНИЦЫ
     259 125702 004767  126326'         	CALL	$BORDR		; ТОЧКА (X,Y) ПРИНАДЛЕЖИТ ГРАНИЦЕ ?
     260 125706 103556                  	BCS	$END		; ДА 
     261                                				; ПРОИЗВОДИМ НАЧАЛЬНОЕ СКАНИРОВАНИЕ ВПРАВО И
     262                                				; ВЛЕВО  ОТ ТОЧКИ С ЦЕЛЬЮ ОПРЕДЕЛЕНИЯ ГРАНИЦ
     263 125710 010103                  	MOV	R1,R3		; СОХРАНЯЕМ X-КООРДИНАТУ
     264                                10$:
     265 125712 005201                  	INC	R1
     266 125714 004767  126326'         	CALL	$BORDR
     267 125720 103374                  	BCC	10$
     268 125722 010100                  	MOV	R1,R0		; ОТНЫНЕ ЭТО ПРАВАЯ ГРАНИЦА
     269 125724 010301                  	MOV	R3,R1		; ВОССТАНОВИЛИ X-КООРДИНАТУ
     270                                20$:
     271 125726 005301                  	DEC	R1
     272 125730 004767  126326'         	CALL	$BORDR
     273 125734 103374                  	BCC	20$
     274                                				; ОТНЫНЕ В R1 ЛЕВАЯ ГРАНИЦА
     275 125736 005003                  	CLR	R3		; НУЛЕВОЙ ШАГ ПО Y - ПРИЗНАК ОКОНЧАНИЯ
     276                                				; ЗАПОЛНЕНИЯ КОНТУРА
     277                                	PUSH	<R3>
       1                                .IRP	ARG,<R3>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 125740 010346                  	MOV	R3,-(SP)
     278 125742 005303                  	DEC	R3
     279                                	PUSH	<R0,R1,R2,R3>	; ПАРАМЕТРЫ ЗАКРАСКИ КОНТУРА СНИЗУ ОТ ТОЧКИ
       1                                .IRP	ARG,<R0,R1,R2,R3>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 125744 010046                  	MOV	R0,-(SP)
       2 125746 010146                  	MOV	R1,-(SP)
       3 125750 010246                  	MOV	R2,-(SP)
       4 125752 010346                  	MOV	R3,-(SP)
     280 125754 005403                  	NEG	R3		; А ПОКА БУДЕМ ЗАКРАШИВАТЬ ВВЕРХ
     281 125756 004767  126274'         	CALL	$LINHR		; НО ВНАЧАЛЕ ПРОВЕДЕМ ПРЯМУЮ ЧЕРЕЗ ТОЧКУ
     282                                $SCANN:				; ОСНОВНОЙ ЦИКЛ ПО ЗАКРАСКЕ ОБЛАСТИ
     283 125762 060302                  	ADD	R3,R2		; НОВОЕ ЗНАЧЕНИЕ Y
     284 125764 005201                  	INC	R1		; НОВАЯ ЛЕВАЯ ГРАНИЦА
     285 125766 004767  126326'         	CALL	$BORDR		; УХОДИТ ВПРАВО ?
     286 125772 103433                  	BCS	30$		; ДА
     287                                	PUSH	<R1,R1>		; X
       1                                .IRP	ARG,<R1,R1>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 125774 010146                  	MOV	R1,-(SP)
       2 125776 010146                  	MOV	R1,-(SP)
     288                                10$:
     289 126000 005301                  	DEC	R1
     290 126002 004767  126326'         	CALL	$BORDR
     291 126006 103374                  	BCC	10$		; НОВАЯ ЛЕВАЯ ГРАНИЦА УХОДИТ ВЛЕВО
     292 126010 160116                  	SUB	R1,(SP)		; СТАРАЯ ЛЕВАЯ ГРАНИЦА БОЛЬШЕ НОВОЙ 
     293 126012 022726  000002          	CMP	#2,(SP)+	; НА 2 ?
     294 126016 002014                  	BGE	20$		; НЕТ
     295 126020 162706  000006          	SUB	#6,SP		; РЕЗЕРВИРУЕМ В СТЕКЕ СЛОТ В 4 СЛОВА
     296                                	PUSH	<6(SP)>		; ПЕРЕПИСЫВАЕМ X В 5-ОЕ СЛОВО
       1                                .IRP	ARG,<6(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126024 016646  000006          	MOV	6(SP),-(SP)
     297 126030 062706  000010          	ADD	#10,SP		; УКАЗАТЕЛЬ НА НАЧАЛО СЛОТА
     298 126034 005316                  	DEC	(SP)		; ЗАПИСЫВАЕМ ПАРАМЕТРЫ ПРОХОДА ОТ НОВОЙ
     299                                	PUSH	<R1,R2,R3>	; ЛЕВОЙ ГРАНИЦЫ ДО СТАРОЙ СО СМЕНОЙ
       1                                .IRP	ARG,<R1,R2,R3>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126036 010146                  	MOV	R1,-(SP)
       2 126040 010246                  	MOV	R2,-(SP)
       3 126042 010346                  	MOV	R3,-(SP)
     300 126044 005416                  	NEG	(SP)		; НАПРАВЛЕНИЯ ПО ОСИ Y В СТЕК
     301 126046 005746                  	TST	-(SP)		; УКАЗАТЕЛЬ НА X
     302                                20$:
     303                                	PUSH	<(SP)>
       1                                .IRP	ARG,<(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126050 011646                  	MOV	(SP),-(SP)
     304 126052 010166  000002          	MOV	R1,2(SP)	; НОВАЯ ЛЕВАЯ ГРАНИЦА
     305                                	POP	<R1>		; X
       1                                .IRP	ARG,<R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126056 012601                  	MOV	(SP)+,R1
     306 126060 000410                  	BR	40$
     307                                30$:				; ИССЛЕДУЕМ ЛЕВУЮ ГРАНИЦУ, УШЕДШУЮ ВПРАВО
     308 126062 005201                  	INC	R1
     309 126064 020100                  	CMP	R1,R0		; КОНТУР ЗАМКНУЛСЯ ?
     310 126066 002060                  	BGE	$ENDSC		; ДА
     311 126070 004767  126326'         	CALL	$BORDR		; ЛЕВАЯ БЕЖИТ ДАЛЬШЕ ВПРАВО ?
     312 126074 103772                  	BCS	30$
     313                                	PUSH	<R1>
       1                                .IRP	ARG,<R1>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126076 010146                  	MOV	R1,-(SP)
     314 126100 005316                  	DEC	(SP)		; НОВАЯ ЛЕВАЯ ГРАНИЦА
     315                                40$:
     316 126102 005201                  	INC	R1		; ПОШЛИ К ПРАВОЙ ГРАНИЦЕ
     317 126104 004767  126326'         	CALL	$BORDR		; ДОСТИГНУТА ?
     318 126110 103374                  	BCC	40$		; НЕТ
     319 126112 005200                  	INC	R0		; СТАРАЯ ПРАВАЯ ГРАНИЦА + 1
     320 126114 020100                  	CMP	R1,R0		; НОВАЯ ПРАВАЯ ГРАНИЦА ПРЕВЫШАЕТ
     321                                				; СТАРУЮ БОЛЬШЕ ЧЕМ НА 1 ?
     322 126116 003415                  	BLE	50$		; НЕТ
     323 126120 162706  000006                  SUB	#6,SP		; РЕЗЕРВИРУЕМ В СТЕКЕ СЛОТ ДЛИНОЙ
     324                                				; В 4 СЛОВА
     325                                	PUSH	<6(SP)>		; ПЕРЕПИСЫВАЕМ ЛЕВУЮ ГРАНИЦУ
       1                                .IRP	ARG,<6(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126124 016646  000006          	MOV	6(SP),-(SP)
     326 126130 062706  000012          	ADD	#12,SP		; ВЫХОДИМ НА НАЧАЛО СЛОТА 
     327 126134 005300                  	DEC	R0		; ЛЕВАЯ ГРАНИЦА ДЛЯ ПОСЛЕДУЮЩЕГО АНАЛИЗА
     328                                	PUSH	<R1,R0,R2,R3>
       1                                .IRP	ARG,<R1,R0,R2,R3>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126136 010146                  	MOV	R1,-(SP)
       2 126140 010046                  	MOV	R0,-(SP)
       3 126142 010246                  	MOV	R2,-(SP)
       4 126144 010346                  	MOV	R3,-(SP)
     329 126146 005416                  	NEG	(SP)		; МЕНЯЕМ ЗНАК ШАГА
     330 126150 000421                  	BR	60$
     331                                50$:
     332 126152 005300                  	DEC	R0		; СТАРАЯ ПРАВАЯ ГРАНИЦА
     333 126154 005300                  	DEC	R0		; СТАРАЯ ПРАВАЯ ГРАНИЦА - 1
     334 126156 020001                  	CMP	R0,R1		; СТАРАЯ ПРАВАЯ ГРАНИЦА ПРЕВЫШАЕТ
     335                                				; НОВУЮ БОЛЬШЕ ЧЕМ НА 1
     336 126160 003416                  	BLE	70$		; НЕТ
     337 126162 162706  000006          	SUB	#6,SP
     338                                	PUSH	<6(SP)>
       1                                .IRP	ARG,<6(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126166 016646  000006          	MOV	6(SP),-(SP)
     339 126172 062706  000012          	ADD	#12,SP
     340 126176 005200                  	INC	R0		; ПРАВАЯ ГРАНИЦА ОСТАЛАСЬ ПРЕЖНЕЙ,
     341                                				; А НОВАЯ ПРАВАЯ ОБ'ЯВЛЯЕТСЯ ЛЕВОЙ
     342                                				; И АНАЛИЗИРУЕТСЯ В ДАЛЬНЕЙШЕМ
     343                                	PUSH	<R0,R1,R2,R3>
       1                                .IRP	ARG,<R0,R1,R2,R3>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126200 010046                  	MOV	R0,-(SP)
       2 126202 010146                  	MOV	R1,-(SP)
       3 126204 010246                  	MOV	R2,-(SP)
       4 126206 010346                  	MOV	R3,-(SP)
     344 126210 161666  000002          	SUB	(SP),2(SP)	; ОСТАТОК СТРОКИ ДОЛЖЕН БЫТЬ ПРОАНАЛИЗИ-
     345                                				; РОВАН ПРИ ТЕКУЩЕМ ЗНАЧЕНИИ Y, А
     346                                				; В НАЧАЛЕ ЦИКЛА БУДЕТ "ДОБАВЛЕН" ШАГ
     347                                60$:
     348 126214 005746                  	TST	-(SP)		; ВОССТАНАВЛИВАЕМ УКАЗАТЕЛЬ НА
     349                                				; НОВУЮ ЛЕВУЮ ГРАНИЦУ
     350                                70$:
     351 126216 010100                  	MOV	R1,R0		; ПЕРЕПИСЫВАЕМ НОВУЮ ПРАВУЮ ГРАНИЦУ
     352                                				; НА ЕЕ МЕСТО
     353                                	POP	<R1>		; ВОССТАНАВЛИВАЕМ ИЗ СТЕКА
       1                                .IRP	ARG,<R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126220 012601                  	MOV	(SP)+,R1
     354                                				; НОВУЮ ЛЕВУЮ
     355 126222 004767  126274'         	CALL	$LINHR
     356 126226 000655                  	BR	$SCANN
     357                                $ENDSC:				; КОНЕЦ СКАНИРОВАНИЯ ЗАМКНУТОЙ ПОДОБЛАСТИ
     358                                	POP	<R3>		; ИМЕЮТСЯ ДРУГИЕ ПОДОБЛАСТИ
       1                                .IRP	ARG,<R3>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126230 012603                  	MOV	(SP)+,R3
     359 126232 001404                  	BEQ	$END		; НЕТ
     360                                	POP	<R2,R1,R0>
       1                                .IRP	ARG,<R2,R1,R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126234 012602                  	MOV	(SP)+,R2
       2 126236 012601                  	MOV	(SP)+,R1
       3 126240 012600                  	MOV	(SP)+,R0
     361 126242 000647                  	BR	$SCANN
     362                                $END:				; ЗАВЕРШЕНИЕ ПРОГРАММЫ
     363                                	POP	<R5,R4,R3>
       1                                .IRP	ARG,<R5,R4,R3>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126244 012605                  	MOV	(SP)+,R5
       2 126246 012604                  	MOV	(SP)+,R4
       3 126250 012603                  	MOV	(SP)+,R3
     364 126252 022626                  	CMP	(SP)+,(SP)+	; ОЧИЩАЕМ СТЕК ОТ УЖЕ
     365                                	POP	<R2,R1>		; НЕНУЖНЫХ ПАРАМЕТРОВ
       1                                .IRP	ARG,<R2,R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126254 012602                  	MOV	(SP)+,R2
       2 126256 012601                  	MOV	(SP)+,R1
     366 126260 010700                  	MOV	PC,R0
     367 126262 104030                  	EMT	30
     368 126264 005067  002134'         	CLR	SAVJMP
     369 126270 000167  125220'         	JMP	COLRET
     370                                ;
     371                                ; .PAGE
     372                                .SBTTL	$LINHR
     373                                
     374                                ;------------------------------------------------------------------------------
     375                                ; ВНУТРЕННЯЯ ПРОЦЕДУРА ПРОВОДИТ ГОРИЗОНТАЛЬНУЮ ПРЯМУЮ МЕЖДУ ГРАНИЦАМИ.
     376                                ; РЕГИСТРЫ НА ВХОДЕ:
     377                                ; R0	ПРАВАЯ ГРАНИЦА;
     378                                ; R1	ЛЕВАЯ ГРАНИЦА;
     379                                ; R2	Y.
     380                                ; ВСЕ РЕГИСТРЫ СОХРАНЯЮТСЯ.
     381                                ;------------------------------------------------------------------------------
     382                                
     383                                $LINHR:
     384                                	PUSH	<R0,R1>
       1                                .IRP	ARG,<R0,R1>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126274 010046                  	MOV	R0,-(SP)
       2 126276 010146                  	MOV	R1,-(SP)
     385 126300 005201                  	INC	R1
     386 126302 005000                  	CLR	R0
     387 126304 005200                  	INC	R0
     388 126306 104030                  	EMT	30
     389 126310 016601  000002          	MOV	2(SP),R1
     390 126314 005301                  	DEC	R1
     391 126316 104032                  	EMT	32
     392                                	POP	<R1,R0>
       1                                .IRP	ARG,<R1,R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126320 012601                  	MOV	(SP)+,R1
       2 126322 012600                  	MOV	(SP)+,R0
     393 126324 000207                  	RETURN
     394                                
     395                                ; .PAGE
     396                                .SBTTL	$BORDR
     397                                
     398                                ;------------------------------------------------------------------------------
     399                                ; ВНУТРЕННЯЯ ПРОЦЕДУРА ОПРЕДЕЛЯЕТ ПОЛОЖЕНИЕ ТОЧКИ ОТНОСИТЕЛЬНО ГРАНИЦЫ.
     400                                ; РЕГИСТРЫ НА ВХОДЕ:
     401                                ; R1	X-КООРДИНАТА ТОЧКИ;
     402                                ; R2	Y;
     403                                ; R4	ЦВЕТ ОКРАСКИ;
     404                                ; R5	ЦВЕТ ГРАНИЦЫ.
     405                                ; ВСЕ РЕГИСТРЫ СОХРАНЯЮТСЯ.
     406                                ; КОДЫ УСЛОВИЙ:
     407                                ; БИТ C УСТАНАВЛИВАЕТСЯ, ЕСЛИ ТОЧКА ПРИНАДЛЕЖИТ ГРАНИЦЕ. В ПРОТИВНОМ СЛУЧАЕ
     408                                ; ОЧИЩАЕТСЯ.
     409                                ;------------------------------------------------------------------------------
     410                                
     411                                $BORDR:
     412 126326 030127  177400          	BIT	R1,#177400	; X-КООРДИНАТА В ДОПУСТИМЫХ ПРЕДЕЛАХ
     413 126332 001021                  	BNE	20$		; НЕТ
     414 126334 030227  177400          	BIT	R2,#177400	; Y-КООРДИНАТА В ДОПУСТИМЫХ ПРЕДЕЛАХ
     415 126340 001016                  	BNE	20$		; НЕТ
     416 126342 020227  000357          	CMP	R2,#357		; У Y-КООРДИНАТЫ МЕНЬШИЙ ПРЕДЕЛ
     417 126346 003013                  	BGT	20$
     418                                	PUSH	<R0>
       1                                .IRP	ARG,<R0>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126350 010046                  	MOV	R0,-(SP)
     419 126352 004767  126402'         	CALL	$COLOR		; ОПРЕДЕЛЯЕМ ЦВЕТ ТОЧКИ (X,Y)
     420 126356 020005                  	CMP	R0,R5		; ЦВЕТ ТОЧКИ СОВПАДАЕТ С ЦВЕТОМ ГРАНИЦЫ
     421 126360 001405                  	BEQ	10$		; ДА
     422 126362 020004                  	CMP	R0,R4		; ЦВЕТ ТОЧКИ СОВПАДАЕТ С ЦВЕТОМ ОКРАСКИ
     423 126364 001403                  	BEQ	10$
     424                                	POP	<R0>
       1                                .IRP	ARG,<R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126366 012600                  	MOV	(SP)+,R0
     425 126370 000241                  	CLC
     426 126372 000207                  	RETURN
     427                                10$:
     428                                	POP	<R0>
       1                                .IRP	ARG,<R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126374 012600                  	MOV	(SP)+,R0
     429                                20$:
     430 126376 000261                  	SEC
     431 126400 000207                  	RETURN
     432                                
     433                                ; .PAGE
     434                                .SBTTL	$COLOR
     435                                
     436                                ;------------------------------------------------------------------------------
     437                                ; ВНУТРЕННЯЯ ПРОЦЕДУРА ОПРЕДЕЛЯЕТ ЦВЕТ ЗАДАННОЙ ТОЧКИ.
     438                                ; РЕГИСТРЫ НА ВХОДЕ:
     439                                ; R1	X-КООРДИНАТА ТОЧКИ;
     440                                ; R2	Y.
     441                                ; РЕГИСТРЫ НА ВЫХОДЕ:
     442                                ; R0	ЦВЕТ ТОЧКИ.
     443                                ; ЗА ИСКЛЮЧЕНИЕМ R0 РЕГИСТРЫ СОХРАНЯЮТСЯ.
     444                                ;------------------------------------------------------------------------------
     445                                
     446                                $COLOR:
     447                                	PUSH	<R1,R2>		; СОХРАНЯЕМ РЕГИСТРЫ
       1                                .IRP	ARG,<R1,R2>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 126402 010146                  	MOV	R1,-(SP)
       2 126404 010246                  	MOV	R2,-(SP)
     448 126406 006302                  	ASL	R2		; УМНОЖАЕМ Y НА 100 ( OCTAL )
     449 126410 006302                  	ASL	R2
     450 126412 006302                  	ASL	R2
     451 126414 006302                  	ASL	R2
     452 126416 006302                  	ASL	R2
     453 126420 006302                  	ASL	R2
     454 126422 010100                  	MOV	R1,R0		; X
     455 126424 006200                  	ASR	R0		; ДЕЛЕНИЕ
     456 126426 006200                  	ASR	R0		; НА 4
     457 126430 060200                  	ADD	R2,R0		; ОТНОСИТЕЛЬНЫЙ АДРЕС БАЙТА С ТОЧКОЙ В ОЗУ
     458 126432 063700  000204          	ADD	@#204,R0	; ДОБАВЛЯЕМ АДРЕС ПЕРВОЙ ГРАФИЧЕСКОЙ СТРОКИ
     459                                				; ОТНОСИТЕЛЬНО НАЧАЛА ОЗУ-ЭКРАНА
     460 126436 042700  140000          	BIC	#140000,R0	; УЧИТЫВАЕМ, ЧТО ОЗУ-ЭКРАНА - СВИТОК
     461 126442 063700  000202          	ADD	@#202,R0	; ДОБАВЛЯЕМ АДРЕС НАЧАЛА ОЗУ-ЭКРАНА
     462 126446 111002                  	MOVB	(R0),R2		; БАЙТ СОБСТВЕННОЙ ПЕРСОНОЙ
     463 126450 042701  177774          	BIC	#177774,R1	; НОМЕР ТОЧКИ В БАЙТЕ:	0,1,2,3
     464 126454 001403                  	BEQ	20$
     465                                10$:
     466 126456 006202                  	ASR	R2
     467 126460 006202                  	ASR	R2
     468 126462 077103                  	SOB	R1,10$
     469                                20$:
     470 126464 042702  177774          	BIC	#177774,R2	; ВЫДЕЛЯЕМ ДВА РАЗРЯДА ТОЧКИ
     471 126470 012700  000224          	MOV	#224,R0
     472 126474 160200                  	SUB	R2,R0
     473                                	POP	<R2,R1>
       1                                .IRP	ARG,<R2,R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 126476 012602                  	MOV	(SP)+,R2
       2 126500 012601                  	MOV	(SP)+,R1
     474 126502 000207                  	RETURN
     475                                ; УХ!!!;-----------------------------------------------------------------
     476                                ; .PAGE
     477                                ;
     478 126504 016646  000016          ANG1::	MOV	16(SP),-(SP)
     479 126510 016646  000016          	MOV	16(SP),-(SP)
     480 126514 016646  000016          	MOV	16(SP),-(SP)
     481 126520 000406                  	BR	ANG
     482 126522 016646  000022          ANG2::	MOV	22(SP),-(SP)
     483 126526 016646  000022          	MOV	22(SP),-(SP)
     484 126532 016646  000022          	MOV	22(SP),-(SP)
     485 126536 010446                  ANG:	MOV	R4,-(SP)
     486 126540 010467  002134'         	MOV	R4,SAVJMP
     487 126544 010600                  	MOV	SP,R0
     488 126546 062700  000020          	ADD	#20,R0
     489 126552 014046                  	MOV	-(R0),-(SP)
     490 126554 014046                  	MOV	-(R0),-(SP)
     491 126556 014046                  	MOV	-(R0),-(SP)
     492 126560 014046                  	MOV	-(R0),-(SP)
     493 126562 004467  166552'         	JSR	R4,STAND
     494 126566 173566                  	.WORD	$B95
     495 126570 126622                  	.WORD	2$
     496 126572 166646                  	.WORD	ID
     497 126574 170210                  	.WORD	$DMUL$
     498 126576 166760                  	.WORD	DI
     499 126600 126630                  	.WORD	3$
     500 126602 126636                  	.WORD	4$
     501 126604 173614                  	.WORD	$B93
     502 126606 126670                  	.WORD	5$
     503 126610 166646                  	.WORD	ID
     504 126612 170210                  	.WORD	$DMUL$
     505 126614 166760                  	.WORD	DI
     506 126616 126630                  	.WORD	3$
     507 126620 126676                  	.WORD	6$
     508 126622 016646  000012          2$:	MOV	12(SP),-(SP)
     509 126626 000134                  	JMP	@(R4)+
     510 126630 066616  000010          3$:	ADD	10(SP),@SP
     511 126634 000134                  	JMP	@(R4)+
     512 126636 010600                  4$:	MOV	SP,R0
     513 126640 062700  000022          	ADD	#22,R0
     514 126644 014046                  	MOV	-(R0),-(SP)
     515 126646 014046                  	MOV	-(R0),-(SP)
     516 126650 014046                  	MOV	-(R0),-(SP)
     517 126652 014046                  	MOV	-(R0),-(SP)
     518 126654 002002                  	BGE	8$
     519 126656 005466  000010          	NEG	10(SP)
     520 126662 052716  100000          8$:	BIS	#100000,@SP
     521 126666 000134                  	JMP	@(R4)+
     522 126670 016646  000014          5$:	MOV	14(SP),-(SP)
     523 126674 000134                  	JMP	@(R4)+
     524 126676 012666  000016          6$:	MOV	(SP)+,16(SP)
     525 126702 012666  000016          	MOV	(SP)+,16(SP)
     526 126706 012604                  	MOV	(SP)+,R4
     527 126710 022626                  	CMP	(SP)+,(SP)+
     528 126712 022626                  	CMP	(SP)+,(SP)+
     529 126714 005726                  	TST	(SP)+
     530 126716 005067  002134'         	CLR	SAVJMP
     531 126722 000134                  	JMP	@(R4)+
     532 126724 016646  000002          ANG01::	MOV	2(SP),-(SP)
     533 126730 066616  000010          	ADD	10(SP),@SP
     534 126734 016646  000006          	MOV	6(SP),-(SP)
     535 126740 000134                  	JMP	@(R4)+
     536 126742 016646  000006          ANG02::	MOV	6(SP),-(SP)
     537 126746 066616  000014          	ADD	14(SP),@SP
     538 126752 016646  000012          	MOV	12(SP),-(SP)
     539 126756 000134                  	JMP	@(R4)+
     540 126760 012746  000001          ASPINT::MOV	#1,-(SP)
     541 126764 000134                  	JMP	@(R4)+
     542 126766 012616                  ASPDBL::MOV	(SP)+,@SP
     543 126770 012616                  	MOV	(SP)+,@SP
     544 126772 012702  000001          ASPSNG::MOV	#1,R2
     545 126776 012601                  	MOV	(SP)+,R1
     546 127000 003447                  	BLE	7$
     547 127002 005000                  	CLR	R0
     548 127004 150100                  	BISB	R1,R0
     549 127006 052700  000200          	BIS	#200,R0
     550 127012 006301                  	ASL	R1
     551 127014 105001                  	CLRB	R1
     552 127016 000301                  	SWAB	R1
     553 127020 162701  000211          	SUB	#211,R1
     554 127024 002026                  	BGE	55$
     555 127026 020127  177760          	CMP	R1,#-20
     556 127032 002426                  	BLT	6$
     557 127034 005201                  1$:	INC	R1
     558 127036 001407                  	BEQ	3$
     559 127040 006200                  	ASR	R0
     560 127042 103374                  	BCC	1$
     561 127044 006100                  	ROL	R0
     562 127046 106302                  2$:	ASLB	R2
     563 127050 103405                  	BCS	4$
     564 127052 005201                  	INC	R1
     565 127054 001374                  	BNE	2$
     566 127056 010016                  3$:	MOV	R0,@SP
     567 127060 010246                  	MOV	R2,-(SP)
     568 127062 000134                  	JMP	@(R4)+
     569 127064 106002                  4$:	RORB	R2
     570 127066 006302                  	ASL	R2
     571 127070 005201                  5$:	INC	R1
     572 127072 001771                  	BEQ	3$
     573 127074 006200                  	ASR	R0
     574 127076 005500                  	ADC	R0
     575 127100 000773                  	BR	5$
     576 127102 012700  000400          55$:	MOV	#400,R0
     577 127106 000763                  	BR	3$
     578 127110 010200                  6$:	MOV	R2,R0
     579 127112 012702  000400          	MOV	#400,R2
     580 127116 000757                  	BR	3$
     581 127120 104405                  7$:	TRAP	5
     582 127122 012746  000001          ASP0::	MOV	#1,-(SP)
     583 127126 012746  000001          	MOV	#1,-(SP)
     584 127132 000134                  	JMP	@(R4)+
     585                                .IFT
     586 127134 010446                  $CONST:	MOV	R4,-(SP)
     587 127136 010546                  	MOV	R5,-(SP)
     588 127140 104510                  	TRAP	110
     589 127142 000406                  	BR	DRKL
     590 127144 016604  000004          	MOV	4(SP),R4
     591 127150 010566  000004          	MOV	R5,4(SP)
     592 127154 012605                  	MOV	(SP)+,R5
     593 127156 000204                  	RTS	R4
     594 127160 104405                  DRKL:	TRAP	5
     595                                ;
     596                                .IFT
     597                                ;
     598 127162 010446                  $VALUE: MOV	R4,-(SP)
     599 127164 010546                  	MOV	R5,-(SP)
     600 127166 005046                  	CLR	-(SP)
     601 127170 104505                  	TRAP	105
     602 127172 000421                  	BR	9$
     603 127174 000420                  	BR	9$
     604 127176 000417                  	BR	9$
     605 127200 104504                  	TRAP	104
     606 127202 005704                  	TST	R4
     607 127204 001414                  	BEQ	9$
     608 127206 012416                  	MOV	(R4)+,@SP
     609 127210 105767  002034'         	TSTB	TYPE
     610 127214 100410                  	BMI	9$
     611 127216 010105                  	MOV	R1,R5
     612 127220 011416                  	MOV	@R4,@SP
     613 127222 014446                  	MOV	-(R4),-(SP)
     614 127224 004467  166552'         	JSR	R4,STAND
     615 127230 166770  127234          	.WORD	SI,1$
     616 127234 010501                  1$:	MOV	R5,R1
     617 127236 016604  000006          9$:	MOV	6(SP),R4
     618 127242 012666  000004          	MOV	(SP)+,4(SP)
     619 127246 012605                  	MOV	(SP)+,R5
     620 127250 000204                  	RTS	R4
     621                                ;
     622 127252 005046                  $STRNG:	CLR	-(SP)
     623 127254 010446                  	MOV	R4,-(SP)
     624 127256 010546                  	MOV	R5,-(SP)
     625 127260 104505                  	TRAP	105
     626 127262 000736                  	BR	DRKL
     627 127264 000735                  	BR	DRKL
     628 127266 000401                  	BR	1$
     629 127270 000733                  	BR	DRKL
     630 127272 104504                  1$:	TRAP	104
     631 127274 005704                  	TST	R4
     632 127276 001411                  	BEQ	5$
     633 127300 016605  000006          	MOV	6(SP),R5
     634 127304 012466  000004          	MOV	(R4)+,4(SP)
     635 127310 011466  000006          	MOV	@R4,6(SP)
     636 127314 010504                  	MOV	R5,R4
     637 127316 012605                  4$:	MOV	(SP)+,R5
     638 127320 000204                  	RTS	R4
     639 127322 016604  000006          5$:	MOV	6(SP),R4
     640 127326 005066  000006          	CLR	6(SP)
     641 127332 000771                  	BR	4$
     642                                
     643                                ; .PAGE
     644                                .SBTTL	$ARC	ARC DRAWING
     645                                
     646                                ;------------------------------------------------------------------------------
     647                                ; ПРОЦЕДУРА ПОСТРОЕНИЯ ДУГИ ОКРУЖНОСТИ ( ПСЕВДОЭЛИПСА ).
     648                                ; СТЕК НА ВХОДЕ:
     649                                ; 22(SP)	X-КООРДИНАТА ЦЕНТРА ОКРУЖНОСТИ;
     650                                ; 20(SP)	Y;
     651                                ; 16(SP)	РАДИУС;
     652                                ; 14(SP)	ЦВЕТ ОТРИСОВКИ;
     653                                ; 12(SP)	X-КООРДИНАТА НАЧАЛЬНОЙ ТОЧКИ;
     654                                ; 10(SP)	Y;
     655                                ;  6(SP)	X-КООРДИНАТА КОНЕЧНОЙ ТОЧКИ;
     656                                ;  4(SP)	Y;
     657                                ;  2(SP)	ЧИСЛИТЕЛЬ СООТНОШЕНИЯ КООРДИНАТ;
     658                                ;   (SP)	ЗНАМЕНАТЕЛЬ;
     659                                ; ЕСЛИ X-КООРДИНАТЫ ГРАНИЧНЫХ ТОЧЕК ОТРИЦАТЕЛЬНЫЕ, ТО ПРОВОДЯТСЯ ПРЯМЫЕ,
     660                                ; СОЕДИНЯЮЩИЕ ЭТИ ТОЧКИ С ЦЕНТРОМ ОКРУЖНОСТИ.
     661                                ;------------------------------------------------------------------------------
     662                                
     663                                .IFT
     664                                $ARC::
     665                                	PUSH	<@#214,R4,R5>
       1                                .IRP	ARG,<@#214,R4,R5>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127334 013746  000214          	MOV	@#214,-(SP)
       2 127340 010446                  	MOV	R4,-(SP)
       3 127342 010546                  	MOV	R5,-(SP)
     666 127344 010467  002134'         	MOV	R4,SAVJMP
     667 127350 016600  000022          	MOV	22(SP),R0		; КОД ЦВЕТА
     668 127354 001401                  	BEQ	10$
     669 127356 104016                  	EMT	16       		; УСТАНАВЛИВАЕМ ЦВЕТ ОТРИСОВКИ
     670                                10$:
     671 127360 016601  000020          	MOV	20(SP),R1		; XS < 0 ?
     672 127364 002071                  	BGE	12$			; НЕТ
     673 127366 005401                  	NEG	R1
     674 127370 005466  000020          	NEG	20(SP)			; XS = -XS
     675 127374 016602  000016          	MOV	16(SP),R2		; YS
     676 127400 026666  000010  000006  	CMP	10(SP),6(SP)		; ЕСТЬ СЖАТИЕ ПО ОДНОЙ ИЗ ОСЕЙ ?
     677 127406 001450                  	BEQ	106$			; НЕТ
     678 127410 002424                  	BLT	103$			; ДА, ПО ОСИ Y
     679 127412 166601  000030          	SUB	30(SP),R1
     680                                	PUSH	<R2,R1,12(SP)>		; СЖАТИЕ ПО ОСИ X
       1                                .IRP	ARG,<R2,R1,12(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127416 010246                  	MOV	R2,-(SP)
       2 127420 010146                  	MOV	R1,-(SP)
       3 127422 016646  000012          	MOV	12(SP),-(SP)
     681 127426 004467  166552'         	JSR	R4,STAND
     682 127432 162116                  	.WORD	SAND	
     683 127434 127442                  	.WORD	101$
     684 127436 162052                  	.WORD	IDIV
     685 127440 127450                  	.WORD	102$
     686                                101$:
     687                                	PUSH	<14(SP)>
       1                                .IRP	ARG,<14(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127442 016646  000014          	MOV	14(SP),-(SP)
     688 127446 000134                  	JMP	@(R4)+
     689                                102$:
     690                                	POP	<R1,R2>
       1                                .IRP	ARG,<R1,R2>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 127450 012601                  	MOV	(SP)+,R1
       2 127452 012602                  	MOV	(SP)+,R2
     691 127454 066601  000030          	ADD	30(SP),R1
     692 127460 000423                  	BR	106$
     693                                103$:
     694 127462 166602  000026          	SUB	26(SP),R2		; СЖАТИЕ ПО ОСИ X
     695                                	PUSH	<R1,R2,14(SP)>
       1                                .IRP	ARG,<R1,R2,14(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127466 010146                  	MOV	R1,-(SP)
       2 127470 010246                  	MOV	R2,-(SP)
       3 127472 016646  000014          	MOV	14(SP),-(SP)
     696 127476 004467  166552'         	JSR	R4,STAND
     697 127502 162116                  	.WORD	SAND
     698 127504 127512                  	.WORD	104$
     699 127506 162052                  	.WORD	IDIV
     700 127510 127520                  	.WORD	105$
     701                                104$:
     702                                	PUSH	<12(SP)>
       1                                .IRP	ARG,<12(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127512 016646  000012          	MOV	12(SP),-(SP)
     703 127516 000134                  	JMP	@(R4)+
     704                                105$:
     705                                	POP	<R2,R1>
       1                                .IRP	ARG,<R2,R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 127520 012602                  	MOV	(SP)+,R2
       2 127522 012601                  	MOV	(SP)+,R1
     706 127524 066602  000026          	ADD	26(SP),R2
     707                                106$:
     708 127530 005000                  	CLR	R0
     709 127532 005200                  	INC	R0
     710 127534 104030                  	EMT	30
     711 127536 016601  000030          	MOV	30(SP),R1		; XC
     712 127542 016602  000026          	MOV	26(SP),R2		; YC
     713 127546 104032                  	EMT	32			; ЧЕРТИМ ОТРЕЗОК (XS,YS)-(XC,YC)
     714                                12$:
     715 127550 016601  000014          	MOV	14(SP),R1		; XT < 0 ?
     716 127554 002071                  	BGE	14$			; НЕТ
     717 127556 005401                  	NEG	R1
     718 127560 005466  000014          	NEG	14(SP)			; XT = -XT
     719 127564 016602  000012          	MOV	12(SP),R2		; YT
     720 127570 026666  000010  000006  	CMP	10(SP),6(SP)
     721 127576 001450                  	BEQ	126$
     722 127600 002424                  	BLT	123$
     723 127602 166601  000030          	SUB	30(SP),R1
     724                                	PUSH	<R2,R1,12(SP)>
       1                                .IRP	ARG,<R2,R1,12(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127606 010246                  	MOV	R2,-(SP)
       2 127610 010146                  	MOV	R1,-(SP)
       3 127612 016646  000012          	MOV	12(SP),-(SP)
     725 127616 004467  166552'         	JSR	R4,STAND
     726 127622 162116                  	.WORD	SAND
     727 127624 127632                  	.WORD	121$
     728 127626 162052                  	.WORD	IDIV
     729 127630 127640                  	.WORD	122$
     730                                121$:
     731                                	PUSH	<14(SP)>
       1                                .IRP	ARG,<14(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127632 016646  000014          	MOV	14(SP),-(SP)
     732 127636 000134                  	JMP	@(R4)+
     733                                122$:
     734                                	POP	<R1,R2>
       1                                .IRP	ARG,<R1,R2>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 127640 012601                  	MOV	(SP)+,R1
       2 127642 012602                  	MOV	(SP)+,R2
     735 127644 066601  000030          	ADD	30(SP),R1
     736 127650 000423                  	BR	126$
     737                                123$:
     738 127652 166602  000026          	SUB	26(SP),R2
     739                                	PUSH	<R1,R2,14(SP)>
       1                                .IRP	ARG,<R1,R2,14(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127656 010146                  	MOV	R1,-(SP)
       2 127660 010246                  	MOV	R2,-(SP)
       3 127662 016646  000014          	MOV	14(SP),-(SP)
     740 127666 004467  166552'         	JSR	R4,STAND
     741 127672 162116                  	.WORD	SAND
     742 127674 127702                  	.WORD	124$
     743 127676 162052                  	.WORD	IDIV
     744 127700 127710                  	.WORD	125$
     745                                124$:
     746                                	PUSH	<12(SP)>
       1                                .IRP	ARG,<12(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 127702 016646  000012          	MOV	12(SP),-(SP)
     747 127706 000134                  	JMP	@(R4)+
     748                                125$:
     749                                	POP	<R2,R1>
       1                                .IRP	ARG,<R2,R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 127710 012602                  	MOV	(SP)+,R2
       2 127712 012601                  	MOV	(SP)+,R1
     750 127714 066602  000026          	ADD	26(SP),R2
     751                                126$:
     752 127720 005000                  	CLR	R0
     753 127722 005200                  	INC	R0
     754 127724 104030                  	EMT	30
     755 127726 016601  000030          	MOV	30(SP),R1		; XC
     756 127732 016602  000026          	MOV	26(SP),R2		; YC
     757 127736 104032                  	EMT	32			; ЧЕРТИМ ОТРЕЗОК (XT,YT)-(XC,YC)
     758                                14$:
     759 127740 005001                  	CLR	R1			; 0 - НАЧАЛЬНОЕ ЗНАЧЕНИЕ X-КООРДИНАТЫ
     760                                					; В ПЕРВОМ КВАДРАНТЕ
     761 127742 016602  000024          	MOV	24(SP),R2		; R - НАЧАЛЬНОЕ ЗНАЧЕНИЕ Y-КООРДИНАТЫ
     762                                					; В ПЕРВОМ КВАДРАНТЕ
     763 127746 010203                  	MOV	R2,R3			; ДАЛЕЕ ВЫЧИСЛЯЕМ D[0]
     764 127750 005303                  	DEC	R3
     765 127752 005403                  	NEG	R3
     766 127754 006303                  	ASL	R3			; D[0]
     767 127756 026666  000020  000014  	CMP	20(SP),14(SP)		; X-КООРДИНАТЫ НАЧАЛЬНОЙ И КОНЕЧНОЙ
     768                                					; ТОЧЕК ДУГИ СОВПАДАЮТ ?
     769 127764 001010                  	BNE	20$			; НЕТ
     770 127766 026666  000016  000012  	CMP	16(SP),12(SP)		; НАЧАЛЬНАЯ И КОНЕЧНАЯ ТОЧКИ
     771                                					; СОВПАДАЮТ ?
     772 127774 001004                  	BNE	20$			; НЕТ
     773 127776 012705  125252          	MOV	#125252,R5		; ЗАДАЕМ ОТРИСОВКУ ВСЕЙ ОКРУЖНОСТИ
     774 130002 000167  130426'         	JMP	$ASET
     775                                20$:
     776 130006 166666  000030  000020  	SUB	30(SP),20(SP)		; ПЕРЕХОДИМ В СИСТЕМУ КООРДИНАТ
     777 130014 166666  000026  000016  	SUB	26(SP),16(SP)		; С НАЧАЛОМ В ЦЕНТРЕ ОКРУЖНОСТИ
     778 130022 166666  000030  000014  	SUB	30(SP),14(SP)
     779 130030 166666  000026  000012  	SUB	26(SP),12(SP)
     780 130036 005000                  	CLR	R0			; R0 - НОМЕР КВАДРАНТА С ( XS, YS )
     781 130040 005766  000020          	TST	20(SP)
     782 130044 002006                  	BGE	30$
     783 130046 005200                  	INC	R0
     784 130050 005200                  	INC	R0
     785 130052 005766  000016          	TST	16(SP)
     786 130056 002405                  	BLT	40$
     787 130060 000403                  	BR	35$
     788                                
     789                                30$:
     790 130062 005766  000016          	TST	16(SP)
     791 130066 002001                  	BGE	40$
     792                                35$:
     793 130070 005200                  	INC	R0
     794                                40$:
     795 130072 005004                  	CLR	R4			; R4 - НОМЕР КВАДРАНТА С ( XT, YT )
     796 130074 005766  000014          	TST	14(SP)
     797 130100 002006                  	BGE	50$
     798 130102 005204                  	INC	R4
     799 130104 005204                  	INC	R4
     800 130106 005766  000012          	TST	12(SP)
     801 130112 002405                  	BLT	60$
     802 130114 000403                  	BR	55$
     803                                50$:
     804 130116 005766  000012          	TST	12(SP)
     805 130122 002001                  	BGE	60$
     806                                55$:
     807 130124 005204                  	INC	R4
     808                                60$:					; "ПЕРЕНОСИМ" НАЧАЛЬНУЮ И КОНЕЧНУЮ
     809 130126 006300                  	ASL	R0			; ТОЧКИ В 1-ЫЙ КВАДРАНТ
     810 130130 000170  130570          	JMP	@$QS(R0)
     811                                $QS1:
     812                                	PUSH	<20(SP)>
       1                                .IRP	ARG,<20(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130134 016646  000020          	MOV	20(SP),-(SP)
     813 130140 016666  000020  000022  	MOV	20(SP),22(SP)		; X=-Y
     814 130146 005466  000022          	NEG	22(SP)
     815                                	POP	<16(SP)>		; Y=X
       1                                .IRP	ARG,<16(SP)>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130152 012666  000016          	MOV	(SP)+,16(SP)
     816 130156 000417                  	BR	$QS0
     817                                $QS2:
     818 130160 005466  000020          	NEG	20(SP)			; X=-X
     819 130164 005466  000016          	NEG	16(SP)			; Y=-Y
     820 130170 000412                  	BR	$QS0
     821                                $QS3:
     822                                	PUSH	<20(SP)>
       1                                .IRP	ARG,<20(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130172 016646  000020          	MOV	20(SP),-(SP)
     823 130176 016666  000020  000022  	MOV	20(SP),22(SP)		; X=Y
     824                                	POP	<16(SP)>		; Y=-X
       1                                .IRP	ARG,<16(SP)>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130204 012666  000016          	MOV	(SP)+,16(SP)
     825 130210 005466  000016          	NEG	16(SP)
     826 130214 000400                  	BR	$QS0
     827                                $QS0:
     828 130216 006200                  	ASR	R0
     829 130220 006304                  	ASL	R4
     830 130222 000174  130600          	JMP	@$QT(R4)
     831                                $QT1:
     832                                	PUSH	<14(SP)>
       1                                .IRP	ARG,<14(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130226 016646  000014          	MOV	14(SP),-(SP)
     833 130232 016666  000014  000016  	MOV	14(SP),16(SP)
     834 130240 005466  000016          	NEG	16(SP)
     835                                	POP	<12(SP)>
       1                                .IRP	ARG,<12(SP)>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130244 012666  000012          	MOV	(SP)+,12(SP)
     836 130250 000416                  	BR	$QT0
     837                                $QT2:
     838 130252 005466  000014          	NEG	14(SP)
     839 130256 005466  000012          	NEG	12(SP)
     840 130262 000411                  	BR	$QT0
     841                                $QT3:
     842                                	PUSH	<14(SP)>
       1                                .IRP	ARG,<14(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130264 016646  000014          	MOV	14(SP),-(SP)
     843 130270 016666  000014  000016  	MOV	14(SP),16(SP)
     844                                	POP	<12(SP)>
       1                                .IRP	ARG,<12(SP)>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130276 012666  000012          	MOV	(SP)+,12(SP)
     845 130302 005466  000012          	NEG	12(SP)
     846                                $QT0:
     847 130306 006204                  	ASR	R4
     848 130310 005005                  	CLR	R5
     849 130312 020004                  	CMP	R0,R4			; НАЧАЛЬНАЯ И КОНЕЧНАЯ ТОЧКИ
     850                                					; В ОДНОМ КВАДРАНТЕ
     851 130314 001425                  	BEQ	40$			; ДА
     852                                	PUSH	<#6>
       1                                .IRP	ARG,<#6>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130316 012746  000006          	MOV	#6,-(SP)
     853 130322 004767  130610'         	CALL	$SETCD
     854                                10$:
     855 130326 005200                  	INC	R0
     856 130330 022700  000004          	CMP	#4,R0
     857 130334 001001                  	BNE	20$
     858 130336 005000                  	CLR	R0
     859                                20$:
     860 130340 020004                  	CMP	R0,R4
     861 130342 001405                  	BEQ	30$
     862                                	PUSH	<#12>
       1                                .IRP	ARG,<#12>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130344 012746  000012          	MOV	#12,-(SP)
     863 130350 004767  130610'         	CALL	$SETCD
     864 130354 000764                  	BR	10$
     865                                30$:
     866                                	PUSH	<#2>
       1                                .IRP	ARG,<#2>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130356 012746  000002          	MOV	#2,-(SP)
     867 130362 004767  130610'         	CALL	$SETCD
     868 130366 000417                  	BR	$ASET
     869                                40$:
     870 130370 026666  000020  000014  	CMP	20(SP),14(SP)		; XS-XT>0 ?
     871 130376 003005                  	BGT	50$
     872                                	PUSH	<#10>
       1                                .IRP	ARG,<#10>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130400 012746  000010          	MOV	#10,-(SP)
     873 130404 004767  130610'         	CALL	$SETCD
     874 130410 000406                  	BR	$ASET
     875                                50$:
     876 130412 012705  125252          	MOV	#125252,R5
     877                                	PUSH	<#4>
       1                                .IRP	ARG,<#4>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130416 012746  000004          	MOV	#4,-(SP)
     878 130422 004767  130610'         	CALL	$SETCD
     879                                $ASET:
     880 130426 004767  130672'         	CALL	$P4SET
     881 130432 005705                  	TST	R5			; ПОСТРОЕНА ВСЯ ДУГА ?
     882 130434 001436                  	BEQ	$AEND			; ДА
     883 130436 010300                  	MOV	R3,R0			; D[I]
     884 130440 003022                  	BGT	20$
     885                                ;------ D[I] <= 0
     886 130442 060200                  	ADD	R2,R0			; ВЫЧИСЛЯЕМ L[I]
     887 130444 006300                  	ASL	R0
     888 130446 005300                  	DEC	R0
     889 130450 003006                  	BGT	10$
     890                                ;...... D[I] <= 0 AND L[I] <= 0   ===> M1
     891 130452 005201                  	INC	R1			; X[I+1]=X[I]+1
     892 130454 010100                  	MOV	R1,R0
     893 130456 006300                  	ASL	R0
     894 130460 060003                  	ADD	R0,R3
     895 130462 005203                  	INC	R3			; D[I+1]=D[I]+2*X[I+1]+1
     896 130464 000760                  	BR	$ASET
     897                                ;...... D[I] <= 0 AND L[I] > 0 OR D[I] >= 0 AND L'[I] <= 0 ====> M2
     898                                10$:
     899 130466 005201                  	INC	R1			; X[I+1]=X[I]+1
     900 130470 005302                  	DEC	R2			; Y[I+1]=Y[I]-1
     901 130472 010100                  	MOV	R1,R0
     902 130474 160200                  	SUB	R2,R0
     903 130476 005200                  	INC	R0
     904 130500 006300                  	ASL	R0
     905 130502 060003                  	ADD	R0,R3			; D[I+1]=D[I]+2*X[I+1]-2*Y[I+1]+2
     906 130504 000750                  	BR	$ASET
     907                                ;------ D[I] > 0
     908                                20$:
     909 130506 160100                  	SUB	R1,R0			; ВЫЧИСЛЯЕМ L'[I]
     910 130510 006300                  	ASL	R0
     911 130512 005300                  	DEC	R0
     912 130514 003764                  	BLE	10$
     913                                ;...... D[I] > 0 AND L'[I] > 0
     914 130516 005302                  	DEC	R2			; Y[I+1]=Y[I]-1
     915 130520 010200                  	MOV	R2,R0
     916 130522 006300                  	ASL	R0
     917 130524 160003                  	SUB	R0,R3
     918 130526 005203                  	INC	R3
     919 130530 000736                  	BR	$ASET
     920                                $AEND:
     921                                	POP	<R5,R4,R3>
       1                                .IRP	ARG,<R5,R4,R3>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130532 012605                  	MOV	(SP)+,R5
       2 130534 012604                  	MOV	(SP)+,R4
       3 130536 012603                  	MOV	(SP)+,R3
     922 130540 062706  000020          	ADD	#20,SP
     923                                	POP	<R2,R1>
       1                                .IRP	ARG,<R2,R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130544 012602                  	MOV	(SP)+,R2
       2 130546 012601                  	MOV	(SP)+,R1
     924 130550 004767  126402'         	CALL	$COLOR
     925 130554 104016                  	EMT	16
     926 130556 104030                  	EMT	30
     927 130560 005067  002134'         	CLR	SAVJMP
     928 130564 000167  125220'         	JMP	COLRET
     929                                $QS:
     930 130570 130216                  	.WORD	$QS0
     931 130572 130134                  	.WORD	$QS1
     932 130574 130160                  	.WORD	$QS2
     933 130576 130172                  	.WORD	$QS3
     934                                $QT:
     935 130600 130306                  	.WORD	$QT0
     936 130602 130226                  	.WORD	$QT1
     937 130604 130252                  	.WORD	$QT2
     938 130606 130264                  	.WORD	$QT3
     939                                
     940                                ; .PAGE
     941                                .SBTTL	$SETCD	QUADRANT CODE SETTING
     942                                
     943                                ;------------------------------------------------------------------------------
     944                                ; ВНУТРЕННЯЯ ПРОЦЕДУРА ОПРЕДЕЛЕНИЯ КОДА КВАДРАНТА.
     945                                ; СТЕК НА ВХОДЕ:
     946                                ; 2(SP)		УСТАНАВЛИВАЕМЫЙ КОД;
     947                                ;  (SP)		АДРЕС ВОЗВРАТА.
     948                                ;------------------------------------------------------------------------------
     949                                 
     950                                $SETCD:
     951                                	PUSH	<R0,R1,R2>
       1                                .IRP	ARG,<R0,R1,R2>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130610 010046                  	MOV	R0,-(SP)
       2 130612 010146                  	MOV	R1,-(SP)
       3 130614 010246                  	MOV	R2,-(SP)
     952 130616 016601  000010          	MOV	10(SP),R1		; УСТАНАВЛИВАЕМЫЙ КОД
     953 130622 012702  000017          	MOV	#17,R2			; МАСКА
     954 130626 005700                  	TST	R0
     955 130630 001411                  	BEQ	20$
     956                                10$:
     957 130632 006301                  	ASL	R1
     958 130634 006301                  	ASL	R1
     959 130636 006301                  	ASL	R1
     960 130640 006301                  	ASL	R1
     961 130642 006302                  	ASL	R2
     962 130644 006302                  	ASL	R2
     963 130646 006302                  	ASL	R2
     964 130650 006302                  	ASL	R2
     965 130652 077011                  	SOB	R0,10$
     966                                20$:
     967 130654 040205                  	BIC	R2,R5
     968 130656 050105                  	BIS	R1,R5
     969                                	POP	<R2,R1,R0,(SP)>
       1                                .IRP	ARG,<R2,R1,R0,(SP)>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130660 012602                  	MOV	(SP)+,R2
       2 130662 012601                  	MOV	(SP)+,R1
       3 130664 012600                  	MOV	(SP)+,R0
       4 130666 012616                  	MOV	(SP)+,(SP)
     970 130670 000207                  	RETURN
     971                                
     972                                ; .PAGE
     973                                .SBTTL	$P4SET	SYMMETRICAL POINTS CHECKING AND DRAWING
     974                                
     975                                ;------------------------------------------------------------------------------
     976                                ; ВНУТРЕННЯЯ ПРОЦЕДУРА ПРОВЕРКИ ДОПУСТИМОСТИ И ОТРИСОВКИ 4-Х СИММЕТРИЧНЫХ
     977                                ; ТОЧЕК.
     978                                ; ВХОДНЫЕ ПАРАМЕТРЫ:
     979                                ; R1	ОТНОСИТЕЛЬНАЯ X-КООРДИНАТА ТОЧКИ ( В 1-ОМ КВАДРАНТЕ );
     980                                ; R2	Y;
     981                                ; R5	КОД КВАДРАНТА.
     982                                ; ВЫХОДНЫЕ ПАРАМЕТРЫ:
     983                                ; R5	КОД КВАДРАНТА.
     984                                ; НЕ СОХРАНЯЕТСЯ R0.
     985                                ; ВНИМАНИЕ!!! СИЯ ПРОЦЕДУРА НАГЛО ИСПОЛЬЗУЕТ ЗНАНИЕ СТЕКА, ПОЭТОМУ ЛЮБЫЕ
     986                                ; ИСПРАВЛЕНИЯ В ВЫЗЫВАЮЩЕЙ ПРОЦЕДУРЕ $ARC, ЗАТРАГИВАЮЩИЕ СТЕК ПРИВЕДУТ
     987                                ; К НЕОБХОДИМОСТИ ЕЕ КОРРЕКЦИИ.
     988                                ;------------------------------------------------------------------------------
     989                                
     990                                $P4SET:
     991                                	PUSH	<R5,R5>
       1                                .IRP	ARG,<R5,R5>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130672 010546                  	MOV	R5,-(SP)
       2 130674 010546                  	MOV	R5,-(SP)
     992 130676 005000                  	CLR	R0			; НОМЕР КВАДРАНТА ( 0,1,2,3 )
     993                                $P4CYC:
     994 130700 042705  177760          	BIC	#177760,R5		; ВЫДЕЛЯЕМ КОД ОЧЕРЕДНОГО КВАДРАНТА
     995 130704 000175  131366          	JMP	@$CODE(R5)		; ОБРАБАТЫВАЕМ ТОЧКУ В ВЫДЕЛЕННОМ
     996                                					; КВАДРАНТЕ СОГЛАСНО ЕЕ КОДУ
     997                                
     998                                $C0000:					; ДУГА В КВАДРАНТЕ НЕ ВЫЧЕРЧИВАЕТСЯ
     999 130710 005200                  	INC	R0
    1000 130712 022700  000004          	CMP	#4,R0			; ОБРАБОТАНЫ ВСЕ КВАДРАНТЫ ?
    1001 130716 001002                  	BNE	10$
    1002 130720 000167  131360'         	JMP	$P4END			; ДА
    1003                                10$:
    1004                                	POP	<R5>
       1                                .IRP	ARG,<R5>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 130724 012605                  	MOV	(SP)+,R5
    1005 130726 006205                  	ASR	R5
    1006 130730 006205                  	ASR	R5
    1007 130732 006205                  	ASR	R5
    1008 130734 006205                  	ASR	R5
    1009                                	PUSH	<R5>
       1                                .IRP	ARG,<R5>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130736 010546                  	MOV	R5,-(SP)
    1010 130740 000757                  	BR	$P4CYC
    1011                                $C0010:					; ДУГА ВЫЧЕРЧИВАЕТСЯ ОТ НАЧАЛА
    1012                                					; КВАДРАНТА ДО КОНЕЧНОЙ ТОЧКИ
    1013 130742 020166  000022          	CMP	R1,22(SP)		; ДОСТИГНУТА КОНЕЧНАЯ ТОЧКА ?
    1014 130746 002426                  	BLT	$L2			; НЕТ
    1015 130750 020266  000020          	CMP	R2,20(SP)
    1016 130754 003023                  	BGT	$L2
    1017 130756 005005                  	CLR	R5			; УСТАНАВЛИВАЕМ, ЧТО В ОСТАВШЕЙСЯ
    1018                                					; ЧАСТИ КВАДРАНТА ДУГА НЕ ВЫЧЕРЧИ-
    1019                                					; ВАЕТСЯ
    1020                                $L0:					; ДАЛЕЕ СЛЕДУЕТ УСТАНОВКА КОДА
    1021                                					; ВЫЧЕРЧИВАЕМОСТИ ДУГИ В ДАННОМ
    1022                                					; КВАДРАНТЕ
    1023 130760 012704  000017          	MOV	#17,R4			; МАСКА
    1024                                	PUSH	<R0>			; СОХРАНЯЕМ НОМЕР КВАДРАНТА
       1                                .IRP	ARG,<R0>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 130764 010046                  	MOV	R0,-(SP)
    1025 130766 001411                  	BEQ	$L1
    1026                                10$:
    1027 130770 006305                  	ASL	R5
    1028 130772 006305                  	ASL	R5
    1029 130774 006305                  	ASL	R5
    1030 130776 006305                  	ASL	R5
    1031 131000 006304                  	ASL	R4
    1032 131002 006304                  	ASL	R4
    1033 131004 006304                  	ASL	R4
    1034 131006 006304                  	ASL	R4
    1035 131010 077011                  	SOB	R0,10$
    1036                                $L1:
    1037                                	POP	<R0>			; ВОССТАНАВЛИВАЕМ НОМЕР КВАДРАНТА
       1                                .IRP	ARG,<R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131012 012600                  	MOV	(SP)+,R0
    1038 131014 040466  000002          	BIC	R4,2(SP)		; ГАСИМ ПРЕДЫДУЩИЙ КОД
    1039 131020 050566  000002          	BIS	R5,2(SP)		; УСТАНАВЛИВАЕМ НОВЫЙ
    1040                                $L2:					; ОТРИСОВКА ТОЧКИ
    1041                                	PUSH	<R0,R1,R2>
       1                                .IRP	ARG,<R0,R1,R2>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131024 010046                  	MOV	R0,-(SP)
       2 131026 010146                  	MOV	R1,-(SP)
       3 131030 010246                  	MOV	R2,-(SP)
    1042 131032 006300                  	ASL	R0
    1043 131034 000170  131402          	JMP	@$QUA(R0)
    1044                                $Q0:
    1045                                	PUSH	<R3,R4,R5>		; STAND, SAND IDIV ПОРТЯТ РЕГИСТРЫ
       1                                .IRP	ARG,<R3,R4,R5>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131040 010346                  	MOV	R3,-(SP)
       2 131042 010446                  	MOV	R4,-(SP)
       3 131044 010546                  	MOV	R5,-(SP)
    1046 131046 026666  000032  000030  	CMP	32(SP),30(SP)
    1047 131054 001440                  	BEQ	$L8
    1048 131056 002420                  	BLT	$L5
    1049                                	PUSH	<R2,R1,34(SP)>
       1                                .IRP	ARG,<R2,R1,34(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131060 010246                  	MOV	R2,-(SP)
       2 131062 010146                  	MOV	R1,-(SP)
       3 131064 016646  000034          	MOV	34(SP),-(SP)
    1050 131070 004467  166552'         	JSR	R4,STAND
    1051 131074 162116                  	.WORD	SAND
    1052 131076 131104                  	.WORD	$L3
    1053 131100 162052                  	.WORD	IDIV
    1054 131102 131112                  	.WORD	$L4
    1055                                $L3:
    1056                                	PUSH	<36(SP)>
       1                                .IRP	ARG,<36(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131104 016646  000036          	MOV	36(SP),-(SP)
    1057 131110 000134                  	JMP	@(R4)+
    1058                                $L4:
    1059                                	POP	<R1,R2>			; ПРЕОБРАЗОВАННАЯ X-КООРДИНАТА
       1                                .IRP	ARG,<R1,R2>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131112 012601                  	MOV	(SP)+,R1
       2 131114 012602                  	MOV	(SP)+,R2
    1060 131116 000417                  	BR	$L8
    1061                                $L5:
    1062                                	PUSH	<R1,R2,36(SP)>
       1                                .IRP	ARG,<R1,R2,36(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131120 010146                  	MOV	R1,-(SP)
       2 131122 010246                  	MOV	R2,-(SP)
       3 131124 016646  000036          	MOV	36(SP),-(SP)
    1063 131130 004467  166552'         	JSR	R4,STAND
    1064 131134 162116                  	.WORD	SAND
    1065 131136 131144                  	.WORD	$L6
    1066 131140 162052                  	.WORD	IDIV
    1067 131142 131152                  	.WORD	$L7
    1068                                $L6:
    1069                                	PUSH	<34(SP)>
       1                                .IRP	ARG,<34(SP)>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131144 016646  000034          	MOV	34(SP),-(SP)
    1070 131150 000134                  	JMP	@(R4)+
    1071                                $L7:
    1072                                	POP	<R2,R1>			; ПРЕОБРАЗОВАННАЯ Y-КООРДИНАТА
       1                                .IRP	ARG,<R2,R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131152 012602                  	MOV	(SP)+,R2
       2 131154 012601                  	MOV	(SP)+,R1
    1073                                $L8:
    1074                                	POP	<R5,R4,R3>
       1                                .IRP	ARG,<R5,R4,R3>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131156 012605                  	MOV	(SP)+,R5
       2 131160 012604                  	MOV	(SP)+,R4
       3 131162 012603                  	MOV	(SP)+,R3
    1075 131164 005000                  	CLR	R0
    1076 131166 005200                  	INC	R0			; УСТАНАВЛИВАЕМ ОТРИСОВКУ
    1077 131170 066601  000044          	ADD	44(SP),R1
    1078 131174 066602  000042          	ADD	42(SP),R2
    1079 131200 104030                  	EMT	30			; ВЫВОДИМ ТОЧКУ
    1080                                	POP	<R2,R1,R0>
       1                                .IRP	ARG,<R2,R1,R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131202 012602                  	MOV	(SP)+,R2
       2 131204 012601                  	MOV	(SP)+,R1
       3 131206 012600                  	MOV	(SP)+,R0
    1081 131210 000637                  	BR	$C0000
    1082                                $Q1:
    1083 131212 010201                  	MOV	R2,R1			; X=Y
    1084 131214 016602  000002          	MOV	2(SP),R2		; Y=-X
    1085 131220 005402                  	NEG	R2
    1086 131222 000706                  	BR	$Q0
    1087                                $Q2:
    1088 131224 005401                  	NEG	R1			; X=-X
    1089 131226 005402                  	NEG	R2			; Y=-Y
    1090 131230 000703                  	BR	$Q0
    1091                                $Q3:
    1092 131232 010201                  	MOV	R2,R1			; X=-Y
    1093 131234 005401                  	NEG	R1
    1094 131236 016602  000002          	MOV	2(SP),R2		; Y=X
    1095 131242 000676                  	BR	$Q0
    1096                                $C0100:					; ДУГА ВЫЧЕРЧИВАЕТСЯ ОТ НАЧАЛА
    1097                                					; КВАДРАНТА ДО КОНЕЧНОЙ ТОЧКИ И
    1098                                					; ОТ НАЧАЛЬНОЙ ТОЧКИ ДО КОНЦА
    1099                                					; КВАДРАНТА
    1100 131244 020166  000022          	CMP	R1,22(SP)		; КОНЕЧНАЯ ТОЧКА ДОСТИГНУТА ?
    1101 131250 002665                  	BLT	$L2			; НЕТ
    1102 131252 020266  000020          	CMP	R2,20(SP)
    1103 131256 003262                  	BGT	$L2
    1104 131260 012705  000006          	MOV	#6,R5			; УСТАНАВЛИВАЕМ ПРИЗНАК ОТРИСОВКИ
    1105                                					; ОТ НАЧАЛЬНОЙ ТОЧКИ ДО КОНЦА
    1106                                					; КВАДРАНТА
    1107 131264 000635                  	BR	$L0
    1108                                $C0110:					; ДУГА ВЫЧЕРЧИВАЕТСЯ ОТ НАЧАЛЬНОЙ
    1109                                					; ТОЧКИ ДО КОНЦА КВАДРАНТА
    1110 131266 020166  000026          	CMP	R1,26(SP)		; НАЧАЛЬНАЯ ТОЧКА ДОСТИГНУТА ?
    1111 131272 002606                  	BLT	$C0000			; НЕТ
    1112 131274 020266  000024          	CMP	R2,24(SP)
    1113 131300 003203                  	BGT	$C0000
    1114 131302 012705  000012          	MOV	#12,R5			; УСТАНАВЛИВАЕМ ПРИЗНАК ОТРИСОВКИ
    1115                                					; ВСЕГО ( ОСТАВШЕГОСЯ) КВАДРАНТА
    1116 131306 000624                  	BR	$L0
    1117                                $C1000:					; ДУГА ВЫЧЕРЧИВАЕТСЯ В ПРЕДЕЛАХ
    1118                                					; ОДНОГО КВАДРАНТА ОТ НАЧАЛЬНОЙ
    1119                                					; ДО КОНЕЧНОЙ ТОЧКИ
    1120 131310 020166  000026          	CMP	R1,26(SP)		; НАЧАЛЬНАЯ ТОЧКА ДОСТИГНУТА ?
    1121 131314 002002                  	BGE	5$
    1122 131316 000167  130710'         	JMP	$C0000			; НЕТ
    1123                                5$:
    1124 131322 020266  000024          	CMP	R2,24(SP)
    1125 131326 003402                  	BLE	10$
    1126 131330 000167  130710'         	JMP	$C0000
    1127                                10$:
    1128 131334 012705  000002          	MOV	#2,R5			; УСТАНАВЛИВАЕМ ПРИЗНАК ОТРИСОВКИ
    1129                                					; ОТ НАЧАЛА КВАДРАНТА ДО КОНЕЧНОЙ
    1130                                					; ТОЧКИ
    1131 131340 000607                  	BR	$L0
    1132                                $C1010:					; ДУГА ЧЕРТИТСЯ ВО ВСЕМ КВАДРАНТЕ
    1133 131342 020166  000032          	CMP	R1,32(SP)		; ДОСТИГНУТ КОНЕЦ КВАДРАНТА ?
    1134 131346 002626                  	BLT	$L2			; НЕТ
    1135 131350 005702                  	TST	R2
    1136 131352 003224                  	BGT	$L2
    1137 131354 005005                  	CLR	R5
    1138 131356 000600                  	BR	$L0
    1139                                $P4END:
    1140                                	POP	<R5,R5>
       1                                .IRP	ARG,<R5,R5>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131360 012605                  	MOV	(SP)+,R5
       2 131362 012605                  	MOV	(SP)+,R5
    1141 131364 000207                  	RETURN
    1142                                $CODE:
    1143 131366 130710                  	.WORD	$C0000
    1144 131370 130742                  	.WORD	$C0010
    1145 131372 131244                  	.WORD	$C0100
    1146 131374 131266                  	.WORD	$C0110
    1147 131376 131310                  	.WORD	$C1000
    1148 131400 131342                  	.WORD	$C1010
    1149                                $QUA:
    1150 131402 131040                  	.WORD	$Q0
    1151 131404 131212                  	.WORD	$Q1
    1152 131406 131224                  	.WORD	$Q2
    1153 131410 131232                  	.WORD	$Q3
    1154                                ; УХ!!!
    1155                                .IFT
    1156                                .MACRO	PUSH	ARGS		; PUSH:  АРГ-->СТЕК
    1157                                .IRP	ARG,<ARGS>
    1158                                	MOV	ARG,-(SP)
    1159                                .ENDR
    1160                                .ENDM
    1161                                .MACRO	POP	ARGS		; POP:   СТЕК-->АРГ
    1162                                .IRP	ARG,<ARGS>
    1163                                	MOV	(SP)+,ARG
    1164                                .ENDR
    1165                                .ENDM
    1166                                ;************************************************
    1167                                ;		ПРОГРАМА  ОПЕРАТОРА DRAW
    1168                                ;	НА ВХОДЕ:	В СТЕКЕ 2(SP) -АДРЕС СТРОКИ
    1169                                ;				 (SP) -ДЛИНА СТРОКИ
    1170                                ;	НА ВЫХОДЕ:	СТЕК ПУСТ
    1171                                ;	ВСЕ РЕГИСТРЫ СОХРАНЮТСЯ.ПРИ ВЫЗОВАХ $CONST,$VALUE,$STRNG R4 СОХР.
    1172                                ;************************************************
    1173                                ;
    1174                                $DRAW::
    1175 131412 010467  002134'         	MOV	R4,SAVJMP
    1176 131416 010500                  	MOV	R5,R0		; СОХРАНИТЬ
    1177                                	POP	<R5,R3>		; ИЗВЛЕЧЬ ДЛ. И АДР.СТР
       1                                .IRP	ARG,<R5,R3>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131420 012605                  	MOV	(SP)+,R5
       2 131422 012603                  	MOV	(SP)+,R3
    1178                                	PUSH	<R0,@#214>	; СОХР. R5,ЦВЕТ
       1                                .IRP	ARG,<R0,@#214>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131424 010046                  	MOV	R0,-(SP)
       2 131426 013746  000214          	MOV	@#214,-(SP)
    1179 131432 016701  000176'         	MOV	$DRVX,R1	; НАЧАЛЬНОЕ ПОЛОЖЕНИЕ
    1180 131436 016702  000200'         	MOV	$DRVY,R2	; НАЧАЛЬНОЕ ПОЛОЖЕНИЕ
    1181 131442 005046                  	CLR	-(SP)		; ЗАПИСЬ СЛОВ( 0,0 -ПРИЗНАК ОКОНЧАНИЯ ),
    1182 131444 005046                  	CLR	-(SP)
    1183 131446 012746  070000          	MOV	#70000,-(SP)	; И СЛОВА ПЕРЕМЕЩЕНИЙ  ( WM )( 70000 )
    1184                                G_NEWSTR:
    1185 131452 005703                  	TST	R3		; НУЛЕВОЙ АДРЕС-ПРИЗНАК КОНЦА ?
    1186 131454 001517                  	BEQ	G_OUT		; ДА--ВЫХОД ИЗ  $DRAW
    1187 131456 060305                  	ADD	R3,R5		; КОРРЕКЦИЯ R5<--АДРЕС ПОСЛЕДН. БАЙТА СТРОКИ
    1188 131460 005305                  	DEC	R5
    1189                                AGAIN:
    1190                                ;----------------------------------------------------------------------
    1191                                ;  SKANER ОПРЕДЕЛЯЕТ ПРИНАДЛЕЖНОСТЬ СИМВОЛА (R3) К КЛЮЧАМ.ДЛЯ КЛЮЧЕВОГО
    1192                                ;	  B R0 СМЕЩЕНИЕ ЕГО В  СТРОКЕ KEY УМНОЖЕННОЕ НА 2
    1193                                ;	!!!!! R3 НА ВЫХОДЕ УКАЗЫВАЕТ НА СЛЕДУЮЩИЙ  СИМВOЛ  !!!!!!
    1194                                ;----------------------------------------------------------------------
    1195                                ;SKANER
    1196 131462 104512                  	TRAP	112
    1197 131464 020305                  	CMP	R3,R5		; КОНЕЦ ОБРАБОТКИ ПОДСТРОКИ?
    1198 131466 101044                  	BHI	G_NEXT		; ДА
    1199 131470 005000                  	CLR	R0		; ПЕРВОНАЧАЛЬНО  НУЛЕВОЕ СМЕЩЕНИЕ
    1200 131472 126013  131534          1$:	CMPB	G_KEY(R0),(R3)	; СИМВОЛЫ СХОДЯТСЯ
    1201 131476 001405                  	BEQ	2$		; ДА-НА ВЫХОД
    1202 131500 005200                  	INC	R0		; НЕТ--СЛЕДУЮЩИЙ
    1203 131502 105760  131534          	TSTB	G_KEY(R0)		; НУЛЕВОЙ ? ДА-НА ВЫХОД
    1204 131506 001371                  	BNE	1$		; НЕТ--ОПЯТЬ СРАВНЕНИЕ
    1205 131510 000464                  	BR	ERROR		; НЕ КЛЮЧ
    1206 131512 006300                  2$:	ASL	R0		;  * 2
    1207 131514 005203                  	INC	R3		; ПРОДВИЖЕНИЕ R3
    1208                                ;----------------------------------------------------------
    1209                                ;	SELEKTOR ОСУЩЕСТВЛЯЕТ ВЕТВЛЕНИЕ ПО ОБРАБОТКЕ КЛЮЧЕЙ
    1210                                ;----------------------------------------------------------
    1211                                ;SELEKTOR
    1212 131516 020027  000016          	CMP	R0,#16		; ПЕРЕМЕЩЕНИЕ  RLDUEFGH
    1213 131522 002402                  	BLT	3$		; НЕТ
    1214 131524 000167  132256'         	JMP	RDEG$		; ДА--НА RDEG$
    1215 131530 000170  131562          3$:	JMP	@CASE(R0)	; НЕТ---ВЕТВЛЕНИE
    1216                                ;
    1217                                G_KEY:
    1218 131534    115     116     102  	.ASCIZ	/MNBCSAXRULDRULEHGFEHG/		; КЛЮЧИ
         131537    103     123     101  
         131542    130     122     125  
         131545    114     104     122  
         131550    125     114     105  
         131553    110     107     106  
         131556    105     110     107  
         131561    000                  
    1219                                	.EVEN
    1220                                CASE:
    1221 131562 132036  131726  131720  	.WORD	M$,N$,B$,C$,S$,A$,X$		;МЕТКИ ПЕРЕXОДА SELEKTOR
         131570 131754  131734  132014  
         131576 131612                  
    1222                                ;
    1223                                G_NEXT:				; ОБРАБОТКА СЛЕД. ПОДСТРОКИ
    1224                                	POP	<R0,R5,R3>	; ЧТЕНИЕ WM,АДР.И ДЛ. СТРОКИ
       1                                .IRP	ARG,<R0,R5,R3>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131600 012600                  	MOV	(SP)+,R0
       2 131602 012605                  	MOV	(SP)+,R5
       3 131604 012603                  	MOV	(SP)+,R3
    1225                                	PUSH	R0		; ЗАПИСЬ WM
       1                                .IRP	ARG,<R0>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131606 010046                  	MOV	R0,-(SP)
    1226 131610 000720                  	BR	G_NEWSTR
    1227                                ;------------------------------
    1228                                ;	X$---ОБРАБОТКА ПОДСТРОК
    1229                                ;------------------------------
    1230                                .IFT
    1231                                X$:
    1232                                	POP	R0		; СОХРАНИТЬ WM
       1                                .IRP	ARG,<R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131612 012600                  	MOV	(SP)+,R0
    1233 131614 024646                  	CMP	-(SP),-(SP)	; ЗАРЕЗЕРВИРОВАТЬ 2 СЛОВА
    1234 131616 004767  131664'         	CALL	BLNC		; ПРОПУСК ПРОБЕЛОВ
    1235 131622 004767  127252'         	CALL	$STRNG		; ПОЛУЧЕНИЕ В СТЕКЕ АДРЕСА НОВОЙ ПОДСТРОКИ
    1236                                				;   И ЕЕ ДЛИНЫ. R3 АВТОМАТИЧЕСКИ ПРОДВИНУТ
    1237 131626 004767  131664'         	CALL	BLNC		; ПРОПУСК ПРОБЕЛОВ
    1238 131632 001013                  	BNE	ERROR		; ОГРАНИЧИТЕЛЬ-";" ? НЕТ-ОШИБКА
    1239 131634 005203                  	INC	R3		; ПРОПУСК ";"
    1240 131636 160305                  	SUB	R3,R5		; КОРРЕКЦИЯ R5<--ДЛИНА СТРОКИ
    1241 131640 005205                  	INC	R5
    1242 131642 010366  000006          	MOV	R3,6(SP)	; ЗАПИСЬ В ОТКЛАДЫВАЕМЫХ
    1243 131646 010566  000004          	MOV	R5,4(SP)	;    АДРЕСА И  ДЛИНЫ
    1244                                	POP	<R5,R3> 	; ПОЛУЧЕНИЕ НОВЫХ
       1                                .IRP	ARG,<R5,R3>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131652 012605                  	MOV	(SP)+,R5
       2 131654 012603                  	MOV	(SP)+,R3
    1245                                	PUSH	R0		; ВОССТ. WM
       1                                .IRP	ARG,<R0>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 131656 010046                  	MOV	R0,-(SP)
    1246 131660 000674                  	BR	G_NEWSTR
    1247                                .IFT
    1248                                ;
    1249                                ERROR:				; ОШИБКА
    1250 131662 104405                  	TRAP	5
    1251                                ;
    1252 131664 104512                  BLNC:	TRAP	112		;ПРОПУСК ПРОБЕЛОВ
    1253 131666 020305                  	CMP	R3,R5
    1254 131670 101374                  	BHI	ERROR
    1255 131672 122713  000073          	CMPB	#';,@R3
    1256 131676 000207                  	RETURN
    1257                                ;
    1258                                G_RET:
    1259                                	POP	<@#214,R5>	; ВОССТ. ЦВЕТ,R5
       1                                .IRP	ARG,<@#214,R5>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 131700 012637  000214          	MOV	(SP)+,@#214
       2 131704 012605                  	MOV	(SP)+,R5
    1260 131706 005067  002134'         	CLR	SAVJMP
    1261 131712 000134                  	JMP	@(R4)+		; !!!!!!!!! ВЫХОД ИЗ $DRAW
    1262                                ;
    1263                                G_OUT:
    1264 131714 005726                  	TST	(SP)+		; ОЧИСТКА СТЕКА WM
    1265 131716 000770                  	BR	G_RET		; HA ВЫХОД ИЗ $DRAW
    1266                                ;-----------------------------------------
    1267                                ;		ОБРАБОТКА ОТДЕЛЬНЫХ КОМАНД
    1268                                ;-----------------------------------------
    1269                                B$:				; КОМ. B--"ПОДНЯТОЕ ПЕРО"
    1270 131720 052716  004000          	BIS	#4000,(SP)	; УСТАНОВКА БИТА 11 В СЛОВЕ ПЕРЕМЕЩ.
    1271 131724 000656                  	BR	AGAIN
    1272                                ;
    1273                                N$:				; КОМ. N--ВОЗВРАТ К НУЛЮ
    1274 131726 052716  100000          	BIS	#100000,(SP)	; УСТАНОВКА БИТА 15-ПРИЗНАК ВОЗВРАТА К ТЧ.(0,0)
    1275 131732 000653                  	BR	AGAIN
    1276                                ;
    1277                                S$:				; КОМ. S--УСТАНОВКА МАСШТАБН.КОЕФФ.
    1278 131734 012700  000004          	MOV	#4,R0		; УМОЛЧАНИЕ
    1279 131740 004767  132560'         	CALL	$$SENSE		; ЧТЕНИЕ ЗНАЧЕНИЯ
    1280 131744 001746                  	BEQ	ERROR		; НУЛЕВОЙ МАСШТАБ--ОШИБКА
    1281 131746 110067  002412'         	MOVB	R0,$SCRT	; ЗАСЫЛКА В СЛОВО ВРАЩЕНИЯ-МАСШТ.
    1282 131752 000643                  	BR	AGAIN
    1283                                ;
    1284                                C$:				; КОМ. C--УСТАНОВКА ЦВЕТА
    1285 131754 005000                  	CLR	R0		; УМОЛЧАНИЕ
    1286 131756 004767  132560'         	CALL	$$SENSE		; ЧТЕНИЕ
    1287 131762 005700                  	TST	R0
    1288 131764 001407                  	BEQ	1$
    1289 131766 022700  000004          	CMP	#4,R0		; R0<=4
    1290 131772 103733                  	BLO	ERROR		; НЕТ-ОШИБКА
    1291 131774 062700  000220          	ADD	#220,R0		; R0+220= КОДЫ ЦВЕТОВ:   КРАСНЫЙ  221
    1292                                				;			 ЗЕЛЕНЫЙ  222
    1293                                				;			 СИНИЙ    223
    1294                                				;			 ЧЕРНЫЙ   224
    1295 132000 104016                  	EMT	16		; ПЕРЕДАЧА КОДА В ДРАЙВЕР
    1296 132002 000627                  	BR	AGAIN
    1297 132004 013737  000212  000214  1$:	MOV	@#212,@#214
    1298 132012 000623                  	BR	AGAIN
    1299                                ;
    1300                                A$:				; КОМ. А--ВРАЩЕНИЕ ОСЕЙ
    1301 132014 005000                  	CLR	R0		; УМОЛЧАНИЕ
    1302 132016 004767  132560'         	CALL	$$SENSE		; ПОЛУЧЕНИЕ ЗНАЧЕНИЯ
    1303 132022 020027  000004          	CMP	R0,#4		; ПРОВЕРКА ГРАНИЦ
    1304 132026 103315                  	BHIS	ERROR
    1305 132030 110067  002413'         	MOVB	R0,$SCRT+1	; УСТАНОВКА НОВОГО ЗНАЧЕНИЯ ВРАЩЕНИЯ
    1306 132034 000612                  JAG:	BR	AGAIN
    1307                                ;----------------------------------------
    1308                                ;		ВХОД ДЛЯ ОБРАБОТКИ КОМ. M
    1309                                ;----------------------------------------
    1310                                M$:
    1311                                	PUSH	<R1,R2>		; СОХРАНЕНИЕ КООРДИНАТ
       1                                .IRP	ARG,<R1,R2>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 132036 010146                  	MOV	R1,-(SP)
       2 132040 010246                  	MOV	R2,-(SP)
    1312 132042 004767  132430'         	CALL	$$SIGN		; ПОЛУЧЕНИЕ ЗНАКА
    1313 132046 005000                  	CLR	R0		; УМОЛЧАНИЕ
    1314 132050 004767  132560'         	CALL	$$SENSE		; ПОЛУЧЕНИЕ ЗНАЧЕНИЯ
    1315 132054 032766  000400  000004  	BIT	#400,4(SP)	; ОТНОСИТЕЛЬНОЕ
    1316 132062 001402                  	BEQ	1$		; НЕТ
    1317 132064 004767  132502'         	CALL	$$SCALE		; ДА--МАСШТАБИРОВАНИЕ
    1318 132070 010001                  1$:	MOV	R0,R1		; КООРДИНАТА Х
    1319 132072 004767  131664'         	CALL	BLNC		; ПРОПУСК ПРОБЕЛОВ
    1320 132076 122713  000054          	CMPB	#',,(R3)	; "," ?
    1321 132102 001267                  	BNE	ERROR		; НЕТ--ОШИБКА
    1322 132104 005203                  	INC	R3		; ПРОПУСК ","
    1323 132106 106366  000004          	ASLB	4(SP)		; В WM БИТ 1--X,БИТ 0--Y
    1324 132112 004767  132430'         	CALL	$$SIGN		; ПОЛУЧЕНИЕ ЗНАКА Y
    1325 132116 005000                  	CLR	R0		; УМОЛЧАНИЕ
    1326 132120 004767  132560'         	CALL	$$SENSE		; ПОЛУЧЕНИЕ ЗНАЧЕНИЯ  Y
    1327 132124 032766  000400  000004  	BIT	#400,4(SP)	; ОТНОСИТЕЛЬНОЕ ?
    1328 132132 001402                  	BEQ	2$		; НЕТ
    1329 132134 004767  132502'         	CALL	$$SCALE		; ДА--МАСШТАБИРОВАНИЕ
    1330 132140 010002                  2$:	MOV	R0,R2		; СМЕЩЕНИЕ ПО Y
    1331 132142 022626                  	CMP	(SP)+,(SP)+	; УКАЗАТЕЛЬ СТЕКА НА WM
    1332 132144 032716  000400          	BIT	#400,(SP)	; ОТНОСИТЕЛЬНОЕ ?
    1333 132150 001475                  	BEQ	MOVIN		; НЕТ- АБСОЛЮТ.
    1334                                ;*******	ОТНОСИТЕЛЬНОЕ
    1335 132152 116700  002413'         	MOVB	$SCRT+1,R0	; БАЙТ ВРАЩЕНИЯ
    1336 132156 022700  000002          	CMP	#2,R0		; А0 ИЛИ А1
    1337 132162 003001                  	BGT	5$		; ДА
    1338 132164 005402                  	NEG	R2		; НЕТ--ИЗМЕНЕНИЕ ЗНАКА ДY
    1339 132166 005300                  5$:	DEC	R0
    1340 132170 022700  000002          	CMP	#2,R0		; А1 ИЛИ А2
    1341 132174 101401                  	BLOS	6$
    1342 132176 005401                  	NEG	R1		; ДА-ИЗМЕНЕНИЕ ЗНАКА ДХ
    1343 132200 106216                  6$:	ASRB	(SP)		; ЗНАК "-" ПРИ ДY ?
    1344 132202 103001                  	BCC	7$		; НЕТ
    1345 132204 005402                  	NEG	R2		; ДА-ИЗМЕНЕНИЕ ЗНАКА ДY
    1346 132206 106216                  7$:	ASRB	(SP)		; ЗНАК "-" ПРИ ДХ ?
    1347 132210 103001                  	BCC	8$		; НЕТ
    1348 132212 005401                  	NEG	R1		; ДА--ИЗМЕНЕНИЕ ЗНАКА ДХ
    1349 132214 006200                  8$:	ASR	R0		; А0 ИЛИ А2
    1350 132216 103403                  	BCS	9$		; ДА
    1351 132220 010100                  	MOV	R1,R0		; НЕТ-ПЕРЕСТАНОВКА
    1352 132222 010201                  	MOV	R2,R1
    1353 132224 010002                  	MOV	R0,R2
    1354 132226 066601  177776          9$:	ADD	-2(SP),R1	; ПРИБАВЛЕНИЕ КООРДИНАТ
    1355 132232 066602  177774          	ADD	-4(SP),R2	; ПРИБАВЛЕНИЕ КООРДИНАТ
    1356 132236 000442                  	BR	MOVIN		; ПЕРЕХОД НА ПЕРЕМЕЩЕНИЕ
    1357                                ;-------------------------------------------------------------
    1358                                ;			ВХОД  ОБРАБОТКИ КОМ.   R,L,D,U,E,F,G,H
    1359                                ;-------------------------------------------------------------
    1360                                ;		R U  L D  R U  L E  H  G  F  E  H  G
    1361 132240    002     011     003  COD:	.BYTE	2,11,3,10,2,11,3,16,13,17,12,16,13,17
         132243    010     002     011  
         132246    003     016     013  
         132251    017     012     016  
         132254    013     017          
    1362                                ;-------------------------------------------------------------
    1363                                RDEG$:
    1364 132256 162700  000016          	SUB	#16,R0		; КОРРЕКЦИЯ СМЕЩЕНИЯ
    1365 132262 006200                  	ASR	R0		; -----"----"---
    1366                                	PUSH	R0		; ОЧИСТИТЬ R0 ,СОХРАНИВ В СТЕКЕ
       1                                .IRP	ARG,<R0>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 132264 010046                  	MOV	R0,-(SP)
    1367 132266 116700  002413'         	MOVB	$SCRT+1,R0	; БАЙТ ВРАЩЕНИЯ ИЗ $SCRT--> В R0
    1368 132272 062600                  	ADD	(SP)+,R0	; СЛОЖЕНИЕ СМЕЩЕНИЯ И БАЙТА ВРАЩЕНИЯ В R0
    1369 132274 116016  132240          	MOVB	COD(R0),(SP)	; ЗАСЛАТЬ КОД В СЛОВО ПЕРЕМЕЩЕНИЙ
    1370 132300 012700  000001          	MOV	#1,R0		; УМОЛЧАНИЕ
    1371 132304 004767  132560'         	CALL	$$SENSE		; ПОЛУЧИТЬ ЗНАЧЕНИЕ
    1372 132310 004767  132502'         	CALL	$$SCALE		; МАСШТАБИРОВАНИЕ
    1373 132314 106216                  	ASRB	(SP)		; БИТ 1-- ОТРИЦАТЕЛЬНЫЙ R0 ?
    1374 132316 103001                  	BCC	1$		; ДА --ИЗМЕНЕНИЕ ЗНАКА
    1375 132320 005400                  	NEG	R0		; -R0
    1376 132322 106216                  1$:	ASRB	(SP)		; БИТ 2--СМЕЩЕНИЕ ПО Х
    1377 132324 103001                  	BCC	2$		; НЕТ
    1378 132326 060001                  	ADD	R0,R1		; СМЕЩЕНИЕ ПО  Х
    1379 132330 106216                  2$:	ASRB	(SP)		; БИТ 3-- ИЗМЕНЕНИЕ ЗНАКА R0 ?
    1380 132332 103001                  	BCC	3$		; НЕТ
    1381 132334 005400                  	NEG	R0		; ИЗМЕНЕНИЕ ЗНАКА
    1382 132336 106216                  3$:	ASRB	(SP)		; БИТ 4-- СМЕЩЕНИЕ ПО Y
    1383 132340 103001                  	BCC	MOVIN		; НЕТ -ПЕРЕХОД НА ПЕРЕМЕЩЕНИЕ
    1384 132342 060002                  	ADD	R0,R2		; СМЕЩЕНИЕ ПО Y
    1385                                ;----------------------------------
    1386                                ;			ПЕРЕМЕЩЕНИЯ
    1387                                ;----------------------------------
    1388                                MOVIN:
    1389 132344 005000                  	CLR	R0		; СТИРАНИЕ R0=0
    1390 132346 016746  000176'         	MOV	$DRVX,-(SP)
    1391 132352 016746  000200'         	MOV	$DRVY,-(SP)
    1392 132356 032766  004000  000004  	BIT	#4000,4(SP)	; 11-БИТ:РИСОВАНИЕ (0)--ПЕРЕМЕЩЕНИЕ (1)
    1393 132364 001003                  	BNE	1$		; ПЕРЕМЕЩЕНИЕ
    1394 132366 005200                  	INC	R0		; РИСОВАНИЕ--ЗАПИСЬ R0=1
    1395 132370 104032                  	EMT	32		; ВЕКТОР
    1396 132372 000401                  	BR	2$
    1397 132374 104030                  1$:	EMT	30		; ПЕРЕМЕЩЕНИЕ--ТОЧКА
    1398 132376 005766  000004          2$:	TST	4(SP)		; ВОЗВРАТ К ПРЕЖНИМ КООРДИНАТАМ?
    1399 132402 100005                  	BPL	3$		; НЕТ
    1400 132404 005000                  	CLR	R0
    1401 132406 012602                  	MOV	(SP)+,R2	; ДА- ВОССТАНОВЛЕНИЕ КООРДИНАТ
    1402 132410 012601                  	MOV	(SP)+,R1
    1403 132412 104030                  	EMT	30
    1404 132414 000401                  	BR	4$
    1405 132416 022626                  3$:	CMP	(SP)+,(SP)+
    1406 132420 012716  070000          4$:	MOV	#70000,(SP)
    1407 132424 000167  131462'         	JMP	AGAIN
    1408                                ;-----------------------------------------
    1409                                ;		ПОЛУЧЕНИЕ ЗНАKА ДЛЯ КОМ. М
    1410                                ;-----------------------------------------
    1411                                $$SIGN:
    1412 132430 004767  131664'         	CALL	BLNC		; ПРОПУСК ПРОБЕЛОВ
    1413 132434 122713  000053          	CMPB	#'+,(R3)	; ПЛЮС ?
    1414 132440 001010                  	BNE	1$		; НЕТ
    1415 132442 052766  000400  000006  	BIS	#400,6(SP)	; ДА--УСТАНОВКА БИТА 8
    1416 132450 042766  000001  000006  	BIC	#1,6(SP)	; CБРОС БИТА 0
    1417 132456 005203                  	INC	R3		; ПРОПУСК "+"
    1418 132460 000407                  	BR	2$
    1419 132462 122713  000055          1$:	CMPB	#'-,(R3)	; МИНУС ?
    1420 132466 001004                  	BNE	2$		; НЕТ
    1421 132470 052766  000401  000006  	BIS	#401,6(SP)	; ДА--УСТАНОВКА БИТОВ 0 И 8
    1422 132476 005203                  	INC	R3		; ПРОПУСК "-"
    1423 132500 000207                  2$:	RETURN
    1424                                ;------------------------------------------------------------------
    1425                                ;		ПРОГРАММА $$SCALE  КОРРЕКТИРУЕТ R0 В СООТВЕТСТВИИ С
    1426                                ;		МАСШТАБОМ, Т.Е. ДЕЛИТ НА 4 И УМНОЖАЕТ НА МАСШТАБНЫЙ
    1427                                ;		КОЭФФИЦИЕНТ,КОТОРЫЙ ХРАНИТСЯ В МЛАДШЕМ БАЙТЕ $SCRT
    1428                                ;------------------------------------------------------------------
    1429                                $$SCALE:
    1430                                	PUSH	<R1,R2,R3>	; ОСВОБОДИТЬ R1,R2,R3 DЛЯ УМНОЖЕНИЯ
       1                                .IRP	ARG,<R1,R2,R3>
       2                                	MOV	ARG,-(SP)
       3                                .ENDR
       1 132502 010146                  	MOV	R1,-(SP)
       2 132504 010246                  	MOV	R2,-(SP)
       3 132506 010346                  	MOV	R3,-(SP)
    1431 132510 012702  000010          	MOV	#8.,R2		; ЧИСЛО РАЗРЯДОВ-ЧИСЛО СЛОЖЕНИЙ
    1432 132514 005001                  	CLR	R1		; НАКОПИТЕЛЬ ПРОИЗВЕДЕНИЯ
    1433 132516 116703  002412'         	MOVB	$SCRT,R3	; МНОЖИТЕЛЬ
    1434 132522 006003                  1$:	ROR	R3		; РАЗРЯД МНОЖИТЕЛЯ В БИТ С
    1435 132524 103001                  	BCC	2$		; НОЛЬ
    1436 132526 060001                  	ADD	R0,R1		; ЕДИНИЦА--СЛОЖЕНИЕ
    1437 132530 020227  000007          2$:	CMP	R2,#7		; ДЛЯ РАЗРЯДОВ 0 И 1
    1438 132534 002402                  	BLT	3$
    1439 132536 006201                  	ASR	R1		; СДВИГ ПРОИЗВЕДЕНИЯ (ДЕЛЕНИЕ НА 4)
    1440 132540 000401                  	BR	4$
    1441 132542 006300                  3$:	ASL	R0		; ДЛЯ ОСТАЛЬНЫХ-СДВИГ МНОЖИТЕЛЯ
    1442                                4$:
    1443 132544 077212                  	SOB	R2,1$		; ВСЕ РАЗРЯДЫ ?
    1444 132546 010100                  	MOV	R1,R0		; РЕЗУЛЬТАТ -В R0
    1445                                	POP	<R3,R2,R1>	; ВОССТАНОВИТЬ R1 И R2
       1                                .IRP	ARG,<R3,R2,R1>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 132550 012603                  	MOV	(SP)+,R3
       2 132552 012602                  	MOV	(SP)+,R2
       3 132554 012601                  	MOV	(SP)+,R1
    1446 132556 000207                  	RETURN
    1447                                ;-------------------------------------------------------------------
    1448                                ;		ПРОГРАММА $$SENSE ВОЗВРАЩАЕТ В R0 ЗНАЧЕНИЕ КОНСТАНТЫ
    1449                                ;		ИЛИ ПЕРЕМЕННОЙ (КОНСТРУКЦИИ =<ИМЯ> )
    1450                                ;-------------------------------------------------------------------
    1451                                $$SENSE:
    1452 132560 004767  131664'         	CALL	BLNC		; ПРОПУСК ПРОБЕЛОВ
    1453 132564 001002                  	BNE	1$
    1454 132566 005203                  	INC	R3		; ПРОПУСК ";"
    1455 132570 000207                  6$:	RETURN
    1456 132572 020305                  1$:	CMP	R3,R5
    1457 132574 101375                  	BHI	6$
    1458                                .IFT
    1459 132576 122713  000075          	CMPB	#'=,(R3)	; КОНСТРУКЦИЯ =<ИМЯ>
    1460 132602 001012                  	BNE	2$		; НЕТ-КОНСТАНТА
    1461 132604 005203                  	INC	R3		; ПРОПУСК "="
    1462 132606 004767  131664'         	CALL	BLNC		; ПРОПУСК ПРОБЕЛОВ
    1463 132612 004767  127162'         	CALL	$VALUE		; ЧТЕНИЕ ЗНАЧЕНИЯ В СТЕК
    1464 132616 004767  131664'         	CALL	BLNC		; ПРОПУСК ПРОБЕЛОВ
    1465 132622 001416                  	BEQ	3$		; ОГРАНИЧИТЕЛЬ- ";" ? ДА
    1466 132624 000167  131662'         	JMP	ERROR		; ОШИБКА
    1467                                2$:
    1468                                .IFT
    1469 132630 122713  000071          	CMPB	#'9,(R3)	; ЦИФРА ?
    1470 132634 103413                  	BLO	5$
    1471 132636 122713  000060          	CMPB	#'0,(R3)
    1472 132642 101010                  	BHI	5$
    1473 132644 004767  127134'         	CALL	$CONST		; ЧТЕНИЕ КОНСТАНТЫ
    1474 132650 104512                  	TRAP	112		; ПРОПУСК ПРОБЕЛОВ
    1475 132652 121327  000073          	CMPB	@R3,#';
    1476 132656 001001                  	BNE	4$		; НЕТ ";"
    1477 132660 005203                  3$:	INC	R3		; ПРОПУСК ";"
    1478                                4$:
    1479                                	POP	R0
       1                                .IRP	ARG,<R0>
       2                                	MOV	(SP)+,ARG
       3                                .ENDR
       1 132662 012600                  	MOV	(SP)+,R0
    1480                                ;
    1481 132664 000207                  5$:	RETURN
    1482                                ;
    1483                                .IFF
    1484                                ;-------------------------------;ВХОД:	2(SP) АДРЕС СТРОКИ
    1485                                ;	ОПЕРАТОР DRAW		;	 (SP) ДЛИНА
    1486                                ;-------------------------------;
    1487                                $DRAW::	MOV	(SP)+,R1	;R3	-УКАЗ. В СТР.
    1488                                	MOV	@SP,R3		;R5	-АДР. КОНЦА СТР.
    1489                                	MOV	R5,@SP		;$SCRT:	0-6	-ПОВОР.
    1490                                	MOV	@#214,-(SP)	;	20	-ВОЗВР.
    1491                                	MOV	R4,SAVJMP
    1492                                	MOV	R3,R5
    1493                                	ADD	R1,R5		;	100	-ОТН. КООРД.
    1494                                	EMT	26		;	200	-ОТРИЦ.
    1495                                	MOV	R1,-(SP)	;$SCRT+1:	-МНОЖ. (=4)
    1496                                	MOV	R2,-(SP)
    1497                                	CLR	-(SP)
    1498                                	MOV	#225,R0
    1499                                	EMT	16
    1500                                	INC	R0
    1501                                	EMT	16
    1502                                	MOV	$DRVX,R1
    1503                                	MOV	$DRVY,R2
    1504                                	EMT	24
    1505                                	BR	AG1
    1506                                ;
    1507                                G_OUT:	TST	(SP)+		;ВЫХОД
    1508                                	EMT	26
    1509                                	MOV	R1,$DRVX
    1510                                	MOV	R2,$DRVY
    1511                                	MOV	#225,R0
    1512                                	EMT	16
    1513                                	MOV	(SP)+,R2
    1514                                	MOV	(SP)+,R1
    1515                                	EMT	24
    1516                                	MOV	(SP)+,@#214
    1517                                	MOV	(SP)+,R5
    1518                                	CLR	SAVJMP
    1519                                	JMP	@(R4)+
    1520                                ;
    1521                                G_NEXT:	TST	@SP		;ВОЗВРАТ ИЗ ПОДСТРОКИ
    1522                                	BEQ	G_OUT
    1523                                	MOV	(SP)+,R3
    1524                                	MOV	(SP)+,R5
    1525                                	CMPB	@R3,#';
    1526                                	BNE	ERROR
    1527                                	BR	AGAIN
    1528                                ;
    1529                                S$:	CALL	REIKS		;МНОЖИТЕЛЬ
    1530                                	MOVB	R0,@#$SCRT+1
    1531                                	BR	AGAIN
    1532                                ;
    1533                                X$:	MOV	R5,-(SP)	;ПОДСТРОКА
    1534                                	CALL	$STRNG
    1535                                	MOV	(SP)+,R5
    1536                                	MOV	(SP),R1
    1537                                	MOV	R3,@SP
    1538                                	MOV	R1,R3
    1539                                	ADD	R3,R5
    1540                                	BR	AG1
    1541                                ;
    1542                                A1$:	INC	R3		;ВЫБОР
    1543                                	SUB	#G_KEY+10,R0
    1544                                	BLO	RD1$
    1545                                	ASL	R0
    1546                                	JMP	@CASE(R0)
    1547                                ;
    1548                                A$:	CALL	REIKS		;ПОВОРОТ
    1549                                	ASL	R0
    1550                                	BIC	#177770,R0
    1551                                	BIC	#7,@#$SCRT
    1552                                	BIS	R0,@#$SCRT
    1553                                ;
    1554                                AGAIN:	TRAP	112		;СЛЕДУЮЩАЯ КОМАНДА
    1555                                	CMPB	@R3,#';
    1556                                	BNE	AG2
    1557                                	INC	R3
    1558                                AG1:	TRAP	112
    1559                                AG2:	MOV	#G_KEY,R0
    1560                                	CMP	R3,R5
    1561                                	BHIS	G_NEXT
    1562                                1$:	CMPB	@R0,@R3
    1563                                	BEQ	A1$
    1564                                	TSTB	(R0)+
    1565                                	BNE	1$
    1566                                ERROR:	MOV	#225,R0		;ОШИБКА
    1567                                	EMT	16
    1568                                1$:	TST	(SP)+
    1569                                	BNE	1$
    1570                                	MOV	(SP)+,R2
    1571                                	MOV	(SP)+,R1
    1572                                	EMT	24
    1573                                	MOV	(SP),@#214
    1574                                	TRAP	5
    1575                                ;
    1576                                RD1$:	ADD	#10,R0		;RFDGLHUE
    1577                                	CALL	SGNTST
    1578                                	MOV	R0,-(SP)
    1579                                	CALL	REIKS
    1580                                	CLR	R1
    1581                                	BISB	@#$SCRT+1,R1
    1582                                	MOV	R0,R2
    1583                                	MOV	R5,R0
    1584                                	CALL	DAUG
    1585                                	MOV	R0,R5
    1586                                	ASR	R1
    1587                                	ASR	R1
    1588                                	SWAB	R1
    1589                                ;
    1590                                	ADD	@#$SCRT,@SP
    1591                                	TSTB	@#$SCRT
    1592                                	BPL	RD4$
    1593                                RD3$:	ADD	#4,@SP
    1594                                RD4$:	MOV	@SP,R0
    1595                                	BIC	#177770,R0
    1596                                	MOVB	COD(R0),R0
    1597                                	CLRB	R1
    1598                                	BISB	R0,R1
    1599                                	MOV	R1,R0
    1600                                	BITB	#40,@#$SCRT
    1601                                	BEQ	2$
    1602                                	MOV	#226,R2
    1603                                	MOV	R2,R0
    1604                                	EMT	16
    1605                                	MOV	R1,R0
    1606                                	EMT	16
    1607                                	MOV	R2,R0
    1608                                2$:	EMT	16
    1609                                	BIT	#20,@#$SCRT
    1610                                	BNE	RD2$
    1611                                	TST	(SP)+
    1612                                RDRET:	BIC	#370,@#$SCRT
    1613                                	BR	AGAIN
    1614                                RD2$:	BICB	#330,@#$SCRT
    1615                                	BR	RD3$
    1616                                ;
    1617                                N$:	BIS	#20,@#$SCRT	;ВОЗВРАТ В НАЧАЛО
    1618                                	BR	AGAIN
    1619                                ;
    1620                                B$:	BIS	#40,@#$SCRT	;ПОДНЯТОЕ ПЕРО
    1621                                	BR	AGAIN
    1622                                ;
    1623                                C$:	CALL	REIKS		;ЦВЕТ
    1624                                	CMP	R0,#4
    1625                                	BHI	ERROR
    1626                                	TST	R0
    1627                                	BLO	ERROR
    1628                                	BNE	1$
    1629                                	MOV	@#212,@#214
    1630                                	BR	AGAIN
    1631                                1$:	ADD	#220,R0
    1632                                	EMT	16
    1633                                	BR	AGAIN
    1634                                ;
    1635                                M$:	EMT	26		;M
    1636                                	MOV	R1,@#$DRVX
    1637                                	MOV	R2,@#$DRVY
    1638                                	MOV	R1,-(SP)
    1639                                	MOV	R2,-(SP)
    1640                                	CALL	SGNTST
    1641                                	BIT	#100,@#$SCRT
    1642                                	BNE	M1$
    1643                                	CALL	REIKS		;АБС. КООРД.
    1644                                	MOV	R0,R1
    1645                                	TRAP	112
    1646                                	CMPB	(R3)+,#',
    1647                                ER1$:	BNE	ERROR
    1648                                	CALL	SGNTST
    1649                                	CALL	REIKS
    1650                                	TSTB	@#$SCRT
    1651                                	BPL	2$
    1652                                	NEG	R0
    1653                                2$:	MOV	R0,R2
    1654                                M6$:	BIT	#40,@#$SCRT
    1655                                	BEQ	3$
    1656                                	MOV	R1,@#$DRVX
    1657                                	MOV	R2,@#$DRVY
    1658                                	BR	4$
    1659                                3$:	MOV	PC,R0
    1660                                	EMT	32
    1661                                4$:	BIT	#20,@#$SCRT
    1662                                	BEQ	5$
    1663                                	MOV	(SP)+,@#$DRVY
    1664                                	MOV	(SP)+,@#$DRVX
    1665                                	BR	RDRET
    1666                                5$:	CMP	(SP)+,(SP)+
    1667                                	EMT	24
    1668                                	BR	RDRET
    1669                                ;
    1670                                M1$:	CALL	MRKS	;М ОТНОС. КООРД.
    1671                                	TRAP	112
    1672                                	CMPB	(R3)+,#',
    1673                                	BNE	ER1$
    1674                                	MOV	R1,-(SP)
    1675                                	CALL	SGNTST
    1676                                	CALL	MRKS
    1677                                	MOV	@#$SCRT,R0
    1678                                	BIC	#177770,R0
    1679                                	ADD	R0,PC
    1680                                	BR	7$
    1681                                	BR	8$
    1682                                	BR	9$
    1683                                	NEG	@SP
    1684                                	BR	10$
    1685                                8$:	NEG	R1
    1686                                	BR	10$
    1687                                9$:	NEG	R1
    1688                                	NEG	@SP
    1689                                7$:	MOV	@SP,R2
    1690                                	MOV	R1,@SP
    1691                                	MOV	R2,R1
    1692                                10$:	MOV	(SP)+,R2
    1693                                	ADD	@#$DRVX,R1
    1694                                	ADD	@#$DRVY,R2
    1695                                	BR	M6$
    1696                                ;
    1697                                MRKS:	CALL	REIKS
    1698                                	MOV	R0,R1
    1699                                	MOV	R5,R0
    1700                                	CLR	R2
    1701                                	BISB	@#$SCRT+1,R2
    1702                                	CALL	DAUG
    1703                                	MOV	R0,R5
    1704                                	ASR	R1
    1705                                	ASR	R1
    1706                                	TSTB	@#$SCRT
    1707                                	BPL	1$
    1708                                	NEG	R0
    1709                                1$:	RETURN
    1710                                ;
    1711                                SGNTST:	TRAP	112		;ТЕСТ. ЗНАКА
    1712                                	CMPB	@R3,#'-
    1713                                	BNE	1$
    1714                                	BIS	#300,@#$SCRT
    1715                                	BR	2$
    1716                                1$:	CMPB	@R3,#'+
    1717                                	BNE	3$
    1718                                	BIS	#100,@#$SCRT
    1719                                2$:	INC	R3
    1720                                3$:	RETURN
    1721                                ;
    1722                                REIKS:	TRAP	112		;ЗНАЧЕНИЕ
    1723                                	CMPB	@R3,#'=
    1724                                	BNE	1$
    1725                                	INC	R3
    1726                                	TRAP	112
    1727                                	CALL	$VALUE
    1728                                ;	TRAP	112
    1729                                	MOV	(SP)+,R0
    1730                                	BPL	3$
    1731                                	NEG	R0
    1732                                	TSTB	@#$SCRT
    1733                                	BPL	4$
    1734                                	BIC	#200,@#$SCRT
    1735                                	BR	3$
    1736                                1$:	CALL	$CONST
    1737                                	MOV	(SP)+,R0
    1738                                	RETURN
    1739                                4$:	BIS	#200,@#$SCRT
    1740                                3$:	CMPB	@R3,#';
    1741                                	BNE	ER1$
    1742                                	RETURN
    1743                                ;
    1744                                G_KEY:	.ASCIZ	/RFDGLHUEMNBCSAX/		;КОМАНДЫ
    1745                                COD:	.BYTE	31,36,33,37,10,34,32,35		;КОДЫ УПР. СИМВ.
    1746                                	.EVEN
    1747                                CASE:	.WORD	M$,N$,B$,C$,S$,A$,X$
    1748                                ;
    1749                                	.ENDC
    1750                                	.ENDC
    1751                                	.END	START
    1752                                ;ВСЕ
    1752                                
       1                                        .TITLE	MONIT
       2                                ;	.ENABLE LC
       3                                	; **********************
       4                                	; *                    *
       5                                	; *   bejsik monitor   *
       6                                	; *                    *
       7                                	; **********************
       8                                	;
       9                                	; =============================
      10                                	; ***ОБЛАСТЬ ДАННЫХ МОНИТОРА***
      11                                	; =============================
      12                                ; start 0132666
      13                                ;
      14 132666    014     040     342  BASVU:	.BYTE	14,40,342,345,352,363,351,353,40,40,40,40,40
         132671    345     352     363  
         132674    351     353     040  
         132677    040     040     040  
         132702    040                  
      15 132703    050     367     351  	.BYTE	50,367,351,354,370,356,340,363
         132706    354     370     356  
         132711    340     363          
      16 132713    054     061     071  	.ASCII	/,1986.07.24)/<12>	;НАЧАЛЬНОЕ СООБЩЕНИЕ
         132716    070     066     056  
         132721    060     067     056  
         132724    062     064     051  
         132727    012                  
      17                                ;
      18 132730    117     153     012  OK:	.BYTE	117,153,12	;OK
      19                                ;
      20 132733    040     040          OPRNAM::.ASCII	/  /	;ТАБЛИЦА ИМЕН ОПЕРАТОРОВ
      21 132735    047     040          	.ASCII	/' /
      22 132737    104     111     115  	.ASCII	/DIM /
         132742    040                  
      23 132743    114     111     116  	.ASCII	/LINE /
         132746    105     040          
      24 132750    103     111     122  	.ASCII	/CIRCLE /
         132753    103     114     105  
         132756    040                  
      25 132757    104     105     106  	.ASCII	/DEF /
         132762    040                  
      26 132763    124     122     117  	.ASCII	/TROFF /
         132766    106     106     040  
      27 132771    106     117     122  OPFOR::	.ASCII	/FOR /
         132774    040                  
      28 132775    107     117     123  	.ASCII	/GOSUB /
         133000    125     102     040  
      29 133003    107     117     124  	.ASCII	/GOTO /
         133006    117     040          
      30 133010    111     106     040  	.ASCII	/IF /
      31 133013    111     116     120  	.ASCII	/INPUT /
         133016    125     124     040  
      32 133021    114     105     124  	.ASCII	/LET /
         133024    040                  
      33 133025    117     120     105  	.ASCII	/OPEN /
         133030    116     040          
      34 133032    077     040          	.ASCII	/? /
      35 133034    103     114     117  	.ASCII	/CLOSE /
         133037    123     105     040  
      36 133042    116     105     130  	.ASCII	/NEXT /
         133045    124     040          
      37 133047    120     101     111  	.ASCII	/PAINT /
         133052    116     124     040  
      38 133055    120     122     111  	.ASCII	/PRINT /
         133060    116     124     040  
      39 133063    104     122     101  	.ASCII	/DRAW /
         133066    127     040          
      40 133070    122     105     115  	.ASCII	/REM /
         133073    040                  
      41 133074    122     105     124  	.ASCII	/RETURN /
         133077    125     122     116  
         133102    040                  
      42 133103    137     040          	.ASCII	/_ /
      43 133105    103     101     114  	.ASCII	/CALL /
         133110    114     040          
      44 133112    122     105     101  	.ASCII	/READ /
         133115    104     040          
      45 133117    120     117     113  	.ASCII	/POKE /
         133122    105     040          
      46 133124    117     125     124  	.ASCII 	/OUT /
         133127    040                  
      47 133130    123     124     117  	.ASCII	/STOP /
         133133    120     040          
      48 133135    114     120     122  	.ASCII	/LPRINT /
         133140    111     116     124  
         133143    040                  
      49 133144    117     116     040  	.ASCII	/ON /
      50 133147    122     105     123  	.ASCII	/RESTORE /
         133152    124     117     122  
         133155    105     040          
      51 133157    105     116     104  	.ASCII	/END /
         133162    040                  
      52 133163    104     101     124  	.ASCII	/DATA /
         133166    101     040          
      53 133170    114     117     103  	.ASCII	/LOCATE /
         133173    101     124     105  
         133176    040                  
      54 133177    103     114     105  	.ASCII	/CLEAR /
         133202    101     122     040  
      55 133205    124     122     117  	.ASCII	/TRON /
         133210    116     040          
      56 133212    113     105     131  	.ASCII	/KEY /
         133215    040                  
      57 133216    102     105     105  	.ASCII	/BEEP /
         133221    120     040          
      58 133223    103     114     123  	.ASCII	/CLS /
         133226    040                  
      59 133227    103     117     114  	.ASCII	/COLOR /
         133232    117     122     040  
      60 133235    120     123     105  	.ASCII	/PSET /
         133240    124     040          
      61 133242    120     122     105  	.ASCII	/PRESET /
         133245    123     105     124  
         133250    040                  
      62 133251    103     114     117  	.ASCII	/CLOAD /
         133254    101     104     040  
      63 133257    102     114     117  	.ASCII	/BLOAD /
         133262    101     104     040  
      64 133265    106     111     116  	.ASCII	/FIND /
         133270    104     040          
      65 133272    103     123     101  	.ASCII	/CSAVE /
         133275    126     105     040  
      66 133300    102     123     101  	.ASCII	/BSAVE /
         133303    126     105     040  
      67 133306    114     117     101  	.ASCII	/LOAD /
         133311    104     040          
      68 133313    123     101     126  	.ASCII	/SAVE /
         133316    105     040          
      69 133320    116     105     127  	.ASCII	/NEW /
         133323    040                  
      70 133324    101     125     124  	.ASCII	/AUTO /
         133327    117     040          
      71 133331    114     111     123  	.ASCII	/LIST /
         133334    124     040          
      72 133336    115     117     116  	.ASCII	/MONIT /
         133341    111     124     040  
      73 133344    114     114     111  	.ASCII	/LLIST /
         133347    123     124     040  
      74 133352    122     105     116  	.ASCII	/RENUM /
         133355    125     115     040  
      75 133360    104     105     114  	.ASCII	/DELETE /
         133363    105     124     105  
         133366    040                  
      76 133367    103     117     116  	.ASCII	/CONT /
         133372    124     040          
      77 133374    122     125     116  	.ASCII	/RUN /
         133377    040                  
      78                                ;	.ASCII	/MOTOR /
      79                                ;	.ASCII	/MERGE /
      80                                ;	.ASCII	/ERASE /
      81                                ;	.ASCII	/SWAP /
      82                                ;	.ASCII	/MAXFILES /
      83                                	.EVEN
      84                                ;
      85                                ;	ТАБЛИЦА АДРЕСОВ ИМЕН ОПЕРАТОРОВ
      86                                ;
      87 133400 132733  132735  132737  AOPNAM::.WORD	OPRNAM,OPRNAM+2,OPRNAM+4,OPRNAM+10,OPRNAM+15		;-CIRCLE
         133406 132743  132750          
      88 133412 132757  132763  132771  	.WORD	OPRNAM+24,OPRNAM+30,OPRNAM+36,OPRNAM+42,OPRNAM+50	;-GOTO
         133420 132775  133003          
      89 133424 133010  133013  133021  	.WORD	OPRNAM+55,OPRNAM+60,OPRNAM+66,OPRNAM+72			;-OPEN
         133432 133025                  
      90 133434 133032  133034  133042  	.WORD	OPRNAM+77,OPRNAM+101,OPRNAM+107,OPRNAM+114		;-PAINT
         133442 133047                  
      91 133444 133055  133063  133070  	.WORD	OPRNAM+122,OPRNAM+130,OPRNAM+135,OPRNAM+141,OPRNAM+150	;-_
         133452 133074  133103          
      92 133456 133105  133112  133117  	.WORD	OPRNAM+152,OPRNAM+157,OPRNAM+164,OPRNAM+171,OPRNAM+175	;-STOP
         133464 133124  133130          
      93 133470 133135  133144          	.WORD	OPRNAM+202,OPRNAM+211					;-ON
      94 133474 133147  133157  133163  	.WORD	OPRNAM+214,OPRNAM+224,OPRNAM+230			;-DATA
      95 133502 133170  133177  133205  	.WORD	OPRNAM+235,OPRNAM+244,OPRNAM+252,OPRNAM+257		;-KEY
         133510 133212                  
      96 133512 133216  133223  133227  	.WORD	OPRNAM+263,OPRNAM+270,OPRNAM+274			;-COLOR
      97 133520 133235  133242  133251  	.WORD	OPRNAM+302,OPRNAM+307,OPRNAM+316,OPRNAM+324		;-BLOAD
         133526 133257                  
      98 133530 133265  133272  133300  	.WORD	OPRNAM+332,OPRNAM+337,OPRNAM+345,OPRNAM+353,OPRNAM+360	;-SAVE
         133536 133306  133313          
      99 133542 133320  133324  133331  	.WORD	OPRNAM+365,OPRNAM+371,OPRNAM+376,OPRNAM+403,OPRNAM+411	;-LLIST
         133550 133336  133344          
     100 133554 133352  133360  133367  	.WORD	OPRNAM+417,OPRNAM+425,OPRNAM+434,OPRNAM+441		;-RUN
         133562 133374                  
     101                                ;	.WORD	OPRNAM+445,OPRNAM+453,OPRNAM+461,OPRNAM+467,OPRNAM+474
     102                                ;
     103                                ;	ТАБЛИЦА АДРЕСОВ ПРОГРАММ КОМПИЛЯЦИИ
     104                                ;
     105                                	.GLOBL	END,FOR,GOSUB,GO,IF,INPUT,LET,NEXT,PIJ,CURON,CUROFF
     106                                	.GLOBL	PRINT,RET,STOP,DIM,PAINT,LINE,POKE,OUT,TRON,TROFF,DRAW
     107                                	.GLOBL	IODEV,STRREG,STRSIZ,FREBEG,FRELEN,KEY,CIRCLE
     108                                	.GLOBL	LOCATE,CLEAR,HIMEM,BEEP,CLS,COLOR,RWREN,PSET,PRESET,DEF
     109                                	.GLOBL	LOAD,SAVE,CLOAD,CSAVE,BLOAD,BSAVE,FIND
     110                                	.GLOBL	DATA,READ,RESTOR,DATBEG,DATPTR,ON,OPEN,CLOSE,REM     ;MOTOR
     111                                	.GLOBL	LPRINT,CALL,MSTART,MAG,HALT			;ERASE,SWAP
     112 133564 142670  142550  144534  AOPSUB::.WORD	LET,REM,DIM,LINE,CIRCLE,DEF,TROFF,FOR,GOSUB
         133572 144754  145352  145556  
         133600 144154  143614  143146  
     113 133606 143154  143422  144320  	.WORD	GO,IF,INPUT,LET,OPEN,PRINT,CLOSE
         133614 142670  146262  142322  
         133622 146326                  
     114 133624 144022  145216  142322  	.WORD	NEXT,PAINT,PRINT,DRAW
         133632 145202                  
     115 133634 142550  143120  146374  	.WORD	REM,RET,CALL,CALL,READ
         133642 146374  144304          
     116 133646 144576  144610  144132  	.WORD	POKE,OUT,STOP,LPRINT,ON
         133654 142312  146172          
     117 133660 144176  144140  144164  	.WORD	RESTOR,END,DATA,LOCATE
         133666 142564                  
     118 133670 144452  144146  145326  	.WORD	CLEAR,TRON,KEY,BEEP,CLS,COLOR,PSET,PRESET
         133676 144662  144670  144620  
         133704 144676  144702          
     119                                ;
     120                                ;
     121                                ;	ТАБЛИЦА АДРЕСОВ ПРОГРАММ НЕПОСРЕДСТВЕННОГО ВЫПОЛНЕНИЯ
     122                                ;
     123                                AOPMON::
     124 133710 136650  136420  136306  	.WORD	CLOAD,BLOAD,FIND,CSAVE,BSAVE,LOAD,SAVE
         133716 137124  136562  136104  
         133724 137256                  
     125 133726 134600  140376  134634  	.WORD	NEW,AUTO,LIST,ADDRMN,LLIST,RENUM,DELETE,CONT,RUN
         133734 124302  134626  141034  
         133742 140514  136066  135242  
     126                                ;	.WORD	MOTOR,MERGE,ERASE,SWAP,MAXFILES
     127                                	;
     128                                	; ========================
     129                                	; ***БЛОК ИНИЦИАЛИЗАЦИИ***
     130                                	; ========================
     131                                	.GLOBL	TABTOP,LENT,TEXT,TXEND,ENDCOD,ERRS,ENDPRG,ADDRMN,STACK
     132                                	.GLOBL	ISV,ISVEIL,IVEIL,BUF,LYGIS,CIKL,NUMBER,ADRHLT,MAGNIT,IRPS
     133                                	.GLOBL	INK,START,FCB,CURLIN,AUTOON,AUINC,TRFLAG,TRIN,SEPAP,PNTSAV
     134                                	.GLOBL	ISVSS,LIMIT,RESTV,BREAK,COPOUT,ISVETO,TMP
     135                                	.GLOBL	BUFOUT,CLOUTF,CLOALL,NAMTYP,COPYIN,TABMOV,BOHPAP,PFACT,WRITE
     136                                ;	.GLOBL	MAXFIL
     137                                	;
     138                                ; 0133750
     139 133750 005067  002046'         MONIT::	CLR	ADRHLT
     140                                	;
     141                                	; ======================================
     142                                	; ***blok wwoda direktiw polxzowatelq***
     143                                	; ======================================
     144                                	;
     145                                STAR::
     146 133754 005067  002052'         AUTOCL:	CLR	AUTOON
     147 133760 005067  002000'         	CLR	LYGIS		;ПРИЗНАК РАБОТЫ МОНИТОРА
     148 133764 012701  132730          	MOV	#OK,R1		;ВЫВОД OK
     149 133770 012702  000003          	MOV	#3,R2
     150 133774 004767  122560'         	CALL	ISVEIL
     151 134000 004767  124076'         	CALL	CURON
     152 134004 005767  002052'         PRGLIN:	TST	AUTOON
     153 134010 001016                  	BNE	AUNEXT
     154 134012 004767  121052'         	CALL	IVEIL		;ВВОД СТРОКИ
     155                                	;
     156                                	; --------------------------
     157                                	; ...АНАЛИЗ СТРОКИ...
     158                                	; --------------------------
     159                                	;
     160 134016 012703  003022          ANALIZ::MOV	#BUF,R3
     161 134022 121327  000056          	CMPB	@R3,#'.
     162 134026 001003                  	BNE	1$
     163 134030 005203                  	INC	R3
     164 134032 000167  140234'         	JMP	EDIT
     165 134036 004167  134106'         1$:	JSR	R1,ASCCOD
     166 134042 000410                  	BR	COMAND
     167 134044 000757                  	BR	PRGLIN
     168                                ;
     169 134046 016705  002056'         AUNEXT:	MOV	CURLIN,R5
     170 134052 066705  002054'         	ADD	AUINC,R5
     171 134056 103736                  	BCS	AUTOCL
     172 134060 000167  140206'         	JMP	EDAUIN
     173                                ;
     174 134064 004767  124120'         COMAND: CALL	CUROFF
     175 134070 020527  000124          	CMP	R5,#AOPMON-AOPSUB
     176 134074 002402                  	BLT	1$
     177 134076 000175  133564          	JMP	@AOPSUB(R5)
     178 134102 000167  135152'         1$:	JMP	STATM
     179                                ;
     180 134106 012703  003022          ASCCOD::MOV	#BUF,R3
     181 134112 104510                  	TRAP	110
     182 134114 000440                  	BR	10$		;БЕЗ НОМЕРА
     183 134116 011767  002032'         	MOV	@PC,ERRS
     184 134122 005067  002004'         	CLR	STRREG
     185 134126 010567  002056'         	MOV	R5,CURLIN
     186 134132 104511                  	TRAP	111
     187 134134 000427                  	BR	5$
     188 134136 121327  000012          	CMPB	@R3,#12
     189 134142 001471                  	BEQ	7$
     190 134144 016700  002024'         	MOV	TABTOP,R0
     191 134150 010002                  	MOV	R0,R2
     192 134152 162702  000006          	SUB	#6,R2
     193 134156 020267  002002'         	CMP	R2,TXEND
     194 134162 101466                  	BLOS	MEMFUL
     195 134164 010267  002024'         	MOV	R2,TABTOP
     196 134170 010267  002022'         	MOV	R2,LENT
     197 134174 010267  002020'         	MOV	R2,LIMIT
     198 134200 010267  002016'         	MOV	R2,CIKL
     199 134204 012022                  17$:	MOV	(R0)+,(R2)+
     200 134206 020004                  	CMP	R0,R4
     201 134210 101775                  	BLOS	17$
     202 134212 010514                  	MOV	R5,@R4
     203 134214 010405                  5$:	MOV	R4,R5
     204 134216 104512                  10$:	TRAP	112
     205                                ; ОПОЗНАНИЕ ОПЕРАТОРА
     206 134220 121327  000012          	CMPB	@R3,#12
     207 134224 001005                  	BNE	16$
     208 134226 005705                  	TST	R5
     209 134230 001436                  	BEQ	7$
     210 134232 004767  134342'         	CALL	DEL
     211 134236 000433                  	BR	7$
     212 134240 010502                  16$:	MOV	R5,R2
     213 134242 104513                  	TRAP	113
     214 134244 132733                  	.WORD	OPRNAM
     215 134246    002                  	.BYTE	2
     216 134247    162                  	.BYTE	MONIT-AOPSUB-2
     217 134250 005005                  	CLR	R5
     218 134252 005702                  25$:	TST	R2
     219 134254 001425                  	BEQ	8$
     220 134256 016700  002002'             	MOV	TXEND,R0
     221 134262 160316                  	SUB	R3,@SP
     222 134264 060016                  	ADD	R0,@SP
     223 134266 021667  002024'         	CMP	@SP,TABTOP
     224 134272 103017                  	BHIS	1$
     225 134274 010042                  	MOV	R0,-(R2)
     226 134276 110520                  	MOVB	R5,(R0)+
     227 134300 112310                  2$:	MOVB	(R3)+,(R0)
     228 134302 122027  000012          	CMPB	(R0)+,#12	;BUTINA PAGAL 12 DEL LOAD
     229 134306 001374                  	BNE	2$
     230 134310 010067  002002'         	MOV	R0,TXEND
     231 134314 005200                  	INC	R0
     232 134316 042700  000001          	BIC	#1,R0
     233 134322 010067  002014'         	MOV	R0,ENDCOD
     234 134326 005721                  7$:	TST	(R1)+
     235 134330 000201                  8$:	RTS	R1
     236                                ;
     237 134332 010204                  1$:	MOV	R2,R4
     238 134334 004767  134342'         	CALL	DEL
     239 134340 104407                  MEMFUL:	TRAP	7
     240                                ;
     241 134342 010400                  DEL:	MOV	R4,R0
     242 134344 005724                  DELINT:	TST	(R4)+
     243 134346 024040                  	CMP	-(R0),-(R0)
     244 134350 020067  002024'         20$:	CMP	R0,TABTOP
     245 134354 101402                  	BLOS	21$
     246 134356 014044                  	MOV	-(R0),-(R4)
     247 134360 000773                  	BR	20$
     248 134362 010467  002024'         21$:	MOV	R4,TABTOP
     249 134366 000207                  	RETURN
     250                                ;
     251 134370 016767  002030' 002026' CLRBUF::MOV	HIMEM,FCB
     252                                ;	MOV	MAXFIL,R1
     253                                ;	BEQ	2$
     254 134376 162767  000422  002026' 1$:	SUB	#422,FCB
     255 134404 005077  002026'         	CLR	@FCB
     256                                ;	SOB	R1,1$
     257 134410 162767  000400  002026' 2$:	SUB	#400,FCB
     258 134416 000207                  	RETURN
     259                                ;
     260 134420 004767  134370'         CLRTXT::CALL	CLRBUF
     261 134424 016767  002026' 002024' 	MOV	FCB,TABTOP	;
     262 134432 012767  003052  002002' 	MOV	#TEXT,TXEND
     263 134440 005067  002126'         	CLR	PFACT
     264 134444 012701  132666          	MOV	#BASVU,R1	;wywod na~alxnogo soob}eniq
     265 134450 012702  000042          	MOV	#42,R2
     266 134454 004767  122560'         	CALL	ISVEIL
     267                                ;
     268 134460 016767  002024' 002022' CLRCOD::MOV	TABTOP,LENT
     269 134466 016767  002024' 002020' 	MOV	TABTOP,LIMIT
     270 134474 016767  002024' 002016' 	MOV	TABTOP,CIKL
     271 134502 016767  002002' 002014' 	MOV	TXEND,ENDCOD
     272 134510 005267  002014'         	INC	ENDCOD
     273 134514 042767  000001  002014' 	BIC	#1,ENDCOD
     274 134522 011767  002032'         	MOV	@PC,ERRS	;ЗАПРЕТИТЬ ВЫПОЛНЕНИЕ РАБОЧЕЙ ПРОГРАММ
     275 134526 005067  002004'                 CLR	STRREG
     276 134532 000207                          RETURN
     277                                ;
     278 134534 016701  002014'         STRMEM:	MOV	ENDCOD,R1
     279 134540 010167  002010'                 MOV	R1,FREBEG
     280 134544 066701  002006'                 ADD	STRSIZ,R1
     281 134550 016767  002006' 002012'         MOV	STRSIZ,FRELEN
     282 134556 020167  002022'                 CMP	R1,LENT
     283 134562 101266                          BHI	MEMFUL
     284 134564 010167  002014'                 MOV	R1,ENDCOD
     285 134570 016767  002010' 002004'         MOV	FREBEG,STRREG
     286 134576 000207                          RETURN
     287                                ;
     288 134600 104506                  NEW:	TRAP	106
     289 134602 012706  002000                  MOV	#STACK,SP
     290 134606 004767  162664'                 CALL	CLOALL
     291 134612 004767  134420'                 CALL	CLRTXT
     292 134616 004767  120760'                 CALL	ISVSS
     293 134622 000167  133750'                 JMP	MONIT
     294                                ;
     295 134626 012767  177777  003016' LLIST:	MOV	#-1,IODEV
     296                                ;
     297 134634 010546                  LIST::	MOV	R5,-(SP)
     298 134636 004767  134724'                 CALL	LARG		; PIRMAS ARGUMENTAS - R4, ANTRAS - R0
     299                                ;	CLR	-(SP)
     300 134642 005267  002000'                 INC	LYGIS
     301 134646 020400                          CMP	R4,R0
     302 134650 103423                          BLO	LS66	;PRIE PUSLAPIAVIMO LS6
     303 134652 010446                  LS1:	MOV	R4,-(SP)
     304 134654 010046                  LS2:	MOV	R0,-(SP)
     305 134656 004767  124120'                 CALL	CUROFF
     306                                ;	CLR	-(SP)
     307 134662 004767  135100'         LS3:	CALL	EILUTE
     308                                ;	ADD	R2,@SP
     309                                ;	CMP	@SP,#1340
     310                                ;	BGT	LS7
     311 134666 012702  005000          LS4:	MOV	#5000,R2
     312 134672 016467  000002  002056'         MOV	2(R4),CURLIN
     313 134700 004767  122546'                 CALL	ISVETO
     314                                ;11$:	BIT	#37,@SP
     315                                ;	BEQ	8$
     316                                ;	INC	@SP
     317                                ;	BR	11$
     318 134704 024444                  8$:	CMP	-(R4),-(R4)
     319 134706 020416                          CMP	R4,@SP	;2(SP) PRIE PUSLAPIAVIMO
     320 134710 103364                          BHIS	LS3
     321                                ;	TST	IODEV
     322                                ;	BEQ	LS8
     323 134712 005067  003016'                 CLR	IODEV
     324 134716 022626                  LS6:	CMP	(SP)+,(SP)+	;TST PRIE  PUSLAPIAVIMO
     325                                ;	BNE	LS6
     326 134720 000167  137370'         LS66:	JMP	ST0
     327                                ;LS7:	TST	IODEV
     328                                ;	BMI	LS4
     329                                ;	TST	(R4)+
     330                                ;LS8:	MOV	R4,@SP
     331                                ;LS9:	CALL	CURON
     332                                ;	CALL	IVEIL
     333                                ;	CMPB	BUF,#12
     334                                ;   	BEQ	3$
     335                                ;	CLR	LYGIS
     336                                ;44$:	TST	(SP)+
     337                                ;	BNE	44$
     338                                ;  	JMP	ANALIZ
     339                                ;3$:	CMP	(SP),2(SP)
     340                                ;	BLO	LS9
     341                                ;	MOV	(SP)+,R4
     342                                ;	MOV	(SP)+,R0
     343                                ;	BR	LS1
     344                                ;LISTBC:	MOV	6(SP),R4
     345                                ;	BEQ	LS9
     346                                ;	TST	(SP)+
     347                                ;	MOV	(SP)+,R0
     348                                ;	TST	(SP)+
     349                                ;	BR	LS2
     350                                ;
     351 134724 005046                  LARG:	CLR	-(SP)		;PIRMAS ARGUMENTAS
     352 134726 004767  135052'                 CALL	ARGUM		;ПРИЗНАК НАЛИЧИЯ ПЕРВОГО АРГУМЕНТА
     353 134732 001435                  	BEQ	1$
     354 134734 005216                  	INC	(SP)
     355 134736 104511                  	TRAP	111
     356 134740 000404                  	BR	11$
     357 134742 005766  000004          	TST	4(SP)
     358 134746 001426                  	BEQ	111$
     359 134750 005416                  	NEG	(SP)
     360 134752 010446                  11$:	MOV	R4,-(SP)	; (SP)-PIRMOS EILUTES ADRESAS RYSIU LENT.
     361 134754 122713  000055          	CMPB	#'-,(R3)	;AR YRA MINUSAS ?
     362 134760 001026                  	BNE	4$
     363 134762 005203                  	INC	R3
     364 134764 004767  135052'         	CALL	ARGUM		;ANTRAS ARGUMENTAS
     365 134770 001425                  	BEQ	3$
     366 134772 104511                  	TRAP	111
     367 134774 000405                  	BR	2$
     368 134776 005766  000006          	TST	6(SP)
     369 135002 001410                  	BEQ	111$
     370 135004 005724                  	TST	(R4)+		;ARGUMENTAS NURODYTAS KLAIDINGAI -
     371 135006 022424                  31$:	CMP	(R4)+,(R4)+	;PASTUMIAM RODYKLE RYSIU LENTELEJE
     372 135010 010400                  2$:	MOV	R4,R0
     373 135012 012604                  	MOV	(SP)+,R4
     374 135014 005726                  	TST	(SP)+
     375 135016 012616                  	MOV	(SP)+,(SP)
     376 135020 104506                  	TRAP	106
     377 135022 000207                  	RETURN
     378 135024 104410                  111$:	TRAP	8.
     379                                ;
     380 135026 016704  002026'         1$:	MOV	FCB,R4		;PIRMO ARGUMENTO NERA => JIS = PIRMOS EILUTES
     381 135032 005744                  	TST	-(R4)
     382 135034 000746                  	BR	11$
     383 135036 005766  000002          4$:	TST	2(SP)
     384 135042 003362                  	BGT	2$
     385 135044 016704  002024'         3$:	MOV	TABTOP,R4
     386 135050 000756                  	BR	31$
     387                                ;
     388 135052 104512                  ARGUM:	TRAP	112
     389 135054 122713  000056          	CMPB	#'.,(R3)
     390 135060 001004                  	BNE	2$
     391 135062 016705  002056'         	MOV	CURLIN,R5
     392 135066 005203                  	INC	R3
     393 135070 000207                  	RETURN
     394 135072 104510                  2$:	TRAP	110
     395 135074 005004                  	CLR	R4
     396 135076 000207                  	RETURN
     397                                ;
     398 135100 011405                  EILUTE::MOV	@R4,R5
     399 135102 004767  140574'         	CALL	IUNPCK
     400 135106 010503                  	MOV	R5,R3
     401 135110 014405                  	MOV	-(R4),R5
     402 135112 112501                  	MOVB	(R5)+,R1
     403 135114 001406                  	BEQ	1$
     404 135116 016101  133400          	MOV	AOPNAM(R1),R1
     405 135122 012700  000040          	MOV	#40,R0
     406 135126 004767  140502'         	CALL	INBUF
     407 135132 010501                  1$:	MOV	R5,R1
     408 135134 012700  000012          	MOV	#12,R0
     409 135140 004767  140502'         	CALL	INBUF
     410 135144 012701  003022          	MOV	#BUF,R1
     411 135150 000207                  	RETURN
     412                                ;
     413 135152 012767  000400  002000' STATM:	MOV	#400,LYGIS
     414 135160 005767  002004'         	TST	STRREG
     415 135164 001002                  	BNE	5$
     416 135166 004767  134534'         	CALL	STRMEM
     417 135172 016701  002014'         5$:	MOV	ENDCOD,R1
     418 135176 005067  002132'         	CLR	TMP
     419 135202 012767  177777  002044' 	MOV	#-1,NUMBER
     420 135210 004775  133564          	CALL	@AOPSUB(R5)
     421 135214 012721  133754          ASTAR::	MOV	#STAR,(R1)+
     422 135220 016704  002014'         	MOV	ENDCOD,R4
     423 135224 020167  002016'         	CMP	R1,CIKL
     424 135230 103126                  	BHIS	MEMORY
     425 135232 005467  002000'         	NEG	LYGIS
     426 135236 000167  136052'         	JMP	VYK1
     427                                ;
     428 135242 016702  002026'         RUN::	MOV	FCB,R2
     429 135246 104510                  	TRAP	110
     430 135250 014205                  	MOV	-(R2),R5
     431 135252 104506                  	TRAP	106
     432 135254 004767  162664'         	CALL	CLOALL
     433 135260 026767  002024' 002026' LRUN::	CMP	TABTOP,FCB
     434 135266 001520                  	BEQ	KL1
     435 135270 104511                  	TRAP	111
     436 135272 000401                  	BR	1$
     437 135274 104410                  	TRAP	8.
     438 135276 004067  135564'         1$:	JSR	R0,SETST
     439 135302 000401                  	BR	4$
     440 135304 000511                  	BR	KL1
     441 135306 004767  124076'         4$:   	CALL	CURON
     442 135312 012767  002036  002040' 	MOV	#DATBEG,DATPTR
     443 135320 005067  002052'         	CLR	AUTOON
     444 135324 005067  002036'         	CLR	DATBEG
     445 135330 005267  002032'         2$:	INC	ERRS
     446 135334 001775                  	BEQ	2$
     447 135336 005267  002000'         	INC	LYGIS
     448 135342 010467  002046'         	MOV	R4,ADRHLT
     449 135346 016767  002024' 002016' 	MOV	TABTOP,CIKL
     450 135354 016767  002024' 002020' 	MOV	TABTOP,LIMIT
     451 135362 016767  002024' 002022' 	MOV	TABTOP,LENT
     452 135370 005067  002004'         	CLR	STRREG
     453 135374 004767  140716'         	CALL	GRBCOL
     454 135400 016700  002024'         	MOV	TABTOP,R0
     455 135404 005020                  3$:	CLR	(R0)+
     456 135406 022020                  	CMP	(R0)+,(R0)+
     457 135410 020067  002026'         	CMP	R0,FCB
     458 135414 103773                  	BLO	3$
     459 135416 005067  002126'         	CLR	PFACT
     460 135422 012706  002000          	MOV	#STACK,SP
     461 135426 020067  002024'         COMPIL:	CMP	R0,TABTOP
     462 135432 101463                  	BLOS	ENDTXT
     463 135434 014067  002044'         	MOV	-(R0),NUMBER
     464 135440 014003                  	MOV	-(R0),R3
     465 135442 005740                  	TST	-(R0)
     466 135444 010005                  	MOV	R0,R5
     467 135446 011502                  1$:	MOV	@R5,R2
     468 135450 010115                  	MOV	R1,@R5
     469 135452 010205                  	MOV	R2,R5
     470 135454 001374                  	BNE	1$
     471 135456 112302                  	MOVB	(R3)+,R2
     472 135460 005067  002132'         	CLR	TMP
     473 135464 020227  000124          	CMP	R2,#AOPMON-AOPSUB
     474 135470 002401                  	BLT	2$
     475 135472 104414                  	TRAP	12.
     476 135474 004772  133564          2$:	CALL	@AOPSUB(R2)
     477 135500 020167  002022'         	CMP	R1,LENT
     478 135504 101750                  	BLOS	COMPIL
     479 135506 005067  002000'         MEMORY:	CLR	LYGIS
     480 135512 020167  002024'         2$:	CMP	R1,TABTOP
     481 135516 101430                  	BLOS	TXTSV
     482 135520 162767  000006  002024' 	SUB	#6,TABTOP
     483 135526 000771                  	BR	2$
     484 135530 000167  133754'         KL1:	JMP	STAR
     485 135534 125427  000050          SET1:	CMPB	@-(4),#50	;REM
     486 135540 001410                  	BEQ	1$
     487 135542 127427  000000  000002  	CMPB	@0(4),#2	;'
     488 135550 001404                  	BEQ	1$
     489 135552 127427  000000  000100  	CMPB	@0(4),#100	;DATA
     490 135560 001005                  	BNE	SET2
     491 135562 024444                  1$:	CMP	-(4),-(4)
     492 135564 020467  002024'         SETST::	CMP	R4,TABTOP
     493 135570 103361                  	BHIS	SET1
     494 135572 005720                  	TST	(0)+
     495 135574 005744                  SET2:	TST	-(4)
     496 135576 000200                  	RTS	R0
     497 135600 104407                  TXTSV:	TRAP	7
     498 135602 026127  177776  154722  ENDTXT:	CMP	-2(R1),#ENDPRG
     499 135610 001406                  	BEQ	2$
     500 135612 026127  177776  154754  	CMP	-2(R1),#HALT
     501 135620 001402                  	BEQ	2$
     502 135622 012721  154722          	MOV	#ENDPRG,(R1)+
     503 135626 016700  002036'         2$:	MOV	DATBEG,R0
     504 135632 001427                  	BEQ	11$
     505 135634 010167  002036'         	MOV	R1,DATBEG
     506 135640 016003  000002          1$:	MOV	2(0),R3
     507 135644 005203                  	INC	R3
     508 135646 011002                  	MOV	@R0,R2
     509 135650 010110                  	MOV	R1,@R0
     510 135652 026701  002022'         13$:	CMP	LENT,R1
     511 135656 101713                  	BLOS	MEMORY
     512 135660 121327  000012          	CMPB	@R3,#12
     513 135664 001402                  	BEQ	3$
     514 135666 112321                  	MOVB	(3)+,(1)+
     515 135670 000770                  	BR	13$
     516 135672 020067  002040'         3$:	CMP	R0,DATPTR
     517 135676 001404                  	BEQ	4$
     518 135700 112721  000054          	MOVB	#54,(1)+
     519 135704 010200                  	MOV	R2,R0
     520 135706 000754                  	BR	1$
     521 135710 111321                  4$:	MOVB	@R3,(1)+
     522 135712 016767  002036' 002040' 11$:	MOV	DATBEG,DATPTR
     523 135720 016700  002052'         	MOV	AUTOON,R0
     524 135724 001422                  	BEQ	10$
     525 135726 011004                  7$:	MOV	@R0,R4
     526 135730 127427  000000  000100  5$:	CMPB	@(4),#100	;DATA
     527 135736 001407                  	BEQ	6$
     528 135740 162704  000006          	SUB	#6,R4
     529 135744 020467  002024'         	CMP	R4,TABTOP
     530 135750 101367                  	BHI	5$
     531 135752 005010                  	CLR	@R0
     532 135754 000401                  	BR	8$
     533 135756 014410                  6$:	MOV	-(4),@R0
     534 135760 014004                  8$:	MOV	-(0),R4
     535 135762 012710  157114          	MOV	#RESTV,@R0
     536 135766 010400                  	MOV	R4,R0
     537 135770 001356                  	BNE	7$
     538 135772 010167  002014'         10$:	MOV	R1,ENDCOD
     539 135776 004767  134534'         	CALL	STRMEM
     540 136002 017704  002046'         	MOV	@ADRHLT,R4
     541 136006 005367  002000'         	DEC	LYGIS
     542 136012 005067  002046'         VYK2:	CLR	ADRHLT
     543 136016 005067  002032'         	CLR	ERRS
     544 136022 005067  002052'         	CLR	AUTOON
     545 136026 005067  002044'         	CLR	NUMBER
     546 136032 005767  002050'         	TST	TRFLAG
     547 136036 001402                  	BEQ	VYKDYT
     548 136040 000167  123204'         	JMP	TRIN
     549 136044 012767  177777  002000' VYKDYT::MOV	#-1,LYGIS
     550 136052 004767  124120'         VYK1:	CALL	CUROFF
     551 136056 005067  003020'         	CLR	INK
     552 136062 000134                  	JMP	@(R4)+
     553                                ;
     554 136064 104421                  PRGFUL:	TRAP	17.
     555                                ;
     556 136066 005767  002032'         CONT:	TST	ERRS
     557 136072 001374                  	BNE	PRGFUL
     558 136074 016704  002046'         	MOV	ADRHLT,R4
     559 136100 001613                  	BEQ	KL1
     560 136102 000743                  	BR	VYK2
     561                                ;
     562                                ;MERGE:	MOV	#-1,-(SP)
     563                                ;	BR	L0
     564                                ;
     565 136104 026767  002024' 002026' LOAD:	CMP	TABTOP,FCB
     566 136112 001401                  	BEQ	1$
     567 136114 104405                  	TRAP	5
     568 136116 005046                  1$:	CLR	-(SP)
     569 136120 012700  000320          L0:	MOV	#MAG,R0
     570 136124 012720  000003          	MOV	#3,(R0)+
     571 136130 016720  002026'         	MOV	FCB,(0)+
     572 136134 012746  000400          	MOV	#400,-(SP)
     573 136140 011620                  	MOV	@SP,(0)+
     574 136142 004767  137456'         	CALL	FILNAM
     575 136146 004767  137710'         	CALL	M_ASC
     576                                ;	TST	2(SP)
     577                                ;	BMI	11$
     578 136152 121327  000054          	CMPB	@R3,#',
     579 136156 001006                  	BNE	11$
     580 136160 005203                  	INC	R3
     581 136162 104501                  	TRAP	101
     582 136164 137410                  	.WORD	RDRM
     583 136166 104402                  	TRAP	2
     584 136170 005266  000002          	INC	2(SP)
     585 136174 104506                  11$:	TRAP	106
     586 136176 004767  140064'         	CALL	CAS
     587 136202 004767  137422'         	CALL	ISVARD
     588 136206 016746  002026'         	MOV	FCB,-(SP)
     589 136212 012603                  4$:	MOV	(SP)+,R3
     590 136214 010600                  	MOV	SP,R0
     591 136216 012705  000346          	MOV	#MAG+26,R5
     592 136222 004767  163072'         	CALL	COPYIN
     593 136226 020127  003022          	CMP	R1,#BUF
     594 136232 001414                  	BEQ	L6
     595 136234 010346                  	MOV	R3,-(SP)
     596 136236 004167  134106'         	JSR	R1,ASCCOD
     597 136242 000401                  	BR	7$
     598 136244 000762                  	BR	4$
     599 136246 012700  000012          7$:	MOV	#12,R0
     600 136252 110027  003022          	MOVB	R0,#BUF
     601 136256 004767  122522'         	CALL	ISV
     602 136262 104471                  	TRAP	57.
     603 136264 005726                  L6:	TST	(SP)+
     604 136266 004767  137750'         L1:	CALL	LASTBL
     605 136272 004767  140064'         L2:	CALL	CAS
     606 136276 004767  137076'         	CALL	TESTR
     607 136302 000167  137370'         	JMP	ST0
     608                                ;
     609 136306 012767  124160  003014' FIND:	MOV	#MAGNIT,WRITE
     610 136314 012700  000320          	MOV	#MAG,R0
     611 136320 012720  000004          	MOV	#4,(R0)+
     612 136324 022020                  	CMP	(R0)+,(R0)+
     613 136326 005010                  	CLR	@R0
     614 136330 005046                  	CLR	-(SP)
     615 136332 024646                  	CMP	-(SP),-(SP)
     616 136334 010601                  	MOV	SP,R1
     617 136336 104520                  	TRAP	120
     618 136340 000240                  	NOP
     619 136342 104506                  	TRAP	106
     620 136344 005726                  	TST	(SP)+
     621 136346 016601  000002          	MOV	2(SP),R1
     622 136352 001744                  	BEQ	L6
     623 136354 012616                  	MOV	(SP)+,@SP
     624 136356 010146                  	MOV	R1,-(SP)
     625 136360 004767  162454'         	CALL	NAMTYP
     626 136364 012703  000335          	MOV	#MAG+13.,R3
     627 136370 104513                  	TRAP	113
     628 136372 137400                  	.WORD	FILTYP
     629 136374    003     002          	.BYTE	3,2
     630 136376 000406                  	BR	1$
     631 136400 005303                  	DEC	R3
     632 136402 010300                  	MOV	R3,R0
     633 136404 004775  137416          	CALL	@BINCOD(R5)
     634 136410 005046                  	CLR	-(SP)
     635 136412 000727                  	BR	L2
     636 136414 005046                  1$:	CLR	-(SP)
     637 136416 000723                  	BR	L1
     638                                ;
     639 136420 012700  000320          BLOAD:	MOV	#MAG,R0
     640 136424 012720  000003          	MOV	#3,(0)+
     641 136430 022020                  	CMP	(0)+,(0)+
     642 136432 004767  137456'         	CALL	FILNAM
     643 136436 004767  137642'         	CALL	M_BIN
     644 136442 162700  000024          	SUB	#24,R0
     645 136446 005046                  	CLR	-(SP)
     646 136450 005005                  	CLR	R5
     647 136452 121327  000054          	CMPB	@R3,#',
     648 136456 001014                  	BNE	2$
     649 136460 005203                  	INC	R3
     650 136462 104501                  	TRAP	101
     651 136464 137410                  	.WORD	RDRM
     652 136466 000406                  	BR	1$
     653 136470 005216                  	INC	@SP
     654 136472 104512                  	TRAP	112
     655 136474 121327  000054          	CMPB	@R3,#',
     656 136500 001003                  	BNE	2$
     657 136502 005203                  	INC	R3
     658 136504 004767  136534'         1$:	CALL	SAVPAP
     659 136510 010520                  2$:	MOV	R5,(0)+
     660 136512 104506                  	TRAP	106
     661 136514 004767  140064'         	CALL	CAS
     662 136520 004767  137422'         	CALL	ISVARD
     663 136524 005726                  	TST	(SP)+
     664 136526 001561                  	BEQ	ST
     665 136530 000177  000264'         	JMP	@MSTART
     666                                ;
     667 136534 104512                  SAVPAP:	TRAP	112
     668 136536 122327  000046          	CMPB	(3)+,#'&
     669 136542 001003                  	BNE	11$
     670 136544 004767  151340'         	CALL	BOHPAP
     671 136550 000207                  	RETURN
     672 136552 005303                  11$:	DEC	R3
     673 136554 104510                  	TRAP	110
     674 136556 104402                  	TRAP	2
     675 136560 000207                  	RETURN
     676                                ;
     677 136562 012700  000320          BSAVE:	MOV	#MAG,R0
     678 136566 012720  000002          	MOV	#2,(0)+
     679 136572 022020                  	CMP	(0)+,(0)+
     680 136574 004767  137456'         	CALL	FILNAM
     681 136600 004767  137642'         	CALL	M_BIN
     682 136604 162700  000024          	SUB	#24,R0
     683 136610 104526                  	TRAP	126
     684 136612 004767  136534'         	CALL	SAVPAP
     685 136616 010520                  	MOV	R5,(0)+
     686 136620 010502                  	MOV	R5,R2
     687 136622 104526                  	TRAP	126
     688 136624 004767  136534'         	CALL	SAVPAP
     689 136630 160205                  	SUB	R2,R5
     690 136632 103405                  	BLO	CL0
     691 136634 010520                  	MOV	R5,(0)+
     692 136636 104506                  	TRAP	106
     693 136640 004767  140064'         	CALL	CAS
     694 136644 000512                  	BR	ST
     695                                ;
     696 136646 104405                  CL0:	TRAP	5
     697                                ;
     698 136650 026767  002024' 002026' CLOAD:	CMP	TABTOP,FCB
     699 136656 001373                  	BNE	CL0
     700 136660 016767  002024' 002016' 	MOV	TABTOP,CIKL
     701 136666 016767  002024' 002020' 	MOV	TABTOP,LIMIT
     702 136674 016767  002024' 002022' 	MOV	TABTOP,LENT
     703 136702 005067  002004'         	CLR	STRREG
     704 136706 012700  000320          	MOV	#MAG,R0
     705 136712 012720  000003          	MOV	#3,(R0)+
     706 136716 012720  003052          	MOV	#TEXT,(R0)+
     707 136722 016710  002026'         	MOV	FCB,@R0
     708 136726 162720  003052          	SUB	#TEXT,(R0)+
     709 136732 004767  137456'         	CALL	FILNAM
     710 136736 005046                  	CLR	-(SP)
     711 136740 121327  000054          	CMPB	@R3,#',
     712 136744 001005                  	BNE	CL1
     713 136746 005203                  	INC	R3
     714 136750 104501                  	TRAP	101
     715 136752 137410                  	.WORD	RDRM
     716 136754 104402                  	TRAP	2
     717 136756 005216                  	INC	@SP
     718 136760 004767  137670'         CL1:	CALL	M_COD
     719 136764 104506                  	TRAP	106
     720 136766 004767  140064'         	CALL	CAS
     721 136772 012703  000346          	MOV	#MAG+26,R3
     722 136776 012302                  	MOV	(R3)+,R2
     723 137000 011300                  	MOV	@R3,R0
     724 137002 012703  003052          	MOV	#TEXT,R3
     725 137006 060300                  	ADD	R3,R0
     726 137010 160203                  	SUB	R2,R3
     727 137012 016702  002026'         	MOV	FCB,R2
     728 137016 010204                  	MOV	R2,R4
     729 137020 164004                  	SUB	-(R0),R4
     730 137022 014042                  5$:	MOV	-(R0),-(R2)
     731 137024 014042                  	MOV	-(R0),-(R2)
     732 137026 060312                  	ADD	R3,@R2
     733 137030 014042                  	MOV	-(R0),-(R2)
     734 137032 020204                  	CMP	R2,R4
     735 137034 101372                  	BHI	5$
     736 137036 010067  002014'         	MOV	R0,ENDCOD
     737 137042 010067  002002'         	MOV	R0,TXEND
     738 137046 010267  002022'         	MOV	R2,LENT
     739 137052 010267  002020'         	MOV	R2,LIMIT
     740 137056 010267  002016'         	MOV	R2,CIKL
     741 137062 010467  002024'         	MOV	R4,TABTOP
     742 137066 004767  137076'         	CALL	TESTR
     743 137072 000167  133754'         ST:	JMP	STAR
     744                                ;
     745 137076 004767  137422'         TESTR:	CALL	ISVARD
     746 137102 012605                  	MOV	(SP)+,R5
     747 137104 005726                  	TST	(SP)+
     748 137106 003405                  	BLE	1$
     749 137110 016704  002026'         	MOV	FCB,R4
     750 137114 014405                  	MOV	-(R4),R5
     751 137116 000167  135260'         	JMP	LRUN
     752 137122 010507                  1$:	MOV	R5,PC
     753                                ;
     754 137124 026767  002024' 002026' CSAVE:	CMP	TABTOP,FCB
     755 137132 001757                  	BEQ	ST
     756 137134 012700  000320          	MOV	#MAG,R0
     757 137140 012720  000002          	MOV	#2,(R0)+
     758 137144 012720  003052          	MOV	#TEXT,(R0)+
     759 137150 010346                  	MOV	R3,-(SP)
     760 137152 004767  140716'         	CALL	GRBCOL
     761 137156 010105                  	MOV	R1,R5
     762 137160 016704  002024'         	MOV	TABTOP,R4
     763 137164 010510                  	MOV	R5,@R0
     764 137166 162720  003050          	SUB	#TEXT-2,(R0)+
     765 137172 012603                  	MOV	(SP)+,R3
     766 137174 004767  137456'         	CALL	FILNAM
     767 137200 004767  137670'         	CALL	M_COD
     768 137204 104506                  	TRAP	106
     769 137206 011767  002032'         	MOV	@PC,ERRS
     770 137212 012425                  7$:	MOV	(R4)+,(R5)+
     771 137214 020467  002026'         	CMP	R4,FCB
     772 137220 103774                  	BLO	7$
     773 137222 010415                  	MOV	R4,@R5
     774 137224 166715  002024'         	SUB	TABTOP,(R5)
     775 137230 012701  000320          	MOV	#MAG,R1
     776 137234 062561  000004          	ADD	(R5)+,4(R1)
     777 137240 004777  003014'         	CALL	@WRITE
     778 137244 004767  137766'         	CALL	ATSTAB
     779 137250 004767  140074'         	CALL	CASERR
     780 137254 000706                  	BR	ST
     781 137256 026767  002024' 002026' SAVE:	CMP	TABTOP,FCB
     782 137264 001702                  	BEQ	ST
     783 137266 012700  000320          	MOV	#MAG,R0
     784 137272 012720  000002          	MOV	#2,(R0)+
     785 137276 016704  002026'         	MOV	FCB,R4
     786 137302 010420                  	MOV	R4,(R0)+
     787 137304 012720  000400          	MOV	#400,(R0)+
     788 137310 005046                  	CLR	-(SP)
     789 137312 004767  137456'         	CALL	FILNAM
     790 137316 004767  137710'         	CALL	M_ASC
     791 137322 104506                  	TRAP	106
     792 137324 010446                  	MOV	R4,-(SP)
     793 137326 005744                  	TST	-(R4)
     794 137330 004767  135100'         1$:	CALL	EILUTE
     795 137334 024444                  	CMP	-(R4),-(R4)
     796 137336 012603                  	MOV	(SP)+,R3
     797 137340 010600                  	MOV	SP,R0
     798 137342 012705  000346          	MOV	#MAG+26,R5
     799 137346 004767  123062'         	CALL	COPOUT
     800 137352 010346                  	MOV	R3,-(SP)
     801 137354 020467  002024'         	CMP	R4,TABTOP
     802 137360 101363                  	BHI	1$
     803 137362 004767  162744'         	CALL	CLOUTF
     804 137366 022626                  	CMP	(SP)+,(SP)+
     805 137370 012767  000012  003022' ST0:	MOV	#12,BUF
     806 137376 000635                  	BR	ST
     807                                ;
     808 137400    103     117     104  FILTYP:	.ASCII	/COD BIN /
         137403    040     102     111  
         137406    116     040          
     809 137410    122     162     000  RDRM:	.BYTE	'R,162,0
     810 137413    124     164     000  TT:	.BYTE	'T,164,0
     811 137416 137700  137652          BINCOD:	.WORD	CODEND,BINEND
     812                                ;
     813 137422 105767  002000'         ISVARD::TSTB	LYGIS
     814 137426 001012                  	BNE	1$
     815 137430 012701  000352          	MOV	#MAG+32,R1
     816 137434 012702  000020          	MOV	#20,R2
     817 137440 004767  122560'         	CALL	ISVEIL
     818 137444 012700  000012          	MOV	#12,R0
     819 137450 004767  122522'         	CALL	ISV
     820 137454 000207                  1$:	RETURN
     821                                ;
     822                                FILNAM:
     823 137456 122327  000042          	CMPB	(R3)+,#'"
     824 137462 001034                  	BNE	7$
     825 137464 004767  137556'         	CALL	TTANAL
     826 137470 012702  000006          	MOV	#6,R2
     827 137474 121327  000042          1$:	CMPB	@R3,#'"
     828 137500 001405                  	BEQ	2$
     829 137502 121327  000012          	CMPB	@R3,#12
     830 137506 001402                  	BEQ	2$
     831 137510 112320                  	MOVB	(R3)+,(R0)+
     832 137512 077210                  	SOB	R2,1$
     833 137514 020227  000006          2$:	CMP	R2,#6
     834 137520 001003                  	BNE	4$
     835 137522 104470                  	TRAP	56.
     836 137524 112720  000040          3$:	MOVB	#40,(R0)+
     837 137530 005302                  4$:	DEC	R2
     838 137532 002374                  	BGE	3$
     839 137534 121327  000012          5$:	CMPB	@R3,#12
     840 137540 001403                  	BEQ	6$
     841 137542 122327  000042          	CMPB	(R3)+,#'"
     842 137546 001372                  	BNE	5$
     843 137550 104512                  6$:	TRAP	112
     844 137552 000207                  	RETURN
     845 137554 104415                  7$:	TRAP	13.
     846                                ;
     847 137556 012767  124160  003014' TTANAL::MOV	#MAGNIT,WRITE
     848 137564 010446                  	MOV	R4,-(SP)
     849 137566 010346                  	MOV	R3,-(SP)
     850 137570 104501                  	TRAP	101
     851 137572 137413                  	.WORD	TT
     852 137574 000417                  	BR	12$
     853 137576 104501                  	TRAP	101
     854 137600 137413                  	.WORD	TT
     855 137602 000414                  	BR	12$
     856 137604 104512                  	TRAP	112
     857 137606 121327  000072          	CMPB	@R3,#':
     858 137612 001010                  	BNE	12$
     859 137614 005203                  	INC	R3
     860 137616 104512                  	TRAP	112
     861 137620 062602                  	ADD	(SP)+,R2
     862 137622 160302                  	SUB	R3,R2
     863 137624 012767  124650  003014' 	MOV	#IRPS,WRITE
     864 137632 000401                  	BR	13$
     865 137634 012603                  12$:	MOV	(SP)+,R3
     866 137636 012604                  13$:	MOV	(SP)+,R4
     867 137640 000207                  	RETURN
     868                                ;
     869 137642 012720  020102          M_BIN:	MOV	#".B,(R0)+
     870 137646 012720  020116          	MOV	#"IN,(R0)+
     871 137652 012720  020040          BINEND:	MOV	#20040,(R0)+
     872 137656 012720  020040          	MOV	#20040,(R0)+
     873 137662 012720  020040          	MOV	#20040,(R0)+
     874 137666 000207                  	RTS	PC
     875                                ;
     876 137670 012720  020103          M_COD:	MOV	#".C,(R0)+
     877 137674 012720  020104          	MOV	#"OD,(R0)+
     878 137700 005020                  CODEND:	CLR	(R0)+
     879 137702 005020                  	CLR	(R0)+
     880 137704 005020                  	CLR	(R0)+
     881 137706 000207                  	RTS	PC
     882                                ;
     883 137710 012720  020101          M_ASC:	MOV	#".A,(R0)+
     884 137714 012720  020103          	MOV	#"SC,(R0)+
     885 137720 012720  020043          BLOCK0::MOV	#" #,(R0)+
     886 137724 012720  020060          	MOV	#"00,(R0)+
     887 137730 012720  015060          	MOV	#15060,(R0)+
     888 137734 000207                  	RETURN
     889                                ;
     890 137736 012720  020104          DAT::	MOV	#".D,(R0)+
     891 137742 012720  020124          	MOV	#"AT,(R0)+
     892 137746 000764                  	BR	BLOCK0
     893                                ;
     894 137750 012701  000341          LASTBL::MOV	#MAG+21,R1
     895 137754 112721  000040          	MOVB	#40,(R1)+
     896 137760 005021                  	CLR	(R1)+
     897 137762 005021                  	CLR	(R1)+
     898 137764 000207                  	RETURN
     899                                ;
     900 137766 020567  002024'         ATSTAB:	CMP	R5,TABTOP
     901 137772 103410                  	BLO	2$
     902 137774 010504                  	MOV	R5,R4
     903 137776 166704  002026'         	SUB	FCB,R4
     904 140002 060504                  	ADD	R5,R4
     905 140004 014445                  1$:	MOV	-(R4),-(R5)
     906 140006 020567  002024'         	CMP	R5,TABTOP
     907 140012 101374                  	BHI	1$	
     908 140014 000207                  2$:	RETURN
     909                                ;
     910 140016 005767  002000'         CASCII::TST	LYGIS
     911 140022 001417                  	BEQ	2$
     912 140024 012701  000320          	MOV	#MAG,R1
     913 140030 012021                  	MOV	(0)+,(1)+
     914 140032 010011                  	MOV	R0,@R1
     915 140034 062721  000020          	ADD	#20,(1)+
     916 140040 012721  000400          	MOV	#400,(1)+
     917 140044 012705  000010          	MOV	#10,R5
     918 140050 012021                  1$:	MOV	(0)+,(1)+
     919 140052 077502                  	SOB	R5,1$
     920 140054 010005                  	MOV	R0,R5
     921 140056 162700  000022          	SUB	#22,R0
     922 140062 000207                  2$:	RETURN
     923 140064 012701  000320          CAS::	MOV	#MAG,R1
     924 140070 004777  003014'         	CALL	@WRITE
     925 140074 116101  000001          CASERR:	MOVB	1(R1),R1
     926 140100 001411                  	BEQ	2$
     927 140102 005301                  	DEC	R1
     928 140104 001404                  	BEQ	1$
     929 140106 005301                  	DEC	R1
     930 140110 001406                  	BEQ	3$
     931 140112 000167  120234'         	JMP	BREAK
     932 140116 004767  137422'         1$:	CALL	ISVARD
     933 140122 000760                  	BR	CAS
     934 140124 000207                  2$:	RETURN
     935 140126 012700  000012          3$:	MOV	#12,R0
     936 140132 004767  122522'         	CALL	ISV
     937 140136 104423                  	TRAP	19.
     938                                ;
     939 140140 012701  000003          BLOCKN::MOV	#3,R1
     940 140144 005305                  	DEC	R5
     941 140146 124527  000071          6$:	CMPB	-(R5),#'9
     942 140152 001004                  	BNE	7$
     943 140154 112715  000060          	MOVB	#'0,@R5
     944 140160 077106                  	SOB	R1,6$
     945 140162 005725                  	TST	(R5)+
     946 140164 105215                  7$:	INCB	@R5
     947 140166 000207                  	RETURN
     948                                ;
     949 140170 062706  000016          BC::	ADD	#16,SP
     950                                ;	TST	LYGIS
     951                                ;	BGT	1$
     952 140174 005002                  	CLR	R2
     953 140176 012703  003022          	MOV	#BUF,R3
     954 140202 010301                  	MOV	R3,R1
     955 140204 000441                  	BR	E4
     956                                ;1$:	JMP	LISTBC
     957                                ;
     958 140206 104511                  EDAUIN:	TRAP	111
     959 140210 000422                  	BR	E6
     960 140212 004767  140574'         	CALL	IUNPCK
     961 140216 004767  122560'         	CALL	ISVEIL
     962 140222 010102                  	MOV	R1,R2
     963 140224 162702  003022          	SUB	#BUF,R2
     964 140230 010103                  	MOV	R1,R3
     965 140232 000444                  	BR	EDEND
     966                                ;
     967 140234 005002                  EDIT:	CLR	R2
     968 140236 016700  002056'         	MOV	CURLIN,R0
     969 140242 104510                  	TRAP	110
     970 140244 010005                  	MOV	R0,R5
     971 140246 104506                  E0:	TRAP	106
     972 140250 104511                  	TRAP	111
     973 140252 000401                  	BR	E6
     974 140254 104410                  	TRAP	8.
     975 140256 004767  140574'         E6:	CALL	IUNPCK
     976 140262 014404                  	MOV	-(R4),R4
     977 140264 010503                  	MOV	R5,R3
     978 140266 112401                  	MOVB	(R4)+,R1
     979 140270 001406                  	BEQ	1$
     980 140272 016101  133400          	MOV	AOPNAM(R1),R1
     981 140276 012700  000040          	MOV	#40,R0
     982 140302 004767  140502'         	CALL	INBUF
     983 140306 010401                  1$:	MOV	R4,R1
     984 140310 012700  000012          E4:	MOV	#12,R0
     985 140314 004767  140502'         	CALL	INBUF
     986 140320 012701  003022          	MOV	#BUF,R1
     987 140324 005303                  	DEC	R3
     988 140326 005302                  	DEC	R2
     989 140330 001404                  	BEQ	5$
     990 140332 010200                  	MOV	R2,R0
     991 140334 004767  122560'         	CALL	ISVEIL
     992 140340 010002                  	MOV	R0,R2
     993 140342 010301                  5$:	MOV	R3,R1
     994 140344 012746  134016          EDEND:	MOV	#ANALIZ,-(SP)
     995 140350 010046                  	MOV	R0,-(SP)
     996 140352 010246                  	MOV	R2,-(SP)
     997 140354 010346                  	MOV	R3,-(SP)
     998 140356 010546                  	MOV	R5,-(SP)
     999 140360 005046                  	CLR	-(SP)
    1000 140362 012746  000420          	MOV	#420,-(SP)
    1001 140366 161602                  	SUB	@SP,R2
    1002 140370 005402                  	NEG	R2
    1003 140372 000167  121102'         	JMP	PIJ
    1004                                ;
    1005 140376 004767  124076'         AUTO:	CALL	CURON
    1006 140402 005002                  	CLR	R2
    1007 140404 122713  000054          	CMPB	#',,@R3
    1008 140410 001406                  	BEQ	2$
    1009 140412 012702  000012          	MOV	#12,R2
    1010 140416 004767  135052'         	CALL	ARGUM
    1011 140422 001401                  	BEQ	2$
    1012 140424 010502                  	MOV	R5,R2
    1013 140426 104512                  2$:	TRAP	112
    1014 140430 012705  000012          	MOV	#12,R5
    1015 140434 122713  000054          	CMPB	#',,@R3
    1016 140440 001007                  	BNE	4$
    1017 140442 016700  002054'         3$:	MOV	AUINC,R0
    1018 140446 005203                  	INC	R3
    1019 140450 104510                  	TRAP	110
    1020 140452 010005                  	MOV	R0,R5
    1021 140454 005705                  	TST	R5
    1022 140456 001565                  	BEQ	ILCALL
    1023 140460 104506                  4$:	TRAP	106
    1024 140462 011767  002052'         	MOV	@PC,AUTOON
    1025 140466 010267  002056'         	MOV	R2,CURLIN
    1026 140472 010567  002054'         	MOV	R5,AUINC
    1027 140476 010205                  	MOV	R2,R5
    1028 140500 000642                  	BR	EDAUIN
    1029                                ;
    1030 140502 111123                  INBUF:	MOVB	(1),(3)+
    1031 140504 005202                  	INC	R2
    1032 140506 122100                  	CMPB	(1)+,R0
    1033 140510 001374                  	BNE	INBUF
    1034 140512 000207                  	RETURN
    1035                                ;
    1036 140514 005046                  DELETE:	CLR	-(SP)
    1037 140516 004767  134724'         	CALL	LARG
    1038 140522 011767  002032'         	MOV	@PC,ERRS
    1039 140526 004767  134344'         	CALL	DELINT
    1040 140532 000167  133754'         	JMP	STAR
    1041                                ;
    1042 140536 012703  003022          ISGUNP::MOV	#BUFOUT,R3
    1043 140542 112723  000040          	MOVB	#40,(R3)+
    1044 140546 005705                  	TST	R5
    1045 140550 100004                  	BPL	1$
    1046 140552 112763  000055  177777  	MOVB	#'-,-1(R3)
    1047 140560 005405                  	NEG	R5
    1048 140562 004767  140600'         1$:	CALL	I1
    1049 140566 005301                  	DEC	R1
    1050 140570 005202                  	INC	R2
    1051 140572 000207                  	RETURN
    1052                                ;
    1053 140574 012703  003022          IUNPCK::MOV	#BUF,R3
    1054 140600 010346                  I1::	MOV	R3,-(SP)
    1055 140602 062703  000005          	ADD	#5,R3
    1056 140606 112713  000040          	MOVB	#40,(R3)
    1057 140612 012702  000005          1$:	MOV	#5,R2
    1058 140616 005001                  	CLR	R1
    1059 140620 006302                  2$:	ASL	R2
    1060 140622 103406                  	BCS	4$
    1061 140624 020205                  	CMP	R2,R5
    1062 140626 101774                  	BLOS	2$
    1063 140630 020227  000012          3$:	CMP	R2,#12
    1064 140634 001410                  	BEQ	5$
    1065 140636 000241                  	CLC
    1066 140640 006002                  4$:	ROR	R2
    1067 140642 006301                  	ASL	R1
    1068 140644 020205                  	CMP	R2,R5
    1069 140646 101370                  	BHI	3$
    1070 140650 160205                  	SUB	R2,R5
    1071 140652 005201                  	INC	R1
    1072 140654 000765                  	BR	3$
    1073 140656 062705  000060          5$:	ADD	#60,R5
    1074 140662 110543                  	MOVB	R5,-(R3)
    1075 140664 010105                  	MOV	R1,R5
    1076 140666 001351                  	BNE	1$
    1077 140670 011605                  	MOV	@SP,R5
    1078 140672 010501                  	MOV	R5,R1
    1079 140674 005002                  	CLR	R2
    1080 140676 062716  000006          	ADD	#6,@SP
    1081 140702 112325                  6$:	MOVB	(R3)+,(R5)+
    1082 140704 005202                  	INC	R2
    1083 140706 020316                  	CMP	R3,@SP
    1084 140710 001374                  	BNE	6$
    1085 140712 005726                  	TST	(SP)+
    1086 140714 000207                  	RETURN
    1087                                ;
    1088 140716 005004                  GRBCOL::CLR	R4
    1089 140720 012701  003052          	MOV	#TEXT,R1
    1090 140724 012703  177777          1$:	MOV	#-1,R3
    1091 140730 016702  002026'         	MOV	FCB,R2
    1092 140734 024242                  	CMP	-(R2),-(R2)
    1093 140736 021204                  2$:	CMP	@R2,R4
    1094 140740 101402                  	BLOS	3$
    1095 140742 011203                  	MOV	@R2,R3
    1096 140744 010205                  	MOV	R2,R5
    1097 140746 024242                  3$:	CMP	-(R2),-(R2)
    1098 140750 020267  002024'         	CMP	R2,TABTOP
    1099 140754 103403                  	BLO	4$
    1100 140756 024203                  	CMP	-(R2),R3
    1101 140760 103766                  	BLO	2$
    1102 140762 000771                  	BR	3$
    1103 140764 020327  177777          4$:	CMP	R3,#-1
    1104 140770 001410                  	BEQ	6$
    1105 140772 010115                  	MOV	R1,@R5
    1106 140774 010304                  	MOV	R3,R4
    1107 140776 112321                  	MOVB	(R3)+,(R1)+
    1108 141000 112311                  5$:	MOVB	(R3)+,@R1
    1109 141002 122127  000012          	CMPB	(R1)+,#12
    1110 141006 001374                  	BNE	5$
    1111 141010 000745                  	BR	1$
    1112 141012 010167  002002'         6$:	MOV	R1,TXEND
    1113 141016 005201                  	INC	R1
    1114 141020 042701  000001          	BIC	#1,R1
    1115 141024 010167  002014'         	MOV	R1,ENDCOD
    1116 141030 000207                  	RETURN
    1117                                ;
    1118 141032 104405                  ILCALL:	TRAP	5
    1119                                ;
    1120 141034 005267  002032'         RENUM:	INC	ERRS
    1121 141040 010300                  	MOV	R3,R0
    1122 141042 004767  140716'         	CALL	GRBCOL
    1123 141046 010003                  	MOV	R0,R3
    1124 141050 005002                  	CLR	R2
    1125 141052 012700  000012          	MOV	#12,R0
    1126 141056 012746  000012          	MOV	#12,-(SP)
    1127 141062 122713  000054          	CMPB	#',,@R3
    1128 141066 001410                  	BEQ	1$
    1129 141070 004767  135052'         	CALL	ARGUM
    1130 141074 001427                  	BEQ	3$
    1131 141076 010516                  	MOV	R5,@SP
    1132 141100 104512                  	TRAP	112
    1133 141102 122713  000054          	CMPB	#',,@R3
    1134 141106 001022                  	BNE	3$
    1135 141110 005203                  1$:	INC	R3		;2 ARG. TIKRINIMAS
    1136 141112 104512                  	TRAP	112
    1137 141114 122713  000054          	CMPB	#',,@R3
    1138 141120 001410                  	BEQ	5$		;2 ARG. PRALEISTAS
    1139 141122 004767  135052'         	CALL	ARGUM
    1140 141126 001412                  	BEQ	3$
    1141 141130 010502                  	MOV	R5,R2
    1142 141132 104512                  	TRAP	112
    1143 141134 122713  000054          	CMPB	#',,@R3
    1144 141140 001005                  	BNE	3$
    1145 141142 005203                  5$:	INC	R3
    1146 141144 104510                  	TRAP	110
    1147 141146 000402                  	BR	3$
    1148 141150 010500                  	MOV	R5,R0
    1149 141152 001727                  	BEQ	ILCALL
    1150 141154 104506                  3$:	TRAP	106
    1151                                ;	ARGUMENTAI ISANALIZUOTI
    1152                                ;	@SP /NEW/,  R2/OLD/,  R0/INC/
    1153 141156 010205                  	MOV	R2,R5
    1154 141160 104511                  	TRAP	111
    1155 141162 000405                  	BR	8$
    1156 141164 020467  002024'         	CMP	R4,TABTOP
    1157 141170 103002                  	BHIS	8$
    1158 141172 000167  133754'         	JMP	STAR
    1159 141176 010402                  8$:	MOV	R4,R2
    1160 141200 010401                  	MOV	R4,R1
    1161 141202 005741                  	TST	-(R1)
    1162 141204 011641                  9$:	MOV	@SP,-(R1)
    1163 141206 011105                  	MOV	@R1,R5
    1164 141210 104511                  	TRAP	111
    1165 141212 000401                  	BR	13$
    1166 141214 000402                  	BR	14$
    1167 141216 020402                  13$:	CMP	R4,R2
    1168 141220 101304                  	BHI	ILCALL
    1169 141222 020167  002024'         14$:	CMP	R1,TABTOP
    1170 141226 101404                  	BLOS	10$
    1171 141230 060016                  	ADD	R0,@SP
    1172 141232 103677                  	BCS	ILCALL
    1173 141234 024141                  	CMP	-(R1),-(R1)
    1174 141236 000762                  	BR	9$
    1175 141240 005726                  10$:	TST	(SP)+
    1176 141242 020167  002026'         38$:	CMP	R1,FCB
    1177 141246 001450                  	BEQ	30$		;TEKSTO ANALIZE BAIGTA
    1178 141250 005721                  	TST	(R1)+
    1179 141252 011100                  	MOV	@R1,R0
    1180 141254 004567  142152'         	JSR	R5,KODTST
    1181 141260 000403                  	BR	12$
    1182 141262 000413                  	BR	24$
    1183 141264 022121                  15$:	CMP	(R1)+,(R1)+
    1184 141266 000765                  	BR	38$
    1185 141270 005200                  12$:	INC	R0
    1186 141272 010003                  	MOV	R0,R3
    1187 141274 104510                  	TRAP	110
    1188 141276 000772                  	BR	15$
    1189 141300 005046                  	CLR	-(SP)
    1190 141302 004767  141536'         	CALL	RENPAP
    1191 141306 000426                  	BR	23$
    1192 141310 000425                  	BR	23$
    1193 141312 005046                  24$:	CLR	-(SP)
    1194 141314 010003                  	MOV	R0,R3
    1195 141316 122327  000012          20$:	CMPB	(3)+,#12
    1196 141322 001420                  	BEQ	23$
    1197 141324 004267  142224'         22$:	JSR	R2,IFGAUD
    1198 141330 000415                  	BR	23$
    1199 141332 000771                  	BR	20$
    1200 141334 010300                  29$:	MOV	R3,R0
    1201 141336 104510                  	TRAP	110
    1202 141340 000771                  	BR	22$
    1203 141342 004767  141536'         	CALL	RENPAP
    1204 141346 000400                  	BR	28$
    1205 141350 104512                  28$:	TRAP	112
    1206 141352 122713  000054          	CMPB	#',,@R3
    1207 141356 001362                  	BNE	22$
    1208 141360 005203                  	INC	R3
    1209 141362 000764                  	BR	29$
    1210 141364 005026                  23$:	CLR	(SP)+
    1211 141366 000736                  	BR	15$
    1212 141370 005722                  30$:	TST	(R2)+
    1213 141372 010200                  31$:	MOV	R2,R0		;SIUNCIAM NEW NR. OF LINE
    1214 141374 024242                  	CMP	-(R2),-(R2)
    1215 141376 014240                  	MOV	-(R2),-(R0)
    1216 141400 020267  002024'         	CMP	R2,TABTOP
    1217 141404 001372                  	BNE	31$
    1218                                ;	SUTVARKOM RL MONOTONISKUMA
    1219                                ;	R0/@MAX EIL NR
    1220 141406 005003                  	CLR	R3
    1221 141410 010004                  36$:	MOV	R0,R4
    1222 141412 062704  000006          33$:	ADD	#6,R4
    1223 141416 020467  002026'         	CMP	R4,FCB
    1224 141422 101043                  	BHI	34$		;BAIGTA
    1225 141424 022024                  35$:	CMP	(R0)+,(R4)+
    1226 141426 002406                  	BLT	32$
    1227 141430 020467  002026'         	CMP	R4,FCB
    1228 141434 001436                  	BEQ	34$
    1229 141436 024044                  	CMP	-(R0),-(R4)
    1230 141440 010400                  	MOV	R4,R0
    1231 141442 000763                  	BR	33$
    1232 141444 005703                  32$:	TST	R3
    1233 141446 001001                  	BNE	37$
    1234 141450 010403                  	MOV	R4,R3
    1235 141452 014446                  37$:	MOV	-(R4),-(SP)
    1236 141454 014446                  	MOV	-(R4),-(SP)
    1237 141456 014446                  	MOV	-(R4),-(SP)
    1238 141460 162700  000006          	SUB	#6,R0
    1239 141464 012024                  	MOV	(R0)+,(R4)+
    1240 141466 012024                  	MOV	(R0)+,(R4)+
    1241 141470 012024                  	MOV	(R0)+,(R4)+
    1242 141472 010004                  	MOV	R0,R4
    1243 141474 162700  000006          	SUB	#6,R0
    1244 141500 012620                  	MOV	(SP)+,(R0)+
    1245 141502 012620                  	MOV	(SP)+,(R0)+
    1246 141504 012620                  	MOV	(SP)+,(R0)+
    1247 141506 162700  000010          	SUB	#10,R0
    1248 141512 005744                  	TST	-(R4)
    1249 141514 020067  002024'         	CMP	R0,TABTOP
    1250 141520 101341                  	BHI	35$
    1251 141522 010300                  	MOV	R3,R0
    1252 141524 005740                  	TST	-(R0)
    1253 141526 005003                  	CLR	R3
    1254 141530 000727                  	BR	36$
    1255 141532 000167  133754'         34$:	JMP	STAR
    1256 141536 010246                  RENPAP:	MOV	R2,-(SP)
    1257 141540 010146                  	MOV	R1,-(SP)
    1258 141542 010346                  	MOV	R3,-(SP)
    1259 141544 104512                  	TRAP	112
    1260 141546 160016                  	SUB	R0,@SP
    1261 141550 005216                  	INC	@SP		;R3/SK. ILGIS +1/
    1262 141552 104511                  	TRAP	111
    1263 141554 000416                  	BR	3$
    1264 141556 020102                  	CMP	R1,R2
    1265 141560 101004                  	BHI	1$
    1266 141562 016167  177776  002044' 	MOV	-2(R1),NUMBER
    1267 141570 000403                  	BR	2$
    1268 141572 016167  000002  002044' 1$:	MOV	2(R1),NUMBER
    1269 141600 012767  000200  002000' 2$:	MOV	#200,LYGIS
    1270 141606 104410                  	TRAP	10
    1271 141610 000422                  	BR	7$
    1272 141612 020402                  3$:	CMP	R4,R2
    1273 141614 101020                  	BHI	7$
    1274 141616 016405  177774          	MOV	-4(R4),R5
    1275 141622 004767  140574'         	CALL	IUNPCK
    1276 141626 160216                  	SUB	R2,@SP
    1277 141630 002420                  	BLT	8$
    1278 141632 005302                  4$:	DEC	R2
    1279 141634 001402                  	BEQ	5$		;EIL. NR. SUVESTI
    1280 141636 112120                  	MOVB	(R1)+,(R0)+
    1281 141640 000774                  	BR	4$
    1282 141642 005316                  5$:	DEC	@SP
    1283 141644 002403                  	BLT	6$
    1284 141646 112720  000040          	MOVB	#40,(R0)+
    1285 141652 000773                  	BR	5$
    1286 141654 010016                  6$:	MOV	R0,@SP
    1287 141656 012603                  7$:	MOV	(SP)+,R3
    1288 141660 012601                  	MOV	(SP)+,R1
    1289 141662 012602                  	MOV	(SP)+,R2
    1290 141664 005067  002000'         	CLR	LYGIS
    1291 141670 000207                  	RTS	PC
    1292 141672 005766  000010          8$:	TST	10(SP)
    1293 141676 001052                  	BNE	13$
    1294 141700 010004                  	MOV	R0,R4
    1295 141702 122427  000012          9$:	CMPB	(R4)+,#12
    1296 141706 001375                  	BNE	9$
    1297 141710 167604  000002          	SUB	@2(SP),R4
    1298 141714 161604                  	SUB	@SP,R4
    1299 141716 066704  002002'         	ADD	TXEND,R4
    1300 141722 026704  002024'         	CMP	TABTOP,R4
    1301 141726 103055                  	BHIS	15$		;OK
    1302 141730 166704  002002'         	SUB	TXEND,R4		;NE OK
    1303 141734 010446                  	MOV	R4,-(SP)
    1304 141736 004767  140716'         	CALL	GRBCOL
    1305 141742 012604                  	MOV	(SP)+,R4
    1306 141744 066704  002002'         	ADD	TXEND,R4
    1307 141750 026704  002024'         	CMP	TABTOP,R4
    1308 141754 101042                  	BHI	15$		;GERAI
    1309 141756 026666  000002  000004  10$:	CMP	2(SP),4(SP)
    1310 141764 101004                  	BHI	11$
    1311 141766 016167  177776  002044' 	MOV	-2(R1),NUMBER
    1312 141774 000403                  	BR	12$
    1313 141776 016167  000002  002044' 11$:	MOV	2(R1),NUMBER
    1314 142004 012767  000200  002000' 12$:	MOV	#200,LYGIS
    1315 142012 104407                  	TRAP	7
    1316 142014 062766  000002  000006  	ADD	#2,6(SP)
    1317 142022 000715                  	BR	7$
    1318 142024 011602                  13$:	MOV	@SP,R2
    1319 142026 005402                  	NEG	R2
    1320 142030 066702  002002'         	ADD	TXEND,R2
    1321 142034 026702  002024'         	CMP	TABTOP,R2
    1322 142040 103746                  	BLO	10$		;NETILPS
    1323 142042 016704  002002'         	MOV	TXEND,R4
    1324 142046 114442                  14$:	MOVB	-(R4),-(R2)
    1325 142050 020400                  	CMP	R4,R0
    1326 142052 001375                  	BNE	14$
    1327 142054 010001                  	MOV	R0,R1
    1328 142056 161601                  	SUB	@SP,R1
    1329 142060 000411                  	BR	17$
    1330 142062 017601  000002          15$:	MOV	@2(SP),R1
    1331 142066 016704  002002'         	MOV	TXEND,R4
    1332 142072 010476  000002          	MOV	R4,@2(SP)
    1333 142076 112124                  16$:	MOVB	(R1)+,(R4)+
    1334 142100 020100                  	CMP	R1,R0
    1335 142102 001375                  	BNE	16$
    1336 142104 012702  003022          17$:	MOV	#BUF,R2
    1337 142110 121227  000040          18$:	CMPB	@R2,#40
    1338 142114 001403                  	BEQ	19$
    1339 142116 112224                  	MOVB	(R2)+,(R4)+
    1340 142120 005201                  	INC	R1
    1341 142122 000772                  	BR	18$
    1342 142124 061601                  19$:	ADD	@SP,R1
    1343 142126 010416                  	MOV	R4,@SP
    1344 142130 111124                  20$:	MOVB	@R1,(R4)+
    1345 142132 122127  000012          	CMPB	(R1)+,#12
    1346 142136 001374                  	BNE	20$
    1347 142140 010467  002002'         	MOV	R4,TXEND
    1348 142144 005266  000010          	INC	10(SP)
    1349 142150 000642                  	BR	7$
    1350                                ;
    1351 142152 122710  000020          KODTST::CMPB	#20,@R0	;GOSUB
    1352 142156 001421                  	BEQ	12$
    1353 142160 122710  000022          	CMPB	#22,@R0	;GOTO
    1354 142164 001416                  	BEQ	12$
    1355 142166 122710  000052          	CMPB	#52,@R0	;RETURN
    1356 142172 001413                  	BEQ	12$
    1357 142174 122710  000074          	CMPB	#74,@R0	;RESTORE
    1358 142200 001410                  	BEQ	12$
    1359 142202 005725                  	TST	(5)+
    1360 142204 122710  000024          	CMPB	#24,@R0	;IF
    1361 142210 001404                  	BEQ	12$
    1362 142212 122710  000072          	CMPB	#72,@R0	;ON
    1363 142216 001401                  	BEQ	12$
    1364 142220 005725                  	TST	(5)+
    1365 142222 000205                  12$:	RTS	R5
    1366                                ;
    1367 142224 104502                  IFGAUD::TRAP	102
    1368 142226 000402                  	BR	25$
    1369 142230 000417                  	BR	21$		;RAIDE
    1370 142232 000425                  	BR	20$
    1371 142234 121327  000047          25$:	CMPB	@R3,#47
    1372 142240 001423                  	BEQ	23$
    1373 142242 121327  000042          	CMPB	@R3,#42
    1374 142246 001017                  	BNE	20$
    1375 142250 005203                  26$:	INC	R3
    1376 142252 121327  000012          	CMPB	@R3,#12
    1377 142256 001414                  	BEQ	23$
    1378 142260 121327  000042          	CMPB	@R3,#42
    1379 142264 001371                  	BNE	26$
    1380 142266 000407                  	BR	20$
    1381 142270 104513                  21$:	TRAP	113
    1382 142272 143262                  	.WORD	RWREN
    1383 142274    002                  	.BYTE	2
    1384 142275    016                  	.BYTE	16
    1385 142276 000403                  	BR	20$
    1386 142300 005705                  	TST	R5
    1387 142302 001402                  	BEQ	23$
    1388 142304 005722                  	TST	(2)+
    1389 142306 005722                  20$:	TST	(2)+
    1390 142310 000202                  23$:	RTS	R2
    1391                                ;
    1392                                ;MAXFL:	CMPB	(R3)+,#'=
    1393                                ;	BNE	1$
    1394                                ;	TRAP	110
    1395                                ;1$:	TRAP	2
    1396                                ;	TRAP	106
    1397                                ;	CMP	R5,#1
    1398                                ;	BHI	2$
    1399                                ;	MOV	R5,-(SP)
    1400                                ;	CALL	CLOALL
    1401                                ;	CLR	R2
    1402                                ;	MOV	#422,R4
    1403                                ;	MOV	MAXFIL,R1
    1404                                ;	SUB	@SP,R1
    1405                                ;	BEQ	3$
    1406                                ;	BPL	4$
    1407                                ;	NEG	R4
    1408                                ;	NEG	R1
    1409                                ;4$:	ADD	R4,R2
    1410                                ;	SOB	R1,4$
    1411                                ;	CALL	TABMOV
    1412                                ;	MOV	(SP)+,MAXFIL
    1413                                ;	CALL	CLRBUF
    1414                                ;3$:	CALL	CLRCOD
    1415                                ;	JMP	STAR
    1416                                ;2$:	TRAP	5
    1417                                ;
    1418                                	.END
    1418                                
       1                                ; .ENABLE LC
       2                                .GLOBL	ZONA,LIT,TAB,AT,LOCX,LOCY,LOC,GETARR,PLMI,PRSPEC,LMID,ERRS	;SPC
       3                                .GLOBL	IOUTSP,SOUTSP,DOUTSP,IFT,IFF,FORDBL,FORINT,SETST,PNTSAV,STACK
       4                                .GLOBL	NXSKIP,NEXINT,NEXDBL,NEXSNG,NEXCMP,NEXJMP,LIMIT,AUTOON
       5                                .GLOBL	HALT,NUMBER,DMOV,SMOV,IMOV,JMP,JSR,RTS,RTSTO,BEEP0	;BEEP1,BEEP2
       6                                .GLOBL	DCONST,ICONST,DXMOV,SXMOV,IXMOV,$XMOV,FCB,DATPTR,SEPAP
       7                                .GLOBL	GET,GETLIT,CLR,CLRSTR,CLRMEM,ENDCOD,TRUN,TREND,ADRHLT
       8                                .GLOBL	DVAR,SVAR,IVAR,TYPE,CINT,CDBL,CSNG,READV,PFACT,ASTAR
       9                                .GLOBL	ENDPRG,STAR,LENT,TABTOP,NEWLIN,LYGIS,POKJMP,OUTJMP,TMP,$SQUEE
      10                                .GLOBL	COLR,COLF,JCLS,SET,RESET,COLRET,LSTP,LSET,RECSET,BOXSET
      11                                .GLOBL	SPFORM,RSP,VIDSP,$PAINT,STP,CURCOR,USRTAB,$DEFUS,STRSIZ
      12                                .GLOBL	AOPSUB,AOPMON,OPRNAM,MIDMOV,NEWSTR,$KEY;KEYISV,KEYON,KEYOFF
      13                                .GLOBL	ONJSR,ONJMP,OPFOR,OPINP,OPOUT,CLOFIL,DEVICE,CLRDEV,DEVLP
      14                                .GLOBL	ANG1,ANG01,ANG2,ANG02,ASPINT,ASPDBL,ASPSNG,ASP0,$ARC
      15                                .GLOBL	INIPRP,USEROM,DFN,IFNRET,SFNRET,DFNRET,DATBEG,RESTV
      16                                ;.GLOBL	SWPD,SWPR,SWPI,SWSSI,SWSIS,SWSII
      17                                ;.GLOBL	$ERASE,APRL
      18                                ;.GLOBL	MTONV,MTOFFV
      19                                .GLOBL	$DRAW
      20                                ;
      21 142312 012711  162640          LPRINT::MOV	#DEVLP,(R1)
      22 142316 012146                  	MOV	(R1)+,-(SP)
      23 142320 000402                  	BR	PRI
      24                                ;
      25 142322 004267  146336'         PRINT::	JSR	R2,TSTFLN
      26 142326 005046                  PRI:	CLR	-(SP)
      27 142330 104522                  PR:	TRAP	122
      28 142332 000406                  	BR	10$
      29 142334 005067  002132'         	CLR	TMP
      30 142340 012721  156460          	MOV	#LIT,(R1)+
      31 142344 005016                  	CLR	@SP
      32 142346 000770                  	BR	PR
      33 142350 104512                  10$:	TRAP	112
      34 142352 104502                  	TRAP	102
      35 142354 000436                  	BR	59$
      36 142356 000411                  	BR	1$
      37 142360 104500                  2$:	TRAP	100
      38 142362 005016                  	CLR	@SP
      39 142364 116704  002034'         	MOVB	TYPE,R4
      40 142370 005204                  	INC	R4
      41 142372 006304                  	ASL	R4
      42 142374 016421  142556          	MOV	AOUTSP(R4),(R1)+
      43 142400 000753                  	BR	PR
      44 142402 010302                  1$:	MOV	R3,R2
      45 142404 104513                  	TRAP	113
      46 142406 143337  003003          	.WORD	RWPRIN,3003
      47 142412 000762                  	BR	2$
      48 142414 162705  000004          	SUB	#4,R5
      49 142420 002440                  	BLT	77$
      50 142422 005016                  	CLR	@SP
      51 142424 104527                  	TRAP	127
      52 142426 010502                  	MOV	R5,R2
      53 142430 104525                  	TRAP	125
      54 142432 005702                  	TST	R2
      55 142434 001002                  	BNE	5$
      56 142436 104526                  	TRAP	126
      57 142440 104525                  	TRAP	125
      58 142442 104530                  5$:	TRAP	130
      59 142444 016221  142552          	MOV	AFNPOZ(R2),(R1)+
      60 142450 000727                  	BR	PR
      61 142452 104501                  59$:	TRAP	101
      62 142454 147306                  	.WORD	PRSPEC
      63 142456 000401                  	BR	58$
      64 142460 000403                  	BR	57$
      65 142462 104501                  58$:	TRAP	101
      66 142464 147300                  	.WORD	PLMI
      67 142466 000402                  	BR	6$
      68 142470 005303                  57$:	DEC	R3
      69 142472 000732                  	BR	2$
      70 142474 121327  000073          6$:	CMPB	@R3,#';
      71 142500 001405                  	BEQ	7$
      72 142502 121327  000054          	CMPB	@R3,#',
      73 142506 001011                  	BNE	8$
      74 142510 012721  124344          	MOV	#ZONA,(R1)+
      75 142514 005216                  7$:	INC	@SP
      76 142516 005203                  	INC	R3
      77 142520 000703                  	BR	PR
      78 142522 010203                  77$:	MOV	R2,R3
      79 142524 020527  177776          	CMP	R5,#-2
      80 142530 001713                  	BEQ	2$
      81 142532 104506                  8$:	TRAP	106
      82 142534 005726                  	TST	(SP)+
      83 142536 001002                  	BNE	88$
      84 142540 012721  156770          	MOV	#NEWLIN,(R1)+
      85 142544 004267  146360'         88$:	JSR	R2,TSTFIL
      86 142550 000207                  REM::	RETURN
      87                                ;
      88 142552 124512  124420          AFNPOZ:	.WORD	AT,TAB;SPC
      89 142556 157070  157022  157014  AOUTSP:	.WORD	IOUTSP,DOUTSP,SOUTSP
      90                                ;
      91 142564 121327  000054          LOCATE::CMPB	@R3,#',
      92 142570 001416                  	BEQ	1$
      93 142572 104525                  	TRAP	125
      94 142574 104516                  11$:	TRAP	116
      95 142576 000416                  	BR	2$
      96 142600 004767  151062'         	CALL	CINT
      97 142604 012721  124512          	MOV	#AT,(R1)+
      98 142610 104516                  21$:	TRAP	116
      99 142612 000422                  	BR	3$
     100 142614 004767  151062'         	CALL	CINT
     101 142620 012721  124324          	MOV	#LOC,(R1)+
     102 142624 000546                  	BR	CEND1
     103                                ;
     104 142626 012721  124546          1$:	MOV	#LOCX,(R1)+
     105 142632 000760                  	BR	11$
     106 142634 012721  124420          2$:	MOV	#TAB,(R1)+
     107 142640 121327  000054          	CMPB	(R3),#',
     108 142644 001136                  	BNE	CEND1
     109 142646 005203                  	INC	R3
     110 142650 121327  000054          	CMPB	(R3),#',
     111 142654 001755                  	BEQ	21$
     112 142656 104430                  	TRAP	24.
     113 142660 121327  000054          3$:	CMPB	(R3),#',
     114 142664 001126                  	BNE	CEND1
     115 142666 104430                  	TRAP	24.
     116                                ;
     117 142670 005002                  LET::	CLR	R2
     118 142672 005004                  	CLR	R4
     119 142674 104507                  	TRAP	107
     120 142676 000413                  	BR	10$
     121 142700 022222                  	CMP	(R2)+,(R2)+
     122 142702 105767  002034'         	TSTB	TYPE
     123 142706 001402                  	BEQ	11$
     124 142710 100402                  	BMI	1$
     125 142712 005722                  	TST	(R2)+
     126 142714 005722                  11$:	TST	(R2)+
     127 142716 105705                  1$:	TSTB	R5
     128 142720 100413                  	BMI	15$
     129 142722 010446                  	MOV	R4,-(SP)
     130 142724 000412                  	BR	2$
     131 142726 005705                  10$:	TST	R5
     132 142730 001371                  	BNE	11$
     133 142732 004767  143074'         	CALL	TSTSQZ
     134 142736 005741                  	TST	-(R1)
     135 142740 004767  153756'         	CALL	LMID
     136 142744 012705  177777          	MOV	#-1,R5
     137 142750 005402                  15$:	NEG	R2
     138 142752 104512                  2$:	TRAP	112
     139 142754 122327  000075          	CMPB	(R3)+,#'=
     140 142760 001030                  	BNE	5$
     141 142762 005705                  	TST	R5
     142 142764 100012                  	BPL	22$
     143 142766 104515                  	TRAP	115
     144 142770 104415                  	TRAP	13.
     145 142772 005704                  	TST	R4
     146 142774 003014                  	BGT	33$
     147 142776 100402                  	BMI	3$
     148 143000 005702                  	TST	R2
     149 143002 001411                  	BEQ	33$
     150 143004 004767  143074'         3$:	CALL	TSTSQZ
     151 143010 000406                  	BR	33$
     152 143012 104500                  22$:	TRAP	100
     153 143014 010204                  	MOV	R2,R4
     154 143016 100001                  	BPL	20$
     155 143020 005404                  	NEG	R4
     156 143022 004774  143062          20$:	CALL	@ATCONV-4(R4)
     157 143026 016221  143054          33$:	MOV	AMOV(R2),(R1)+
     158 143032 005702                  	TST	R2
     159 143034 003442                  	BLE	CEND1
     160 143036 012621                  	MOV	(SP)+,(R1)+
     161 143040 000440                  	BR	CEND1
     162 143042 104402                  5$:	TRAP	2
     163                                ;
     164 143044 156276                  	.WORD					SXMOV	;-10
     165 143046 156304                  	.WORD				DXMOV		;-6
     166 143050 156324                  	.WORD			IXMOV			;-4
     167 143052 156256                  	.WORD		$XMOV				;-2
     168 143054 156354                  AMOV:	.WORD	MIDMOV					; 0
     169 143056 156330                  	.WORD		SMOV				;+2
     170 143060 156350                  	.WORD			IMOV			;+4
     171 143062 156334                  	.WORD				DMOV		;+6
     172 143064 156330                  	.WORD					SMOV	;+10
     173                                ;
     174 143066 151062  151134  151106  ATCONV::.WORD			CINT,	CDBL,	CSNG
     175                                ;
     176 143074 005767  002132'         TSTSQZ::TST	TMP
     177 143100 001004                  	BNE	1$
     178 143102 012721  160634          	MOV	#$SQUEE,(R1)+
     179 143106 005267  002132'         	INC	TMP
     180 143112 012721  156672          1$:	MOV	#NEWSTR,(R1)+
     181 143116 000207                  	RETURN
     182                                ;
     183 143120 104510                  RET::	TRAP	110
     184 143122 000403                  	BR	1$
     185 143124 012721  155702          	MOV	#RTSTO,(R1)+
     186 143130 000415                  	BR	TO1
     187 143132 012721  155722          1$:	MOV	#RTS,(R1)+
     188 143136 004767  143236'         	CALL	TSTLYG
     189 143142 104506                  CEND1:	TRAP	106
     190 143144 000207                  	RETURN
     191                                ;
     192 143146 012721  155526          GOSUB::	MOV	#JSR,(R1)+
     193 143152 000402                  	BR	TO
     194                                ;
     195 143154 012721  155560          GO::	MOV	#JMP,(R1)+
     196                                ;
     197 143160 104510                  TO:	TRAP	110
     198 143162 104402                  	TRAP	2
     199 143164 104506                  TO1:	TRAP	106
     200 143166 104511                  	TRAP	111
     201 143170 000401                  	BR	2$
     202 143172 104410                  	TRAP	8.
     203 143174 004767  143236'         2$:	CALL	TSTLYG
     204 143200 004067  135564'         	JSR	R0,SETST
     205 143204 000403                  	BR	5$
     206 143206 012721  143234          	MOV	#TOTO1,(1)+
     207 143212 000207                  	RETURN
     208 143214 011411                  5$:	MOV	@R4,@R1
     209 143216 026467  000004  002044' 	CMP	4(R4),NUMBER
     210 143224 101401                  	BLOS	1$
     211 143226 010114                  	MOV	R1,@R4
     212 143230 005721                  1$:	TST	(R1)+
     213 143232 000207                  	RETURN
     214 143234 154722                  TOTO1:	.WORD	ENDPRG
     215                                ;
     216 143236 105767  002000'         TSTLYG:	TSTB	LYGIS
     217 143242 001005                  	BNE	1$
     218 143244 005767  002032'         	TST	ERRS
     219 143250 001003                  	BNE	2$
     220 143252 005067  002046'             	CLR	ADRHLT
     221 143256 000207                  1$:	RETURN
     222 143260 104421                  2$:	TRAP	17.
     223                                ;
     224 143262    122     105     115  RWREN::	.ASCII	/REM /
         143265    040                  
     225 143266    122     105     124  	.ASCII	/RETURN /
         143271    125     122     116  
         143274    040                  
     226 143275    116     105     130  	.ASCII	/NEXT /
         143300    124     040          
     227 143302    122     105     123  	.ASCII	/RESTORE /
         143305    124     117     122  
         143310    105     040          
     228 143312    107     117     123  RWON:	.ASCII	/GOSUB /
         143315    125     102     040  
     229 143320    107     117     124  RWIF:	.ASCII	/GOTO /
         143323    117     040          
     230 143325    124     110     105  	.ASCII	/THEN /
         143330    116     040          
     231 143332    105     114     123  	.ASCII	/ELSE /
         143335    105     040          
     232 143337    105     114     040  RWPRIN:	.ASCII	/EL /
     233 143342    101     124     116  	.ASCII	/ATN /
         143345    040                  
     234 143346    101     124     040  	.ASCII	/AT /
     235 143351    124     101     102  	.ASCII	/TAB /
         143354    040                  
     236                                ;	.ASCII	/SPC /
     237 143355    124     117     040  RWFOR:	.ASCII	/TO /
     238 143360    123     124     105  	.ASCII	/STEP /
         143363    120     040          
     239 143365    117     125     124  RWOPEN:	.ASCII	/OUTPUT INPUT /
         143370    120     125     124  
         143373    040     111     116  
         143376    120     125     124  
         143401    040                  
     240 143402    101     123     040  	.ASCII	/AS /
     241 143405    125     123     122  RWDEF:	.ASCII	/USR /
         143410    040                  
     242 143411    106     116     040  	.ASCII	/FN /
     243                                ;	.ASCII	/STR /
     244                                ;	.ASCII	/SNG /
     245                                ;	.ASCII	/DBL /
     246                                ;	.ASCII	/INT /
     247                                ;RWKEY:	.ASCII	/LIST /
     248                                ;RWMOT:	.ASCII	/ON /
     249                                ;	.ASCII	/OFF /
     250 143414    102     040     102  RWLINE:	.ASCII	/B BF /
         143417    106     040          
     251 143421    000                  	.EVEN
     252                                ;
     253 143422 104500                  IF::	TRAP	100
     254 143424 004767  151062'         	CALL	CINT
     255 143430 104513                  	TRAP	113	;THEN,GOTO?
     256 143432 143320  001002          	.WORD	RWIF,1002
     257 143436 104402                  	TRAP	2
     258 143440 104502                  	TRAP	102
     259 143442 000411                  	BR	6$
     260 143444 000410                  	BR	6$
     261 143446 012721  155376          	MOV	#IFT,(R1)+	;THEN <LINE NUMBER>
     262 143452 010046                  	MOV	R0,-(SP)
     263 143454 005000                  	CLR	R0
     264 143456 004767  143160'         	CALL	TO
     265 143462 005046                  	CLR	-(SP)
     266 143464 000415                  	BR	5$
     267 143466 012721  155404          6$:	MOV	#IFF,(R1)+	;THEN	<STATMENT>
     268 143472 010046                  	MOV	R0,-(SP)
     269 143474 010146                  	MOV	R1,-(SP)
     270 143476 104513                  	TRAP	113
     271 143500 132733                  	.WORD	OPRNAM
     272 143502    002     122          	.BYTE	2,AOPMON-AOPSUB-2
     273 143504 005005                  	CLR	R5
     274 143506 005721                  	TST	(R1)+
     275 143510 005000                  	CLR	R0
     276 143512 004775  133564          	CALL	@AOPSUB(R5)
     277 143516 005002                  	CLR	R2
     278 143520 104513                  5$:	TRAP	113
     279 143522 143332  000002          	.WORD	RWIF+12,2	;ELSE?
     280 143526 000424                  	BR	62$
     281 143530 104502                  	TRAP	102
     282 143532 000404                  	BR	50$
     283 143534 000403                  	BR	50$
     284 143536 012705  000022          	MOV	#22,R5
     285 143542 000404                  	BR	55$
     286 143544 104513                  50$:	TRAP	113
     287 143546 132733                  	.WORD	OPRNAM
     288 143550    002     122          	.BYTE	2,AOPMON-AOPSUB-2
     289 143552 005005                  	CLR	R5
     290 143554 005716                  55$:	TST	@SP
     291 143556 001406                  	BEQ	4$
     292 143560 012721  155560          	MOV	#JMP,(R1)+
     293 143564 010102                  	MOV	R1,R2
     294 143566 005721                  	TST	(R1)+
     295 143570 010136                  	MOV	R1,@(SP)+
     296 143572 010246                  	MOV	R2,-(SP)
     297 143574 004775  133564          4$:	CALL	@AOPSUB(R5)
     298 143600 012600                  62$:	MOV	(SP)+,R0
     299 143602 001401                  	BEQ	7$
     300 143604 010110                  	MOV	R1,@R0
     301 143606 012600                  7$:	MOV	(SP)+,R0
     302 143610 000167  144160'         	JMP	CEND
     303                                ;
     304 000001                         .IF EQ,1
     305                                MOTOR::	TRAP	113
     306                                	.WORD	RWMOT
     307                                	.BYTE	2,2
     308                                	TRAP	2
     309                                	TST	R5
     310                                	BNE	1$
     311                                	MOV	#MTONV,(1)+
     312                                	BR	2$
     313                                1$:	MOV	#MTOFFV,(1)+
     314                                2$:	BR	CEND
     315                                .ENDC
     316                                ;
     317 143614 005004                  FOR::	CLR	R4
     318 143616 104507                  	TRAP	107
     319 143620 104415                  	TRAP	13.
     320 143622 105705                  	TSTB	R5
     321 143624 100473                  	BMI	SYNERR
     322 143626 104512                  	TRAP	112
     323 143630 122327  000075          	CMPB	(R3)+,#'=
     324 143634 001067                  	BNE	SYNERR
     325 143636 010446                  	MOV	R4,-(SP)
     326 143640 116702  002034'         	MOVB	TYPE,R2
     327 143644 005202                  	INC	R2
     328 143646 006302                  	ASL	R2
     329 143650 104500                  	TRAP	100
     330 143652 004772  143066          	CALL	@ATCONV(R2)
     331 143656 016221  143060          	MOV	AMOV+4(R2),(R1)+
     332 143662 011621                  	MOV	@SP,(R1)+
     333 143664 104513                  	TRAP	113
     334 143666 143355  000002          	.WORD	RWFOR,2
     335 143672 104402                  	TRAP	2
     336 143674 104500                  	TRAP	100
     337 143676 020227  000004          	CMP	R2,#4
     338 143702 001001                  	BNE	10$
     339 143704 005742                  	TST	-(R2)
     340 143706 004772  143066          10$:	CALL	@ATCONV(R2)
     341 143712 104513                  	TRAP	113
     342 143714 143360  000002          	.WORD	RWFOR+3,2
     343 143720 000416                  	BR	2$
     344 143722 104500                  	TRAP	100
     345 143724 004772  143066          	CALL	@ATCONV(R2)
     346 143730 016221  144016          1$:	MOV	AFOR(R2),(R1)+
     347 143734 012721  135216          	MOV	#ASTAR+2,(R1)+
     348 143740 012621                  	MOV	(SP)+,(R1)+
     349 143742 105767  002000'         	TSTB	LYGIS
     350 143746 001504                  	BEQ	CEND
     351 143750 010161  177774          	MOV	R1,-4(R1)
     352 143754 000501                  	BR	CEND
     353 143756 005702                  2$:	TST	R2
     354 143760 001410                  	BEQ	3$
     355 143762 012721  156152          	MOV	#DCONST,(R1)+
     356 143766 005021                  	CLR	(R1)+
     357 143770 005021                  	CLR	(R1)+
     358 143772 005021                  	CLR	(R1)+
     359 143774 012721  040200          	MOV	#40200,(R1)+
     360 144000 000753                  	BR	1$
     361 144002 012721  156160          3$:	MOV	#ICONST,(R1)+
     362 144006 012721  000001          	MOV	#1,(R1)+
     363 144012 000746                  	BR	1$
     364 144014 104402                  SYNERR:	TRAP	2
     365                                ;
     366 144016 156426  156404          AFOR:	.WORD	FORINT,FORDBL
     367                                ;
     368 144022 012721  156466          NEXT::	MOV	#NXSKIP,(R1)+
     369 144026 005004                  	CLR	R4
     370 144030 012767  000001  002034' 	MOV	#1,TYPE
     371 144036 121327  000012          	CMPB	@R3,#12
     372 144042 001404                  	BEQ	1$
     373 144044 104507                  	TRAP	107
     374 144046 104415                  	TRAP	13.
     375 144050 105705                  	TSTB	R5
     376 144052 100760                  	BMI	SYNERR
     377 144054 010421                  1$:	MOV	R4,(R1)+
     378 144056 116702  002034'         	MOVB	TYPE,R2
     379 144062 005202                  	INC	R2
     380 144064 006302                  	ASL	R2
     381 144066 016221  144124          	MOV	ANXADD(R2),(R1)+
     382 144072 162702  000002          	SUB	#2,R2
     383 144076 002404                  	BLT	2$
     384 144100 012721  155176          	MOV	#NEXCMP,(R1)+
     385 144104 012721  155466          	MOV	#NEXJMP,(R1)+
     386 144110 104512                  2$:	TRAP	112
     387 144112 122327  000054          	CMPB	(R3)+,#',
     388 144116 001741                  	BEQ	NEXT
     389 144120 005303                  	DEC	R3
     390 144122 000416                  	BR	CEND
     391                                ;
     392 144124 156572  156636  156544  ANXADD:	.WORD	NEXINT,NEXDBL,NEXSNG
     393                                ;
     394 144132 012721  154754          STOP::	MOV	#HALT,(R1)+
     395 144136 000410                  	BR	CEND
     396                                ;
     397 144140 012721  154722          END::	MOV	#ENDPRG,(R1)+
     398 144144 000405                  	BR	CEND
     399                                ;
     400 144146 012721  154626          TRON::	MOV	#TRUN,(R1)+
     401 144152 000402                  	BR	CEND
     402                                ;
     403 144154 012721  154674          TROFF::	MOV	#TREND,(R1)+
     404 144160 104506                  CEND:	TRAP	106
     405 144162 000207                  	RETURN
     406                                ;
     407 144164 010077  002040'         DATA::	MOV	R0,@DATPTR
     408 144170 010067  002040'         	MOV	R0,DATPTR
     409 144174 000207                  	RETURN
     410                                ;
     411 144176 105767  002000'         RESTOR::TSTB	LYGIS
     412 144202 001417                  	BEQ	3$
     413 144204 016721  002052'         	MOV	AUTOON,(1)+
     414 144210 010167  002052'         	MOV	R1,AUTOON
     415 144214 104510                  	TRAP 	110
     416 144216 000403                  	BR	1$
     417 144220 104511                  	TRAP	111
     418 144222 000404                  	BR	2$
     419 144224 104410                  	TRAP	8.
     420 144226 016704  002026'         1$:	MOV	FCB,R4
     421 144232 005744                  	TST	-(4)
     422 144234 005744                  2$:	TST	-(4)
     423 144236 010421                  	MOV	R4,(1)+
     424 144240 000747                  	BR	CEND
     425 144242 005767  002032'         3$:	TST	ERRS
     426 144246 001015                  	BNE	5$
     427 144250 012721  157114          	MOV	#RESTV,(R1)+
     428 144254 016721  002036'         	MOV	DATBEG,(R1)+
     429 144260 104510                  	TRAP	110
     430 144262 000736                  	BR	CEND
     431 144264 104511                  	TRAP	111
     432 144266 000401                  	BR	4$
     433 144270 104410                  	TRAP	8.
     434 144272 016461  177774  177776  4$:	MOV	-4(R4),-2(R1)
     435 144300 000727                  	BR	CEND
     436 144302 104404                  5$:	TRAP	4
     437                                ;
     438 144304 012721  160634          READ::	MOV	#$SQUEE,(R1)+
     439 144310 012721  157122          	MOV	#READV,(1)+
     440 144314 005046                  	CLR	-(SP)
     441 144316 000423                  	BR	INPENT
     442                                ;
     443 144320 012721  160634          INPUT::	MOV	#$SQUEE,(R1)+
     444 144324 104520                  	TRAP	120
     445 144326 000413                  	BR	10$
     446 144330 012721  156460          	MOV	#LIT,(R1)+
     447 144334 104512                  	TRAP	112
     448 144336 122327  000073          	CMPB	(R3)+,#';
     449 144342 001224                  	BNE	SYNERR
     450 144344 104512                  	TRAP	112
     451 144346 012721  157100          	MOV	#GETLIT,(R1)+
     452 144352 005046                  	CLR	-(SP)
     453 144354 000404                  	BR	INPENT
     454 144356 004267  146336'         10$:	JSR	R2,TSTFLN
     455 144362 012721  157150          	MOV	#GET,(R1)+
     456 144366 010146                  INPENT:	MOV	R1,-(SP)
     457 144370 005721                  	TST	(R1)+
     458 144372 005004                  1$:	CLR	R4
     459 144374 010146                  	MOV	R1,-(SP)
     460 144376 005721                  	TST	(R1)+
     461 144400 104507                  	TRAP	107
     462 144402 000240                  	NOP
     463 144404 105705                  	TSTB	R5
     464 144406 100414                  	BMI	2$
     465 144410 005705                  	TST	R5
     466 144412 001416                  	BEQ	4$
     467 144414 010436                  	MOV	R4,@(SP)+
     468 144416 104512                  3$:	TRAP	112
     469 144420 122327  000054          	CMPB	(R3)+,#',
     470 144424 001762                  	BEQ	1$
     471 144426 010136                  	MOV	R1,@(SP)+
     472 144430 005303                  	DEC	R3
     473 144432 004267  146360'         	JSR	R2,TSTFIL
     474 144436 000650                  	BR	CEND
     475 144440 012721  157712          2$:	MOV	#GETARR,(R1)+
     476 144444 010136                  	MOV	R1,@(SP)+
     477 144446 000763                  	BR	3$
     478 144450 104402                  4$:	TRAP	2
     479                                ;
     480 144452 121327  000012          CLEAR::	CMPB	@R3,#12
     481 144456 001423                  	BEQ	1$
     482 144460 121327  000054          	CMPB	@R3,#',
     483 144464 001005                  	BNE	3$
     484 144466 012721  156232          	MOV	#IVAR,(R1)+
     485 144472 012721  002006          	MOV	#STRSIZ,(R1)+
     486 144476 000401                  	BR	4$
     487 144500 104525                  3$:	TRAP	125
     488 144502 104516                  4$:	TRAP	116
     489 144504 000405                  	BR	2$
     490 144506 004767  151062'         	CALL	CINT
     491 144512 012721  160642          	MOV	#CLRMEM,(R1)+
     492 144516 000620                  	BR	CEND
     493 144520 012721  161032          2$:	MOV	#CLRSTR,(R1)+
     494 144524 000615                  	BR	CEND
     495 144526 012721  161076          1$:	MOV	#CLR,(R1)+
     496 144532 000612                  	BR	CEND
     497                                ;
     498 144534 012704  000010          DIM::	MOV	#10,R4
     499 144540 104507                  	TRAP	107
     500 144542 000240                  	NOP
     501 144544 005705                  1$:	TST	R5
     502 144546 001412                  	BEQ	4$
     503 144550 104512                  	TRAP	112
     504 144552 122327  000054          	CMPB	(R3)+,#',
     505 144556 001004                  	BNE	2$
     506 144560 105767  002000'         	TSTB	LYGIS
     507 144564 001363                  	BNE	DIM
     508 144566 104414                  	TRAP	12.
     509 144570 005303                  2$:	DEC	R3
     510 144572 000404                  	BR	CEND2
     511 144574 104402                  4$:	TRAP	2
     512 000001                         .IF EQ,1
     513                                ;
     514                                ERASE::	MOV	#$ERASE,(R1)+
     515                                	CLR	R2
     516                                5$:	TRAP	112
     517                                	TRAP	102
     518                                	BR	1$
     519                                	BR	2$
     520                                6$:	TRAP	2
     521                                2$:	TRAP	105
     522                                	TRAP	5
     523                                	TRAP	5
     524                                	NOP
     525                                	CLR	R2
     526                                	BIS	#200,R5
     527                                	TRAP	104
     528                                	MOV	R4,(R1)+
     529                                	TRAP	112
     530                                	CMPB	@R3,#',
     531                                	BNE	1$
     532                                	INC	R3
     533                                	INC	R2
     534                                	BR	5$
     535                                1$:	TST	R2
     536                                	BNE	6$
     537                                	CLR	(R1)+
     538                                	BR	CEND2
     539                                .ENDC
     540                                ;
     541 144576 104524                  POKE::	TRAP	124
     542 144600 012721  160536          	MOV	#POKJMP,(R1)+
     543 144604 104506                  CEND2:	TRAP	106
     544 144606 000207                  	RETURN
     545                                ;
     546 144610 104523                  OUT::	TRAP	123
     547 144612 012721  160542          	MOV	#OUTJMP,(R1)+
     548 144616 000772                  	BR	CEND2
     549                                ;
     550 144620 005002                  COLOR::	CLR	R2
     551 144622 122713  000054          	CMPB	#',,(R3)
     552 144626 001402                  	BEQ	1$
     553 144630 005202                  	INC	R2
     554 144632 104525                  	TRAP	125
     555 144634 104516                  1$:	TRAP	116
     556 144636 000404                  	BR	2$
     557 144640 004767  151062'         	CALL	CINT
     558                                ;	MOV	#SPFORM,(R1)+
     559 144644 012721  125172          	MOV	#COLF,(R1)+
     560 144650 005702                  2$:	TST	R2
     561 144652 001754                  	BEQ	CEND2
     562                                ;	MOV	#SPFORM,(R1)+
     563 144654 012721  125242          	MOV	#COLR,(R1)+
     564 144660 000751                  	BR	CEND2
     565                                ;
     566                                BEEP::;	CLR	R2
     567                                ;	CMPB	@R3,#12
     568                                ;	BEQ	1$
     569                                ;	TST	(R2)+
     570                                ;	TRAP	125
     571                                ;	TRAP	116
     572                                ;	TST	(R2)+
     573                                ;	CALL	CINT
     574 144662 012721  156762          1$:	MOV	#BEEP0,(R1)+	;	ABEEP(R2),(R1)+
     575 144666 000746                  	BR	CEND2
     576                                ;
     577                                ;ABEEP:	.WORD	BEEP0,	BEEP2,	BEEP1
     578                                ;
     579 144670 012721  156776          CLS::	MOV	#JCLS,(R1)+
     580 144674 000743                  	BR	CEND2
     581                                ;
     582 144676 005002                  PSET::	CLR	R2
     583 144700 000402                  	BR	C_PNT
     584 144702 012702  000002          PRESET::MOV	#2,R2
     585 144706 004767  145136'         C_PNT:	CALL	KOORD
     586 144712 104516                  	TRAP	116
     587 144714 000411                  	BR	6$
     588 144716 004767  151062'         	CALL	CINT
     589                                ;	MOV	#SPFORM,(R1)+
     590 144722 012721  125242          	MOV	#COLR,(R1)+
     591 144726 012721  125410          	MOV	#SET,(R1)+
     592 144732 012721  125220          	MOV	#COLRET,(R1)+
     593 144736 000402                  	BR	7$
     594 144740 016221  144750          6$:	MOV	APOINT(R2),(R1)+
     595 144744 104506                  7$:	TRAP	106
     596 144746 000207                  	RETURN
     597 144750 125410  125422          APOINT:	.WORD	SET,RESET
     598                                ;
     599 144754 121327  000055          LINE::	CMPB	(R3),#'-
     600 144760 001403                  	BEQ	1$
     601 144762 004767  145136'         	CALL	KOORD
     602 144766 000402                  	BR	2$
     603 144770 012721  125272          1$:	MOV	#CURCOR,(R1)+
     604 144774 122327  000055          2$:	CMPB	(R3)+,#'-
     605 145000 001035                  	BNE	SYNER3
     606 145002 104512                  	TRAP	112
     607 145004 004767  145136'         	CALL	KOORD
     608 145010 005704                  	TST	R4
     609 145012 001403                  	BEQ	4$
     610 145014 012761  125320  177776  	MOV	#LSTP,-2(R1)
     611 145022 005002                  4$:	CLR	R2
     612 145024 104516                  	TRAP	116
     613 145026 000405                  	BR	5$
     614 145030 004767  151062'         	CALL	CINT
     615                                ;	MOV	#SPFORM,(R1)+
     616 145034 012721  125242          	MOV	#COLR,(R1)+
     617 145040 000406                  	BR	6$
     618 145042 005202                  5$:	INC	R2
     619 145044 121327  000054          	CMPB	(R3),#',
     620 145050 001017                  	BNE	L7
     621 145052 005203                  	INC	R3
     622 145054 104512                  	TRAP	112
     623 145056 121327  000054          6$:	CMPB	(R3),#',
     624 145062 001012                  	BNE	L7
     625 145064 005203                  	INC	R3
     626 145066 104513                  	TRAP	113
     627 145070 143414                  	.WORD	RWLINE
     628 145072    002     002          	.BYTE	2,2
     629 145074 104402                  SYNER3:	TRAP	2
     630 145076 060507                  	ADD	R5,PC
     631 145100 000406                  	BR	L8
     632 145102 012721  125522          	MOV	#BOXSET,(R1)+
     633 145106 000405                  	BR	L9
     634 145110 012721  125426          L7:	MOV	#LSET,(R1)+
     635 145114 000402                  	BR	L9
     636 145116 012721  125454          L8:	MOV	#RECSET,(R1)+
     637 145122 005702                  L9:	TST	R2
     638 145124 001002                  	BNE	10$
     639 145126 012721  125220          	MOV	#COLRET,(R1)+
     640 145132 104506                  10$:	TRAP	106
     641 145134 000207                  	RETURN
     642                                ;
     643 145136 005046                  KOORD:	CLR	-(SP)
     644 145140 122327  000100          	CMPB	(R3)+,#'@
     645 145144 001405                  	BEQ	1$
     646 145146 005303                  	DEC	R3
     647 145150 104513                  	TRAP	113
     648 145152 143360                  	.WORD	RWFOR+3
     649 145154    002     000          	.BYTE	2,0
     650 145156 000401                  	BR	3$
     651 145160 005216                  1$:	INC	@SP
     652 145162 104527                  3$:	TRAP	127
     653 145164 104524                  	TRAP	124
     654 145166 104530                  	TRAP	130
     655 145170 012604                  	MOV	(SP)+,R4
     656 145172 001402                  	BEQ	8$
     657 145174 012721  125304          	MOV	#STP,(R1)+
     658 145200 000207                  8$:	RETURN
     659                                ;
     660 000000                         .IF EQ,0
     661 145202 104515                  DRAW::	TRAP	115
     662 145204 104405                  	TRAP	5
     663 145206 104506                  	TRAP	106
     664 145210 012721  131412          	MOV	#$DRAW,(R1)+
     665 145214 000207                  	RETURN
     666                                .ENDC
     667                                ;
     668 145216 004767  145136'         PAINT::	CALL	KOORD
     669 145222 005002                  	CLR	R2
     670 145224 004767  145266'         	CALL	SPL
     671 145230 004767  145266'         	CALL	SPL
     672 145234 024127  125376          	CMP	-(R1),#RSP
     673 145240 001002                  	BNE	10$
     674 145242 012711  125404          	MOV	#VIDSP,@R1
     675 145246 005721                  10$:	TST	(R1)+
     676 145250 104506                  	TRAP	106
     677 145252 005702                  	TST	R2
     678 145254 001401                  	BEQ	5$
     679 145256 104430                  	TRAP	24.
     680 145260 012721  125642          5$:	MOV	#$PAINT,(R1)+
     681 145264 000207                  	RETURN
     682                                ;
     683 145266 104516                  SPL:	TRAP	116
     684 145270 000406                  	BR	1$
     685 145272 004767  151062'         	CALL	CINT
     686 145276 012721  125334          	MOV	#SPFORM,(R1)+
     687 145302 005002                  	CLR	R2
     688 145304 000407                  	BR	2$
     689 145306 012721  125376          1$:	MOV	#RSP,(R1)+
     690 145312 121327  000054          	CMPB	@R3,#',
     691 145316 001002                  	BNE	2$
     692 145320 005203                  	INC	R3
     693 145322 005202                  	INC	R2
     694 145324 000207                  2$:	RETURN
     695                                ;
     696                                KEY::;	TRAP	113
     697                                ;	.WORD	RWKEY
     698                                ;	.BYTE	2,4
     699                                ;	BR	3$
     700                                ;	MOV	KEYTAB(R5),(R1)+
     701                                ;	BR	KEY4
     702 145326 104525                  3$:	TRAP	125
     703 145330 122327  000054          	CMPB	(R3)+,#',
     704 145334 001257                  	BNE	SYNER3
     705 145336 104515                  	TRAP	115
     706 145340 104415                  KEY3:	TRAP	13.
     707 145342 012721  124570          	MOV	#$KEY,(R1)+
     708 145346 104506                  KEY4:	TRAP	106
     709 145350 000207                  	RETURN
     710                                ;KEYTAB::.WORD	KEYISV,KEYON,KEYOFF
     711                                ;
     712 000001                         .IF EQ,1
     713                                SWAP::	JSR	R2,SWARG
     714                                	TRAP	126
     715                                	JSR	R2,SWARG
     716                                	CMP	(SP)+,2(SP)
     717                                	BNE	KEY3
     718                                	MOV	(SP)+,R5
     719                                	BMI	2$
     720                                	MOVB	(SP)+,R4
     721                                	INC	R4
     722                                	ASL	R4
     723                                	MOV	SWADR(4),(1)+
     724                                	TST	(SP)+
     725                                	BR	KEY4
     726                                2$:	TST	(SP)+
     727                                	TSTB	R5
     728                                	BMI	3$
     729                                	TSTB	(SP)+
     730                                	BMI	4$
     731                                	MOV	#SWPR,(1)+
     732                                	BR	KEY4
     733                                4$:	MOV	#SWSIS,(1)+
     734                                	BR	KEY4
     735                                3$:	TSTB	(SP)+
     736                                	BMI	5$
     737                                	MOV	#SWSSI,(1)+
     738                                	BR	KEY4
     739                                5$:	MOV	#SWSII,(1)+
     740                                	BR	KEY4
     741                                ;
     742                                SWARG:	TST	(SP)+
     743                                	CLR	R4
     744                                	TRAP	107
     745                                	BR	1$
     746                                3$:	TSTB	R5
     747                                	BMI	2$
     748                                	MOV	#ICONST,(1)+
     749                                	MOV	R4,(1)+
     750                                2$:	MOV	R5,-(SP)
     751                                	MOV	TYPE,-(SP)
     752                                	MOV	R2,PC
     753                                1$:	TST	R5
     754                                	BNE	3$
     755                                	TRAP	2
     756                                ;
     757                                SWADR:	.WORD	SWPI
     758                                	.WORD	SWPD
     759                                	.WORD	SWPR
     760                                .ENDC
     761                                ;
     762 145352 004767  145136'         CIRCLE::CALL	KOORD
     763 145356 104516                  	TRAP	116
     764 145360 104402                  	TRAP	2
     765 145362 004767  151062'         	CALL	CINT
     766 145366 005002                  	CLR	R2
     767 145370 004767  145266'         	CALL	SPL
     768 145374 104516                  	TRAP	116
     769 145376 000406                  	BR	1$
     770 145400 004767  151134'         	CALL	CDBL
     771 145404 012721  126504          	MOV	#ANG1,(R1)+
     772 145410 005002                  	CLR	R2
     773 145412 000407                  	BR	2$
     774 145414 012721  126724          1$:	MOV	#ANG01,(R1)+
     775 145420 121327  000054          	CMPB	@R3,#',
     776 145424 001002                  	BNE	2$
     777 145426 005203                  	INC	R3
     778 145430 005202                  	INC	R2
     779 145432 104516                  2$:	TRAP	116
     780 145434 000406                  	BR	3$
     781 145436 004767  151134'         	CALL	CDBL
     782 145442 012721  126522          	MOV	#ANG2,(R1)+
     783 145446 005002                  	CLR	R2
     784 145450 000407                  	BR	4$
     785 145452 012721  126742          3$:	MOV	#ANG02,(R1)+
     786 145456 121327  000054          	CMPB	@R3,#',
     787 145462 001002                  	BNE	4$
     788 145464 005203                  	INC	R3
     789 145466 005202                  	INC	R2
     790 145470 104516                  4$:	TRAP	116
     791 145472 000410                  	BR	10$
     792 145474 116704  002034'         	MOVB	TYPE,R4
     793 145500 005204                  	INC	R4
     794 145502 006304                  	ASL	R4
     795 145504 016421  145550          	MOV	7$(R4),(R1)+
     796 145510 005002                  	CLR	R2
     797 145512 000407                  	BR	6$
     798 145514 012721  127122          10$:	MOV	#ASP0,(R1)+
     799 145520 121327  000054          	CMPB	@R3,#',
     800 145524 001002                  	BNE	6$
     801 145526 005203                  	INC	R3
     802 145530 005202                  	INC	R2
     803 145532 104506                  6$:	TRAP	106
     804 145534 005702                  	TST	R2
     805 145536 001401                  	BEQ	8$
     806 145540 104430                  	TRAP	24.
     807 145542 012721  127334          8$:	MOV	#$ARC,(R1)+
     808 145546 000207                  	RETURN
     809 145550 126760  126766  126772  7$:	.WORD	ASPINT,ASPDBL,ASPSNG
     810                                ;
     811 145556 104513                  DEF::	TRAP	113
     812 145560 143405                  	.WORD	RWDEF
     813 145562    003     002          	.BYTE	3,2	;12 SU DEFTYP
     814 145564 104402                  DEFERR:	TRAP	2
     815 145566 104512                  DEFUSR:	TRAP	112
     816 145570 104502                  	TRAP	102
     817 145572 000423                  	BR	1$
     818 145574 000424                  	BR	DEFFN
     819 145576 112302                  	MOVB	(R3)+,R2
     820 145600 162702  000060          	SUB	#'0,R2
     821 145604 006302                  	ASL	R2
     822 145606 005705                  2$:	TST	R5
     823 145610 001365                  	BNE	DEFERR
     824 145612 062702  002100          	ADD	#USRTAB,R2
     825 145616 104512                  	TRAP	112
     826 145620 122327  000075          	CMPB	(R3)+,#'=
     827 145624 001357                  	BNE	DEFERR
     828 145626 104525                  	TRAP	125
     829 145630 104506                  	TRAP	106
     830 145632 012721  162354          	MOV	#$DEFUS,(R1)+
     831 145636 010221                  	MOV	R2,(R1)+
     832 145640 000207                  	RETURN
     833 145642 005002                  1$:	CLR	R2
     834 145644 000760                  	BR	2$
     835                                ;
     836 145646 005705                  DEFFN:	TST	R5		;SUB #2 SU DEFTYP
     837 145650 001745                  	BEQ	DEFERR		;BMI	SU DEFTYP
     838                                ;	BGT	DEFTYP		;	SU DEFTYP
     839 145652 105767  002000'         	TSTB	LYGIS
     840 145656 001001                  	BNE	11$
     841 145660 104414                  	TRAP	12.
     842 145662 012721  156022          11$:	MOV	#DFN,(R1)+
     843 145666 010046                  	MOV	R0,-(SP)
     844 145670 010146                  	MOV	R1,-(SP)
     845 145672 005721                  	TST	(R1)+
     846 145674 104505                  	TRAP	105
     847 145676 104402                  	TRAP	2
     848 145700 104402                  	TRAP	2
     849 145702 000240                  	NOP
     850 145704 052705  100100          	BIS	#100100,R5
     851 145710 016700  002034'         	MOV	TYPE,R0
     852 145714 012767  177777  002034' 	MOV	#-1,TYPE
     853 145722 104504                  	TRAP	104
     854 145724 010421                  	MOV	R4,(R1)+
     855 145726 005724                  	TST	(R4)+
     856 145730 010446                  	MOV	R4,-(SP)
     857 145732 005002                  	CLR	R2
     858 145734 005046                  	CLR	-(SP)
     859 145736 121327  000050          	CMPB	@R3,#'(
     860 145742 001034                  	BNE	6$
     861 145744 005203                  1$:	INC	R3
     862 145746 104502                  	TRAP	102
     863 145750 104402                  	TRAP	2
     864 145752 000401                  	BR	3$
     865 145754 104402                  2$:	TRAP	2
     866 145756 104505                  3$:	TRAP	105
     867 145760 104402                  	TRAP	2
     868 145762 104402                  	TRAP	2
     869 145764 000240                  	NOP
     870 145766 011604                  	MOV	@SP,R4
     871 145770 010546                  	MOV	R5,-(SP)
     872 145772 100405                  	BMI	4$
     873 145774 006105                  	ROL	R5
     874 145776 100404                  	BMI	5$
     875 146000 006105                  	ROL	R5
     876 146002 100401                  	BMI	4$
     877 146004 022424                  	CMP	(R4)+,(R4)+
     878 146006 005724                  4$:	TST	(R4)+
     879 146010 005724                  5$:	TST	(R4)+
     880 146012 016746  002034'         	MOV	TYPE,-(SP)
     881 146016 010446                  	MOV	R4,-(SP)
     882 146020 005202                  	INC	R2
     883 146022 104512                  	TRAP	112
     884 146024 121327  000054          	CMPB	@R3,#',
     885 146030 001745                  	BEQ	1$
     886 146032 104530                  	TRAP	130
     887 146034 010221                  6$:	MOV	R2,(R1)+
     888 146036 122327  000075          	CMPB	(R3)+,#'=
     889 146042 001344                  	BNE	2$
     890 146044 010667  002126'         	MOV	SP,PFACT
     891 146050 010146                  	MOV	R1,-(SP)
     892 146052 006302                  	ASL	R2
     893 146054 060201                  	ADD	R2,R1
     894 146056 005267  002132'         	INC	TMP
     895 146062 005700                  	TST	R0
     896 146064 100011                  	BPL	7$
     897 146066 104515                  	TRAP	115
     898 146070 104415                  	TRAP	13.
     899 146072 012700  000004          	MOV	#4,R0
     900 146076 005704                  	TST	R4
     901 146100 001011                  	BNE	8$
     902 146102 012721  156672          	MOV	#NEWSTR,(1)+
     903 146106 000406                  	BR	8$
     904 146110 104500                  7$:	TRAP	100
     905 146112 110000                  	MOVB	R0,R0
     906 146114 005200                  	INC	R0
     907 146116 006300                  	ASL	R0
     908 146120 004770  143066          	CALL	@ATCONV(R0)
     909 146124 005067  002126'         8$:	CLR	PFACT
     910 146130 012604                  	MOV	(SP)+,R4
     911 146132 005726                  9$:	TST	(SP)+
     912 146134 001403                  	BEQ	10$
     913 146136 012624                  	MOV	(SP)+,(R4)+
     914 146140 005726                  	TST	(SP)+
     915 146142 000773                  	BR	9$
     916 146144 016021  146162          10$:	MOV	ARET(R0),(R1)+
     917 146150 012621                  	MOV	(SP)+,(R1)+
     918 146152 010136                  	MOV	R1,@(SP)+
     919 146154 012600                  	MOV	(SP)+,R0
     920 146156 104506                  	TRAP	106
     921 146160 000207                  	RETURN
     922 146162 156014  155752  156006  ARET:	.WORD	IFNRET,DFNRET,SFNRET
     923                                ;
     924 000001                         .IF EQ,1
     925                                DEFTYP:	TST	-(R5)
     926                                10$:	TRAP	102
     927                                	TRAP	2
     928                                	BR	1$
     929                                	TRAP	2
     930                                1$:	MOVB	(R3)+,R2
     931                                	TRAP	112
     932                                	CMPB	@R3,#'-
     933                                	BNE	2$
     934                                	INC	R3
     935                                	TRAP	102
     936                                	TRAP	2
     937                                	BR	3$
     938                                	TRAP	2
     939                                3$:	INC	R3
     940                                	TRAP	112
     941                                2$:	SUB	R2,R4
     942                                	INC	R4
     943                                	BLOS	8$
     944                                5$:	ADD	#APRL-'A,R2
     945                                6$:	MOVB	R5,(R2)+
     946                                	SOB	R4,6$
     947                                	CMPB	(R3)+,#',
     948                                	BEQ	10$
     949                                	DEC	R3
     950                                	TRAP	106
     951                                	RETURN
     952                                8$:	TRAP	5
     953                                ;
     954                                .ENDC
     955                                ;
     956 146170 000000                  SUM2::	.WORD	0
     957                                ;
     958 146172 104500                  ON::	TRAP	100
     959 146174 004767  151062'         	CALL	CINT
     960 146200 104513                  	TRAP	113
     961 146202 143312                  	.WORD	RWON
     962 146204    003     002          	.BYTE	3,2
     963 146206 104402                  	TRAP	2
     964 146210 016521  146256          	MOV	ADRON(R5),(R1)+
     965 146214 010046                  	MOV	R0,-(SP)
     966 146216 005000                  	CLR	R0
     967 146220 005002                  	CLR	R2
     968 146222 010146                  	MOV	R1,-(SP)
     969 146224 005721                  	TST	(R1)+
     970 146226 004767  143160'         1$:	CALL	TO
     971 146232 005202                  	INC	R2
     972 146234 104512                  	TRAP	112
     973 146236 122327  000054          	CMPB	(R3)+,#',
     974 146242 001771                  	BEQ	1$
     975 146244 005303                  	DEC	R3
     976 146246 010236                  	MOV	R2,@(SP)+
     977 146250 012600                  	MOV	(SP)+,R0
     978 146252 104506                  	TRAP	106
     979 146254 000207                  	RETURN
     980                                ;
     981 146256 155614  155564          ADRON:	.WORD	ONJSR,ONJMP
     982                                ;
     983 146262 104515                  OPEN::	TRAP	115
     984 146264 104470                  	TRAP	56.
     985 146266 005002                  	CLR	R2
     986 146270 104513                  	TRAP	113
     987 146272 132771                  	.WORD	OPFOR
     988 146274    003     000          	.BYTE	3,0
     989 146276 000405                  	BR	1$
     990 146300 104513                  	TRAP	113
     991 146302 143365                  	.WORD	RWOPEN
     992 146304    006     002          	.BYTE	6,2
     993 146306 104402                  	TRAP	2
     994 146310 010502                  	MOV	R5,R2
     995                                1$:
     996                                ;	TRAP	113
     997                                ;	.WORD	RWOPEN+13.
     998                                ;	.BYTE	2,0
     999                                ;	BR	2$
    1000                                ;	CALL	FILNUM
    1001                                ;	BR	3$
    1002                                ;2$:	MOV	#ICONST,(R1)+
    1003                                ;	MOV	#1,(R1)+
    1004                                ;
    1005 146312 104506                  3$:	TRAP	106
    1006 146314 016221  146322          	MOV	OP(R2),(R1)+
    1007 146320 000207                  	RETURN
    1008                                ;
    1009 146322 162366  162360          OP:	.WORD	OPOUT,OPINP
    1010                                ;
    1011                                CLOSE::	
    1012                                ;	CLR	R2
    1013                                ;	CMPB	@R3,#12
    1014                                ;	BEQ	2$
    1015                                ;1$:	CALL	FILNUM
    1016                                ;	INC	R2
    1017                                ;	CMPB	(R3)+,#',
    1018                                ;	BEQ	1$
    1019                                ;	DEC	R3
    1020                                ;
    1021 146326 104506                  2$:	TRAP	106
    1022 146330 012721  162656          	MOV	#CLOFIL,(R1)+
    1023                                ;	MOV	R2,(R1)+
    1024 146334 000207                  	RETURN
    1025                                ;
    1026                                ;FILNUM:	TRAP	112
    1027                                ;	CMPB	@R3,#'#
    1028                                ;	BNE	1$
    1029                                ;	INC	R3
    1030                                ;1$:
    1031                                ;	TRAP	100
    1032                                ;	CALL	CINT
    1033                                ;	RETURN
    1034                                ;
    1035 146336 005016                  TSTFLN:	CLR	@SP
    1036 146340 121327  000043          	CMPB	@R3,#'#
    1037 146344 001004                  	BNE	1$
    1038 146346 005316                  	DEC	@SP
    1039 146350 005203                  	INC	R3
    1040                                ;	CALL	FILNUM
    1041                                ;	TRAP	126
    1042 146352 012721  162626          	MOV	#DEVICE,(R1)+
    1043 146356 010207                  1$:	MOV	R2,PC
    1044                                ;1$:	MOV	#INIPRP,(1)+	;PRINT SKAITIKLIS...
    1045                                ;	MOV	R2,PC
    1046                                ;
    1047 146360 005726                  TSTFIL:	TST	(SP)+
    1048 146362 005716                  	TST	@SP
    1049 146364 001402                  	BEQ	1$
    1050 146366 012721  162650          	MOV	#CLRDEV,(R1)+
    1051 146372 000202                  1$:	RTS	R2
    1052                                ;
    1053 146374 012721  124164          CALL::	MOV	#USEROM,(1)+
    1054 146400 010321                  	MOV	R3,(1)+
    1055 146402 000207                  	RETURN
    1056                                ;
    1057                                	.END
    1057                                
       1                                ;.ENABLE	LC
       2                                .GLOBL	DFRE,IFRE,$FRE,DLOCX,SLOCX,ILOCX,DLOCY,SLOCY,ILOCY
       3                                .GLOBL	FRE,SFRE,PEEK,LEN,INP,LOCX,LOCY,EOF			;INSTR
       4                                .GLOBL	ASC,VAL,SUM,SKIRT,SAND,POINT				;INSTR2
       5                                .GLOBL	LPOS,ILPOS,DLPOS,SLPOS
       6                                .GLOBL	$DADD$,$DSUB$,TMP,TSTSQZ
       7                                .GLOBL	$DDIV$,$DMUL$
       8                                .GLOBL	PI,RAN,$B91,$B93,$B95,$TAN,$B97,$B99
       9                                .GLOBL	$B103,$INT,$FIX,ABS,IABS,ISGN,DSGN,SSGN
      10                                .GLOBL	ISVEIL,NUMBER,ATLIN1,LNUM,ISV,DI,ID,SI,SD,IS,DS
      11                                .GLOBL	SEPAP,DVAR,SVAR,IVAR,DCONST,SCONST,ICONST
      12                                .GLOBL	APLMI,ADGDL,INEG,NEG,PACK,ADRHLT,AFUN,IRPS2,BREAK,BREAKW
      13                                .GLOBL	TABTOP,LENT,STAR,LYGIS,ERRS,SETST,DATINP,SAVJMP
      14                                .GLOBL	INDEX,ARRAY,ARR10,$USR,ISTR,DSTR,SSTR,BIN,OCT,HEX
      15                                .GLOBL	DXVAR,SXVAR,IXVAR,$XVAR,DCMP,SCMP,ICMP,$CMP,NOT,ADLOG,ADDRBR
      16                                .GLOBL	ATCONV,MOD,IDIV,$B103,$DMUL$,$B99,POW,BUFOUT
      17                                .GLOBL	FCB,INKEY,NEWSTR,CURLIN,STRREG,I1,TYPE,CIKL,STACK,LIMIT
      18                                .GLOBL	STR,STR2,IODEV,CONCAT,CHR,ALLSM,ALLSK	;SIGNAL
      19                                .GLOBL	FNST,FNCALL,DPAR,SPAR,IPAR,APAR,PFACT			;APRL
      20 146404 010046                  TRAP::	MOV	R0,-(SP)
      21 146406 010246                  	MOV	R2,-(SP)
      22 146410 016600  000004          	MOV	4(SP),R0
      23 146414 016002  177776          	MOV	-2(R0),R2
      24 146420 042702  177400          	BIC	#177400,R2
      25 146424 162702  000100          	SUB	#100,R2
      26 146430 002410                  	BLT	T_ERROR
      27 146432 006302                  	ASL	R2
      28 146434 004772  146716          	CALL	@ATRAP(R2)
      29 146440 010066  000004          	MOV	R0,4(SP)
      30                                T_TREND:
      31 146444 012602                  	MOV	(SP)+,R2
      32 146446 012600                  	MOV	(SP)+,R0
      33 146450 000002                  	RTI
      34                                ;
      35                                T_ERROR:
      36 146452 005067  003016'         	CLR	IODEV
      37 146456 010205                  	MOV	R2,R5
      38 146460 062705  000100          	ADD	#100,R5
      39                                ;	MOV	#400,R1
      40                                ;	MOV	#24,R2
      41                                ;	CALL	SIGNAL
      42 146464 012701  146706          	MOV	#ERR,R1
      43 146470 012702  000010          	MOV	#10,R2
      44 146474 004767  122560'         	CALL	ISVEIL
      45                                ;	MOV	#400,R1
      46                                ;	MOV	#37,R2
      47                                ;	CALL	SIGNAL
      48 146500 010502                  	MOV	R5,R2
      49 146502 104514                  	TRAP	114	;KEICIA R1,R3,R5(R4 NE)
      50 146504 005767  002000'         	TST	LYGIS
      51 146510 001461                  	BEQ	MONERR
      52 146512 100417                  	BMI	RUNERR
      53 146514 105767  002000'         	TSTB	LYGIS
      54 146520 001455                  	BEQ	MONERR
      55 146522 011767  002032'         	MOV	@PC,ERRS
      56 146526 016705  002044'         	MOV	NUMBER,R5
      57 146532 010567  002056'         	MOV	R5,CURLIN
      58 146536 004767  155100'         	CALL	ATLIN1
      59 146542 105767  002000'         	TSTB	LYGIS
      60 146546 100736                  	BMI	T_TREND
      61 146550 000445                  	BR	COMERR
      62 146552 120227  000015          RUNERR:	CMPB	R2,#13.
      63 146556 001003                  	BNE	10$
      64 146560 005767  002042'         	TST	DATINP
      65 146564 001443                  	BEQ	GETERR
      66 146566 005767  002134'         10$:	TST	SAVJMP
      67 146572 001404                  	BEQ	1$
      68 146574 016704  002134'         	MOV	SAVJMP,R4
      69 146600 005067  002134'         	CLR	SAVJMP
      70 146604 020467  002004'         1$:	CMP	R4,STRREG
      71 146610 101021                  	BHI	MONERR
      72 146612 004267  124022'         	JSR	R2,SEPAP
      73 146616 012737  125070  000004  	MOV	#IRPS2-10,@#BREAKW
      74 146624 004767  155070'         	CALL	LNUM
      75 146630 010267  002056'         	MOV	R2,CURLIN
      76                                ;	CMP	-(4),-(4)
      77                                ;	JSR	R0,SETST
      78                                ;	BR	2$
      79 146634 005067  002046'         	CLR	ADRHLT
      80                                ;	BR	3$
      81                                ;2$:	MOV	@R4,ADRHLT
      82 146640 005067  002000'         3$:	CLR	LYGIS
      83 146644 012737  120234  000004  	MOV	#BREAK,@#BREAKW
      84 146652 000404                  	BR	COMERR
      85 146654 012700  000012          MONERR::MOV	#12,R0
      86 146660 004767  122522'         	CALL	ISV
      87 146664 012706  002000          COMERR:	MOV	#STACK,SP
      88 146670 000167  133754'         COMER2:	JMP	STAR
      89 146674 012700  000012          GETERR:	MOV	#12,R0
      90 146700 004767  122522'         	CALL	ISV
      91 146704 000657                  	BR	T_TREND
      92                                ;
      93 146706    357     373     351  ERR:	.BYTE	357,373,351,342,353,341,40,7
         146711    342     353     341  
         146714    040     007          
      94                                	.EVEN
      95                                ;
      96 146716 147324                  ATRAP:	.WORD	T100
      97 146720 151646                  	.WORD	T101
      98 146722 151704                  	.WORD	T102
      99 146724 151760                  	.WORD	T103
     100 146726 152176                  	.WORD	T104
     101 146730 152422                  	.WORD	T105
     102 146732 152744                  	.WORD	T106
     103 146734 152774                  	.WORD	T107
     104 146736 153072                  	.WORD	T110
     105 146740 153154                  	.WORD	T111
     106 146742 153210                  	.WORD	T112
     107 146744 153222                  	.WORD	T113
     108 146746 153402                  	.WORD	T114
     109 146750 153420                  	.WORD	T115
     110 146752 154300                  	.WORD	T116
     111 146754 154346                  	.WORD	T117
     112 146756 154404                  	.WORD	T120
     113 146760 154460                  	.WORD	T121
     114 146762 154544                  	.WORD	T122
     115 146764 154570                  	.WORD	T123
     116 146766 154574                  	.WORD	T124
     117 146770 154600                  	.WORD	T125
     118 146772 154610                  	.WORD	T126
     119 146774 151046                  	.WORD	T127
     120 146776 151036                  	.WORD	T130
     121                                ;
     122 147000    115     117     104  RWMOD:	.ASCII	/MOD /
         147003    040                  
     123 147004    116     117     124  RWLOG:	.ASCII	/NOT IMP EQV XOR OR AND /
         147007    040     111     115  
         147012    120     040     105  
         147015    121     126     040  
         147020    130     117     122  
         147023    040     117     122  
         147026    040     101     116  
         147031    104     040          
     124 147033    120     111     040  FUN:	.ASCII	/PI POINT INP PEEK /
         147036    120     117     111  
         147041    116     124     040  
         147044    111     116     120  
         147047    040     120     105  
         147052    105     113     040  
     125 147055    122     116     104  	.ASCII	/RND SQR SIN COS TAN ATN /
         147060    040     123     121  
         147063    122     040     123  
         147066    111     116     040  
         147071    103     117     123  
         147074    040     124     101  
         147077    116     040     101  
         147102    124     116     040  
     126 147105    105     130     120  	.ASCII	/EXP LOG INT FIX ABS SGN CINT CDBL CSNG /
         147110    040     114     117  
         147113    107     040     111  
         147116    116     124     040  
         147121    106     111     130  
         147124    040     101     102  
         147127    123     040     123  
         147132    107     116     040  
         147135    103     111     116  
         147140    124     040     103  
         147143    104     102     114  
         147146    040     103     123  
         147151    116     107     040  
     127 147154    105     117     106  	.ASCII	/EOF CSRLIN POS LPOS FRE LEN ASC VAL /
         147157    040     103     123  
         147162    122     114     111  
         147165    116     040     120  
         147170    117     123     040  
         147173    114     120     117  
         147176    123     040     106  
         147201    122     105     040  
         147204    114     105     116  
         147207    040     101     123  
         147212    103     040     126  
         147215    101     114     040  
     128                                ;	.ASCII	/INSTR VARPTR /
     129 147220    125     123     122  	.ASCII	/USR FN /
         147223    040     106     116  
         147226    040                  
     130 147227    111     116     113  SFUN:	.ASCII	/INKEY MID STRING STR CHR BIN OCT HEX /
         147232    105     131     040  
         147235    115     111     104  
         147240    040     123     124  
         147243    122     111     116  
         147246    107     040     123  
         147251    124     122     040  
         147254    103     110     122  
         147257    040     102     111  
         147262    116     040     117  
         147265    103     124     040  
         147270    110     105     130  
         147273    040                  
     131 147274    075     076     074  RELAT:	.BYTE	'=,'>,'<,0
         147277    000                  
     132 147300    053     055     000  PLMI::	.BYTE	'+,'-,0
     133 147303    057     052     000  DGDL:	.BYTE	'/,'*,0
     134 147306    042                  PRSPEC::.BYTE	'"
     135 147307    046     056     050  SPECHR:	.BYTE	'&,'.,'(,0
         147312    000                  
     136 147313    102     117     110  TYPBOH:	.BYTE	'B,'O,'H,0
         147316    000                  
     137 147317    044     041     043  TYPCHR:	.BYTE	'$,'!,'#,'%,0
         147322    045     000          
     138                                	.EVEN
     139                                ;
     140 147324 012705  177777          T100:	MOV	#-1,R5
     141 147330 010546                  1$:	MOV	R5,-(SP)
     142 147332 004767  147404'         	CALL	SANT
     143 147336 104513                  	TRAP	113
     144 147340 147010                  	.WORD	RWLOG+4
     145 147342    003     010          	.BYTE	3,10
     146 147344 000414                  	BR	4$
     147 147346 004767  151062'         	CALL	CINT
     148 147352 020516                  2$:	CMP	R5,@SP
     149 147354 003365                  	BGT	1$
     150 147356 012602                  	MOV	(SP)+,R2
     151 147360 016221  162274          	MOV	ADLOG(R2),(R1)+
     152 147364 000772                  	BR	2$
     153 147366 004767  151062'         3$:	CALL	CINT
     154 147372 016221  162274          	MOV	ADLOG(R2),(R1)+
     155 147376 012602                  4$:	MOV	(SP)+,R2
     156 147400 002372                  	BGE	3$
     157 147402 000207                  	RETURN
     158                                ;
     159 147404 104512                  SANT:	TRAP	112
     160 147406 005046                  	CLR	-(SP)
     161 147410 104513                  	TRAP	113
     162 147412 147004  000003          	.WORD	RWLOG,3
     163 147416 005216                  	INC	@SP
     164 147420 016746  002132'         	MOV	TMP,-(SP)
     165 147424 104515                  	TRAP	115
     166 147426 000412                  	BR	1$
     167 147430 004767  147644'         	CALL	LYGOP
     168 147434 103401                  	BCS	10$
     169 147436 104515                  	TRAP	115
     170 147440 104415                  10$:	TRAP	13.
     171 147442 012667  002132'         	MOV	(SP)+,TMP
     172 147446 012721  155342          	MOV	#$CMP,(R1)+
     173 147452 000454                  	BR	7$
     174 147454 005726                  1$:	TST	(SP)+
     175 147456 004767  147702'         	CALL	SUDAT
     176 147462 004767  147644'         2$:	CALL	LYGOP
     177 147466 100454                  	BMI	8$
     178 147470 010246                  	MOV	R2,-(SP)
     179 147472 010146                  	MOV	R1,-(SP)
     180 147474 016746  002034'         	MOV	TYPE,-(SP)
     181 147500 004767  147702'         	CALL	SUDAT
     182 147504 116705  002034'         	MOVB	TYPE,R5
     183 147510 120516                  	CMPB	R5,@SP
     184 147512 001426                  	BEQ	5$
     185 147514 101017                  	BHI	4$
     186 147516 011667  002034'         	MOV	@SP,TYPE
     187 147522 010104                  	MOV	R1,R4
     188 147524 005724                  	TST	(R4)+
     189 147526 010416                  	MOV	R4,@SP
     190 147530 014144                  3$:	MOV	-(R1),-(R4)
     191 147532 020166  000002          	CMP	R1,2(SP)
     192 147536 101374                  	BHI	3$
     193 147540 005205                  	INC	R5
     194 147542 006305                  	ASL	R5
     195 147544 004775  143066          	CALL	@ATCONV(R5)
     196 147550 011601                  	MOV	@SP,R1
     197 147552 000410                  	BR	6$
     198 147554 111605                  4$:	MOVB	@SP,R5
     199 147556 005205                  	INC	R5
     200 147560 006305                  	ASL	R5
     201 147562 004775  143066          	CALL	@ATCONV(R5)
     202 147566 000402                  	BR	6$
     203 147570 005205                  5$:	INC	R5
     204 147572 006305                  	ASL	R5
     205 147574 016521  147636          6$:	MOV	ACMP(R5),(R1)+
     206 147600 022626                  	CMP	(SP)+,(SP)+
     207 147602 012602                  	MOV	(SP)+,R2
     208 147604 012767  000377  002034' 7$:	MOV	#377,TYPE
     209 147612 016221  155412          	MOV	ADDRBR (R2),(R1)+
     210 147616 000721                  	BR	2$
     211 147620 005726                  8$:	TST	(SP)+
     212 147622 001004                  	BNE	9$
     213 147624 004767  151062'         	CALL	CINT
     214 147630 012721  162306          	MOV	#NOT,(R1)+
     215 147634 000207                  9$:	RETURN
     216                                ;
     217 147636 155172  177034  155264  ACMP:	.WORD	ICMP,	DCMP,	SCMP
     218                                ;
     219 147644 104501                  LYGOP:	TRAP	101
     220 147646 147274                  	.WORD	RELAT
     221 147650 000411                  	BR	1$
     222 147652 010402                  	MOV	R4,R2
     223 147654 104501                  	TRAP	101
     224 147656 147274                  	.WORD	RELAT
     225 147660 000207                  	RETURN
     226 147662 020402                  	CMP	R4,R2
     227 147664 001405                  	BEQ	2$
     228 147666 022424                  	CMP	(R4)+,(R4)+
     229 147670 060402                  	ADD	R4,R2
     230 147672 000207                  	RETURN
     231 147674 005104                  1$:	COM	R4
     232 147676 000207                  	RETURN
     233 147700 104402                  2$:	TRAP	2
     234                                ;
     235 147702 004767  147776'         SUDAT:	CALL	LIEK
     236 147706 104501                  3$:	TRAP	101
     237 147710 147300                  	.WORD	PLMI
     238 147712 000207                  	RETURN
     239 147714 016746  002034'         	MOV	TYPE,-(SP)
     240 147720 010446                  	MOV	R4,-(SP)
     241 147722 004767  151134'         	CALL	CDBL
     242 147726 010146                  	MOV	R1,-(SP)
     243 147730 004767  147776'         	CALL	LIEK
     244 147734 012604                  	MOV	(SP)+,R4
     245 147736 012602                  	MOV	(SP)+,R2
     246 147740 105767  002034'         	TSTB	TYPE
     247 147744 100006                  	BPL	1$
     248 147746 105716                  	TSTB	@SP
     249 147750 100004                  	BPL	1$
     250 147752 004767  150330'         	CALL	SUSP
     251 147756 022222                  	CMP	(R2)+,(R2)+
     252 147760 000402                  	BR	2$
     253 147762 004767  151134'         1$:	CALL	CDBL
     254 147766 016221  152606          2$:	MOV	APLMI(R2),(R1)+
     255 147772 005726                  	TST	(SP)+
     256 147774 000744                  	BR	3$
     257                                ;
     258 147776 004767  150034'         LIEK:	CALL	SDAL
     259 150002 104513                  1$:	TRAP	113
     260 150004 147000                  	.WORD	RWMOD
     261 150006 000003                  	.WORD	3
     262 150010 000207                  	RETURN
     263 150012 004767  151062'         	CALL	CINT
     264 150016 004767  150034'         	CALL	SDAL
     265 150022 004767  151062'         	CALL	CINT
     266 150026 012721  162066          	MOV	#MOD,(R1)+
     267 150032 000763                  	BR	1$
     268                                ;
     269 150034 004767  150072'         SDAL:	CALL	T_DAUG
     270 150040 121327  000134          1$:	CMPB	@R3,#'\
     271 150044 001037                  	BNE	D3
     272 150046 005203                  	INC	R3
     273 150050 004767  151062'         	CALL	CINT
     274 150054 004767  150106'         	CALL	DAUG1
     275 150060 004767  151062'         	CALL	CINT
     276 150064 012721  162052          	MOV	#IDIV,(R1)+
     277 150070 000763                  	BR	1$
     278                                ;
     279 150072 005046                  T_DAUG:	CLR	-(SP)
     280 150074 104501                  	TRAP	101
     281 150076 147300                  	.WORD	PLMI
     282 150100 000403                  	BR	DAUG2
     283 150102 010416                  	MOV	R4,@SP
     284 150104 000401                  	BR	DAUG2
     285 150106 005046                  DAUG1:	CLR	-(SP)
     286 150110 004767  150232'         DAUG2:	CALL	LAIPS
     287 150114 005726                  	TST	(SP)+
     288 150116 001410                  	BEQ	D2
     289 150120 105767  002034'         	TSTB	TYPE
     290 150124 100003                  	BPL	D1
     291 150126 012721  166562          	MOV	#INEG,(R1)+
     292 150132 000402                  	BR	D2
     293 150134 012721  156750          D1:	MOV	#NEG,(R1)+
     294 150140 104501                  D2:	TRAP	101
     295 150142 147303                  	.WORD	DGDL
     296 150144 000207                  D3:	RETURN
     297 150146 016746  002034'         	MOV	TYPE,-(SP)
     298 150152 010446                  	MOV	R4,-(SP)
     299 150154 004767  151134'         	CALL	CDBL
     300 150160 010146                  	MOV	R1,-(SP)
     301 150162 004767  150232'         	CALL	LAIPS
     302 150166 012604                  	MOV	(SP)+,R4
     303 150170 012602                  	MOV	(SP)+,R2
     304 150172 001411                  	BEQ	1$
     305 150174 105767  002034'         	TSTB	TYPE
     306 150200 100006                  	BPL	1$
     307 150202 105716                  	TSTB	@SP
     308 150204 100004                  	BPL	1$
     309 150206 004767  150330'         	CALL	SUSP
     310 150212 005722                  	TST	(R2)+
     311 150214 000402                  	BR	2$
     312 150216 004767  151134'         1$:	CALL	CDBL
     313 150222 016221  152616          2$:	MOV	ADGDL(R2),(R1)+
     314 150226 005726                  	TST	(SP)+
     315 150230 000743                  	BR	D2
     316                                ;
     317 150232 004767  150346'         LAIPS:	CALL	OPER
     318 150236 121327  000136          1$:	CMPB	(R3),#'^
     319 150242 001340                  	BNE	D3
     320 150244 005203                  	INC	R3
     321 150246 004767  151134'         	CALL	CDBL
     322 150252 012721  173052          	MOV	#$B103,(R1)+	; LOG
     323 150256 010146                  	MOV	R1,-(SP)
     324 150260 004767  150346'         	CALL	OPER
     325 150264 012604                  	MOV	(SP)+,R4
     326 150266 105767  002034'         	TSTB	TYPE
     327 150272 100407                  	BMI	2$
     328 150274 004767  151134'         	CALL	CDBL
     329 150300 012721  170210          	MOV	#$DMUL$,(R1)+
     330 150304 012721  171762          	MOV	#$B99,(R1)+	;EXP
     331 150310 000752                  	BR	1$
     332 150312 004767  150330'         2$:	CALL	SUSP
     333 150316 012721  177134          	MOV	#POW,(R1)+
     334 150322 005067  002034'         	CLR	TYPE
     335 150326 000743                  	BR	1$
     336                                ;
     337 150330 010405                  SUSP:	MOV	R4,R5
     338 150332 005745                  	TST	-(R5)
     339 150334 012425                  3$:	MOV	(R4)+,(R5)+
     340 150336 020401                  	CMP	R4,R1
     341 150340 103775                  	BLO	3$
     342 150342 005741                  	TST	-(R1)
     343 150344 000207                  	RETURN
     344                                ;
     345 150346 004767  151370'         OPER:	CALL	CISLO
     346 150352 104430                  	TRAP	24.
     347 150354 000434                  	BR	3$
     348 150356 000431                  	BR	2$
     349 150360 010467  002034'         	MOV	R4,TYPE
     350 150364 100420                  	BMI	13$
     351 150366 001405                  	BEQ	11$
     352 150370 012721  156156          	MOV	#SCONST,(R1)+
     353 150374 022121                  	CMP	(R1)+,(R1)+
     354 150376 010104                  	MOV	R1,R4
     355 150400 000407                  	BR	12$
     356 150402 012721  156152          11$:	MOV	#DCONST,(R1)+
     357 150406 062701  000010          	ADD	#10,R1
     358 150412 010104                  	MOV	R1,R4
     359 150414 012644                  	MOV	(SP)+,-(R4)
     360 150416 012644                  	MOV	(SP)+,-(R4)
     361 150420 012644                  12$:	MOV	(SP)+,-(R4)
     362 150422 012644                  	MOV	(SP)+,-(R4)
     363 150424 000207                  	RETURN
     364 150426 012721  156160          13$:	MOV	#ICONST,(R1)+
     365 150432 010521                  	MOV	R5,(R1)+
     366 150434 105067  002035'         	CLRB	TYPE+1
     367 150440 000207                  	RETURN
     368 150442 000167  151034'         2$:	JMP	OP2
     369 150446 104505                  3$:	TRAP	105
     370 150450 000406                  	BR	31$
     371 150452 104415                  	TRAP	13.
     372 150454 104415                  	TRAP	13.
     373 150456 005004                  	CLR	R4
     374 150460 104521                  	TRAP	121
     375 150462 104503                  	TRAP	103
     376 150464 000207                  30$:	RETURN
     377 150466 020527  000066          31$:	CMP	R5,#66
     378 150472 002411                  	BLT	4$
     379                                ;	BEQ	34$	;VARPTR
     380 150474 016746  002132'         	MOV	TMP,-(SP)
     381 150500 004767  154032'         	CALL	USR	;USR
     382 150504 100403                  	BMI	32$
     383 150506 012667  002132'         	MOV	(SP)+,TMP
     384 150512 000207                  	RETURN
     385 150514 104415                  32$:	TRAP	13.
     386                                ;33$:	TRAP	5
     387                                ;34$:	TRAP	127	;VARPTR
     388                                ;	CLR	R4
     389                                ;	TRAP	107
     390                                ;	NOP
     391                                ;	TST	R5
     392                                ;	BEQ	33$
     393                                ;	MOV	#377,TYPE
     394                                ;	TSTB	R5
     395                                ;	BMI	35$
     396                                ;	MOV	#ICONST,(1)+
     397                                ;	MOV	R4,(1)+
     398                                ;35$:	JMP	OP3
     399 150516 010546                  4$:	MOV	R5,-(SP)
     400 150520 001534                  	BEQ	6$
     401 150522 020527  000046          	CMP	R5,#46		; SURISTA SU FUNKCIJOMIS
     402 150526 002471                  	BLT	5$
     403 150530 020527  000060          	CMP	R5,#60		; SURISTA SU FUNKCIJOMIS
     404 150534 002014                  	BGE	40$
     405 150536 105367  002034'         	DECB	TYPE
     406 150542 020527  000046          	CMP	R5,#46
     407 150546 001521                  	BEQ	6$
     408 150550 121327  000050          	CMPB	@R3,#'(
     409 150554 001116                  	BNE	6$
     410 150556 162705  000061          	SUB	#61,R5
     411 150562 006305                  	ASL	R5
     412 150564 060516                  	ADD	R5,@SP
     413 150566 062716  000032          40$:	ADD	#32,@SP
     414 150572 104527                  	TRAP	127
     415 150574 021627  000100          	CMP	@SP,#100		;SURISTA SU FUNKCIJOMIS
     416 150600 003011                  	BGT	42$
     417 150602 104500                  41$:	TRAP	100
     418 150604 116705  002034'         	MOVB	TYPE,R5
     419 150610 005205                  	INC	R5
     420 150612 160567  002034'         	SUB	R5,TYPE
     421 150616 006305                  	ASL	R5
     422 150620 061605                  	ADD	@SP,R5
     423 150622 000416                  	BR	46$
     424 150624 016746  002132'         42$:	MOV	TMP,-(SP)
     425 150630 104522                  	TRAP	122
     426 150632 000414                  	BR	47$
     427 150634 012667  002132'         	MOV	(SP)+,TMP
     428 150640 005067  002034'         	CLR	TYPE
     429 150644 021627  000116          	CMP	@SP,#116
     430 150650 001402                  	BEQ	45$
     431                                ;	BLT	44$
     432                                ;	TRAP	126
     433                                ;	TRAP	115
     434                                ;43$:	TRAP	13.
     435 150652 105367  002034'         44$:	DECB	TYPE
     436 150656 011605                  45$:	MOV	@SP,R5
     437 150660 104530                  46$:	TRAP	130
     438 150662 000453                  	BR	6$
     439 150664 005726                  47$:	TST	(SP)+
     440 150666 062716  000002          	ADD	#2,@SP
     441 150672 021627  000104          	CMP	@SP,#104
     442 150676 001741                  	BEQ	41$
     443                                ;	CMP	@SP,#122
     444 150700 001305                  	BNE	32$
     445                                ;	TRAP	125
     446                                ;	TRAP	126
     447                                ;	BR	42$
     448 150702 104524                  48$:	TRAP	124
     449 150704 000764                  	BR	45$
     450 150706 104525                  49$:	TRAP	125
     451 150710 000762                  	BR	45$
     452 150712 104527                  5$:	TRAP	127
     453 150714 020527  000006          	CMP	R5,#6
     454 150720 002770                  	BLT	48$
     455 150722 001771                  	BEQ	49$
     456 150724 104500                  	TRAP	100
     457 150726 104530                  	TRAP	130
     458 150730 011605                  	MOV	(SP),R5
     459 150732 020527  000026          	CMP	R5,#26
     460 150736 003423                  	BLE	52$
     461 150740 116704  002034'         	MOVB	TYPE,R4
     462 150744 005204                  	INC	R4
     463 150746 006304                  	ASL	R4
     464 150750 020527  000036          	CMP	R5,#36
     465 150754 003022                  	BGT	7$
     466 150756 001410                  	BEQ	51$
     467 150760 020527  000034          	CMP	R5,#34
     468 150764 001403                  	BEQ	50$
     469 150766 005704                  	TST	R4
     470 150770 001006                  	BNE	52$
     471 150772 000411                  	BR	60$
     472 150774 005704                  50$:	TST	R4
     473 150776 001005                  	BNE	6$
     474 151000 005724                  51$:	TST	(R4)+
     475 151002 060405                  	ADD	R4,R5
     476 151004 000402                  	BR	6$
     477 151006 004767  151134'         52$:	CALL	CDBL
     478 151012 016521  152624          6$:	MOV	AFUN(R5),(R1)+
     479 151016 005726                  60$:	TST	(SP)+
     480 151020 000207                  	RETURN
     481 151022 162705  000040          7$:	SUB	#40,R5
     482 151026 004775  143066          	CALL	@ATCONV(R5)
     483 151032 000771                  	BR	60$
     484 151034 104500                  OP2:	TRAP	100
     485                                T130:
     486 151036 122327  000051          OP3:	CMPB	(R3)+,#')
     487 151042 001405                  	BEQ	SKLUZ
     488 151044 104402                  OP4:	TRAP	2
     489                                ;
     490 151046 104512                  T127:	TRAP	112
     491 151050 122327  000050          	CMPB	(R3)+,#'(
     492 151054 001373                  	BNE	OP4
     493 151056 104512                  SKLUZ:	TRAP	112
     494 151060 000207                  	RETURN
     495                                ;
     496 151062 116704  002034'         CINT::	MOVB	TYPE,R4
     497 151066 002406                  	BLT	1$
     498 151070 006304                  	ASL	R4
     499 151072 016421  151166          	MOV	ACINT(R4),(R1)+
     500 151076 012767  000377  002034' 	MOV	#377,TYPE
     501 151104 000207                  1$:	RETURN
     502                                ;
     503 151106 116704  002034'         CSNG::	MOVB	TYPE,R4
     504 151112 003007                  	BGT	1$
     505 151114 005204                  	INC	R4
     506 151116 006304                  	ASL	R4
     507 151120 016421  151162          	MOV	ACSNG(R4),(R1)+
     508 151124 012767  000001  002034' 	MOV	#1,TYPE
     509 151132 000207                  1$:	RETURN
     510                                ;
     511 151134 116704  002034'         CDBL::	MOVB	TYPE,R4
     512 151140 001405                  	BEQ	1$
     513 151142 005204                  	INC	R4
     514 151144 016421  151156          	MOV	ACDBL(R4),(R1)+
     515 151150 005067  002034'         	CLR	TYPE
     516 151154 000207                  1$:	RETURN
     517                                ;
     518 151156 166646  166742          ACDBL:	.WORD	ID,SD
     519 151162 166656  162020          ACSNG:	.WORD	IS,DS
     520 151166 166760  166770          ACINT:	.WORD	DI,SI
     521 151172 151314  151254  151200  ABOH:	.WORD	CBIN,COCT,CHEX
     522                                ;
     523 151200 005005                  CHEX:	CLR	R5
     524 151202 104502                  6$:	TRAP	102
     525 151204 000422                  	BR	T_C1
     526 151206 000416                  	BR	7$
     527 151210 162704  000077          	SUB	#77,R4
     528 151214 062704  000017          8$:	ADD	#15.,R4
     529 151220 005203                  	INC	R3
     530 151222 020527  010000          	CMP	R5,#10000
     531 151226 103043                  	BHIS	C3
     532 151230 006305                  	ASL	R5
     533 151232 006105                  	ROL	R5
     534 151234 006105                  	ROL	R5
     535 151236 006105                  	ROL	R5
     536 151240 050405                  	BIS	R4,R5
     537 151242 000757                  	BR	6$
     538 151244 162704  000106          7$:	SUB	#'F,R4
     539 151250 003761                  	BLE	8$
     540 151252 000207                  T_C1:	RETURN
     541                                ;
     542 151254 005005                  COCT:	CLR	R5
     543 151256 111304                  5$:	MOVB	@R3,R4
     544 151260 162704  000060          	SUB	#60,R4
     545 151264 032704  177770          	BIT	#177770,R4
     546 151270 001370                  	BNE	T_C1
     547 151272 005203                  	INC	R3
     548 151274 006305                  	ASL	R5
     549 151276 103417                  	BCS	C3
     550 151300 006105                  	ROL	R5
     551 151302 103415                  	BCS	C3
     552 151304 006105                  	ROL	R5
     553 151306 103413                  	BCS	C3
     554 151310 050405                  	BIS	R4,R5
     555 151312 000761                  	BR	5$
     556                                ;
     557 151314 005005                  CBIN:	CLR	R5
     558 151316 111304                  2$:	MOVB	@R3,R4
     559 151320 162704  000060          	SUB	#60,R4
     560 151324 006004                  	ROR	R4
     561 151326 001351                  	BNE	T_C1
     562 151330 005203                  	INC	R3
     563 151332 006105                  	ROL	R5
     564 151334 103370                  	BCC	2$
     565 151336 104406                  C3:	TRAP	6
     566                                ;
     567                                ;
     568 151340 104502                  BOHPAP::TRAP	102
     569 151342 000401                  	BR	14$
     570 151344 000403                  	BR	11$
     571 151346 016604  000004          14$:	MOV	4(SP),R4
     572 151352 104402                  	TRAP	2
     573 151354 104501                  11$:	TRAP	101
     574 151356 147313                  	.WORD	TYPBOH
     575 151360 000772                  	BR	14$
     576 151362 004774  151172          	CALL	@ABOH(R4)
     577 151366 000207                  	RETURN
     578                                ;
     579 151370 012602                  CISLO::	MOV	(SP)+,R2
     580 151372 005722                  	TST	(R2)+
     581 151374 104501                  	TRAP	101
     582 151376 147307                  	.WORD	SPECHR
     583 151400 000413                  	BR	1$
     584 151402 060407                  	ADD	R4,PC
     585 151404 000403                  	BR	10$
     586 151406 000421                  	BR	13$
     587 151410 005722                  	TST	(R2)+
     588 151412 010207                  	MOV	R2,PC
     589 151414 004767  151340'         10$:	CALL	BOHPAP
     590 151420 012704  177777          12$:	MOV	#-1,R4
     591 151424 022222                  15$:	CMP	(R2)+,(R2)+
     592 151426 010207                  	MOV	R2,PC
     593 151430 104502                  1$:	TRAP	102
     594 151432 000402                  	BR	16$
     595 151434 010207                  	MOV	R2,PC
     596 151436 000406                  	BR	2$
     597 151440 005767  002000'         16$:	TST	LYGIS
     598 151444 100403                  	BMI	2$
     599 151446 005742                  	TST	-(R2)
     600 151450 010207                  	MOV	R2,PC
     601 151452 005303                  13$:	DEC	R3
     602 151454 010346                  2$:	MOV	R3,-(SP)
     603 151456 005046                  	CLR	-(SP)
     604 151460 104501                  	TRAP	101
     605 151462 147300                  	.WORD	PLMI
     606 151464 005404                  	NEG	R4
     607 151466 010416                  	MOV	R4,@SP
     608 151470 104517                  	TRAP	117
     609 151472 104501                  	TRAP	101
     610 151474 147320                  	.WORD	TYPCHR+1
     611 151476 005404                  	NEG	R4
     612 151500 020427  000002          	CMP	R4,#2
     613 151504 003423                  	BLE	20$
     614 151506 012604                  	MOV	(SP)+,R4
     615 151510 100401                  	BMI	21$
     616 151512 005216                  	INC	@SP
     617 151514 012603                  21$:	MOV	(SP)+,R3
     618 151516 010446                  	MOV	R4,-(SP)
     619 151520 104510                  	TRAP	110
     620 151522 005005                  	CLR	R5
     621 151524 104517                  	TRAP	117
     622 151526 005203                  	INC	R3
     623 151530 005705                  	TST	R5
     624 151532 100405                  	BMI	24$
     625 151534 005726                  	TST	(SP)+
     626 151536 003730                  	BLE	12$
     627 151540 005405                  26$:	NEG	R5
     628 151542 100726                  	BMI	12$
     629 151544 000402                  	BR	27$
     630 151546 005726                  24$:	TST	(SP)+
     631 151550 003373                  	BGT	26$
     632 151552 104406                  27$:	TRAP	6
     633 151554 010405                  20$:	MOV	R4,R5
     634 151556 005726                  	TST	(SP)+
     635 151560 011603                  	MOV	@SP,R3
     636 151562 012746  000500          	MOV	#500,-(SP)
     637 151566 004767  163702'         	CALL	PACK
     638 151572 005004                  	CLR	R4
     639 151574 006026                  	ROR	(SP)+
     640 151576 103406                  	BCS	23$
     641 151600 005705                  	TST	R5
     642 151602 001403                  	BEQ	22$
     643 151604 100707                  	BMI	15$
     644 151606 005203                  	INC	R3
     645 151610 000705                  	BR	15$
     646 151612 005203                  22$:	INC	R3
     647 151614 006166  000004          23$:	ROL	4(SP)
     648 151620 005566  000002          	ADC	2(SP)
     649 151624 005516                  	ADC	@SP
     650 151626 102751                  	BVS	27$
     651 151630 103750                  	BCS	27$
     652 151632 012666  000002          	MOV	(SP)+,2(SP)
     653 151636 012666  000002          	MOV	(SP)+,2(SP)
     654 151642 005204                  	INC	R4
     655 151644 000667                  	BR	15$
     656                                ;
     657 151646 104512                  T101:	TRAP	112
     658 151650 012002                  	MOV	(R0)+,R2
     659 151652 012704  177776          	MOV	#-2,R4
     660 151656 105712                  1$:	TSTB	@R2
     661 151660 001406                  	BEQ	2$
     662 151662 062704  000002          	ADD	#2,R4
     663 151666 122213                  	CMPB	(R2)+,@R3
     664 151670 001372                  	BNE	1$
     665 151672 005203                  	INC	R3
     666 151674 005720                  	TST	(R0)+
     667 151676 000207                  2$:	RETURN
     668                                ;
     669 151700 142713  000040          MZ:	BICB	#40,@R3
     670 151704 111304                  T102:	MOVB	@R3,R4
     671 151706 120427  000172          	CMPB	R4,#172
     672 151712 101021                  	BHI	2$
     673 151714 120427  000140          	CMPB	R4,#140
     674 151720 101367                  	BHI	MZ
     675 151722 120427  000132          	CMPB	R4,#132
     676 151726 101013                  	BHI	2$
     677 151730 120427  000100          	CMPB	R4,#100
     678 151734 101007                  	BHI	1$
     679 151736 120427  000071          	CMPB	R4,#71
     680 151742 101005                  	BHI	2$
     681 151744 120427  000060          	CMPB	R4,#60
     682 151750 103402                  	BLO	2$
     683 151752 005720                  	TST	(R0)+
     684 151754 005720                  1$:	TST	(R0)+
     685 151756 000207                  2$:	RETURN
     686                                ;
     687 151760 104512                  T103:	TRAP	112
     688 151762 005002                  	CLR	R2
     689 151764 121327  000050          	CMPB	@R3,#'(
     690 151770 001025                  	BNE	2$
     691 151772 010402                  	MOV	R4,R2
     692 151774 005722                  	TST	(R2)+
     693 151776 005203                  	INC	R3
     694 152000 016746  002034'         	MOV	TYPE,-(SP)
     695 152004 010546                  	MOV	R5,-(SP)
     696 152006 104525                  	TRAP	125
     697 152010 005046                  	CLR	-(SP)
     698 152012 104516                  6$:	TRAP	116
     699 152014 000404                  	BR	1$
     700 152016 005216                  	INC	@SP
     701 152020 004767  151062'         	CALL	CINT
     702 152024 000772                  	BR	6$
     703 152026 010204                  1$:	MOV	R2,R4
     704 152030 012602                  	MOV	(SP)+,R2
     705 152032 012605                  	MOV	(SP)+,R5
     706 152034 012667  002034'         	MOV	(SP)+,TYPE
     707 152040 104530                  	TRAP	130
     708 152042 000402                  	BR	8$
     709 152044 005704                  2$:	TST	R4
     710 152046 001406                  	BEQ	7$
     711 152050 052705  000200          8$:	BIS	#200,R5
     712 152054 005202                  	INC	R2
     713 152056 105367  002035'         	DECB	TYPE+1
     714 152062 000410                  	BR	4$
     715 152064 005705                  7$:	TST	R5
     716 152066 100406                  	BMI	4$
     717 152070 105767  002034'         	TSTB	TYPE
     718 152074 001402                  	BEQ	5$
     719 152076 100002                  	BPL	4$
     720 152100 005724                  	TST	(R4)+
     721 152102 022424                  5$:	CMP	(R4)+,(R4)+
     722 152104 016421  152152          4$:	MOV	AKINPP(R4),(R1)+
     723 152110 104504                  	TRAP	104
     724 152112 010421                  	MOV	R4,(R1)+
     725 152114 105705                  	TSTB	R5
     726 152116 100014                  	BPL	3$
     727 152120 010221                  	MOV	R2,(R1)+
     728 152122 012702  000006          	MOV	#6,R2
     729 152126 105267  002035'         	INCB	TYPE+1
     730 152132 100404                  	BMI	9$
     731 152134 116702  002034'         	MOVB	TYPE,R2
     732 152140 005202                  	INC	R2
     733 152142 006302                  	ASL	R2
     734 152144 016221  152166          9$:	MOV	AXKINP(R2),(R1)+
     735 152150 000207                  3$:	RETURN
     736                                ;
     737 152152 156214  160056  156170  AKINPP:	.WORD	SVAR,	INDEX,	DVAR,IVAR
         152160 156232                  
     738 152162 160222  160226          	.WORD	ARR10,	ARRAY
     739                                ;
     740 152166 156226  156164  156210  AXKINP:	.WORD	IXVAR,DXVAR,SXVAR,$XVAR
         152174 156236                  
     741                                ;
     742 152176 016704  002022'         T104:	MOV	LENT,R4
     743 152202 020467  002024'         1$:	CMP	R4,TABTOP
     744 152206 103016                  	BHIS	2$
     745 152210 012402                  	MOV	(R4)+,R2
     746 152212 020502                  	CMP	R5,R2
     747 152214 001474                  	BEQ	3$
     748 152216 105702                  	TSTB	R2
     749 152220 100406                  	BMI	10$
     750 152222 006102                  	ROL	R2
     751 152224 103404                  	BCS	10$
     752 152226 100404                  	BMI	11$
     753 152230 006102                  	ROL	R2
     754 152232 100401                  	BMI	10$
     755 152234 022424                  	CMP	(R4)+,(R4)+
     756 152236 005724                  10$:	TST	(R4)+
     757 152240 005724                  11$:	TST	(R4)+
     758 152242 000757                  	BR	1$
     759 152244 005767  002000'         2$:	TST	LYGIS
     760 152250 100461                  	BMI	50$
     761 152252 016704  002022'         	MOV	LENT,R4
     762 152256 162704  000006          	SUB	#6,R4
     763 152262 016702  002034'         	MOV	TYPE,R2
     764 152266 100406                  	BMI	20$
     765 152270 105702                  	TSTB	R2
     766 152272 001403                  	BEQ	22$
     767 152274 003003                  	BGT	20$
     768 152276 005724                  	TST	(R4)+
     769 152300 000401                  	BR	20$
     770 152302 024444                  22$:	CMP	-(R4),-(R4)
     771 152304 020401                  20$:	CMP	R4,R1
     772 152306 101444                  	BLOS	4$
     773 152310 010467  002022'         	MOV	R4,LENT
     774 152314 010467  002020'         	MOV	R4,LIMIT
     775 152320 010467  002016'         	MOV	R4,CIKL
     776 152324 010524                  	MOV	R5,(R4)+
     777 152326 010402                  	MOV	R4,R2
     778 152330 005767  002035'         	TST	TYPE+1
     779 152334 100406                  	BMI	30$
     780 152336 105767  002034'         	TSTB	TYPE
     781 152342 100404                  	BMI	33$
     782 152344 001002                  	BNE	30$
     783 152346 005022                  	CLR	(R2)+
     784 152350 005022                  	CLR	(R2)+
     785 152352 005022                  30$:	CLR	(R2)+
     786 152354 005022                  33$:	CLR	(R2)+
     787 152356 105705                  	TSTB	R5
     788 152360 100012                  	BPL	3$
     789 152362 112742  000002          	MOVB	#2,-(R2)
     790 152366 005705                  	TST	R5
     791 152370 100407                  	BMI	40$
     792 152372 105767  002034'         	TSTB	TYPE
     793 152376 100403                  	BMI	3$
     794 152400 001001                  	BNE	35$
     795 152402 106312                  	ASLB	@R2
     796 152404 106312                  35$:	ASLB	@R2
     797 152406 000207                  3$:	RETURN
     798 152410 105212                  40$:	INCB	@R2
     799 152412 000207                  	RETURN
     800 152414 005004                  50$:	CLR	R4
     801 152416 000207                  	RETURN
     802 152420 104407                  4$:	TRAP	7
     803                                ;
     804 152422 010346                  T105:	MOV	R3,-(SP)
     805 152424 005067  002034'         	CLR	TYPE
     806 152430 104513                  	TRAP	113
     807 152432 147033                  	.WORD	FUN
     808 152434    006     110          	.BYTE	6,110		;КОЛИЧЕСТВО ФУНКЦИЙ
     809 152436 000412                  	BR	2$
     810 152440 005726                  	TST	(SP)+
     811 152442 020527  000072          	CMP	R5,#72		;КОЛИЧЕСТВО ЧИСЛОВЫХ ФУНКЦИЙ
     812 152446 002451                  	BLT	1$
     813 152450 162705  000072          	SUB	#72,R5		;ПЕРЕКОДИРОВАТЬ С НУЛЯ
     814 152454 122327  000044          	CMPB	(R3)+,#'$
     815 152460 001443                  	BEQ	6$
     816 152462 104415                  	TRAP	13.
     817 152464 012603                  2$:	MOV	(SP)+,R3
     818 152466 022020                  	CMP	(R0)+,(R0)+
     819 152470 005005                  	CLR	R5		;MOV	#20000,R5	TRACE
     820 152472 152305                  	BISB	(R3)+,R5
     821 152474 042705  000100          	BIC	#100,R5
     822 152500 000305                  	SWAB	R5
     823 152502 104502                  	TRAP	102
     824 152504 000411                  	BR	4$
     825 152506 000240                  	NOP			;CLRB	R5		TRACE
     826 152510 151305                  	BISB	(R3),R5
     827 152512 042705  000100          	BIC	#100,R5
     828 152516 005203                  3$:	INC	R3
     829 152520 104502                  	TRAP	102
     830 152522 000402                  	BR	4$
     831 152524 000774                  	BR	3$
     832 152526 000773                  	BR	3$
     833 152530 104501                  4$:	TRAP	101
     834 152532 147317                  	.WORD	TYPCHR
     835 152534 000415                  	BR	6$	;8$	SU DEFTYP
     836 152536 060407                  9$:	ADD	R4,PC
     837 152540 000415                  	BR	5$
     838 152542 000406                  	BR	7$
     839 152544 000411                  	BR	6$
     840 152546 052705  040000          	BIS	#40000,R5
     841 152552 105367  002034'         	DECB	TYPE
     842 152556 000404                  	BR	6$
     843 152560 052705  020000          7$:	BIS	#20000,R5
     844 152564 005267  002034'         	INC	TYPE
     845 152570 005720                  6$:	TST	(R0)+
     846 152572 000207                  1$:	RETURN
     847                                ;8$:	MOV	R5,R4
     848                                ;	CLRB	R4
     849                                ;	SWAB	R4
     850                                ;	MOVB	APRL-1(R4),R4
     851                                ;	BR	9$
     852 152574 052705  160000          5$:	BIS	#160000,R5
     853 152600 105167  002035'         	COMB	TYPE+1
     854 152604 000207                  	RETURN
     855                                ;
     856 152606 167144  167124  162102  APLMI::	.WORD	$DADD$,$DSUB$,SUM,SKIRT
         152614 162112                  
     857 152616 170776  170210  162116  ADGDL::	.WORD	$DDIV$,$DMUL$,SAND
     858 152624 167102  125602  160564  AFUN::	.WORD	PI,POINT,INP,PEEK,RAN,$B91,$B93,$B95,$TAN,$B97,$B99
         152632 160556  175176  171350  
         152640 173614  173566  174306  
         152646 174434  171762          
     859 152652 173052  176340  176212  	.WORD	$B103,$INT,$FIX,ABS,IABS,ISGN,DSGN,SSGN
         152660 166566  166556  166574  
         152666 166614  166624          
     860 152672 163040  124562  124546  	.WORD	EOF,LOCY,LOCX,LPOS,FRE,ILOCY,DLOCY,SLOCY
         152700 157056  160606  124560  
         152706 124554  124556          
     861 152712 124544  124540  124542  	.WORD	ILOCX,DLOCX,SLOCX,ILPOS,DLPOS,SLPOS
         152720 157054  157050  157052  
     862 152726 160620  160604  160600  	.WORD	$FRE,IFRE,DFRE,SFRE
         152734 160602                  
     863 152736 161530  161534  161550  	.WORD	LEN,ASC,VAL			;INSTR2,INSTR
     864                                ;
     865 152744 104512                  T106:	TRAP	112
     866 152746 005766  000004          	TST	4(SP)
     867 152752 001406                  	BEQ	2$
     868 152754 121327  000012          	CMPB	@R3,#12
     869 152760 001403                  	BEQ	2$
     870 152762 121327  000047          	CMPB	@R3,#''
     871 152766 001001                  	BNE	1$
     872 152770 000207                  2$:	RETURN
     873 152772 104402                  1$:	TRAP	2
     874                                ;
     875 152774 010402                  T107:	MOV	R4,R2
     876 152776 104512                  	TRAP	112
     877 153000 104502                  	TRAP	102
     878 153002 104402                  	TRAP	2
     879 153004 000405                  	BR	2$
     880 153006 104402                  3$:	TRAP	2
     881 153010 162705  000002          1$:	SUB	#2,R5
     882 153014 001374                  	BNE	3$
     883 153016 000207                  	RETURN
     884 153020 104505                  2$:	TRAP	105
     885 153022 104402                  	TRAP	2
     886 153024 000771                  	BR	1$
     887 153026 005740                  	TST	-(R0)
     888 153030 005720                  	TST	(R0)+
     889 153032 010204                  	MOV	R2,R4
     890 153034 104521                  	TRAP	121
     891 153036 000407                  	BR	5$
     892 153040 024141                  	CMP	-(1),-(1)
     893 153042 012721  156106          	MOV	#APAR,(1)+
     894 153046 016421  177772          	MOV	-6(4),(1)+
     895 153052 105405                  	NEGB	R5
     896 153054 000207                  	RETURN
     897 153056 104503                  5$:	TRAP	103
     898 153060 105705                  	TSTB	R5
     899 153062 100401                  	BMI	4$
     900 153064 005741                  	TST	-(R1)
     901 153066 005741                  4$:	TST	-(R1)
     902 153070 000207                  	RETURN
     903                                ;
     904 153072 005005                  T110:	CLR	R5
     905 153074 104512                  	TRAP	112
     906 153076 104502                  	TRAP	102
     907 153100 000207                  	RETURN
     908 153102 000207                  	RETURN
     909 153104 162704  000060          1$:	SUB	#60,R4
     910 153110 005203                  	INC	R3
     911 153112 006305                  	ASL	R5
     912 153114 060504                  	ADD	R5,R4
     913 153116 006305                  	ASL	R5
     914 153120 006305                  	ASL	R5
     915 153122 060405                  	ADD	R4,R5
     916 153124 103406                  	BCS	2$
     917 153126 104502                  	TRAP	102
     918 153130 000407                  	BR	3$
     919 153132 000406                  	BR	3$
     920 153134 020527  014631          	CMP	R5,#14631
     921 153140 101761                  	BLOS	1$
     922 153142 016604  000016          2$:	MOV	16(SP),R4
     923 153146 104406                  	TRAP	6
     924 153150 005720                  3$:	TST	(R0)+
     925 153152 000207                  	RETURN
     926                                ;
     927 153154 016704  002026'         T111:	MOV	FCB,R4
     928 153160 005744                  	TST	-(R4)
     929 153162 020467  002024'         1$:	CMP	R4,TABTOP
     930 153166 103406                  	BLO	2$
     931 153170 020514                  	CMP	R5,(R4)
     932 153172 001405                  	BEQ	3$
     933 153174 103403                  	BLO	2$
     934 153176 162704  000006          	SUB	#6,R4
     935 153202 000767                  	BR	1$
     936 153204 005720                  2$:	TST	(R0)+
     937 153206 000207                  3$:	RETURN
     938                                ;
     939 153210 122327  000040          T112:	CMPB	(R3)+,#40
     940 153214 001775                  	BEQ	T112
     941 153216 005303                  	DEC	R3
     942 153220 000207                  	RETURN
     943                                ;
     944 153222 010146                  T113:	MOV	R1,-(SP)
     945 153224 010346                  	MOV	R3,-(SP)
     946 153226 012746  177777          	MOV	#-1,-(SP)
     947 153232 005001                  	CLR	R1
     948 153234 005005                  	CLR	R5
     949 153236 012002                  	MOV	(R0)+,R2
     950 153240 104502                  	TRAP	102
     951 153242 104512                  	TRAP	112
     952 153244 000401                  	BR	1$
     953 153246 000451                  	BR	14$
     954 153250 105016                  1$:	CLRB	@SP
     955 153252 121322                  2$:	CMPB	(R3),(R2)+
     956 153254 001010                  	BNE	3$
     957 153256 005203                  	INC	R3
     958 153260 105216                  	INCB	@SP
     959 153262 121227  000040          	CMPB	@R2,#40
     960 153266 001437                  	BEQ	6$
     961 153270 104502                  	TRAP	102
     962 153272 000401                  	BR	3$
     963 153274 000766                  	BR	2$
     964 153276 105316                  3$:	DECB	@SP
     965 153300 003406                  	BLE	4$
     966 153302 020103                  	CMP	R1,R3
     967 153304 101004                  	BHI	4$
     968 153306 001415                  	BEQ	7$
     969 153310 010301                  	MOV	R3,R1
     970 153312 110566  000001          	MOVB	R5,1(SP)
     971 153316 016603  000002          4$:	MOV	2(SP),R3
     972 153322 120560  000001          	CMPB	R5,1(R0)
     973 153326 001410                  	BEQ	11$
     974 153330 122227  000040          5$:	CMPB	(R2)+,#40
     975 153334 001375                  	BNE	5$
     976 153336 005725                  	TST	(R5)+
     977 153340 000743                  	BR	1$
     978 153342 012716  177777          7$:	MOV	#-1,@SP
     979 153346 000763                  	BR	4$
     980 153350 116605  000001          11$:	MOVB	1(SP),R5
     981 153354 100406                  	BMI	14$
     982 153356 121027  000003          	CMPB	@R0,#3
     983 153362 002003                  	BGE	14$
     984 153364 010103                  	MOV	R1,R3
     985 153366 104512                  6$:	TRAP	112
     986 153370 005720                  	TST	(R0)+
     987 153372 005720                  14$:	TST	(R0)+
     988 153374 022626                  	CMP	(SP)+,(SP)+
     989 153376 012601                  	MOV	(SP)+,R1
     990 153400 000207                  	RETURN
     991                                ;
     992 153402 012703  003022          T114:	MOV	#BUFOUT,R3
     993 153406 004767  140600'         	CALL	I1
     994 153412 004767  122560'         	CALL	ISVEIL
     995 153416 000207                  	RETURN
     996                                ;
     997 153420 104512                  T115:	TRAP	112
     998 153422 005002                  	CLR	R2
     999 153424 010346                  	MOV	R3,-(SP)
    1000 153426 104502                  	TRAP	102
    1001 153430 000402                  	BR	1$
    1002 153432 000404                  	BR	6$
    1003 153434 000452                  	BR	NOT$
    1004 153436 104520                  1$:	TRAP	120
    1005 153440 000450                  	BR	NOT$
    1006 153442 000410                  	BR	S10
    1007 153444 104505                  6$:	TRAP	105
    1008 153446 000435                  	BR	SIMUSR
    1009 153450 000451                  	BR	SIMFUN
    1010 153452 000401                  	BR	8$
    1011 153454 000442                  	BR	NOT$
    1012 153456 005004                  8$:	CLR	R4
    1013 153460 104521                  	TRAP	121
    1014 153462 104503                  	TRAP	103
    1015 153464 104512                  S10:	TRAP	112
    1016 153466 005726                  	TST	(SP)+
    1017 153470 121327  000053          	CMPB	(R3),#'+
    1018 153474 001017                  	BNE	2$
    1019 153476 005702                  	TST	R2
    1020 153500 003004                  	BGT	3$
    1021 153502 005202                  4$:	INC	R2
    1022 153504 001776                  	BEQ	4$
    1023 153506 004767  143074'         	CALL	TSTSQZ
    1024 153512 005203                  3$:	INC	R3
    1025 153514 104515                  	TRAP	115
    1026 153516 104415                  	TRAP	13.
    1027 153520 005704                  	TST	R4
    1028 153522 003002                  	BGT	1$
    1029 153524 012721  156672          	MOV	#NEWSTR,(R1)+
    1030 153530 012721  161456          1$:	MOV	#CONCAT,(R1)+
    1031 153534 005720                  2$:	TST	(R0)+
    1032 153536 010204                  	MOV	R2,R4
    1033 153540 000207                  	RETURN
    1034                                ;
    1035 153542 020527  000066          SIMUSR:	CMP	R5,#66	;USR$
    1036 153546 002405                  	BLT	NOT$
    1037 153550 010146                  	MOV	R1,-(SP)
    1038 153552 004767  154032'         	CALL	USR
    1039 153556 100403                  	BMI	S2
    1040 153560 012601                  	MOV	(SP)+,R1
    1041 153562 012603                  NOT$:	MOV	(SP)+,R3
    1042 153564 000207                  	RETURN
    1043 153566 005726                  S2:	TST	(SP)+
    1044 153570 005202                  	INC	R2
    1045 153572 000734                  	BR	S10
    1046                                ;
    1047 153574 006205                  SIMFUN:	ASR	R5	;MID$
    1048 153576 001411                  	BEQ	10$
    1049 153600 104527                  	TRAP	127
    1050 153602 005305                  	DEC	R5
    1051 153604 001021                  	BNE	S30
    1052 153606 104515                  	TRAP	115
    1053 153610 104415                  	TRAP	13.
    1054 153612 004767  154000'         	CALL	MIDEND
    1055 153616 005302                  	DEC	R2
    1056 153620 000721                  	BR	S10
    1057                                ;
    1058 153622 012721  124132          10$:	MOV	#INKEY,(R1)+	;INKEY$
    1059 153626 000716                  	BR	S10
    1060                                ;
    1061 153630 005305                  S20:	DEC	R5	;CHR$,BIN$,OCT$,HEX$
    1062 153632 006305                  	ASL	R5
    1063 153634 010546                  	MOV	R5,-(SP)
    1064 153636 104525                  21$:	TRAP	125
    1065 153640 012605                  	MOV	(SP)+,R5
    1066 153642 016521  153746          	MOV	ASFINT(R5),(R1)+
    1067 153646 000420                  	BR	S33
    1068                                ;
    1069 153650 005305                  S30:	DEC	R5	;STRING$
    1070 153652 001020                  	BNE	S40
    1071 153654 104525                  	TRAP	125
    1072 153656 104526                  	TRAP	126
    1073 153660 004767  143074'         	CALL	TSTSQZ
    1074 153664 005741                  	TST	-(R1)
    1075 153666 104522                  	TRAP	122
    1076 153670 000403                  	BR	31$
    1077 153672 012721  161404          	MOV	#ALLSM,(R1)+
    1078 153676 000403                  	BR	S32
    1079 153700 104525                  31$:	TRAP	125
    1080 153702 012721  161372          	MOV	#ALLSK,(R1)+
    1081 153706 005202                  S32:	INC	R2
    1082 153710 104530                  S33:	TRAP	130
    1083 153712 000664                  	BR	S10
    1084                                ;
    1085 153714 005305                  S40:	DEC	R5	;STR$
    1086 153716 001344                  	BNE	S20
    1087 153720 104500                  	TRAP	100
    1088 153722 116704  002034'         	MOVB	TYPE,R4
    1089 153726 005204                  	INC	R4
    1090 153730 006304                  	ASL	R4
    1091 153732 016421  153740          	MOV	ASTR(R4),(R1)+
    1092 153736 000764                  	BR	S33
    1093                                ;
    1094 153740 161610  161602  161574  ASTR:	.WORD	ISTR,	DSTR,	SSTR
    1095 153746 160510  161672  161624  ASFINT:	.WORD	CHR,	BIN,	OCT,	HEX
         153754 161734                  
    1096                                ;
    1097 153756 104527                  LMID::	TRAP	127
    1098 153760 005004                  	CLR	R4
    1099 153762 104507                  	TRAP	107
    1100 153764 000401                  	BR	10$
    1101 153766 104415                  	TRAP	13.
    1102 153770 005721                  10$:	TST	(R1)+
    1103 153772 105705                  	TSTB	R5
    1104 153774 100401                  	BMI	MIDEND
    1105 153776 005721                  	TST	(R1)+
    1106 154000 104526                  MIDEND:	TRAP	126
    1107 154002 104525                  	TRAP	125
    1108 154004 104516                  	TRAP	116
    1109 154006 000405                  	BR	11$
    1110 154010 004767  151062'         	CALL	CINT
    1111 154014 012721  161340          	MOV	#STR,(R1)+
    1112 154020 000402                  	BR	12$
    1113 154022 012721  161332          11$:	MOV	#STR2,(R1)+
    1114 154026 104530                  12$:	TRAP	130
    1115 154030 000207                  	RETURN
    1116                                ;
    1117 154032 104512                  USR:	TRAP	112
    1118 154034 005002                  	CLR	R2
    1119 154036 104502                  	TRAP	102
    1120 154040 000405                  	BR	1$
    1121 154042 000427                  	BR	4$
    1122 154044 112302                  	MOVB	(R3)+,R2
    1123 154046 162702  000060          	SUB	#'0,R2
    1124 154052 006302                  	ASL	R2
    1125 154054 020527  000070          1$:	CMP	R5,#70
    1126 154060 001550                  	BEQ	T_SYNERR
    1127 154062 104527                  	TRAP	127
    1128 154064 104522                  	TRAP	122
    1129 154066 000405                  	BR	2$
    1130 154070 005704                  	TST	R4
    1131 154072 003004                  	BGT	3$
    1132 154074 004767  143074'         	CALL	TSTSQZ
    1133 154100 000401                  	BR	3$
    1134 154102 104500                  2$:	TRAP	100
    1135 154104 012721  163652          3$:	MOV	#$USR,(R1)+
    1136 154110 010221                  	MOV	R2,(R1)+
    1137 154112 104530                  	TRAP	130
    1138 154114 016721  002034'         	MOV	TYPE,(R1)+
    1139 154120 000207                  	RETURN
    1140 154122 020527  000070          4$:	CMP	R5,#70
    1141 154126 001125                  	BNE	T_SYNERR
    1142 154130 104505                  	TRAP	105
    1143 154132 104402                  	TRAP	2
    1144 154134 104402                  	TRAP	2
    1145 154136 000240                  	NOP
    1146 154140 052705  100100          	BIS	#100100,R5
    1147 154144 016746  002034'         	MOV	TYPE,-(SP)
    1148 154150 012767  177777  002034' 	MOV	#-1,TYPE
    1149 154156 104504                  	TRAP	104
    1150 154160 010446                  	MOV	R4,-(SP)
    1151 154162 004767  143074'         	CALL	TSTSQZ
    1152 154166 012761  156034  177776  	MOV	#FNST,-2(1)
    1153 154174 104512                  	TRAP	112
    1154 154176 121327  000050          	CMPB	@R3,#'(
    1155 154202 001022                  	BNE	7$
    1156 154204 005203                  40$:	INC	R3
    1157 154206 104522                  	TRAP	122
    1158 154210 000407                  	BR	41$
    1159 154212 012746  177400          	MOV	#177400,-(SP)
    1160 154216 005704                  	TST	R4
    1161 154220 003006                  	BGT	5$
    1162 154222 012721  156672          	MOV	#NEWSTR,(R1)+
    1163 154226 000403                  	BR	5$
    1164 154230 104500                  41$:	TRAP	100
    1165 154232 016746  002034'         	MOV	TYPE,-(SP)
    1166 154236 005202                  5$:	INC	R2
    1167 154240 121327  000054          	CMPB	@R3,#',
    1168 154244 001757                  	BEQ	40$
    1169 154246 104530                  6$:	TRAP	130
    1170 154250 012721  156046          7$:	MOV	#FNCALL,(1)+
    1171 154254 010104                  	MOV	R1,R4
    1172 154256 005721                  	TST	(1)+
    1173 154260 010221                  	MOV	R2,(1)+
    1174 154262 001402                  	BEQ	9$
    1175 154264 012621                  8$:	MOV	(SP)+,(R1)+
    1176 154266 077202                  	SOB	R2,8$
    1177 154270 012614                  9$:	MOV	(SP)+,@R4
    1178 154272 012667  002034'         	MOV	(SP)+,TYPE
    1179 154276 000207                  	RETURN
    1180                                ;
    1181 154300 104512                  T116:	TRAP	112
    1182 154302 121327  000054          	CMPB	@R3,#',
    1183 154306 001016                  	BNE	2$
    1184 154310 010346                  	MOV	R3,-(SP)
    1185 154312 005203                  	INC	R3
    1186 154314 104512                  	TRAP	112
    1187 154316 121327  000054          	CMPB	@R3,#',
    1188 154322 001407                  	BEQ	1$
    1189 154324 121327  000012          	CMPB	@R3,#12
    1190 154330 001404                  	BEQ	1$
    1191 154332 104500                  	TRAP	100
    1192 154334 005720                  	TST	(R0)+
    1193 154336 005726                  	TST	(SP)+
    1194 154340 000207                  	RETURN
    1195 154342 012603                  1$:	MOV	(SP)+,R3
    1196 154344 000207                  2$:	RETURN
    1197                                ;
    1198 154346 005002                  T117:	CLR	R2
    1199 154350 104502                  1$:	TRAP	102
    1200 154352 000403                  	BR	3$
    1201 154354 000407                  	BR	4$
    1202 154356 005203                  2$:	INC	R3
    1203 154360 000773                  	BR	1$
    1204 154362 120427  000056          3$:	CMPB	R4,#'.
    1205 154366 001002                  	BNE	4$
    1206 154370 005202                  	INC	R2
    1207 154372 000771                  	BR	2$
    1208 154374 005302                  4$:	DEC	R2
    1209 154376 003001                  	BGT	T_SYNERR
    1210 154400 000207                  	RETURN
    1211 154402 104402                  T_SYNERR:	TRAP	2
    1212                                ;
    1213 154404 121327  000042          T120:	CMPB	@R3,#'"
    1214 154410 001022                  	BNE	1$
    1215 154412 005203                  3$:	INC	R3
    1216 154414 012721  156156          	MOV	#SCONST,(R1)+
    1217 154420 010321                  	MOV	R3,(R1)+
    1218 154422 005004                  	CLR	R4
    1219 154424 121327  000012          4$:	CMPB	@R3,#12
    1220 154430 001405                  	BEQ	5$
    1221 154432 122327  000042          	CMPB	(R3)+,#'"
    1222 154436 001402                  	BEQ	5$
    1223 154440 005204                  	INC	R4
    1224 154442 000770                  	BR	4$
    1225 154444 010421                  5$:	MOV	R4,(R1)+
    1226 154446 005720                  	TST	(R0)+
    1227 154450 012767  177400  002034' 	MOV	#177400,TYPE
    1228 154456 000207                  1$:	RETURN
    1229                                ;
    1230 154460 016702  002126'         T121:	MOV	PFACT,R2
    1231 154464 001423                  	BEQ	4$
    1232 154466 005722                  1$:	TST	(2)+
    1233 154470 001421                  	BEQ	4$
    1234 154472 005722                  	TST	(2)+
    1235 154474 022205                  	CMP	(2)+,R5
    1236 154476 001373                  	BNE	1$
    1237 154500 005767  002034'         	TST	TYPE
    1238 154504 100406                  	BMI	3$
    1239 154506 105767  002034'         	TSTB	TYPE
    1240 154512 001402                  	BEQ	2$
    1241 154514 100002                  	BPL	3$
    1242 154516 005724                  	TST	(4)+
    1243 154520 005724                  2$:	TST	(4)+
    1244 154522 016421  154536          3$:	MOV	PARMOV(R4),(1)+
    1245 154526 011221                  	MOV	(2),(1)+
    1246 154530 010204                  	MOV	R2,R4
    1247 154532 005720                  	TST	(0)+
    1248 154534 000207                  4$:	RETURN
    1249                                ;
    1250 154536 156124  156132  156116  PARMOV:	.WORD	SPAR,DPAR,IPAR
    1251                                ;
    1252 154544 010346                  T122:	MOV	R3,-(SP)
    1253 154546 104515                  	TRAP	115
    1254 154550 000403                  	BR	1$
    1255 154552 104501                  	TRAP	101
    1256 154554 147274                  	.WORD	RELAT
    1257 154556 000402                  	BR	2$
    1258 154560 012603                  1$:	MOV	(SP)+,R3
    1259 154562 000207                  	RETURN
    1260 154564 022620                  2$:	CMP	(SP)+,(R0)+
    1261 154566 000207                  	RETURN
    1262                                ;
    1263 154570 104525                  T123:	TRAP	125
    1264 154572 104526                  	TRAP	126
    1265 154574 104525                  T124:	TRAP	125
    1266 154576 104526                  	TRAP	126
    1267 154600 104500                  T125:	TRAP	100
    1268 154602 004767  151062'         	CALL	CINT
    1269 154606 000207                  	RETURN
    1270                                ;
    1271 154610 104512                  T126:	TRAP	112
    1272 154612 122327  000054          	CMPB	(R3)+,#',
    1273 154616 001002                  	BNE	1$
    1274 154620 104512                  	TRAP	112
    1275 154622 000207                  	RETURN
    1276 154624 104402                  1$:	TRAP	2
    1277                                ;
    1278                                	.END
    1278                                
       1                                ; .ENABLE LC
       2                                .GLOBL	BREAK,BREAKW,IRPS2
       3                                .GLOBL	TXEND,LYGIS,STRREG,STRSIZ,CURON,CUROFF,$DADD$,STACK
       4                                .GLOBL	CISLO,ID,SD,IS,SI,SEPAP,TRFLAG,TRIN,LIMIT,SAVJMP
       5                                .GLOBL	ADRHLT,STAR,ISV,ENDCOD,LENT,CIKL,ISVEIL,IVEIL,DCMP
       6                                .GLOBL	ISVTO,ISVETO,FCB,EGO,DGO,ISGUNP,HIMEM,BLOCK0,BLOCKN,ISVARD
       7                                .GLOBL	BUF,PACK,TABTOP,BUFOUT,INK,FREBEG,FRELEN,MONERR,NUMBER
       8                                .GLOBL	USRTAB,DATINP,DATPTR,IODEV,MAG,CASCII,DAT,CAS,LASTBL	;MAXFIL
       9                                .GLOBL	CLRBUF,CLRCOD,LPTPOS,PFACT,WSTOP,TTANAL,SETST		;SIGNAL
      10                                ;
      11                                ;MTONV::	MOV	#1,MAG
      12                                ;MONV1:	CALL	CAS
      13                                ;	JMP	@(4)+
      14                                ;MTOFFV::CLR	MAG
      15                                ;	BR	MONV1
      16                                ;
      17 154626 005767  002050'         TRUN::	TST	TRFLAG
      18 154632 001032                  	BNE	TEND
      19 154634 005267  002050'         	INC	TRFLAG
      20 154640 105767  002000'         	TSTB	LYGIS
      21 154644 001425                  	BEQ	TEND
      22 154646 005767  002044'         	TST	NUMBER
      23 154652 001403                  	BEQ	1$
      24 154654 005467  002050'         	NEG	TRFLAG
      25 154660 000417                  	BR	TEND
      26 154662 021427  154722          1$:	CMP	@R4,#ENDPRG
      27 154666 001414                  	BEQ	TEND
      28 154670 000167  123204'         	JMP	TRIN
      29                                ;
      30 154674 005767  002050'         TREND::	TST	TRFLAG
      31 154700 003405                  	BLE	1$
      32 154702 105767  002000'         	TSTB	LYGIS
      33 154706 001402                  	BEQ	1$
      34 154710 004267  124022'         	JSR	R2,SEPAP
      35 154714 005067  002050'         1$:	CLR	TRFLAG
      36 154720 000134                  TEND:	JMP	@(4)+
      37                                ;
      38 154722 004767  162664'         ENDPRG::CALL	CLOALL
      39 154726 005267  002000'         	INC	LYGIS
      40 154732 001006                          BNE	END1
      41 154734 004267  124022'         	JSR	R2,SEPAP
      42 154740 005067  002046'                 CLR	ADRHLT
      43 154744 004767  155054'         	CALL	TRTOPL
      44 154750 000167  133754'         END1:	JMP	STAR
      45                                ;
      46 154754 010467  002134'         HALT::	MOV	R4,SAVJMP
      47 154760 012701  120226          	MOV	#WSTOP,R1
      48 154764 012702  000005          	MOV	#5,R2
      49 154770 004767  122560'         	CALL	ISVEIL
      50 154774 020467  002004'         	CMP	R4,STRREG
      51 155000 101021                  	BHI	3$
      52 155002 010467  002046'         	MOV	R4,ADRHLT
      53 155006 004267  124022'         2$:	JSR	R2,SEPAP
      54 155012 004767  155054'         	CALL	TRTOPL
      55 155016 004767  155070'         	CALL	LNUM
      56 155022 024444                  	CMP	-(R4),-(R4)
      57 155024 004067  135564'         	JSR	R0,SETST
      58 155030 000402                  	BR	1$
      59 155032 005067  002046'         	CLR	ADRHLT
      60 155036 005067  002134'         1$:	CLR	SAVJMP
      61 155042 000742                     	BR	END1
      62 155044 005067  002134'         3$:	CLR	SAVJMP
      63 155050 000167  146654'         	JMP	MONERR
      64                                ;
      65 155054 005767  002050'         TRTOPL:	TST	TRFLAG
      66 155060 100002                  	BPL	1$
      67 155062 005467  002050'         	NEG	TRFLAG
      68 155066 000207                  1$:	RETURN
      69                                ;
      70 155070 004767  155132'         LNUM::	CALL	AGAUD
      71 155074 016005  000002          	MOV	2(0),R5
      72 155100 012701  155160          ATLIN1::MOV	#ATLINE,R1
      73 155104 012702  000012          	MOV	#12,R2
      74 155110 004767  122560'         	CALL	ISVEIL
      75 155114 010502                  	MOV	R5,R2
      76 155116 104514                  	TRAP	114
      77 155120 012700  000012          	MOV	#12,R0
      78 155124 004767  122522'         	CALL	ISV
      79 155130 000207                  	RETURN
      80                                ;
      81 155132 016700  002024'         AGAUD:: MOV	TABTOP,R0
      82 155136 022004                  3$:	CMP	(R0)+,R4
      83 155140 103405                  	BLO	4$
      84 155142 022020                  	CMP	(R0)+,(R0)+
      85 155144 020067  002026'         	CMP	R0,FCB
      86 155150 103772                  	BLO	3$
      87 155152 005720                  	TST	(R0)+
      88 155154 010004                  4$:	MOV	R0,R4
      89 155156 000207                  	RETURN
      90                                ;
      91 155160    040     367     040  ATLINE: .BYTE	40,367,40,363,364,362,357,353,345,40	; В СТРОКЕ
         155163    363     364     362  
         155166    357     353     345  
         155171    040                  
      92                                	.EVEN
      93                                ;
      94 155172 162626                  ICMP::	SUB     (SP)+,(SP)+
      95 155174 000134                          JMP     @(R4)+
      96                                ;
      97 155176 016701  002016'         NEXCMP::MOV	CIKL,R1
      98 155202 012100                  	MOV	(R1)+,R0
      99 155204 010602                  	MOV	SP,R2
     100 155206 012220                  	MOV	(R2)+,(R0)+
     101 155210 032760  020000  177774  	BIT	#20000,-4(R0)
     102 155216 001410                  	BEQ	NDCMP
     103 155220 012210                  	MOV	(R2)+,(R0)
     104 155222 011202                  	MOV	@R2,R2
     105 155224 006102                  	ROL	R2
     106 155226 005510                  	ADC	@R0
     107 155230 005540                  	ADC	-(R0)
     108 155232 102401                  	BVS	1$
     109 155234 103004                  	BCC	NCMP
     110 155236 104406                  1$:	TRAP	6
     111                                ;
     112 155240 012220                  NDCMP:	MOV     (R2)+,(R0)+
     113 155242 011220                          MOV     (R2),(R0)+
     114 155244 011220                          MOV     (R2),(R0)+
     115 155246 005721                  NCMP:	TST     (R1)+
     116 155250 012146                          MOV     (R1)+,-(SP)
     117 155252 012146                          MOV     (R1)+,-(SP)
     118 155254 012146                          MOV     (R1)+,-(SP)
     119 155256 011146                          MOV     @R1,-(SP)
     120 155260 000167  177034'         	JMP	DCMP
     121                                ;
     122 155264 011700                  SCMP::  MOV     @PC,R0
     123 155266 016601  000004                  MOV     4(SP),R1
     124 155272 002004                          BGE     1$
     125 155274 006300                          ASL     R0
     126 155276 012602                          MOV     (SP)+,R2
     127 155300 002403                          BLT     2$
     128 155302 000412                          BR      4$
     129 155304 012602                  1$:     MOV     (SP)+,R2
     130 155306 002411                          BLT     5$
     131 155310 020102                  2$:     CMP     R1,R2
     132 155312 001004                          BNE     3$
     133 155314 026616  000004                  CMP     4(SP),@SP
     134 155320 001001                          BNE     3$
     135 155322 005000                          CLR     R0
     136 155324 006000                  3$:     ROR     R0
     137 155326 103401                          BCS     5$
     138 155330 005400                  4$:     NEG     R0
     139 155332 062706  000006          5$:     ADD     #6,SP
     140 155336 005700                          TST     R0
     141 155340 000134                          JMP     @(R4)+
     142                                ;
     143 155342 012602                  $CMP::	MOV	(SP)+,R2
     144 155344 012603                  	MOV	(SP)+,R3
     145 155346 012601                  	MOV	(SP)+,R1
     146 155350 012600                  	MOV	(SP)+,R0
     147 155352 160102                  	SUB	R1,R2
     148 155354 100001                  	BPL	1$
     149 155356 060201                  	ADD	R2,R1
     150 155360 005301                  1$:	DEC	R1
     151 155362 100403                  	BMI	2$
     152 155364 122023                  	CMPB	(R0)+,(R3)+
     153 155366 001774                  	BEQ	1$
     154 155370 000134                  	JMP	@(R4)+
     155 155372 005402                  2$:	NEG	R2
     156 155374 000134                  	JMP	@(R4)+
     157                                ;
     158 000001                         .IF EQ,1
     159                                SWPD::	MOV	#4,R2
     160                                	BR	EXSWAP
     161                                SWPR::	MOV	#2,R2
     162                                	BR	EXSWAP
     163                                SWPI::	MOV	#1,R2
     164                                EXSWAP:	MOV	(SP)+,R0
     165                                	MOV	(SP)+,R1
     166                                1$:	MOV	@R0,-(SP)
     167                                	MOV	@R1,(0)+
     168                                	MOV	(SP)+,(1)+
     169                                	SOB	R2,1$
     170                                	JMP	@(4)+
     171                                ;
     172                                SWSSI::	MOV	(SP)+,R1
     173                                	MOV	(SP)+,R0
     174                                	BR	SWAP1
     175                                SWSIS::	MOV	(SP)+,R0
     176                                	MOV	(SP)+,R1
     177                                SWAP1:	MOV	@R0,-(SP)
     178                                	MOVB	@R1,@R0
     179                                	MOVB	(SP)+,(1)+
     180                                	TST	(0)+
     181                                	MOV	#2,R2
     182                                	BR	EXSSW
     183                                SWSII::	MOV	(SP)+,R0
     184                                	MOV	(SP)+,R1
     185                                	MOV	#3,R2
     186                                ;
     187                                EXSSW:	MOVB	@R0,-(SP)
     188                                	MOVB	@R1,(0)+
     189                                	MOVB	(SP)+,(1)+
     190                                	SOB	R2,EXSSW
     191                                	JMP	@(4)+
     192                                .ENDC
     193                                ;
     194 155376 005726                  IFT::   TST     (SP)+
     195 155400 001067                          BNE     JMP
     196 155402 000561                          BR      NJMP
     197                                ;
     198 155404 005726                  IFF::   TST     (SP)+
     199 155406 001464                          BEQ     JMP
     200 155410 000556                          BR      NJMP
     201                                ;
     202 155412 155430  155456  155452  ADDRBR::.WORD   EQ,GT,LT,GE,LE,NE,0
         155420 155446  155442  155436  
         155426 000000                  
     203                                ;
     204 155430 001413                  EQ:     BEQ     TRUE
     205 155432 005046                  FALSE:  CLR     -(SP)
     206 155434 000134                          JMP     @(R4)+
     207                                ;
     208 155436 001010                  NE:     BNE     TRUE
     209 155440 000774                          BR      FALSE
     210                                ;
     211 155442 003406                  LE:     BLE     TRUE
     212 155444 000772                          BR      FALSE
     213                                ;
     214 155446 002004                  GE:     BGE     TRUE
     215 155450 000770                          BR      FALSE
     216                                ;
     217 155452 002402                  LT:     BLT     TRUE
     218 155454 000766                          BR      FALSE
     219                                ;
     220 155456 003765                  GT:     BLE     FALSE
     221 155460 012746  177777          TRUE:   MOV     #-1,-(SP)
     222 155464 000134                          JMP     @(R4)+
     223                                ;
     224 155466 016701  002016'         NEXJMP::MOV     CIKL,R1
     225 155472 005761  000022          	TST	22(R1)
     226 155476 100405                          BMI     2$
     227 155500 005700                          TST     R0
     228 155502 003005                          BGT     3$
     229 155504 016104  000002          1$:     MOV     2(R1),R4
     230 155510 000134                          JMP     @(R4)+
     231 155512 005700                  2$:     TST     R0
     232 155514 002373                          BGE     1$
     233 155516 062767  000024  002016' 3$:     ADD     #24,CIKL
     234 155524 000134                          JMP     @(R4)+
     235                                ;
     236 155526 016700  002016'         JSR::	MOV	CIKL,R0
     237 155532 005740                  	TST	-(R0)
     238 155534 020067  002014'         	CMP	R0,ENDCOD
     239 155540 101457                  	BLOS	STCKER
     240 155542 016710  002020'         	MOV	LIMIT,@R0
     241 155546 010440                  	MOV     R4,-(R0)
     242 155550 010067  002016'         SUB:	MOV	R0,CIKL
     243 155554 010067  002020'         	MOV	R0,LIMIT
     244                                ;
     245 155560 011404                  JMP::   MOV     @R4,R4
     246 155562 000134                          JMP     @(R4)+
     247                                ;
     248 155564 012600                  ONJMP::	MOV	(SP)+,R0
     249 155566 001405                  	BEQ	ONSKIP
     250 155570 032700  177400          	BIT	#177400,R0
     251 155574 001006                  	BNE	ONERR
     252 155576 020014                  	CMP	R0,@R4
     253 155600 003434                  	BLE	JUMP
     254 155602 012400                  ONSKIP:	MOV	(R4)+,R0
     255 155604 006300                  	ASL	R0
     256 155606 060004                  	ADD	R0,R4
     257 155610 000134                  	JMP	@(R4)+
     258 155612 104405                  ONERR:	TRAP	5
     259                                ;
     260 155614 012600                  ONJSR::	MOV	(SP)+,R0
     261 155616 001771                  	BEQ	ONSKIP
     262 155620 032700  177400          	BIT	#177400,R0
     263 155624 001372                  	BNE	ONERR
     264 155626 020014                  	CMP	R0,@R4
     265 155630 003364                  	BGT	ONSKIP
     266 155632 011401                  	MOV	@R4,R1
     267 155634 006301                  	ASL	R1
     268 155636 060401                  	ADD	R4,R1
     269 155640 016702  002016'         	MOV	CIKL,R2
     270 155644 005742                  	TST	-(R2)
     271 155646 020267  002014'         	CMP	R2,ENDCOD
     272 155652 101412                  	BLOS	STCKER
     273 155654 016712  002020'         	MOV	LIMIT,@R2
     274 155660 010142                  	MOV	R1,-(R2)
     275 155662 010267  002016'         	MOV	R2,CIKL
     276 155666 010267  002020'         	MOV	R2,LIMIT
     277 155672 006300                  JUMP:	ASL	R0
     278 155674 060004                  	ADD	R0,R4
     279 155676 000730                  	BR	JMP
     280 155700 104407                  STCKER:	TRAP	7
     281                                ;
     282 155702 016700  002020'         RTSTO::	MOV	LIMIT,R0
     283 155706 020067  002022'         	CMP	R0,LENT
     284 155712 103002                  	BHIS	RETERR
     285 155714 011000                  	MOV	@R0,R0
     286 155716 000714                  	BR	SUB
     287 155720 104403                  RETERR:	TRAP	3
     288                                ;
     289 155722 016700  002020'         RTS::   MOV     LIMIT,R0
     290 155726 020067  002022'         	CMP	R0,LENT
     291 155732 103372                  	BHIS	RETERR
     292 155734 012004                  	MOV	(R0)+,R4
     293 155736 012067  002020'         	MOV	(R0)+,LIMIT
     294 155742 010067  002016'         	MOV	R0,CIKL
     295                                ;
     296 155746 005724                  NJMP:   TST     (R4)+
     297 155750 000134                          JMP     @(R4)+
     298                                ;
     299 155752 012701  000004          DFNRET::MOV	#4,R1
     300                                ;
     301 155756 016700  002126'         RETFN:	MOV	PFACT,R0
     302 155762 012067  002126'         	MOV	(R0)+,PFACT
     303 155766 010102                  	MOV	R1,R2
     304 155770 006302                  	ASL	R2
     305 155772 060602                  	ADD	SP,R2
     306 155774 014240                  1$:	MOV	-(2),-(0)
     307 155776 077102                  	SOB	R1,1$
     308 156000 010006                  	MOV	R0,SP
     309 156002 013404                  	MOV	@(4)+,R4
     310 156004 000134                  	JMP	@(4)+
     311                                ;
     312 156006 012701  000002          SFNRET::MOV	#2,R1
     313 156012 000761                  	BR	RETFN
     314                                ;
     315 156014 012701  000001          IFNRET::MOV	#1,R1
     316 156020 000756                  	BR	RETFN
     317                                ;
     318 156022 012400                  DFN::	MOV	(4)+,R0
     319 156024 012401                  	MOV	(4)+,R1
     320 156026 010411                  	MOV	R4,@R1
     321 156030 010004                  	MOV	R0,R4
     322 156032 000134                  	JMP	@(4)+
     323                                ;
     324 156034 016746  002126'         FNST::	MOV	PFACT,-(SP)
     325 156040 010667  002130'         	MOV	SP,PFACT+2
     326 156044 000134                  	JMP	@(4)+
     327                                ;
     328 156046 012400                  FNCALL::MOV	(4)+,R0
     329 156050 012002                  	MOV	(0)+,R2
     330 156052 001413                  	BEQ	2$
     331 156054 011401                  	MOV	@R4,R1
     332 156056 005201                  	INC	R1
     333 156060 022422                  1$:	CMP	(4)+,(2)+
     334 156062 001010                  	BNE	3$
     335 156064 077103                  	SOB	R1,1$
     336 156066 010410                  	MOV	R4,@R0
     337 156070 010204                  	MOV	R2,R4
     338 156072 016767  002130' 002126' 	MOV	PFACT+2,PFACT
     339 156100 000134                  	JMP	@(4)+
     340 156102 104422                  2$:	TRAP	18.
     341 156104 104405                  3$:	TRAP	5
     342                                ;
     343 156106 016746  002126'         APAR::	MOV	PFACT,-(SP)
     344 156112 162416                  	SUB	(4)+,@SP
     345 156114 000134                  	JMP	@(4)+
     346                                ;
     347 156116 012701  000001          IPAR::	MOV	#1,R1
     348 156122 000405                  	BR	PARAM
     349                                ;
     350 156124 012701  000002          SPAR::	MOV	#2,R1
     351 156130 000402                  	BR	PARAM
     352                                ;
     353 156132 012701  000004          DPAR::	MOV	#4,R1
     354                                ;
     355 156136 016700  002126'         PARAM:	MOV	PFACT,R0
     356 156142 162400                  	SUB	(4)+,R0
     357 156144 014046                  1$:	MOV	-(0),-(SP)
     358 156146 077102                  	SOB	R1,1$
     359 156150 000134                  	JMP	@(4)+
     360                                ;
     361 156152 012446                  DCONST::MOV     (R4)+,-(SP)
     362 156154 012446                          MOV     (R4)+,-(SP)
     363 156156 012446                  SCONST::MOV     (R4)+,-(SP)
     364 156160 012446                  ICONST::MOV     (R4)+,-(SP)
     365 156162 000134                          JMP     @(R4)+
     366                                ;
     367 156164 012601                  DXVAR:: MOV     (SP)+,R1
     368 156166 000401                          BR      DVAR1
     369                                ;
     370 156170 012401                  DVAR::  MOV     (R4)+,R1
     371 156172 062701  000010          DVAR1:  ADD     #10,R1
     372 156176 014146                          MOV     -(R1),-(SP)
     373 156200 014146                          MOV     -(R1),-(SP)
     374 156202 014146                          MOV     -(R1),-(SP)
     375 156204 014146                          MOV     -(R1),-(SP)
     376 156206 000134                          JMP     @(R4)+
     377                                ;
     378 156210 012601                  SXVAR:: MOV     (SP)+,R1
     379 156212 000401                          BR      SVAR1
     380                                ;
     381 156214 012401                  SVAR::  MOV     (R4)+,R1
     382 156216 016146  000002          SVAR1:  MOV     2(R1),-(SP)
     383 156222 011146                          MOV     @R1,-(SP)
     384 156224 000134                          JMP     @(R4)+
     385                                ;
     386 156226 013646                  IXVAR:: MOV     @(SP)+,-(SP)
     387 156230 000134                          JMP     @(R4)+
     388                                ;
     389 156232 013446                  IVAR::  MOV     @(R4)+,-(SP)
     390 156234 000134                          JMP     @(R4)+
     391                                ;
     392 156236 011600                  $XVAR:: MOV     @SP,R0
     393 156240 112001                          MOVB    (R0)+,R1
     394 156242 112016                          MOVB    (R0)+,@SP
     395 156244 112066  000001                  MOVB    (R0)+,1(SP)
     396 156250 005046                          CLR     -(SP)
     397 156252 150116                          BISB    R1,@SP
     398 156254 000134                          JMP     @(R4)+
     399                                ;
     400 156256 012600                  $XMOV:: MOV     (SP)+,R0
     401 156260 012601                          MOV     (SP)+,R1
     402 156262 012602                          MOV     (SP)+,R2
     403 156264 110022                          MOVB    R0,(R2)+
     404 156266 110122                          MOVB    R1,(R2)+
     405 156270 000301                          SWAB    R1
     406 156272 110122                          MOVB    R1,(R2)+
     407 156274 000134                          JMP     @(R4)+
     408                                ;
     409 156276 016601  000004          SXMOV:: MOV     4(SP),R1
     410 156302 000404                          BR      XMOV
     411                                ;
     412 156304 016601  000010          DXMOV:: MOV     10(SP),R1
     413 156310 012621                          MOV     (SP)+,(R1)+
     414 156312 012621                          MOV     (SP)+,(R1)+
     415 156314 012621                  XMOV::  MOV     (SP)+,(R1)+
     416 156316 012611                          MOV     (SP)+,@R1
     417 156320 005726                  SPJ:	TST     (SP)+
     418 156322 000134                          JMP     @(R4)+
     419                                ;
     420                                ;
     421 156324 012636                  IXMOV:: MOV     (SP)+,@(SP)+
     422 156326 000134                          JMP     @(R4)+
     423                                ;
     424 156330 012401                  SMOV::  MOV     (R4)+,R1
     425 156332 000403                          BR      MOVS
     426                                ;
     427 156334 012401                  DMOV::  MOV     (R4)+,R1
     428 156336 012621                  	MOV     (SP)+,(R1)+
     429 156340 012621                          MOV     (SP)+,(R1)+
     430 156342 012621                  MOVS:	MOV     (SP)+,(R1)+
     431 156344 012611                  	MOV	(SP)+,@R1
     432 156346 000134                  	JMP     @(R4)+
     433                                ;
     434 156350 012634                  IMOV::  MOV     (SP)+,@(R4)+
     435 156352 000134                          JMP     @(R4)+
     436                                ;
     437 156354 012603                  MIDMOV::MOV     (SP)+,R3
     438 156356 012602                          MOV     (SP)+,R2
     439 156360 012601                          MOV     (SP)+,R1
     440 156362 012600                          MOV     (SP)+,R0
     441 156364 020301                          CMP     R3,R1
     442 156366 003401                          BLE     1$
     443 156370 010103                          MOV     R1,R3
     444 156372 005303                  1$:     DEC     R3
     445 156374 100402                          BMI     3$
     446 156376 112220                          MOVB    (R2)+,(R0)+
     447 156400 000774                          BR      1$
     448 156402 000134                  3$:     JMP     @(R4)+
     449                                ;
     450 156404 016700  002016'         FORDBL::MOV     CIKL,R0
     451 156410 012640                          MOV     (SP)+,-(R0)
     452 156412 012640                          MOV     (SP)+,-(R0)
     453 156414 012640                          MOV     (SP)+,-(R0)
     454 156416 012640                          MOV     (SP)+,-(R0)
     455 156420 012640                          MOV     (SP)+,-(R0)
     456 156422 012640                          MOV     (SP)+,-(R0)
     457 156424 000402                  	BR	FORMOV
     458 156426 016700  002016'         FORINT::MOV	CIKL,R0
     459 156432 012640                  FORMOV: MOV     (SP)+,-(R0)
     460 156434 012640                          MOV     (SP)+,-(R0)
     461 156436 012440                          MOV     (R4)+,-(R0)
     462 156440 012440                          MOV     (R4)+,-(R0)
     463 156442 020067  002014'                 CMP     R0,ENDCOD
     464 156446 103403                          BLO     1$
     465 156450 010067  002016'                 MOV     R0,CIKL
     466 156454 000134                          JMP     @(R4)+
     467 156456 104407                  1$:     TRAP    7
     468                                ;
     469 156460 012602                  LIT::	MOV	(SP)+,R2
     470 156462 001716                  	BEQ	SPJ
     471 156464 000561                  	BR	OUT2
     472                                ;
     473 156466 016701  002016'         NXSKIP::MOV     CIKL,R1
     474 156472 012400                  	MOV	(R4)+,R0
     475 156474 001001                  	BNE	1$
     476 156476 011100                  	MOV	@R1,R0
     477 156500 020167  002020'         1$:	CMP	R1,LIMIT
     478 156504 103016                  	BHIS	3$
     479 156506 020021                  	CMP	R0,(R1)+
     480 156510 001413                  	BEQ	2$
     481 156512 014102                  	MOV	-(R1),R2
     482 156514 062701  000010          	ADD	#10,R1
     483 156520 032742  040000          	BIT	#40000,-(R2)
     484 156524 001002                  	BNE	10$
     485 156526 062701  000014          	ADD	#14,R1
     486 156532 010167  002016'         10$:	MOV	R1,CIKL
     487 156536 000760                  	BR	1$
     488 156540 000134                  2$:	JMP	@(R4)+
     489 156542 104401                  3$:	TRAP	1
     490                                ;
     491 156544 016002  177776          NEXSNG::MOV	-2(R0),R2
     492 156550 006102                  	ROL	R2
     493 156552 100406                  	BMI	1$
     494 156554 006102                  	ROL	R2
     495 156556 100027                  	BPL	NEXDBL
     496 156560 005046                  	CLR	-(SP)
     497 156562 005046                  	CLR	-(SP)
     498 156564 022020                  	CMP	(R0)+,(R0)+
     499 156566 000427                  	BR	NEXADD
     500 156570 022424                  1$:	CMP	(R4)+,(R4)+
     501                                ;
     502 156572 022121                  NEXINT::CMP	(R1)+,(R1)+
     503 156574 011102                  	MOV	@R1,R2
     504 156576 061002                  	ADD	@R0,R2
     505 156600 102415                  	BVS	4$
     506 156602 010210                  	MOV	R2,@R0
     507 156604 005711                  	TST	@R1
     508 156606 100404                  	BMI	2$
     509 156610 020241                  	CMP	R2,-(R1)
     510 156612 003004                  	BGT	3$
     511 156614 014104                  1$:	MOV	-(R1),R4
     512 156616 000134                  	JMP	@(R4)+
     513 156620 020241                  2$:	CMP	R2,-(R1)
     514 156622 002374                  	BGE	1$
     515 156624 062767  000010  002016' 3$:	ADD	#10,CIKL
     516 156632 000134                  	JMP	@(R4)+
     517 156634 104406                  4$:	TRAP	6
     518                                ;
     519 156636 062700  000006          NEXDBL::ADD     #6,R0
     520 156642 011046                          MOV     @R0,-(SP)
     521 156644 014046                          MOV     -(R0),-(SP)
     522 156646 014046                  NEXADD: MOV     -(R0),-(SP)
     523 156650 014046                          MOV     -(R0),-(SP)
     524 156652 062701  000012          	ADD     #12,R1
     525 156656 012146                          MOV     (R1)+,-(SP)
     526 156660 012146                          MOV     (R1)+,-(SP)
     527 156662 012146                          MOV     (R1)+,-(SP)
     528 156664 011146                          MOV     @R1,-(SP)
     529 156666 000167  167144'                 JMP     $DADD$
     530                                ;
     531 156672 011601                  NEWSTR::MOV     (SP),R1
     532 156674 004767  156736'         	CALL	TSTFRE
     533 156700 160167  002012'                 SUB     R1,FRELEN
     534 156704 016600  000002                  MOV     2(SP),R0
     535 156710 016702  002010'                 MOV     FREBEG,R2
     536 156714 010266  000002                  MOV     R2,2(SP)
     537 156720 060167  002010'                 ADD     R1,FREBEG
     538 156724 005301                  1$:     DEC     R1
     539 156726 100402                          BMI     2$
     540 156730 112022                          MOVB    (R0)+,(R2)+
     541 156732 000774                          BR      1$
     542 156734 000134                  2$:     JMP     @(R4)+
     543                                ;
     544 156736 020167  002012'         TSTFRE:	CMP	R1,FRELEN
     545                                ;	BLOS	1$
     546                                ;	MOV	R1,-(SP)
     547                                ;	CALL	STRSQU
     548                                ;	MOV	(SP)+,R1
     549                                ;	CMP	R1,FRELEN
     550 156742 101001                   	BHI	2$
     551 156744 000207                  1$:	RETURN
     552 156746 104416                  2$:	TRAP	14.
     553                                ;
     554 156750 005716                  NEG::   TST     @SP
     555 156752 001402                          BEQ     1$
     556 156754 062716  100000                  ADD     #100000,@SP
     557 156760 000134                  1$:     JMP     @(R4)+
     558                                ;
     559 156762 012700  000007          BEEP0::	MOV	#7,R0	;TIK PYPT
     560 156766 000405                  	BR	JEND	;TIK PYPT
     561                                ;	MOV	#1000,-(SP)
     562                                ;BEEP1::	MOV	#37,-(SP)
     563                                ;BEEP2::	MOV	(SP)+,R2
     564                                ;	MOV     (SP)+,R1
     565                                ;	CALL	SIGNAL
     566                                ;	JMP	@(R4)+
     567                                ;
     568 156770 012700  000012          NEWLIN::MOV	#12,R0
     569 156774 000402                  	BR	JEND
     570                                ;
     571 156776 012700  000014          JCLS::	MOV	#14,R0
     572 157002 010467  002134'         JEND:	MOV	R4,SAVJMP
     573 157006 004767  122526'         	CALL    ISVTO
     574 157012 000413                  	BR	OUT3
     575                                ;
     576 157014 004767  164664'         SOUTSP::CALL	EGO
     577 157020 000402                  	BR	J_OUT
     578                                ;
     579 157022 004767  164710'         DOUTSP::CALL	DGO
     580 157026 012602                  J_OUT:	MOV	(SP)+,R2
     581 157030 012601                  OUT2:	MOV	(SP)+,R1
     582 157032 010467  002134'         OUT1:	MOV	R4,SAVJMP
     583 157036 004767  122546'         	CALL	ISVETO
     584 157042 005067  002134'         OUT3:	CLR	SAVJMP
     585 157046 000134                  	JMP	@(R4)+
     586                                ;
     587 157050 022626                  DLPOS::	CMP	(SP)+,(SP)+
     588 157052 005726                  SLPOS::	TST	(SP)+
     589 157054 005726                  ILPOS::	TST	(SP)+
     590 157056 005046                  LPOS::	CLR	-(SP)
     591 157060 116716  002136'         	MOVB	LPTPOS,@SP
     592 157064 005216                  	INC	@SP
     593 157066 000134                  	JMP	@(4)+
     594                                ;
     595 157070 012605                  IOUTSP::MOV     (SP)+,R5
     596 157072 004767  140536'                 CALL    ISGUNP
     597 157076 000755                          BR      OUT1
     598                                ;
     599 157100 010467  002134'         GETLIT::MOV	R4,SAVJMP
     600 157104 162767  000010  002134' 	SUB	#10,SAVJMP
     601 157112 000420                  	BR	G01
     602                                ;
     603 157114 012467  002040'         RESTV::	MOV	(4)+,DATPTR
     604 157120 000134                  	JMP	@(4)+
     605                                ;
     606 157122 016703  002040'         READV::	MOV	DATPTR,R3
     607 157126 001001                  	BNE	1$
     608 157130 104404                  	TRAP	4
     609 157132 012767  177777  002042' 1$:	MOV	#-1,DATINP
     610 157140 010467  002134'         	MOV	R4,SAVJMP
     611 157144 012446                  	MOV	(4)+,-(SP)
     612 157146 000461                  	BR	G1
     613                                ;
     614 157150 010467  002134'         GET::   MOV     R4,SAVJMP
     615 157154 012446                  G01:	MOV     (R4)+,-(SP)
     616 157156 016700  003016'         	MOV	IODEV,R0
     617 157162 010067  002042'         	MOV	R0,DATINP
     618 157166 001014                  	BNE	G03
     619 157170 012700  000077                  MOV     #'?,R0
     620 157174 000430                          BR      G00
     621 157176 121327  000012          G13:	CMPB	@R3,#12
     622 157202 001414                  	BEQ	G02
     623 157204 021467  002022'         	CMP	@R4,LENT
     624 157210 103142                  	BHIS	G30
     625 157212 010346                  	MOV	R3,-(SP)
     626 157214 005724                  	TST	(4)+
     627 157216 000134                  	JMP	@(4)+
     628 157220 004767  163060'         G03:	CALL	FILINP
     629 157224 020127  003022          	CMP	R1,#BUF
     630 157230 001022                  	BNE	G04
     631 157232 104467                  	TRAP	55.
     632 157234 016700  002042'         G02:	MOV	DATINP,R0
     633 157240 001402                  	BEQ	1$
     634 157242 100366                  	BPL	G03
     635 157244 104404                  	TRAP	4
     636 157246 012700  000077          1$:	MOV     #'?,R0
     637 157252 004767  122522'         	CALL    ISV
     638 157256 004767  122522'         G00:    CALL    ISV
     639 157262 004767  124076'                 CALL    CURON
     640 157266 004767  121052'                 CALL    IVEIL
     641 157272 004767  124120'                 CALL    CUROFF
     642 157276 012703  003022          G04:	MOV	#BUF,R3
     643 157302 104512                  	TRAP	112
     644 157304 121327  000012          	CMPB	@R3,#12
     645 157310 001543                  	BEQ	G5
     646 157312 020416                  G1:     CMP     R4,@SP
     647 157314 001542                          BEQ     G6
     648 157316 104512                  	TRAP	112
     649 157320 121327  000054                  CMPB    @R3,#',
     650 157324 001324                          BNE     G13
     651 157326 022467  002022'                 CMP     (R4)+,LENT
     652 157332 103001                  	BHIS	G12
     653 157334 014404                  	MOV	-(R4),R4
     654 157336 005203                  G12:    INC     R3
     655 157340 000764                          BR      G1
     656 157342 012746  000054          G20:	MOV	#',,-(SP)
     657 157346 010146                  	MOV	R1,-(SP)
     658 157350 005001                  	CLR	R1
     659 157352 010346                  	MOV	R3,-(SP)
     660 157354 121327  000042                  CMPB    @R3,#'"
     661 157360 001003                          BNE     22$
     662 157362 112366  000004          21$:    MOVB    (R3)+,4(SP)
     663 157366 005216                  	INC	(SP)
     664 157370 121327  000012          22$:    CMPB    @R3,#12
     665 157374 001405                          BEQ     24$
     666 157376 122366  000004                  CMPB    (3)+,4(SP)
     667 157402 001402                          BEQ     24$
     668 157404 005201                          INC     R1
     669 157406 000770                          BR      22$
     670 157410 010005                  24$:	MOV	R0,R5
     671 157412 011646                  	MOV	@SP,-(SP)
     672 157414 010366  000002          	MOV	R3,2(SP)
     673 157420 032701  177400          	BIT	#177400,R1
     674 157424 001033                  	BNE	28$
     675 157426 004767  156736'         	CALL	TSTFRE
     676 157432 016702  002010'         	MOV	FREBEG,R2
     677 157436 012603                  	MOV	(SP)+,R3
     678 157440 010100                  	MOV	R1,R0
     679 157442 001402                  	BEQ	26$
     680 157444 112322                  25$:	MOVB	(3)+,(2)+
     681 157446 077102                  	SOB	R1,25$
     682 157450 012603                  26$:	MOV	(SP)+,R3
     683 157452 012601                  	MOV	(SP)+,R1
     684 157454 110021                  	MOVB	R0,(R1)+
     685 157456 105705                  	TSTB	R5
     686 157460 100401                  	BMI	27$
     687 157462 105021                  	CLRB	(R1)+
     688 157464 116721  002010'         27$:	MOVB	FREBEG,(R1)+
     689 157470 116721  002011'         	MOVB	FREBEG+1,(R1)+
     690 157474 160067  002012'         	SUB	R0,FRELEN
     691 157500 010267  002010'         	MOV	R2,FREBEG
     692 157504 022627  000054                  CMP     (SP)+,#',
     693 157510 001700                          BEQ     G1
     694 157512 000455                          BR      G40
     695 157514 104417                  28$:    TRAP    15.
     696 157516 012401                  G30:    MOV     (R4)+,R1
     697 157520 010100                  	MOV	R1,R0
     698 157522 014000                  G3:	MOV	-(R0),R0
     699 157524 100706                          BMI     G20
     700 157526 010446                  	MOV	R4,-(SP)
     701 157530 010146                  	MOV	R1,-(SP)
     702 157532 004767  151370'         	CALL	CISLO
     703 157536 000463                  	BR	G41
     704 157540 000462                  	BR	G41
     705 157542 000461                  	BR	G41
     706 157544 006100                  	ROL	R0
     707 157546 100417                  	BMI	32$
     708 157550 006100                  	ROL	R0
     709 157552 100410                  	BMI	31$
     710 157554 004467  160036'         	JSR	R4,TODBL
     711 157560 166742  156304  157644  	.WORD	SD,DXMOV,G33
     712 157566 166646  156304  157644  	.WORD	ID,DXMOV,G33
     713 157574 004467  160002'         31$:	JSR	R4,TOSNG
     714 157600 166656  156276  157644  	.WORD	IS,SXMOV,G33
     715 157606 004467  157724'         32$:	JSR	R4,TOINT
     716 157612 166770  156324  157644  	.WORD	SI,IXMOV,G33
     717 157620 011604                  G5:	MOV	@SP,R4
     718 157622 005067  002134'         G6:	CLR	SAVJMP
     719 157626 005767  002042'         	TST	DATINP
     720 157632 100002                  	BPL	G66
     721 157634 010367  002040'         	MOV	R3,DATPTR
     722 157640 005726                  G66:	TST	(SP)+
     723 157642 000134                  	JMP	@(4)+
     724 157644 012604                  G33:	MOV	(SP)+,R4
     725 157646 104512                  G40:	TRAP	112
     726 157650 121327  000054          	CMPB	@R3,#',
     727 157654 001630                          BEQ     G12
     728 157656 121327  000012                  CMPB    @R3,#12
     729 157662 001613                          BEQ     G1
     730 157664 005767  002042'         	TST	DATINP
     731 157670 003210                  	BGT	G1
     732 157672 104415                  G4:     TRAP    13.
     733 157674 005726                          TST     (SP)+
     734 157676 016704  002134'                 MOV     SAVJMP,R4
     735 157702 000174  177776          	JMP	@-2(R4)
     736 157706 022626                  G41:	CMP	(SP)+,(SP)+
     737 157710 000770                  	BR	G4
     738 157712 012601                  GETARR::MOV     (SP)+,R1
     739 157714 012603                          MOV     (SP)+,R3
     740 157716 016400  177772                  MOV     -6(R4),R0
     741 157722 000677                  	BR	G3
     742                                ;
     743 157724 012602                  TOINT::	MOV	(SP)+,R2
     744 157726 002002                  	BGE	1$
     745 157730 010536                  	MOV	R5,@(SP)+
     746 157732 000744                  	BR	G33
     747 157734 021627  044000          1$:	CMP	@SP,#44000
     748 157740 002016                  	BGE	E1
     749 157742 021627  144000          	CMP	@SP,#144000
     750 157746 103404                  	BLO	3$
     751 157750 001012                  	BNE	E1
     752 157752 105766  000003          	TSTB	3(SP)
     753 157756 001007                  	BNE	E1
     754 157760 005702                  3$:	TST	R2
     755 157762 001033                  	BNE	FROMS
     756 157764 012666  000002          FROMD:	MOV	(SP)+,2(SP)
     757 157770 012666  000002          	MOV	(SP)+,2(SP)
     758 157774 000134                  	JMP	@(R4)+
     759                                ;
     760                                E1:	
     761                                E2:
     762 157776 104406                  E3:	TRAP	6
     763 160000 104405                  	TRAP	5
     764                                ;
     765 160002 012602                  TOSNG:	MOV	(SP)+,R2
     766 160004 100412                  	BMI	1$
     767 160006 001020                  	BNE	NOCONV
     768 160010 006166  000004          	ROL	4(SP)
     769 160014 005566  000002          	ADC	2(SP)
     770 160020 005516                  	ADC	@SP
     771 160022 102765                  	BVS	E2
     772 160024 103764                  	BCS	E2
     773 160026 005724                  	TST	(R4)+
     774 160030 000755                  	BR	FROMD
     775 160032 005744                  1$:	TST	-(R4)
     776 160034 000404                  	BR	FROMI
     777                                ;
     778 160036 005726                  TODBL:	TST	(SP)+
     779 160040 001403                  	BEQ	NOCONV
     780 160042 100003                  	BPL	FROMS
     781 160044 022424                  	CMP	(R4)+,(R4)+
     782 160046 010546                  FROMI:	MOV	R5,-(SP)
     783 160050 005724                  NOCONV:	TST	(R4)+
     784 160052 000134                  FROMS:	JMP	@(R4)+
     785                                ;
     786 160054 104414                  ARR12:	TRAP	12.
     787                                ;
     788 160056 012401                  INDEX:: MOV     (R4)+,R1
     789 160060 012100                          MOV     (R1)+,R0
     790 160062 001017                          BNE     1$
     791 160064 105767  002000'         	TSTB	LYGIS
     792 160070 001771                  	BEQ	ARR12
     793 160072 016700  002014'                 MOV     ENDCOD,R0
     794 160076 005200                  	INC	R0
     795 160100 042700  000001          	BIC	#1,R0
     796 160104 020067  002016'                 CMP     R0,CIKL
     797 160110 103105                          BHIS    AR7
     798 160112 012710  000013                  MOV     #11.,@R0
     799 160116 112711  000001                  MOVB    #1,@R1
     800 160122 012403                  1$:     MOV     (R4)+,R3
     801 160124 120311                          CMPB    R3,@R1
     802 160126 001143                          BNE     AR9
     803 160130 012601                          MOV     (SP)+,R1
     804 160132 100540                          BMI     AR5
     805 160134 020120                          CMP     R1,(R0)+
     806 160136 002137                          BGE     AR9
     807 160140 005303                  2$:     DEC     R3
     808 160142 003413                          BLE     3$
     809 160144 012602                          MOV     (SP)+,R2
     810 160146 100532                          BMI     AR5
     811 160150 020210                          CMP     R2,@R0
     812 160152 002131                          BGE     AR9
     813 160154 010146                          MOV     R1,-(SP)
     814 160156 014001                          MOV     -(R0),R1
     815 160160 004767  160442'                 CALL    DAUG
     816 160164 062601                          ADD     (SP)+,R1
     817 160166 022020                          CMP     (R0)+,(R0)+
     818 160170 000763                          BR      2$
     819 160172 016403  177774          3$:     MOV     -4(R4),R3
     820 160176 116302  000003                  MOVB    3(R3),R2
     821 160202 004767  160442'                 CALL    DAUG
     822 160206 060100                          ADD     R1,R0
     823 160210 010046                          MOV     R0,-(SP)
     824 160212 005723                          TST     (R3)+
     825 160214 001401                          BEQ     4$
     826 160216 000134                          JMP     @(R4)+
     827 160220 024444                  4$:     CMP     -(R4),-(R4)
     828                                ;
     829 160222 012746  000012          ARR10::MOV      #10.,-(SP)
     830                                ;
     831 160226 005267  002014'         ARRAY:: INC     ENDCOD
     832 160232 042767  000001  002014'         BIC     #1,ENDCOD
     833 160240 012400                  AR1:    MOV     (R4)+,R0
     834 160242 005720                          TST     (R0)+
     835 160244 001075                          BNE     AR10
     836 160246 011403                          MOV     @R4,R3
     837 160250 016700  002014'                 MOV     ENDCOD,R0
     838 160254 060003                          ADD     R0,R3
     839 160256 020367  002016'                 CMP     R3,CIKL
     840 160262 103020                          BHIS    AR7
     841 160264 160003                          SUB     R0,R3
     842 160266 012601                          MOV     (SP)+,R1
     843 160270 100461                          BMI     AR5
     844 160272 005201                          INC     R1
     845 160274 102413                          BVS     AR7
     846 160276 010120                          MOV     R1,(R0)+
     847 160300 005303                  1$:     DEC     R3
     848 160302 001411                          BEQ     AR2
     849 160304 012602                          MOV     (SP)+,R2
     850 160306 002452                          BLT     AR5
     851 160310 005202                          INC     R2
     852 160312 102404                          BVS     AR7
     853 160314 010220                          MOV     R2,(R0)+
     854 160316 004767  160442'                 CALL    DAUG
     855 160322 100366                          BPL     1$
     856 160324 104407                  AR7:    TRAP    7
     857 160326 016403  177776          AR2:    MOV     -2(R4),R3
     858 160332 116302  000003                  MOVB    3(R3),R2
     859 160336 004767  160442'                 CALL    DAUG
     860 160342 100770                          BMI     AR7
     861 160344 060100                          ADD     R1,R0
     862 160346 102766                          BVS     AR7
     863 160350 020067  002016'                 CMP     R0,CIKL
     864 160354 101363                          BHI     AR7
     865 160356 016723  002014'                 MOV     ENDCOD,(R3)+
     866 160362 010067  002014'                 MOV     R0,ENDCOD
     867 160366 112413                          MOVB    (R4)+,@R3
     868 160370 005204                          INC     R4
     869 160372 032713  000400                  BIT     #400,@R3
     870 160376 001404                          BEQ     3$
     871 160400 105040                  2$:     CLRB    -(R0)
     872 160402 005301                          DEC     R1
     873 160404 003375                          BGT     2$
     874 160406 000404                          BR      4$
     875 160410 005040                  3$:     CLR     -(R0)
     876 160412 162701  000002                  SUB     #2,R1
     877 160416 003374                          BGT     3$
     878 160420 105767  002000'         4$:     TSTB    LYGIS
     879 160424 001401                          BEQ     5$
     880 160426 000134                          JMP     @(R4)+
     881 160430 000167  133754'         5$:     JMP     STAR
     882 160434 104405                  AR5:    TRAP    5
     883 160436 104411                  AR9:    TRAP    9.
     884 160440 104412                  AR10:   TRAP    10.
     885                                ;
     886 160442 010105                  DAUG::	MOV     R1,R5
     887 160444 020502                  	CMP	R5,R2
     888 160446 101402                          BLOS    3$
     889 160450 010205                          MOV     R2,R5
     890 160452 010102                          MOV     R1,R2
     891 160454 005001                  3$:     CLR     R1
     892 160456 005705                  4$:     TST     R5
     893 160460 001412                          BEQ     7$
     894 160462 005702                          TST     R2
     895 160464 100406                          BMI     6$
     896 160466 006205                          ASR     R5
     897 160470 103002                          BCC     5$
     898 160472 060201                          ADD     R2,R1
     899 160474 102402                          BVS     6$
     900 160476 006302                  5$:     ASL     R2
     901 160500 000766                          BR      4$
     902 160502 012705  177777          6$:     MOV     #-1,R5
     903 160506 000207                  7$:     RETURN
     904                                ;
     905 160510 032716  177400          CHR::   BIT     #177400,@SP
     906 160514 001007                          BNE     IFCERR
     907 160516 111667  003021'         	MOVB	@SP,INK+1
     908 160522 012716  003021                  MOV     #INK+1,@SP
     909 160526 012746  000001          	MOV     #1,-(SP)
     910 160532 000134                          JMP     @(R4)+
     911 160534 104405                  IFCERR:	TRAP	5
     912                                ;
     913 160536 012636                  POKJMP::MOV     (SP)+,@(SP)+
     914 160540 000134                          JMP     @(R4)+
     915                                ;
     916 160542 005726                  OUTJMP::TST     (SP)+
     917 160544 001402                          BEQ     1$
     918 160546 052636                          BIS     (SP)+,@(SP)+
     919 160550 000134                          JMP     @(R4)+
     920 160552 042636                  1$:     BIC     (SP)+,@(SP)+
     921 160554 000134                          JMP     @(R4)+
     922                                ;
     923 160556 017616  000000          PEEK::  MOV     @(SP),(SP)
     924 160562 000134                          JMP     @(R4)+
     925                                ;
     926 160564 017666  000002  000002  INP::   MOV     @2(SP),2(SP)
     927 160572 005116                          COM     (SP)
     928 160574 042616                          BIC     (SP)+,(SP)
     929 160576 000134                          JMP     @(R4)+
     930                                ;
     931 160600 022626                  DFRE::  CMP     (SP)+,(SP)+
     932 160602 005726                  SFRE::  TST     (SP)+
     933 160604 005726                  IFRE::  TST     (SP)+
     934 160606 016746  002016'         FRE::   MOV     CIKL,-(SP)
     935 160612 166716  002014'                 SUB     ENDCOD,@SP
     936 160616 000134                  ENDFRE: JMP     @(R4)+
     937                                ;
     938 160620 005726                  $FRE::	TST	(SP)+
     939 160622 004767  163174'         	CALL	STRSQU
     940 160626 016716  002012'         	MOV	FRELEN,@SP
     941 160632 000134                  	JMP	@(R4)+
     942                                ;
     943 160634 004767  163174'         $SQUEE::CALL	STRSQU
     944 160640 000134                  	JMP	@(R4)+
     945                                ;
     946                                CLRMEM::
     947 160642 021627  070000          	CMP	@SP,#70000
     948 160646 101332                  	BHI	IFCERR
     949 160650 012737  125070  000004  	MOV	#IRPS2-10,@#BREAKW
     950 160656 004767  162664'         	CALL	CLOALL
     951 160662 012602                  	MOV	(SP)+,R2
     952 160664 006202                  	ASR	R2
     953 160666 006302                  	ASL	R2
     954 160670 166702  002030'         	SUB	HIMEM,R2
     955 160674 004767  160742'         	CALL	TABMOV
     956 160700 060267  002030'         	ADD	R2,HIMEM
     957 160704 004767  134370'         	CALL	CLRBUF
     958 160710 004767  134460'         	CALL	CLRCOD
     959 160714 012600                  	MOV	(SP)+,R0
     960 160716 005200                  	INC	R0
     961 160720 042700  000001          	BIC	#1,R0
     962 160724 010067  002006'         	MOV	R0,STRSIZ
     963 160730 012737  120234  000004  	MOV	#BREAK,@#BREAKW
     964 160736 000167  133754'         S1T:	JMP	STAR
     965                                ;
     966 160742 016700  002024'         TABMOV::MOV	TABTOP,R0
     967 160746 060200                  	ADD	R2,R0
     968 160750 020067  002002'         	CMP	R0,TXEND
     969 160754 002447                  	BLT	CLRERR
     970 160756 016701  002026'         	MOV	FCB,R1
     971 160762 166701  002024'         	SUB	TABTOP,R1
     972 160766 001416                  	BEQ	4$
     973 160770 006201                  	ASR	R1
     974 160772 005702                  	TST	R2
     975 160774 100407                  	BMI	2$
     976 160776 016703  002026'         	MOV	FCB,R3
     977 161002 010300                  	MOV	R3,R0
     978 161004 060200                  	ADD	R2,R0
     979 161006 014340                  3$:	MOV	-(R3),-(R0)
     980 161010 077102                  	SOB	R1,3$
     981 161012 000404                  	BR	4$
     982 161014 016703  002024'         2$:	MOV	TABTOP,R3
     983 161020 012320                  5$:	MOV	(R3)+,(R0)+
     984 161022 077102                  	SOB	R1,5$
     985 161024 060267  002024'         4$:	ADD	R2,TABTOP
     986 161030 000207                  	RETURN
     987                                ;
     988 161032 011600                  CLRSTR::MOV	@SP,R0
     989 161034 002637                  	BLT	IFCERR
     990 161036 005200                  	INC	R0
     991 161040 042700  000001          	BIC	#1,R0
     992 161044 010016                  	MOV	R0,@SP
     993 161046 166700  002006'         	SUB	STRSIZ,R0	;
     994 161052 010001                  	MOV	R0,R1		;АНАЛИЗ I-ГО АРГУМЕНТА
     995 161054 066700  002014'         	ADD	ENDCOD,R0	;
     996 161060 020067  002022'         	CMP	R0,LENT
     997 161064 101003                  	BHI	CLRERR
     998 161066 012667  002006'         	MOV	(SP)+,STRSIZ
     999 161072 000402                  	BR	CLR1
    1000 161074 104407                  CLRERR:	TRAP	7
    1001 161076 005001                  CLR::	CLR	R1
    1002                                ;.............УСТАНОВКА ОБЛАСТИ ДЛЯ СТРОК..........
    1003 161100 016700  002004'         CLR1:	MOV	STRREG,R0
    1004 161104 012737  125070  000004  	MOV	#IRPS2-10,@#BREAKW
    1005 161112 010067  002010'         	MOV	R0,FREBEG
    1006 161116 016767  002006' 002012' 	MOV	STRSIZ,FRELEN
    1007 161124 016767  002022' 002020' 	MOV	LENT,LIMIT
    1008 161132 016767  002022' 002016' 	MOV	LENT,CIKL
    1009 161140 060167  002014'         	ADD     R1,ENDCOD
    1010                                ;.........................СДВИГ МАССИВОВ...........
    1011 161144 066700  002006'         	ADD	STRSIZ,R0
    1012 161150 016703  002014'         	MOV	ENDCOD,R3
    1013 161154 010105                  	MOV	R1,R5
    1014 161156 001413                  	BEQ	1$
    1015 161160 005401                  	NEG	R1
    1016 161162 100405                  	BMI	20$
    1017 161164 060001                  	ADD	R0,R1
    1018 161166 012120                  10$:	MOV	(R1)+,(R0)+
    1019 161170 020003                  	CMP	R0,R3
    1020 161172 103775                  	BLO	10$
    1021 161174 000404                  	BR	1$
    1022 161176 060301                  20$:	ADD	R3,R1
    1023 161200 014143                  22$:	MOV	-(R1),-(R3)
    1024 161202 020300                  	CMP	R3,R0
    1025 161204 101375                  	BHI	22$
    1026                                ;...................ОЧИСТКА ПЕРЕМЕННЫХ.............
    1027 161206 016702  002022'         1$:	MOV	LENT,R2
    1028 161212 020267  002024'         7$:	CMP	R2,TABTOP
    1029 161216 103035                  	BHIS	8$
    1030 161220 105712                  	TSTB	@R2
    1031 161222 100020                  	BPL	6$
    1032 161224 005722                  	TST	(R2)+
    1033 161226 005722                  	TST	(R2)+
    1034 161230 001413                  	BEQ	77$
    1035 161232 060542                  	ADD	R5,-(R2)
    1036 161234 004767  163474'         	CALL	MASREG
    1037 161240 012200                  	MOV	(R2)+,R0
    1038 161242 005003                  	CLR	R3
    1039 161244 151203                  	BISB	@R2,R3
    1040 161246 006303                  	ASL	R3
    1041 161250 060300                  	ADD	R3,R0
    1042 161252 006201                  	ASR	R1
    1043 161254 005020                  2$:	CLR	(R0)+
    1044 161256 077102                  	SOB	R1,2$
    1045 161260 005722                  77$:	TST	(R2)+
    1046 161262 000753                  	BR	7$
    1047 161264 012200                  6$:	MOV	(R2)+,R0
    1048 161266 100406                  	BMI	5$
    1049 161270 006300                  	ASL	R0
    1050 161272 100405                  	BMI	4$
    1051 161274 006300                  	ASL	R0
    1052 161276 100402                  	BMI	5$
    1053 161300 005022                  	CLR	(R2)+
    1054 161302 005022                  	CLR	(R2)+
    1055 161304 005022                  5$:	CLR	(R2)+
    1056 161306 005022                  4$:	CLR	(R2)+
    1057 161310 000740                  3$:	BR	7$
    1058 161312 012737  120234  000004  8$:	MOV	#BREAK,@#BREAKW
    1059 161320 020467  002004'         	CMP	R4,STRREG
    1060 161324 103401                  	BLO	9$
    1061 161326 000603                   	BR	S1T
    1062 161330 000134                  9$:	JMP	@(R4)+
    1063                                ;
    1064 161332 016600  000002          STR2::  MOV     2(SP),R0
    1065 161336 000402                          BR      STR1
    1066                                ;
    1067 161340 012600                  STR::   MOV     (SP)+,R0
    1068 161342 002417                          BLT     A5
    1069 161344 012601                  STR1:   MOV     (SP)+,R1
    1070 161346 003415                          BLE     A5
    1071 161350 005301                          DEC     R1
    1072 161352 060166  000002                  ADD     R1,2(SP)
    1073 161356 160116                          SUB     R1,@SP
    1074 161360 003410                          BLE     A5
    1075 161362 020016                          CMP     R0,@SP
    1076 161364 002001                          BGE     1$
    1077 161366 010016                          MOV     R0,@SP
    1078 161370 000134                  1$:     JMP     @(R4)+
    1079                                ;
    1080 161372 012605                  ALLSK::	MOV	(SP)+,R5
    1081 161374 032705  177400          	BIT	#177400,R5
    1082 161400 001404                  	BEQ	STRING
    1083 161402 104405                  A5:	TRAP	5
    1084                                ;
    1085 161404 005726                  ALLSM::	TST	(SP)+
    1086 161406 001775                  	BEQ	A5
    1087 161410 113605                  	MOVB	@(SP)+,R5
    1088 161412 011601                  STRING: MOV	(SP),R1
    1089 161414 032701  177400          	BIT	#177400,R1
    1090 161420 001370                  	BNE	A5
    1091 161422 004767  156736'         	CALL	TSTFRE
    1092 161426 160167  002012'         	SUB	R1,FRELEN
    1093 161432 016702  002010'         	MOV	FREBEG,R2
    1094 161436 010216                  	MOV	R2,@SP
    1095 161440 010146                  	MOV	R1,-(SP)
    1096 161442 001404                  	BEQ	2$
    1097 161444 110522                  1$:	MOVB	R5,(R2)+
    1098 161446 077102                  	SOB	R1,1$
    1099 161450 010267  002010'         	MOV	R2,FREBEG
    1100 161454 000134                  2$:	JMP	@(R4)+
    1101                                ;
    1102 161456 012600                  CONCAT::MOV	(SP)+,R0
    1103 161460 012601                  	MOV	(SP)+,R1
    1104 161462 011602                  	MOV	@SP,R2
    1105 161464 060016                  	ADD	R0,@SP
    1106 161466 032716  177400          	BIT	#177400,@SP
    1107 161472 001015                  	BNE	2$
    1108 161474 066602  000002          	ADD	2(SP),R2
    1109 161500 005700                  	TST	R0
    1110 161502 001402                  	BEQ	3$
    1111 161504 112122                  1$:	MOVB	(R1)+,(R2)+
    1112 161506 077002                  	SOB	R0,1$
    1113 161510 166702  002010'         3$:	SUB	FREBEG,R2
    1114 161514 060267  002010'         	ADD	R2,FREBEG
    1115 161520 160267  002012'         	SUB	R2,FRELEN
    1116 161524 000134                          JMP     @(R4)+
    1117 161526 104417                  2$:	TRAP	15.
    1118                                ;
    1119 161530 012616                  LEN::   MOV     (SP)+,@SP
    1120 161532 000134                          JMP     @(R4)+
    1121                                ;
    1122 000001                         .IF EQ,1
    1123                                INSTR::	MOV	(SP)+,R0
    1124                                	MOV	(SP)+,R1
    1125                                	MOV	(SP)+,R2
    1126                                	BEQ	I3
    1127                                	MOV	(SP)+,R3
    1128                                	MOV	(SP)+,R5
    1129                                	BLE	A5
    1130                                	CMP	R5,#255.
    1131                                	BHI	A5
    1132                                	DEC	R5
    1133                                I0:	MOV	R2,-(SP)
    1134                                	SUB	R5,R2
    1135                                	BLE	A5
    1136                                	ADD	R3,R5
    1137                                	MOV	R0,-(SP)
    1138                                	BEQ	I6
    1139                                I1:	MOV	R1,-(SP)
    1140                                1$:	CMPB	(R5)+,(R1)
    1141                                	BEQ	I5
    1142                                	SOB	R2,1$
    1143                                I2:	TST	(SP)+
    1144                                I3:	TST	(SP)+
    1145                                I4:	CLR	@SP
    1146                                	JMP	@(R4)+
    1147                                I5:	CMP	R2,R0
    1148                                	BLT	I2
    1149                                	MOV	R5,-(SP)
    1150                                	DEC	R5
    1151                                8$:	CMPB	(R5)+,(R1)+
    1152                                	BNE	I7
    1153                                	SOB	R0,8$
    1154                                	CMP	(SP)+,(SP)+
    1155                                I6:	TST	(SP)+
    1156                                	DEC	R2
    1157                                	SUB	R2,@SP
    1158                                	JMP	@(R4)+
    1159                                I7:	MOV	(SP)+,R5
    1160                                	MOV	(SP)+,R1
    1161                                	MOV	(SP),R0
    1162                                	DEC	R2
    1163                                	BR	I1
    1164                                ;
    1165                                INSTR2::MOV	(SP)+,R0
    1166                                	MOV	(SP)+,R1
    1167                                	MOV	(SP)+,R2
    1168                                	BEQ	I4
    1169                                	MOV	(SP)+,R3
    1170                                	CLR	R5
    1171                                	BR	I0
    1172                                .ENDC
    1173                                ;
    1174 161534 005726                  ASC::   TST     (SP)+
    1175 161536 001721                  	BEQ	A5
    1176 161540 005000                  	CLR	R0
    1177 161542 153600                  	BISB	@(SP)+,R0
    1178 161544 010046                          MOV     R0,-(SP)
    1179 161546 000134                  	JMP	@(R4)+
    1180                                ;
    1181 161550 010467  002134'         VAL::	MOV	R4,SAVJMP
    1182 161554 004767  163702'         	CALL	PACK
    1183 161560 016704  002134'         	MOV	SAVJMP,R4
    1184 161564 005067  002134'         	CLR	SAVJMP
    1185 161570 005726                  	TST	(SP)+
    1186 161572 000134                  	JMP	@(R4)+
    1187                                ;
    1188 161574 004767  164664'         SSTR::	CALL	EGO
    1189 161600 000134                  	JMP	@(R4)+
    1190                                ;
    1191 161602 004767  164710'         DSTR::	CALL	DGO
    1192 161606 000134                  	JMP	@(R4)+
    1193                                ;
    1194 161610 012605                  ISTR::	MOV	(SP)+,R5
    1195 161612 004767  140536'         	CALL	ISGUNP
    1196 161616 010146                  	MOV	R1,-(SP)
    1197 161620 010246                  	MOV	R2,-(SP)
    1198 161622 000134                  	JMP	@(R4)+
    1199                                ;
    1200 161624 005000                  OCT::	CLR	R0
    1201 161626 012701  003030          	MOV	#BUFOUT+6,R1
    1202 161632 012605                  	MOV	(SP)+,R5
    1203 161634 010502                  1$:	MOV	R5,R2
    1204 161636 042702  177770          	BIC	#177770,R2
    1205 161642 062702  000060          	ADD	#'0,R2
    1206 161646 110241                  	MOVB	R2,-(R1)
    1207 161650 005200                  	INC	R0
    1208 161652 000241                  	CLC
    1209 161654 006005                  	ROR	R5
    1210 161656 006205                  	ASR	R5
    1211 161660 006205                  	ASR	R5
    1212 161662 001364                  	BNE	1$
    1213 161664 010146                  	MOV	R1,-(SP)
    1214 161666 010046                  	MOV	R0,-(SP)
    1215 161670 000134                  	JMP	@(R4)+
    1216                                ;
    1217 161672 005000                  BIN::	CLR	R0
    1218 161674 012701  003040          	MOV	#BUFOUT+16,R1
    1219 161700 012605                  	MOV	(SP)+,R5
    1220 161702 010502                  1$:	MOV	R5,R2
    1221 161704 042702  177776          	BIC	#177776,R2
    1222 161710 062702  000060          	ADD	#000060,R2
    1223 161714 110241                  	MOVB	R2,-(R1)
    1224 161716 005200                  	INC	R0
    1225 161720 000241                  	CLC
    1226 161722 006005                  	ROR	R5
    1227 161724 001366                  	BNE	1$
    1228 161726 010146                  	MOV	R1,-(SP)
    1229 161730 010046                  	MOV	R0,-(SP)
    1230 161732 000134                  	JMP	@(R4)+
    1231                                ;
    1232 161734 005000                  HEX::	CLR	R0
    1233 161736 012701  003026          	MOV	#BUFOUT+4,R1
    1234 161742 012605                  	MOV	(SP)+,R5
    1235 161744 010502                  3$:	MOV	R5,R2
    1236 161746 042702  177760          	BIC	#177760,R2
    1237 161752 020227  000011          	CMP	R2,#9.
    1238 161756 003403                  	BLE	1$
    1239 161760 062702  000067          	ADD	#000067,R2
    1240 161764 000402                  	BR	2$
    1241 161766 062702  000060          1$:	ADD	#000060,R2
    1242 161772 110241                  2$:	MOVB	R2,-(R1)
    1243 161774 005200                  	INC	R0
    1244 161776 000241                  	CLC
    1245 162000 006005                  	ROR	R5
    1246 162002 006205                  	ASR	R5
    1247 162004 006205                  	ASR	R5
    1248 162006 006205                  	ASR	R5
    1249 162010 001355                  	BNE	3$
    1250 162012 010146                  	MOV	R1,-(SP)
    1251 162014 010046                  	MOV	R0,-(SP)
    1252 162016 000134                  	JMP	@(R4)+
    1253                                ;
    1254 162020 006166  000004          DS::	ROL	4(SP)
    1255 162024 005566  000002          	ADC	2(SP)
    1256 162030 005516                  	ADC	(SP)
    1257 162032 102406                  	BVS	1$
    1258 162034 103405                  	BCS	1$
    1259 162036 012666  000002          	MOV	(SP)+,2(SP)
    1260 162042 012666  000002          	MOV	(SP)+,2(SP)
    1261 162046 000134                  	JMP	@(R4)+
    1262 162050 104406                  1$:	TRAP	6
    1263                                ;
    1264 162052 012602                  IDIV::	MOV	(SP)+,R2
    1265 162054 011601                  	MOV	@SP,R1
    1266 162056 004767  162162'         	CALL	DAL
    1267 162062 010116                  	MOV	R1,@SP
    1268 162064 000134                  	JMP	@(R4)+
    1269                                ;
    1270 162066 012602                  MOD::	MOV	(SP)+,R2
    1271 162070 011601                  	MOV	@SP,R1
    1272 162072 004767  162162'         	CALL	DAL
    1273 162076 010316                  	MOV	R3,@SP
    1274 162100 000134                  	JMP	@(R4)+
    1275                                ;
    1276 162102 062616                  SUM::	ADD	(SP)+,@SP
    1277 162104 102401                  SUMPAB:	BVS	OVF
    1278 162106 000134                  	JMP	@(R4)+
    1279 162110 104406                  OVF:	TRAP	6
    1280                                ;
    1281 162112 162616                  SKIRT::	SUB	(SP)+,@SP
    1282 162114 000773                  	BR	SUMPAB
    1283                                ;
    1284 162116 005000                  SAND::	CLR	R0
    1285 162120 012602                  	MOV	(SP)+,R2
    1286 162122 002002                  	BGE	1$
    1287 162124 005200                  	INC	R0
    1288 162126 005402                  	NEG	R2
    1289 162130 011601                  1$:	MOV	@SP,R1
    1290 162132 002002                  	BGE	2$
    1291 162134 005300                  	DEC	R0
    1292 162136 005401                  	NEG	R1
    1293 162140 004767  160442'         2$:	CALL	DAUG
    1294 162144 005705                  	TST	R5
    1295 162146 002760                  	BLT	OVF
    1296 162150 005700                  	TST	R0
    1297 162152 001401                  	BEQ	3$
    1298 162154 005401                  	NEG	R1
    1299 162156 010116                  3$:	MOV	R1,@SP
    1300 162160 000134                  	JMP	@(R4)+
    1301                                ;
    1302 162162 005000                  DAL:	CLR	R0
    1303 162164 010103                  	MOV	R1,R3
    1304 162166 100003                  	BPL	1$
    1305 162170 005403                  	NEG	R3
    1306 162172 100746                  	BMI	OVF
    1307 162174 005200                  	INC	R0
    1308 162176 005702                  1$:	TST	R2
    1309 162200 001434                  	BEQ	2$
    1310 162202 100003                  	BPL	3$
    1311 162204 005402                  	NEG	R2
    1312 162206 052700  000002          	BIS	#2,R0
    1313 162212 010205                  3$:	MOV	R2,R5
    1314 162214 005001                  	CLR	R1
    1315 162216 020203                  5$:	CMP	R2,R3
    1316 162220 101002                  	BHI	4$
    1317 162222 006302                  	ASL	R2
    1318 162224 000774                  	BR	5$
    1319 162226 020205                  4$:	CMP	R2,R5
    1320 162230 001410                  	BEQ	6$
    1321 162232 000241                  	CLC
    1322 162234 006002                  	ROR	R2
    1323 162236 006301                  	ASL	R1
    1324 162240 020203                  	CMP	R2,R3
    1325 162242 101371                  	BHI	4$
    1326 162244 160203                  	SUB	R2,R3
    1327 162246 005201                  	INC	R1
    1328 162250 000766                  	BR	4$
    1329 162252 006200                  6$:	ASR	R0
    1330 162254 103002                  	BCC	7$
    1331 162256 005401                  	NEG	R1
    1332 162260 005403                  	NEG	R3
    1333 162262 005700                  7$:	TST	R0
    1334 162264 001401                  	BEQ	8$
    1335 162266 005401                  	NEG	R1
    1336 162270 000207                  8$:	RETURN
    1337 162272 104413                  2$:	TRAP	11.
    1338                                ;
    1339 162274 162344  162340  162324  ADLOG::	.WORD	IMP,EQV,XOR,OR,AND
         162302 162312  162316          
    1340                                ;
    1341 162306 005116                  NOT::	COM	@SP
    1342 162310 000134                  	JMP	@(R4)+
    1343 162312 052616                  OR::	BIS	(SP)+,@SP
    1344 162314 000134                  	JMP	@(R4)+
    1345 162316 005116                  AND::	COM	@SP
    1346 162320 042616                  	BIC	(SP)+,@SP
    1347 162322 000134                  	JMP	@(R4)+
    1348 162324 011600                  XOR::	MOV	@SP,R0
    1349 162326 046600  000002          	BIC	2(SP),R0
    1350 162332 042616                  	BIC	(SP)+,@SP
    1351 162334 050016                  	BIS	R0,@SP
    1352 162336 000134                  	JMP	@(R4)+
    1353 162340 005116                  EQV::	COM	@SP
    1354 162342 000770                  	BR	XOR
    1355 162344 005166  000002          IMP::	COM	2(SP)
    1356 162350 052616                  	BIS	(SP)+,@SP
    1357 162352 000134                  	JMP	@(R4)+
    1358                                ;
    1359 162354 012634                  $DEFUS::MOV	(SP)+,@(R4)+
    1360 162356 000134                  	JMP	@(R4)+
    1361                                ;
    1362 162360 012701  000003          OPINP::	MOV	#3,R1
    1363 162364 000402                  	BR	OPFILE
    1364                                ;
    1365 162366 012701  000002          OPOUT::	MOV	#2,R1
    1366                                OPFILE:;MOV	MAXFIL,R3	;JEI NERA AS#
    1367                                ;	MOV	(SP)+,R3	;JEI  YRA AS#
    1368                                ;	BLE	BADFN
    1369                                ;	CMP	R3,MAXFIL
    1370                                ;	BHI	BADFN
    1371 162372 004767  162442'         	CALL	FNDBUF
    1372 162376 005720                  	TST	(0)+
    1373 162400 001016                  	BNE	2$
    1374 162402 004767  162454'         	CALL	NAMTYP
    1375 162406 162700  000022          	SUB	#22,R0
    1376 162412 010110                  	MOV	R1,@R0
    1377 162414 006001                  	ROR	R1
    1378 162416 103006                  	BCC	10$
    1379 162420 004767  140016'         	CALL	CASCII
    1380 162424 004767  140064'         	CALL	CAS
    1381 162430 004767  137422'         	CALL	ISVARD
    1382 162434 000134                  10$:	JMP	@(R4)+
    1383 162436 104466                  2$:	TRAP	54.
    1384 162440 104464                  BADFN:	TRAP	52.
    1385                                ;
    1386 162442 016700  002026'         FNDBUF::MOV	FCB,R0
    1387                                ;	SUB	#22,R0
    1388 162446 062700  000400          1$:	ADD	#400,R0		;VELIAU #422
    1389                                ;	SOB	R3,1$
    1390 162452 000207                  	RETURN
    1391                                ;
    1392 162454 016603  000004          NAMTYP::MOV	4(SP),R3
    1393 162460 012666  000002          	MOV	(SP)+,2(SP)
    1394 162464 012602                  	MOV	(SP)+,R2
    1395 162466 010467  002134'         	MOV	R4,SAVJMP
    1396 162472 004767  137556'         	CALL	TTANAL
    1397 162476 016704  002134'         	MOV	SAVJMP,R4
    1398 162502 005067  002134'         	CLR	SAVJMP
    1399 162506 005702                  	TST	R2
    1400 162510 101424                  	BLOS	5$
    1401 162512 012705  000006          	MOV	#6,R5
    1402 162516 121327  000056          1$:	CMPB	(R3),#'.
    1403 162522 001420                  	BEQ	6$
    1404 162524 112320                  	MOVB	(R3)+,(R0)+
    1405 162526 005305                  	DEC	R5
    1406 162530 001404                  	BEQ	3$
    1407 162532 077207                  	SOB	R2,1$
    1408 162534 112720  000040          2$:	MOVB	#40,(R0)+
    1409 162540 077503                  	SOB	R5,2$
    1410 162542 005302                  3$:	DEC	R2
    1411 162544 003003                  	BGT	4$
    1412 162546 004767  137736'         	CALL	DAT
    1413 162552 000207                  	RETURN
    1414 162554 121327  000056          4$:	CMPB	@R3,#'.
    1415 162560 001404                  	BEQ	7$
    1416 162562 104470                  5$:	TRAP	56.
    1417 162564 112720  000040          6$:	MOVB	#40,(0)+
    1418 162570 077503                  	SOB	R5,6$
    1419 162572 012705  000004          7$:	MOV	#4,R5
    1420 162576 112320                  8$:	MOVB	(3)+,(0)+
    1421 162600 005305                  	DEC	R5
    1422 162602 001404                  	BEQ	10$
    1423 162604 077204                  	SOB	R2,8$
    1424 162606 112720  000040          9$:	MOVB	#40,(0)+
    1425 162612 077503                  	SOB	R5,9$
    1426 162614 005302                  10$:	DEC	R2
    1427 162616 003361                  	BGT	5$
    1428 162620 004767  137720'         	CALL	BLOCK0
    1429 162624 000207                  	RETURN
    1430                                ;
    1431 162626 012767  000001  003016' DEVICE::MOV	#1,IODEV	;MAXFIL,IODEV		;VERSIJA 1
    1432 162634 000134                  	JMP	@(R4)+
    1433                                ;	MOV	(SP)+,IODEV
    1434                                ;	BLE	NOTOP
    1435                                ;	CMP	IODEV,MAXFIL
    1436                                ;	BGT	INIPRP		;VELIAU - BLOS
    1437 162636 104473                  NOTOP:	TRAP	59.
    1438                                ;
    1439 162640 012767  177777  003016' DEVLP::	MOV	#-1,IODEV
    1440 162646 000134                  INIPRP::JMP	@(4)+
    1441                                ;
    1442 162650 005067  003016'         CLRDEV::CLR	IODEV
    1443 162654 000134                  	JMP	@(R4)+
    1444                                ;
    1445                                CLOFIL::
    1446                                ;	MOV	(R4)+,R2
    1447                                ;	BEQ	3$
    1448                                ;1$:	MOV	(SP)+,R3
    1449                                ;	BEQ	2$
    1450                                ;	CMP	R3,MAXFIL
    1451                                ;	BHI	BADFN
    1452                                ;	CALL	FNDBUF
    1453                                ;	CALL	CLOF
    1454                                ;2$:	SOB	R2,1$
    1455                                ;	JMP	@(R4)+
    1456 162656 004767  162664'         3$:	CALL	CLOALL
    1457 162662 000134                  	JMP	@(R4)+
    1458                                ;
    1459                                CLOALL::;MOV	MAXFIL,R2
    1460                                ;	BEQ	5$
    1461 162664 016700  002030'         	MOV	HIMEM,R0
    1462 162670 162700  000422          4$:	SUB	#422,R0
    1463                                ;	CALL	CLOF
    1464                                ;	SOB	R2,4$
    1465                                ;5$:	RETURN
    1466                                ;
    1467 162674 011003                  CLOF:	MOV	(R0),R3
    1468 162676 001412                  	BEQ	2$
    1469 162700 106003                  	RORB	R3
    1470 162702 103411                  	BCS	3$
    1471 162704 105003                  	CLRB	R3
    1472 162706 000303                  	SWAB	R3
    1473 162710 060003                  	ADD	R0,R3
    1474 162712 062703  000022          	ADD	#22,R3
    1475 162716 004767  162744'         	CALL	CLOUTF
    1476 162722 005010                  1$:	CLR	(0)
    1477 162724 000207                  2$:	RETURN
    1478 162726 004767  140016'         3$:	CALL	CASCII		;CLINF
    1479 162732 004767  137750'         	CALL	LASTBL
    1480 162736 004767  140064'         	CALL	CAS
    1481 162742 000767                  	BR	1$
    1482                                ;
    1483 162744 112713  000032          CLOUTF::MOVB	#32,@R3	;^Z
    1484 162750 004767  140016'         	CALL	CASCII
    1485 162754 004767  140064'         	CALL	CAS
    1486 162760 004767  137750'         	CALL	LASTBL
    1487 162764 005077  000322'         	CLR	@MAG+2
    1488 162770 012767  000002  000324' 	MOV	#2,MAG+4
    1489 162776 004767  140064'         	CALL	CAS
    1490 163002 000207                  	RETURN
    1491                                ;
    1492 163004 016703  003016'         FNDCHR:	MOV	IODEV,R3
    1493 163010 003712                  	BLE	NOTOP
    1494 163012 004767  162442'         FNDCR:	CALL	FNDBUF
    1495 163016 132720  000001          	BITB	#1,(0)+
    1496 163022 001606                  	BEQ	BADFN
    1497 163024 005003                  	CLR	R3
    1498 163026 151003                  	BISB	@R0,R3
    1499 163030 060003                  	ADD	R0,R3
    1500 163032 062703  000021          	ADD	#21,R3
    1501 163036 000207                  	RETURN
    1502                                ;
    1503 163040 005046                  EOF::	CLR	-(SP)
    1504 163042 004767  163012'         	CALL	FNDCR
    1505 163046 121327  000032          	CMPB	@R3,#32	;^Z
    1506 163052 001001                  	BNE	1$
    1507 163054 005116                  	COM	@SP
    1508 163056 000134                  1$:	JMP	@(4)+
    1509                                ;
    1510 163060 004767  163004'         FILINP:	CALL	FNDCHR
    1511 163064 010005                  	MOV	R0,R5
    1512 163066 062705  000021          	ADD	#21,R5
    1513 163072 012701  003022          COPYIN::MOV	#BUF,R1
    1514 163076 121327  000032          1$:	CMPB	@R3,#32
    1515 163102 001430                  	BEQ	3$
    1516 163104 020127  003442          	CMP	R1,#BUF+420
    1517 163110 103030                  	BHIS	4$
    1518 163112 112311                  	MOVB	(3)+,(1)
    1519 163114 105210                  	INCB	(0)
    1520 163116 001017                  	BNE	2$
    1521 163120 010146                  	MOV	R1,-(SP)
    1522 163122 010046                  	MOV	R0,-(SP)
    1523 163124 005300                  	DEC	R0
    1524 163126 162703  000400          	SUB	#400,R3
    1525 163132 004767  140140'         	CALL	BLOCKN
    1526 163136 004767  140016'         	CALL	CASCII
    1527 163142 004767  140064'         	CALL	CAS
    1528 163146 004767  137422'         	CALL	ISVARD
    1529 163152 012600                  	MOV	(SP)+,R0
    1530 163154 012601                  	MOV	(SP)+,R1
    1531 163156 122127  000012          2$:	CMPB	(1)+,#12
    1532 163162 001345                  	BNE	1$
    1533 163164 112711  000012          3$:	MOVB	#12,@R1
    1534 163170 000207                  	RETURN
    1535 163172 104431                  4$:	TRAP	25.
    1536                                ;
    1537 163174 010467  002134'         STRSQU::MOV	R4,SAVJMP	;R3 - NAUJAS FREBEG
    1538 163200 010546                  	MOV	R5,-(SP)	;R0 - PERKELIAMO MAS. PRADZIA
    1539 163202 016703  002004'         	MOV	STRREG,R3	;R2 - RODYKLE PO VARD. LENT.
    1540 163206 010346                  	MOV	R3,-(SP)	;@SP - STRREG GALAS
    1541 163210 066716  002006'         	ADD	STRSIZ,@SP
    1542 163214 011600                  40$:	MOV	@SP,R0
    1543 163216 016702  002022'         	MOV	LENT,R2
    1544 163222 020267  002024'         8$:	CMP	R2,TABTOP
    1545 163226 103032                  	BHIS	58$
    1546 163230 004467  163606'         	JSR	R4,J_FIND
    1547 163234 000772                  	BR	8$
    1548 163236 000411                  	BR	1$
    1549 163240 005722                  	TST	(R2)+
    1550 163242 001405                  	BEQ	7$
    1551 163244 021200                  	CMP	@R2,R0
    1552 163246 103003                  	BHIS	7$
    1553 163250 021203                  	CMP	@R2,R3
    1554 163252 103401                  	BLO	7$
    1555 163254 011200                  	MOV	@R2,R0
    1556 163256 005722                  7$:	TST	(R2)+
    1557 163260 000760                  	BR	8$
    1558 163262 004767  163540'         1$:	CALL	SSQ1
    1559 163266 004767  163562'         38$:	CALL	SSQ2
    1560 163272 020400                  	CMP	R4,R0
    1561 163274 103003                  	BHIS	39$
    1562 163276 020403                  	CMP	R4,R3
    1563 163300 103401                  	BLO	39$
    1564 163302 010400                  	MOV	R4,R0
    1565 163304 020501                  39$:	CMP	R5,R1
    1566 163306 103767                  	BLO	38$
    1567 163310 022222                  	CMP	(R2)+,(R2)+
    1568 163312 000743                  	BR	8$
    1569 163314 020016                  58$:	CMP	R0,@SP
    1570 163316 001444                  	BEQ	22$
    1571 163320 016702  002022'         	MOV	LENT,R2
    1572 163324 004467  163606'         14$:	JSR	R4,J_FIND
    1573 163330 000775                  	BR	14$
    1574 163332 000413                  	BR	11$
    1575 163334 005722                  	TST	(R2)+
    1576 163336 001002                  	BNE	3$
    1577 163340 005722                  	TST	(R2)+
    1578 163342 000770                  	BR	14$
    1579 163344 022200                  3$:	CMP	(R2)+,R0
    1580 163346 001366                  	BNE	14$
    1581 163350 010342                  	MOV	R3,-(R2)
    1582 163352 014201                  	MOV	-(R2),R1
    1583 163354 004767  163456'         	CALL	PERK
    1584 163360 000715                  	BR	40$
    1585 163362 004767  163540'         11$:	CALL	SSQ1
    1586 163366 004767  163562'         37$:	CALL	SSQ2
    1587 163372 020400                  	CMP	R4,R0
    1588 163374 001404                  	BEQ	36$
    1589 163376 020501                  	CMP	R5,R1
    1590 163400 103772                  	BLO	37$
    1591 163402 022222                  	CMP	(R2)+,(R2)+
    1592 163404 000747                  	BR	14$
    1593 163406 000303                  36$:	SWAB	R3
    1594 163410 110345                  	MOVB	R3,-(R5)
    1595 163412 000303                  	SWAB	R3
    1596 163414 110345                  	MOVB	R3,-(R5)
    1597 163416 005001                  	CLR	R1
    1598 163420 154501                  	BISB	-(R5),R1
    1599 163422 004767  163456'         	CALL	PERK
    1600 163426 000672                  	BR	40$
    1601 163430 010367  002010'         22$:	MOV	R3,FREBEG
    1602 163434 160316                  	SUB	R3,@SP
    1603 163436 012667  002012'         	MOV	(SP)+,FRELEN
    1604 163442 012605                  	MOV	(SP)+,R5
    1605 163444 016704  002134'         	MOV	SAVJMP,R4
    1606 163450 005067  002134'         	CLR	SAVJMP
    1607 163454 000207                  	RETURN
    1608 163456 020003                  PERK:	CMP	R0,R3		;R0 - SENAS
    1609 163460 001403                  	BEQ	3$		;R3 - NAUJAS
    1610 163462 112023                  1$:	MOVB	(R0)+,(R3)+	;R1 - ILGIS
    1611 163464 077102                  	SOB	R1,1$
    1612 163466 000207                  	RETURN
    1613 163470 060103                  3$:	ADD	R1,R3
    1614 163472 000207                  	RETURN
    1615 163474 010046                  MASREG::MOV	R0,-(SP)	;R2 -> VARD.+2
    1616 163476 010246                  	MOV	R2,-(SP)
    1617 163500 010346                  	MOV	R3,-(SP)
    1618 163502 012203                  	MOV	(R2)+,R3
    1619 163504 005000                  	CLR	R0
    1620 163506 152200                  	BISB	(R2)+,R0
    1621 163510 111201                  	MOVB	@R2,R1
    1622 163512 012302                  1$:	MOV	(R3)+,R2
    1623 163514 004767  160442'         	CALL	DAUG
    1624 163520 077004                  	SOB	R0,1$
    1625 163522 005201                  	INC	R1
    1626 163524 006201                  	ASR	R1
    1627 163526 006301                  	ASL	R1		;R1<- MAS. ILG. BE IND.
    1628 163530 012603                  	MOV	(SP)+,R3
    1629 163532 012602                  	MOV	(SP)+,R2
    1630 163534 012600                  	MOV	(SP)+,R0
    1631 163536 000207                  	RETURN
    1632                                ;
    1633 163540 004767  163474'         SSQ1:	CALL	MASREG
    1634 163544 062201                  	ADD	(R2)+,R1
    1635 163546 005005                  	CLR	R5
    1636 163550 151205                  	BISB	@R2,R5
    1637 163552 006305                  	ASL	R5
    1638 163554 060501                  	ADD	R5,R1
    1639 163556 064205                  	ADD	-(R2),R5
    1640 163560 000207                  	RETURN
    1641 163562 005004                  SSQ2:	CLR	R4
    1642 163564 105725                  	TSTB	(R5)+
    1643 163566 001405                  	BEQ	1$
    1644 163570 152504                  	BISB	(R5)+,R4
    1645 163572 000304                  	SWAB	R4
    1646 163574 152504                  	BISB	(R5)+,R4
    1647 163576 000304                  	SWAB	R4
    1648 163600 000207                  	RETURN
    1649 163602 122525                  1$:	CMPB	(R5)+,(R5)+
    1650 163604 000207                  	RETURN
    1651 163606 105712                  J_FIND:	TSTB	@R2		;IEJ.:	R2-> VARD.
    1652 163610 100003                  	BPL	6$		;	R4= GRAZ. ADR.
    1653 163612 005722                  	TST	(R2)+		;ISEJ:	+0	NESIMB.	R2->SEK.VARD.
    1654 163614 100414                  	BMI	1$		;	+2	SIMB.MAS. R2->VARD.+2
    1655 163616 000407                  	BR	3$		;	+4	SIMB.KINT. --//---
    1656 163620 012201                  6$:	MOV	(R2)+,R1	;	R1 GADINA
    1657 163622 100410                  	BMI	5$
    1658 163624 006301                  	ASL	R1
    1659 163626 100404                  	BMI	2$
    1660 163630 006301                  	ASL	R1
    1661 163632 100401                  	BMI	3$
    1662 163634 022222                  	CMP	(R2)+,(R2)+
    1663 163636 005722                  3$:	TST	(R2)+
    1664 163640 005722                  2$:	TST	(R2)+
    1665 163642 000204                  	RTS	R4
    1666 163644 005724                  5$:	TST	(R4)+
    1667 163646 005724                  1$:	TST	(R4)+
    1668 163650 000204                  	RTS	R4
    1669                                ;
    1670 163652 010605                  $USR::	MOV	SP,R5
    1671 163654 012400                  	MOV	(R4)+,R0
    1672 163656 012403                  	MOV	(R4)+,R3
    1673 163660 010467  002134'         	MOV	R4,SAVJMP
    1674 163664 004770  002100          	CALL	@USRTAB(R0)
    1675 163670 016704  002134'         	MOV	SAVJMP,R4
    1676 163674 005067  002134'         	CLR	SAVJMP
    1677 163700 000134                  	JMP	@(R4)+
    1678                                ;
    1679 000001                         .IF EQ,1
    1680                                $ERASE::TST	@R4
    1681                                	BEQ	$ER0
    1682                                3$:	MOV	(R4)+,R2
    1683                                	BEQ	$EREND
    1684                                	TST	@R2
    1685                                	BEQ	1$
    1686                                	CALL	MASREG
    1687                                	MOV	@R2,R3
    1688                                	CLR	(R2)+
    1689                                	CLR	R0
    1690                                	BISB	@R2,R0
    1691                                	CLRB	@R2
    1692                                	ASL	R0
    1693                                	ADD	R0,R1
    1694                                	MOV	R3,R2
    1695                                	ADD	R1,R2
    1696                                	MOV	R3,R0
    1697                                6$:	MOV	(R2)+,(R3)+
    1698                                	CMP	R2,ENDCOD
    1699                                	BLO	6$
    1700                                	MOV	R3,ENDCOD
    1701                                	MOV	LENT,R2
    1702                                2$:	TSTB	@R2
    1703                                	BPL	7$
    1704                                	TST	(R2)+
    1705                                	CMP	@R2,R0
    1706                                	BLO	8$
    1707                                	SUB	R1,@R2
    1708                                8$:	CMP	(R2)+,(R2)+
    1709                                	BR	9$
    1710                                7$:	CALL	PRAL
    1711                                9$:	CMP	R2,TABTOP
    1712                                	BLO	2$
    1713                                	BR	3$
    1714                                1$:	TRAP	5
    1715                                ;
    1716                                PRAL:	TSTB	@R2
    1717                                	BMI	1$
    1718                                	MOV	(R2)+,R1
    1719                                	BMI	1$
    1720                                	ASL	R1
    1721                                	BMI	8$
    1722                                	ASL	R1
    1723                                	BMI	1$
    1724                                	CMP	(R2)+,(R2)+
    1725                                1$:	TST	(R2)+
    1726                                8$:	TST	(R2)+
    1727                                	RETURN
    1728                                ;
    1729                                $ER0:	MOV	LENT,R2
    1730                                1$:	TSTB	@R2
    1731                                	BMI	2$
    1732                                	CALL	PRAL
    1733                                	BR	4$
    1734                                2$:	TST	(R2)+
    1735                                	CLR	(R2)+
    1736                                	CLRB	(R2)+
    1737                                	INC	R2
    1738                                4$:	CMP	R2,TABTOP
    1739                                	BLO	1$
    1740                                	MOV	STRREG,R0
    1741                                	ADD	STRSIZ,R0
    1742                                	MOV	R0,ENDCOD
    1743                                	TST	(R4)+
    1744                                $EREND:	JMP	@(R4)+
    1745                                ;
    1746                                .ENDC
    1747                                	.END
    1748                                 
    1748                                
       1                                ;	.ENABLE	LC
       2                                	.GLOBL	RNDSAV,III,SAVJMP,BUFOUT
       3                                ;
       4                                	;-----------------------------------------------------
       5                                	;    ПРОГРАММА ПРЕОБРАЗОВАНИЯ ЧИСЕЛ
       6                                	;  ИЗ СИМВОЛЬНОГО ФОРМАТА В ФОРМАТ С ПЛАВАЮЩЕЙ ЗАПЯТОЙ
       7                                	;-----------------------------------------------------
       8                                	;
       9 163702 011603                  PACK::	MOV	@SP,R3
      10 163704 005016                  	CLR	@SP
      11 163706 005046                  	CLR	-(SP)
      12 163710 005046                  	CLR	-(SP)
      13 163712 010346                  	MOV	R3,-(SP)
      14 163714 010046                  	MOV	R0,-(SP)
      15 163716 010146                  	MOV	R1,-(SP)
      16 163720 010246                  	MOV	R2,-(SP)
      17 163722 010346                  	MOV	R3,-(SP)
      18 163724 010446                  	MOV	R4,-(SP)
      19 163726 010546                  	MOV	R5,-(SP)
      20 163730 012746  177756          	MOV	#-18.,-(SP)
      21 163734 012746  000101          	MOV	#101,-(SP)
      22 163740 016605  000032          	MOV	32(SP),R5
      23 163744 060566  000030          	ADD	R5,30(SP)
      24 163750 005000                  	CLR	R0
      25 163752 005001                  	CLR	R1
      26 163754 005002                  	CLR	R2
      27 163756 005003                  	CLR	R3
      28 163760 020566  000030          1$:	CMP	R5,30(SP)
      29 163764 002157                  	BGE	17$
      30 163766 112504                  	MOVB	(R5)+,R4
      31                                ;	CMPB	R4,#40
      32                                ;	BEQ	1$
      33                                ;
      34 163770 120427  000053          	CMPB	R4,#'+
      35 163774 001443                  	BEQ	7$
      36 163776 120427  000055          	CMPB	R4,#'-
      37 164002 001004                  	BNE	4$
      38 164004 005266  000026          	INC	26(SP)
      39 164010 000435                  	BR	7$
      40                                ;
      41 164012 112504                  3$:	MOVB	(R5)+,R4
      42                                ;	CMPB	R4,#40
      43                                ;	BEQ	7$
      44 164014 162704  000060          4$:	SUB	#60,R4
      45 164020 002521                  	BLT	15$
      46 164022 001012                  	BNE	5$
      47 164024 026627  000002  177756  	CMP	2(SP),#-18.
      48 164032 001006                  	BNE	5$
      49 164034 105766  000023          	TSTB	23(SP)
      50 164040 001421                  	BEQ	7$
      51 164042 005366  000024          	DEC	24(SP)
      52 164046 000416                  	BR	7$
      53 164050 120427  000011          5$:	CMPB	R4,#11
      54 164054 003125                  	BGT	18$
      55 164056 005266  000002          	INC	2(SP)
      56 164062 003010                  	BGT	7$
      57 164064 004767  166472'         	CALL	PDAUG5
      58 164070 004767  166540'         	CALL	PDAUG2
      59 164074 060403                  	ADD	R4,R3
      60 164076 005502                  	ADC	R2
      61 164100 005502                  	ADC	R2
      62 164102 005500                  	ADC	R0
      63 164104 020566  000030          7$:	CMP	R5,30(SP)
      64 164110 002740                  	BLT	3$
      65 164112 000411                  	BR	6$
      66                                ;
      67 164114 105766  000027          32$:	TSTB	27(SP)
      68 164120 001401                  	BEQ	24$
      69 164122 005403                  	NEG	R3
      70 164124 060366  000024          24$:	ADD	R3,24(SP)
      71 164130 016603  000032          	MOV	32(SP),R3
      72                                ;
      73 164134 005305                  8$:	DEC	R5
      74 164136 010566  000010          6$:	MOV	R5,10(SP)
      75 164142 005700                  	TST	R0
      76 164144 001006                  	BNE	9$
      77 164146 005701                  	TST	R1
      78 164150 001004                  	BNE	9$
      79 164152 005702                  	TST	R2
      80 164154 001002                  	BNE	9$
      81 164156 005703                  	TST	R3
      82 164160 001461                  	BEQ	17$
      83 164162 105766  000023          9$:	TSTB	23(SP)
      84 164166 001402                  	BEQ	2$
      85 164170 005466  000002          	NEG	2(SP)
      86 164174 005766  000002          2$:	TST	2(SP)
      87 164200 002002                  	BGE	11$
      88 164202 005066  000002          	CLR	2(SP)
      89 164206 066666  000024  000002  11$:	ADD	24(SP),2(SP)
      90 164214 003003                  	BGT	12$
      91 164216 002525                  	BLT	25$
      92 164220 000167  164524'         	JMP	30$
      93                                ;
      94 164224 020027  031462          12$:	CMP	R0,#31462
      95 164230 101010                  	BHI	14$
      96 164232 004767  166472'         	CALL	PDAUG5
      97 164236 005216                  	INC	(SP)
      98 164240 005366  000002          13$:	DEC	2(SP)
      99 164244 003367                  	BGT	12$
     100 164246 000167  164524'         	JMP	30$
     101                                ;
     102 164252 004767  166424'         14$:	CALL	PD5DL4
     103 164256 062716  000003          	ADD	#3,(SP)
     104 164262 000766                  	BR	13$
     105                                ;
     106 164264 120427  177776          15$:	CMPB	R4,#-2
     107 164270 001321                  	BNE	8$
     108 164272 105766  000023          	TSTB	23(SP)
     109 164276 001316                  	BNE	8$
     110 164300 105166  000023          	COMB	23(SP)
     111 164304 016666  000002  000024  	MOV	2(SP),24(SP)
     112 164312 000674                  	BR	7$
     113                                ;
     114 164314 005000                  16$:	CLR	R0
     115 164316 005001                  	CLR	R1
     116 164320 005002                  	CLR	R2
     117 164322 005003                  	CLR	R3
     118 164324 000167  164624'         17$:	JMP	31$
     119                                ;
     120 164330 142704  000040          18$:	BICB	#40,R4
     121 164334 162704  000024          	SUB	#24,R4
     122 164340 001402                  	BEQ	19$
     123 164342 005304                  	DEC	R4
     124 164344 001273                  	BNE	8$
     125 164346 121527  000100          19$:	CMPB	(R5),#100	;ELSE OR NAME?
     126 164352 003270                  	BGT	8$
     127 164354 142745  000040          	BICB	#40,-(R5)
     128 164360 112566  000022          	MOVB	(R5)+,22(SP)
     129 164364 112504                  10$:	MOVB	(R5)+,R4
     130 164366 020566  000030          	CMP	R5,30(SP)
     131 164372 101260                  	BHI	8$
     132                                ;	CMPB	R4,#40
     133                                ;	BEQ	10$
     134 164374 010366  000032          	MOV	R3,32(SP)
     135 164400 005003                  	CLR	R3
     136 164402 120427  000053          	CMPB	R4,#'+
     137 164406 001405                  	BEQ	20$
     138 164410 120427  000055          	CMPB	R4,#'-
     139 164414 001006                  	BNE	22$
     140 164416 105266  000027          	INCB	27(SP)
     141 164422 112504                  20$:	MOVB	(R5)+,R4
     142 164424 020566  000030          	CMP	R5,30(SP)
     143 164430 101231                  	BHI	32$
     144                                22$:;	CMPB	R4,#40
     145                                ;	BEQ	20$
     146 164432 162704  000060          	SUB	#60,R4
     147 164436 002626                  	BLT	32$
     148 164440 120427  000011          	CMPB	R4,#11
     149 164444 003223                  	BGT	32$
     150 164446 020327  000500          	CMP	R3,#500
     151 164452 103363                  	BHIS	20$
     152 164454 006303                  	ASL	R3
     153 164456 060304                  	ADD	R3,R4
     154 164460 006303                  	ASL	R3
     155 164462 006303                  	ASL	R3
     156 164464 060403                  	ADD	R4,R3
     157 164466 000755                  	BR	20$
     158                                ;
     159 164470 104406                  34$:	TRAP	6
     160                                ;
     161 164472 005700                  25$:	TST	R0
     162 164474 002404                  	BLT	27$
     163 164476 005316                  26$:	DEC	(SP)
     164 164500 004767  166540'         	CALL	PDAUG2
     165 164504 100374                  	BPL	26$
     166 164506 004767  165702'         27$:	CALL	DG4DL5
     167 164512 162716  000003          	SUB	#3,(SP)
     168 164516 005266  000002          	INC	2(SP)
     169 164522 002763                  	BLT	25$
     170                                ;
     171 164524 005316                  30$:	DEC	(SP)
     172 164526 004767  166540'         	CALL	PDAUG2
     173 164532 103374                  	BCC	30$
     174 164534 062716  000200          	ADD	#200,(SP)
     175 164540 003665                  	BLE	16$
     176 164542 021627  000377          	CMP	(SP),#377
     177 164546 003350                  	BGT	34$
     178 164550 105003                  	CLRB	R3
     179 164552 150203                  	BISB	R2,R3
     180 164554 000303                  	SWAB	R3
     181 164556 105002                  	CLRB	R2
     182 164560 150102                  	BISB	R1,R2
     183 164562 000302                  	SWAB	R2
     184 164564 105001                  	CLRB	R1
     185 164566 150001                  	BISB	R0,R1
     186 164570 000301                  	SWAB	R1
     187 164572 105000                  	CLRB	R0
     188 164574 151600                  	BISB	(SP),R0
     189 164576 000300                  	SWAB	R0
     190 164600 006066  000026          	ROR	26(SP)
     191 164604 004767  166412'         	CALL	PDAL2
     192 164610 005503                  	ADC	R3
     193 164612 005502                  	ADC	R2
     194 164614 005501                  	ADC	R1
     195 164616 005500                  	ADC	R0
     196 164620 102723                  	BVS	34$
     197 164622 103722                  	BCS	34$
     198 164624 010066  000024          31$:	MOV	R0,24(SP)
     199 164630 010166  000026          	MOV	R1,26(SP)
     200 164634 010266  000030          	MOV	R2,30(SP)
     201 164640 010366  000032          	MOV	R3,32(SP)
     202 164644 022626                  	CMP	(SP)+,(SP)+
     203 164646 012605                  	MOV	(SP)+,R5
     204 164650 012604                  	MOV	(SP)+,R4
     205 164652 012603                  	MOV	(SP)+,R3
     206 164654 012602                  	MOV	(SP)+,R2
     207 164656 012601                  	MOV	(SP)+,R1
     208 164660 012600                  	MOV	(SP)+,R0
     209 164662 000207                  	RETURN
     210                                ;
     211                                	;---------------------------------------------------------
     212                                	;	ПОДПРОГРАММА РАСПАКОВКИ ЧИСЕЛ
     213                                	;	ИЗ ФОРМАТА С ПЛАВАЮЩЕЙ ЗАПЯТОЙ (ОДИН. ИЛИ ДВОЙНОЙ)
     214                                	;	В СИМВОЛЬНЫЕ ФОРМАТЫ G,F,E,D
     215                                	;---------------------------------------------------------
     216                                ;
     217 164664 012605                  EGO::	MOV	(SP)+,R5
     218 164666 012600                  	MOV	(SP)+,R0
     219 164670 011601                  	MOV	@SP,R1
     220 164672 005002                  	CLR	R2
     221 164674 005003                  	CLR	R3
     222 164676 012716  000006          	MOV	#6,@SP
     223 164702 012746  042403          	MOV	#42403,-(SP)
     224 164706 000411                  	BR	F_GO
     225                                ;
     226 164710 012605                  DGO::	MOV	(SP)+,R5
     227 164712 012600                  	MOV	(SP)+,R0
     228 164714 012601                  	MOV	(SP)+,R1
     229 164716 012602                  	MOV	(SP)+,R2
     230 164720 011603                  	MOV	@SP,R3
     231 164722 012716  000020          	MOV	#20,(SP)
     232 164726 012746  042003          	MOV	#42003,-(SP)
     233 164732 012746  000001          F_GO:	MOV	#1,-(SP)
     234 164736 012746  003022          	MOV	#BUFOUT,-(SP)
     235 164742 012746  000030          	MOV	#30,-(SP)
     236 164746 010546                  	MOV	R5,-(SP)
     237                                ;
     238 164750 010446                  UNPCK::	MOV	R4,-(SP)
     239 164752 010467  002134'         	MOV	R4,SAVJMP
     240 164756 024646                  	CMP	-(SP),-(SP)
     241 164760 005046                  	CLR	-(SP)
     242 164762 005046                  	CLR	-(SP)
     243 164764 066666  000016  000014  	ADD	16(SP),14(SP)
     244                                ;
     245 164772 006100                  	ROL	R0
     246 164774 006166  000006          	ROL	6(SP)
     247 165000 000300                  	SWAB	R0
     248 165002 110066  000002          	MOVB	R0,2(SP)
     249 165006 001002                  	BNE	2$
     250 165010 005004                  	CLR	R4
     251 165012 000475                  	BR	3$
     252                                ;
     253 165014 000261                  2$:	SEC
     254 165016 006000                  	ROR	R0
     255 165020 105000                  	CLRB	R0
     256 165022 000301                  	SWAB	R1
     257 165024 150100                  	BISB	R1,R0
     258 165026 105001                  	CLRB	R1
     259 165030 000302                  	SWAB	R2
     260 165032 150201                  	BISB	R2,R1
     261 165034 105002                  	CLRB	R2
     262 165036 000303                  	SWAB	R3
     263 165040 150302                  	BISB	R3,R2
     264 165042 105003                  	CLRB	R3
     265                                ;
     266 165044 162766  000200  000002  	SUB	#200,2(SP)
     267 165052 002421                  	BLT	20$
     268 165054 001443                  	BEQ	30$
     269                                ;
     270 165056 005700                  10$:	TST	R0
     271 165060 002406                  	BLT	11$
     272 165062 004767  166540'         	CALL	PDAUG2
     273 165066 005366  000002          	DEC	2(SP)
     274 165072 003371                  	BGT	10$
     275 165074 000433                  	BR	30$
     276 165076 004767  165702'         11$:	CALL	DG4DL5
     277 165102 005216                  	INC	(SP)
     278 165104 162766  000003  000002  	SUB	#3,2(SP)
     279 165112 003361                  	BGT	10$
     280 165114 001423                  	BEQ	30$
     281                                ;
     282 165116 020027  146314          20$:	CMP	R0,#146314
     283 165122 103013                  	BHIS	21$
     284 165124 026627  000002  177775  	CMP	2(SP),#-3
     285 165132 003007                  	BGT	21$
     286 165134 004767  165614'         	CALL	DG5DL4
     287 165140 005316                  	DEC	(SP)
     288 165142 062766  000002  000002  	ADD	#2,2(SP)
     289 165150 000402                  	BR	22$
     290 165152 004767  166412'         21$:	CALL	PDAL2
     291 165156 005266  000002          22$:	INC	2(SP)
     292 165162 001355                  	BNE	20$
     293                                ;
     294 165164 005004                  30$:	CLR	R4
     295 165166 004767  165614'         31$:	CALL	DG5DL4
     296 165172 004767  166006'         	CALL	UDAUG8
     297 165176 005704                  	TST	R4
     298 165200 001002                  	BNE	3$
     299 165202 005316                  	DEC	(SP)
     300 165204 000770                  	BR	31$
     301                                ;
     302 165206 016605  000024          3$:	MOV	24(SP),R5
     303 165212 066605  000020          	ADD	20(SP),R5
     304 165216 105766  000022          	TSTB	22(SP)
     305 165222 001426                  	BEQ	4$
     306 165224 010566  000002          	MOV	R5,2(SP)
     307 165230 004767  166056'         	CALL	ROUND1
     308 165234 106066  000022          	RORB	22(SP)
     309 165240 103071                  	BCC	5$
     310 165242 021627  177777          	CMP	@SP,#-1
     311 165246 002466                  	BLT	5$
     312 165250 016605  000002          	MOV	2(SP),R5
     313 165254 021605                  	CMP	@SP,R5
     314 165256 003062                  	BGT	5$
     315 165260 161605                  	SUB	@SP,R5
     316 165262 105066  000022          	CLRB	22(SP)
     317 165266 010566  000024          	MOV	R5,24(SP)
     318 165272 005066  000020          	CLR	20(SP)
     319 165276 000401                  	BR	41$
     320                                ;
     321 165300 061605                  4$:	ADD	(SP),R5
     322 165302 005366  000014          41$:	DEC	14(SP)
     323 165306 016605  000014          44$:	MOV	14(SP),R5
     324 165312 166605  000024          	SUB	24(SP),R5
     325 165316 005305                  	DEC	R5
     326 165320 010566  000004          	MOV	R5,4(SP)
     327 165324 005305                  	DEC	R5
     328 165326 105766  000022          	TSTB	22(SP)
     329 165332 001010                  	BNE	40$
     330 165334 061666  000020          	ADD	(SP),20(SP)
     331 165340 003405                  	BLE	40$
     332 165342 166605  000020          	SUB	20(SP),R5
     333 165346 004767  166220'         	CALL	SIGN
     334 165352 000406                  	BR	42$
     335                                ;
     336 165354 004767  166220'         40$:	CALL	SIGN
     337 165360 112725  000056          	MOVB	#'.,(R5)+
     338 165364 112725  000060          	MOVB	#'0,(R5)+
     339                                ;
     340 165370 016605  000004          42$:	MOV	4(SP),R5
     341 165374 005766  000020          	TST	20(SP)
     342 165400 003001                  	BGT	43$
     343 165402 005205                  	INC	R5
     344 165404 166605  000020          43$:	SUB	20(SP),R5
     345 165410 004767  166274'         	CALL	NUMB
     346 165414 105766  000022          	TSTB	22(SP)
     347 165420 001454                  	BEQ	UNPEND
     348 165422 000424                  	BR	50$
     349                                ;
     350 165424 162766  000005  000014  5$:	SUB	#5,14(SP)
     351 165432 005766  000020          	TST	20(SP)
     352 165436 003723                  	BLE	44$
     353 165440 016605  000014          	MOV	14(SP),R5
     354 165444 166605  000024          	SUB	24(SP),R5
     355 165450 005305                  	DEC	R5
     356 165452 010566  000004          	MOV	R5,4(SP)
     357 165456 166605  000020          	SUB	20(SP),R5
     358 165462 005305                  	DEC	R5
     359 165464 004767  166220'         	CALL	SIGN
     360 165470 004767  166274'         	CALL	NUMB
     361 165474 166616  000020          50$:	SUB	20(SP),(SP)
     362 165500 116625  000023          	MOVB	23(SP),(R5)+
     363 165504 011604                  	MOV	(SP),R4
     364 165506 002004                  	BGE	52$
     365 165510 005404                  	NEG	R4
     366 165512 112725  000055          	MOVB	#'-,(R5)+
     367 165516 000402                  	BR	53$
     368                                ;
     369 165520 112725  000053          52$:	MOVB	#'+,(R5)+
     370 165524 112715  000060          53$:	MOVB	#'0,(R5)
     371 165530 162704  000012          54$:	SUB	#12,R4
     372 165534 002402                  	BLT	55$
     373 165536 105215                  	INCB	@R5
     374 165540 000773                  	BR	54$
     375                                ;
     376 165542 062704  000072          55$:	ADD	#72,R4
     377 165546 005205                  	INC	R5
     378 165550 110425                  	MOVB	R4,(R5)+
     379 165552 112725  000040          UNPEND:	MOVB	#40,(R5)+
     380 165556 166605  000024          	SUB	24(SP),R5
     381 165562 062706  000010          	ADD	#10,SP
     382 165566 012604                  	MOV	(SP)+,R4
     383 165570 005067  002134'         	CLR	SAVJMP
     384 165574 012666  000004          	MOV	(SP)+,4(SP)
     385 165600 022626                  	CMP	(SP)+,(SP)+
     386 165602 006166  000002          	ROL	2(SP)
     387 165606 010566  000002          	MOV	R5,2(SP)
     388 165612 000207                  	RETURN
     389                                ;
     390 165614 010046                  DG5DL4:	MOV	R0,-(SP)
     391 165616 010146                  	MOV	R1,-(SP)
     392 165620 010246                  	MOV	R2,-(SP)
     393 165622 010346                  	MOV	R3,-(SP)
     394 165624 004767  166410'         	CALL	UDAL2
     395 165630 004767  166410'         	CALL	UDAL2
     396 165634 005503                  	ADC	R3
     397 165636 005502                  	ADC	R2
     398 165640 005501                  	ADC	R1
     399 165642 005500                  	ADC	R0
     400 165644 062603                  	ADD	(SP)+,R3
     401 165646 005502                  	ADC	R2
     402 165650 005501                  	ADC	R1
     403 165652 005500                  	ADC	R0
     404 165654 005504                  	ADC	R4
     405 165656 062602                  	ADD	(SP)+,R2
     406 165660 005501                  	ADC	R1
     407 165662 005500                  	ADC	R0
     408 165664 005504                  	ADC	R4
     409 165666 062601                  	ADD	(SP)+,R1
     410 165670 005500                  	ADC	R0
     411 165672 005504                  	ADC	R4
     412 165674 062600                  	ADD	(SP)+,R0
     413 165676 005504                  	ADC	R4
     414 165700 000207                  	RETURN
     415                                ;
     416 165702 012704  000020          DG4DL5:	MOV	#20,R4
     417 165706 004767  166410'         	CALL	UDAL2
     418 165712 010346                  	MOV	R3,-(SP)
     419 165714 010246                  	MOV	R2,-(SP)
     420 165716 010146                  	MOV	R1,-(SP)
     421 165720 010046                  	MOV	R0,-(SP)
     422 165722 004767  166410'         1$:	CALL	UDAL2
     423 165726 004767  166410'         	CALL	UDAL2
     424 165732 004767  166410'         2$:	CALL	UDAL2
     425 165736 066603  000006          	ADD	6(SP),R3
     426 165742 005502                  	ADC	R2
     427 165744 005501                  	ADC	R1
     428 165746 005500                  	ADC	R0
     429 165750 066602  000004          	ADD	4(SP),R2
     430 165754 005501                  	ADC	R1
     431 165756 005500                  	ADC	R0
     432 165760 066601  000002          	ADD	2(SP),R1
     433 165764 005500                  	ADC	R0
     434 165766 061600                  	ADD	@SP,R0
     435 165770 005404                  	NEG	R4
     436 165772 002757                  	BLT	2$
     437 165774 005304                  	DEC	R4
     438 165776 003351                  	BGT	1$
     439 166000 062706  000010          	ADD	#10,SP
     440 166004 000207                  	RETURN
     441                                ;
     442 166006 010546                  UDAUG8:	MOV	R5,-(SP)
     443 166010 012705  000003          	MOV	#3,R5
     444 166014 004767  166540'         1$:	CALL	PDAUG2
     445 166020 006104                  	ROL	R4
     446 166022 005305                  	DEC	R5
     447 166024 003373                  	BGT	1$
     448 166026 012605                  	MOV	(SP)+,R5
     449 166030 000207                  	RETURN
     450                                ;
     451 166032 005726                  ASTER:	TST	(SP)+
     452 166034 016605  000016          	MOV	16(SP),R5
     453 166040 010566  000024          	MOV	R5,24(SP)
     454 166044 112725  000045          	MOVB	#'%,(R5)+
     455 166050 005166  000022          	COM	22(SP)
     456 166054 000636                  	BR	UNPEND
     457                                ;
     458 166056 020527  000024          ROUND1:	CMP	R5,#24
     459 166062 003052                  	BGT	4$
     460 166064 005705                  	TST	R5
     461 166066 001451                  	BEQ	5$
     462 166070 002447                  	BLT	4$
     463 166072 010446                  	MOV	R4,-(SP)
     464 166074 010046                  	MOV	R0,-(SP)
     465 166076 010146                  	MOV	R1,-(SP)
     466 166100 010246                  	MOV	R2,-(SP)
     467 166102 010346                  	MOV	R3,-(SP)
     468 166104 012700  100000          	MOV	#100000,R0
     469 166110 005001                  	CLR	R1
     470 166112 005002                  	CLR	R2
     471 166114 005003                  	CLR	R3
     472 166116 005305                  1$:	DEC	R5
     473 166120 001411                  	BEQ	2$
     474 166122 004767  165702'         	CALL	DG4DL5
     475 166126 004767  166410'         	CALL	UDAL2
     476 166132 004767  166410'         	CALL	UDAL2
     477 166136 004767  166410'         	CALL	UDAL2
     478 166142 000765                  	BR	1$
     479 166144 005004                  2$:	CLR	R4
     480 166146 062603                  	ADD	(SP)+,R3
     481 166150 005502                  	ADC	R2
     482 166152 005501                  	ADC	R1
     483 166154 005500                  	ADC	R0
     484 166156 062602                  	ADD	(SP)+,R2
     485 166160 005501                  	ADC	R1
     486 166162 005500                  	ADC	R0
     487 166164 062601                  	ADD	(SP)+,R1
     488 166166 005500                  	ADC	R0
     489 166170 062600                  	ADD	(SP)+,R0
     490 166172 005504                  	ADC	R4
     491 166174 062604                  	ADD	(SP)+,R4
     492 166176 022704  000012          3$:	CMP	#12,R4
     493 166202 003002                  	BGT	4$
     494 166204 005266  000002          	INC	2(SP)
     495 166210 000207                  4$:	RETURN
     496                                ;
     497 166212 062704  000005          5$:	ADD	#5,R4
     498 166216 000767                  	BR	3$
     499                                ;
     500 166220 010566  000026          SIGN:	MOV	R5,26(SP)
     501 166224 020566  000020          	CMP	R5,20(SP)
     502 166230 103411                  	BLO	2$
     503 166232 006066  000010          	ROR	10(SP)
     504 166236 103003                  	BCC	1$
     505 166240 112725  000055          	MOVB	#'-,(R5)+
     506 166244 000207                  	RETURN
     507 166246 112725  000040          1$:	MOVB	#40,(R5)+
     508 166252 000207                  	RETURN
     509                                ;
     510 166254 006066  000010          2$:	ROR	10(SP)
     511 166260 103664                  	BCS	ASTER
     512 166262 005205                  	INC	R5
     513 166264 020566  000020          	CMP	R5,20(SP)
     514 166270 103660                  	BLO	ASTER
     515 166272 000207                  	RETURN
     516                                ;
     517 166274 022704  000012          NUMB:	CMP	#12,R4
     518 166300 003004                  	BGT	1$
     519 166302 112725  000061          	MOVB	#'1,(R5)+
     520 166306 162704  000012          	SUB	#12,R4
     521 166312 026605  000006          1$:	CMP	6(SP),R5
     522 166316 001002                  	BNE	2$
     523 166320 112725  000056          	MOVB	#'.,(R5)+
     524 166324 026605  000016          2$:	CMP	16(SP),R5
     525 166330 101411                  	BLOS	3$
     526 166332 062704  000060          	ADD	#60,R4
     527 166336 110425                  	MOVB	R4,(R5)+
     528 166340 005004                  	CLR	R4
     529 166342 004767  165614'         	CALL	DG5DL4
     530 166346 004767  166006'         	CALL	UDAUG8
     531 166352 000757                  	BR	1$
     532 166354 124527  000060          3$:	CMPB	-(R5),#'0
     533 166360 001775                  	BEQ	3$
     534 166362 121527  000056          	CMPB	@R5,#'.
     535 166366 001006                  	BNE	4$
     536 166370 126527  177777  000060  	CMPB	-1(R5),#'0
     537 166376 103003                  	BHIS	5$
     538 166400 112715  000060          	MOVB	#'0,@R5
     539 166404 005205                  4$:	INC	R5
     540 166406 000207                  5$:	RETURN
     541                                ;
     542 166410 000241                  UDAL2:	CLC
     543 166412 006000                  PDAL2:	ROR	R0
     544 166414 006001                  	ROR	R1
     545 166416 006002                  	ROR	R2
     546 166420 006003                  	ROR	R3
     547 166422 000207                  	RETURN
     548                                ;
     549 166424 020027  146314          PD5DL4:	CMP	R0,#146314
     550 166430 103405                  	BCS	1$
     551 166432 000241                  	CLC
     552 166434 004767  166412'         	CALL	PDAL2
     553 166440 005266  000002          	INC	2(SP)
     554 166444 010046                  1$:	MOV	R0,-(SP)
     555 166446 010146                  	MOV	R1,-(SP)
     556 166450 010246                  	MOV	R2,-(SP)
     557 166452 010346                  	MOV	R3,-(SP)
     558 166454 000241                  	CLC
     559 166456 004767  166412'         	CALL	PDAL2
     560 166462 000241                  	CLC
     561 166464 004767  166412'         	CALL	PDAL2
     562 166470 000410                  	BR	PLIUS
     563                                ;
     564 166472 010046                  PDAUG5:	MOV	R0,-(SP)
     565 166474 010146                  	MOV	R1,-(SP)
     566 166476 010246                  	MOV	R2,-(SP)
     567 166500 010346                  	MOV	R3,-(SP)
     568 166502 004767  166540'         	CALL	PDAUG2
     569 166506 004767  166540'         	CALL	PDAUG2
     570                                ;
     571 166512 062603                  PLIUS:	ADD	(SP)+,R3
     572 166514 005502                  	ADC	R2
     573 166516 005501                  	ADC	R1
     574 166520 005500                  	ADC	R0
     575 166522 062602                  	ADD	(SP)+,R2
     576 166524 005501                  	ADC	R1
     577 166526 005500                  	ADC	R0
     578 166530 062601                  	ADD	(SP)+,R1
     579 166532 005500                  	ADC	R0
     580 166534 062600                  	ADD	(SP)+,R0
     581 166536 000207                  	RETURN
     582                                ;
     583 166540 006303                  PDAUG2:	ASL	R3
     584 166542 006102                  	ROL	R2
     585 166544 006101                  	ROL	R1
     586 166546 006100                  	ROL	R0
     587 166550 000207                  	RETURN
     588                                ;
     589 166552 005726                  STAND::	TST	(SP)+
     590 166554 000134                  	JMP	@(R4)+
     591                                ;
     592 166556 005716                  IABS::	TST	@SP
     593 166560 100001                  	BPL	F_I1
     594 166562 005416                  INEG::	NEG	@SP
     595 166564 000134                  F_I1:	JMP	@(R4)+
     596                                ;
     597 166566 042716  100000          ABS::	BIC	#100000,@SP
     598 166572 000134                  	JMP	@(R4)+
     599                                ;
     600 166574 012700  000001          ISGN::	MOV	#1,R0
     601 166600 005716                  	TST	@SP
     602 166602 001403                  	BEQ	2$
     603 166604 100001                  	BPL	1$
     604 166606 005400                  	NEG	R0
     605 166610 010016                  1$:	MOV	R0,@SP
     606 166612 000134                  2$:	JMP	@(R4)+
     607                                ;
     608 166614 005066  000004          DSGN::	CLR	4(SP)
     609 166620 005066  000006          	CLR	6(SP)
     610                                ;
     611 166624 005716                  SSGN::	TST	@SP
     612 166626 001406                  	BEQ	1$
     613 166630 006316                  	ASL	@SP
     614 166632 012716  100400          	MOV	#100400,@SP
     615 166636 006016                  	ROR	@SP
     616 166640 005066  000002          	CLR	2(SP)
     617 166644 000134                  1$:	JMP	@(R4)+
     618                                ;
     619 166646 011600                  ID::	MOV	@SP,R0
     620 166650 005016                  	CLR	@SP
     621 166652 005046                  	CLR	-(SP)
     622 166654 010046                  	MOV	R0,-(SP)
     623                                ;
     624 166656 005046                  IS::	CLR	-(SP)
     625 166660 016601  000002          	MOV	2(SP),R1
     626 166664 003002                  	BGT	IR1
     627 166666 001424                  	BEQ	IR4
     628 166670 005401                  	NEG	R1
     629 166672 006146                   IR1:	ROL	-(SP)
     630 166674 012702  000220          	MOV	#220,R2
     631 166700 105066  000004          	CLRB	4(SP)
     632 166704 006101                   IR2:	ROL	R1
     633 166706 103402                  	BCS	IR3
     634 166710 005302                  	DEC	R2
     635 166712 000774                  	BR	IR2
     636                                 ;
     637 166714 110166  000005           IR3:	MOVB	R1,5(SP)
     638 166720 105001                  	CLRB	R1
     639 166722 150201                  	BISB	R2,R1
     640 166724 000301                  	SWAB	R1
     641 166726 006026                  	ROR	(SP)+
     642 166730 006001                  	ROR	R1
     643 166732 106066  000003          	RORB	3(SP)
     644 166736 010116                  	MOV	R1,@SP
     645 166740 000134                  IR4:	JMP	@(R4)+
     646                                ;
     647 166742 012601                  SD::	MOV	(SP)+,R1
     648 166744 012602                  	MOV	(SP)+,R2
     649 166746 005046                  	CLR	-(SP)
     650 166750 005046                  	CLR	-(SP)
     651 166752 010246                  	MOV	R2,-(SP)
     652 166754 010146                  	MOV	R1,-(SP)
     653 166756 000134                  	JMP	@(R4)+
     654                                ;
     655 166760 012666  000002          DI::	MOV	(SP)+,2(SP)
     656 166764 012666  000002          	MOV	(SP)+,2(SP)
     657                                 ;
     658 166770 005002                  SI::	CLR	R2
     659 166772 005202                  	INC	R2
     660 166774 012601                  	MOV	(SP)+,R1
     661 166776 006116                  	ROL	@SP
     662 167000 006101                  	ROL	R1
     663 167002 006146                  	ROL	-(SP)
     664 167004 110100                  	MOVB	R1,R0
     665 167006 105001                  	CLRB	R1
     666 167010 000301                  	SWAB	R1
     667 167012 162701  000201          	SUB	#201,R1
     668 167016 002427                  	BLT	RI1
     669 167020 001413                  	BEQ	RI2
     670 167022 022701  000017          	CMP	#17,R1
     671 167026 002422                  	BLT	RI3
     672 167030 000300                  	SWAB	R0
     673 167032 105000                  	CLRB	R0
     674 167034 156600  000003          	BISB	3(SP),R0
     675 167040 006100                   RI4:	ROL	R0
     676 167042 006102                  	ROL	R2
     677 167044 005301                  	DEC	R1
     678 167046 003374                  	BGT	RI4
     679 167050 005402                   RI2:	NEG	R2
     680 167052 102406                  	BVS	RI5
     681 167054 003007                  	BGT	RI3
     682 167056 006026                   RI7:	ROR	(SP)+
     683 167060 103401                  	BCS	RI6
     684 167062 005402                  	NEG	R2
     685 167064 010216                   RI6:	MOV	R2,@SP
     686 167066 000134                  	JMP	@(R4)+
     687                                 ;
     688 167070 006026                   RI5:	ROR	(SP)+
     689 167072 103774                  	BCS	RI6
     690 167074 104406                   RI3:	TRAP	6
     691 167076 005002                   RI1:	CLR	R2
     692 167100 000766                  	BR	RI7
     693                                ;
     694 167102 012746  064302          PI::	MOV	#64302,-(SP)
     695 167106 012746  121041          	MOV	#121041,-(SP)
     696 167112 012746  007732          	MOV	#7732,-(SP)
     697 167116 012746  040511          	MOV	#40511,-(SP)
     698 167122 000134                  	JMP	@(R4)+
     699                                ;
     700                                ;		MACRO	DEFINITIONS
     701                                	.MACRO	PUSH,A
     702                                	.IRP	X,<A>
     703                                		MOV	X,-(SP)
     704                                	.ENDM
     705                                	.ENDM
     706                                ;
     707                                	.MACRO	POP,A
     708                                	.IRP	X,<A>
     709                                		MOV	(SP)+,X
     710                                	.ENDM
     711                                	.ENDM
     712                                ;
     713                                	.MACRO	FPUSH,A
     714                                	.NTYPE	ATV,A
     715                                	.IF	EQ,ATV&60-40
     716                                		MOV	A,-(SP)
     717                                		MOV	A,-(SP)
     718                                		MOV	A,-(SP)
     719                                		MOV	A,-(SP)
     720                                	.IFF
     721                                	.IF	EQ	ATV&7-6
     722                                	.REPT 4
     723                                	MOV	6+A,-(SP)
     724                                	.ENDR
     725                                	.IFF
     726                                		MOV	6+A,-(SP)
     727                                		MOV	4+A,-(SP)
     728                                		MOV	2+A,-(SP)
     729                                		MOV	A,-(SP)
     730                                	.ENDC
     731                                	.ENDC
     732                                	.ENDM
     733                                ;
     734                                	.MACRO	FPOP,A
     735                                	.REPT	4
     736                                		MOV	(SP)+,A
     737                                	.ENDR
     738                                	.ENDM
     739                                ;
     740                                .SBTTL	SUPPORT ENTRY $B5,	SIMULATE DOUBLE PRECISION REAL SUBTRACTION
     741                                .SBTTL	SUPPORT ENTRY $B7,	SIMULATE DOUBLE PRECISION REAL ADDITION
     742 000001                         ROUND=1
     743                                ;
     744                                ; THESE ROUTINES PERFORM SOFTWARE SIMULATION OF DOUBLE PRECISION
     745                                ; ADDITION AND SUBTRACTION OF THE FORM A (+-) B.  WHEN EVERYTHING
     746                                ; IS SET UP (AT ABOUT 20$) THE STACK LOOKS LIKE THE FOLLOWING:
     747                                ; (LOW MEMORY TO HIGH)
     748                                ;
     749                                ; SP==> POINTER TO MANTISSA NOT IN R1-R4
     750                                ;	RESULT EXPONENT
     751                                ;	RESULT SIGN
     752                                ;	B SIGN
     753                                ;	A SIGN
     754                                ;	R0
     755                                ;	R1
     756                                ;	R2
     757                                ;	R3	(REGISTERS SAVED AT CALL)
     758                                ;	R4
     759                                ;	R5
     760                                ;	RETURN TO CALLER
     761                                ;	B1
     762                                ;	B2
     763                                ;	B3	(B MANTISSA)
     764                                ;	B4
     765                                ;	A1
     766                                ;	A2
     767                                ;	A3	(A MANTISSA)
     768                                ;	A4
     769                                ;
     770                                ; ALL REGISTERS ARE PRESERVED.  DURING EXECUTION, THE MANTISSA THAT
     771                                ; NEEDS ALIGNMENT (BY SHIFTING RIGHT) IS HELD IN R1 (MSB) THRU R4 (LSB).
     772                                ;
     773                                ; WHEN FADD OR FSUB IS CALLED, THE ARGUMENTS HAVE ALREADY BEEN PLACED
     774                                ; ON THE STACK AND THE STACK POINTER POINTS TO THE RETURN ADDRESS IN
     775                                ; THE ABOVE STACK DESCRIPTION.
     776                                ;
     777                                ;
     778                                ; FLOATING SUBTRACTION
     779                                ;
     780                                $B5::
     781                                $DSUB$::			; SIMULATE REAL SUBTRACTION
     782 167124 005746                  	TST	-(SP)
     783 167126 005766  000002          	TST	2(SP)		; ZERO?
     784 167132 001405                  	BEQ	$B7		; YES, SO IT CAN'T BE NEGATED
     785 167134 062766  100000  000002  	ADD	#100000,2(SP)	; NEGATE SIGN OF B ON STACK
     786 167142 000401                  	BR	$B7		; FALL THROUGH AND DO AN ADDITION (A-B=A+(-B))
     787                                ;
     788                                ; FLOATING ADDITION
     789                                ;
     790 167144 005746                  $DADD$::TST	-(SP)
     791                                $B7::				; SIMULATE REAL ADDITION
     792 167146 010546                  	MOV	R5,-(SP)
     793 167150 010446                  	MOV	R4,-(SP)
     794 167152 005767  002134'         	TST	SAVJMP
     795 167156 001003                  	BNE	1$
     796 167160 010467  002134'         	MOV	R4,SAVJMP
     797 167164 005016                  	CLR	@SP
     798                                1$:	PUSH	<R3,R2,R1,R0>
       1                                	.IRP	X,<R3,R2,R1,R0>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 167166 010346                  		MOV	R3,-(SP)
       2 167170 010246                  		MOV	R2,-(SP)
       3 167172 010146                  		MOV	R1,-(SP)
       4 167174 010046                  		MOV	R0,-(SP)
     799                                ;
     800                                ; FIND SIGN AND EXPONENT FOR A
     801                                ;
     802 167176 005046                  	CLR	-(SP)		; MAKE ROOM FOR SIGN
     803 167200 010604                  	MOV	SP,R4		; COPY STACK POINTER
     804 167202 062704  000030          	ADD	#30,R4		; POINT TO A1
     805 167206 011400                  	MOV	(R4),R0		; GET SIGN, EXPONENT, MSB OF MANTISSA
     806 167210 001444                  	BEQ	35$		; A IS ZERO SO ANSWER IS B
     807 167212 006300                  	ASL	R0		; SIGN INTO CARRY, EXPONENT IN UPPER BYTE
     808 167214 006016                  	ROR	(SP)		; RECORD SIGN (IN CARRY)
     809 167216 105000                  	CLRB	R0		; CLEAR MANTISSA BITS
     810 167220 000300                  	SWAB	R0		; EXPONENT IN LOW ORDER BYTE
     811 167222 152714  000200          	BISB	#200,(R4)	; SET HIDDEN BIT IS MSB OF MANTISSA
     812 167226 105064  000001          	CLRB	1(R4)		; CLEAR SIGN AND EXPONENT
     813                                ;
     814                                ; FIND SIGN AND EXPONENT FOR B
     815                                ;
     816 167232 005046                  	CLR	-(SP)		; MAKE ROOM FOR SIGN
     817 167234 010605                  	MOV	SP,R5		; COPY STACK POINTER
     818 167236 062705  000022          	ADD	#22,R5		; POINT TO B1
     819 167242 011501                  	MOV	(R5),R1		; GET SIGN, EXPONENT, MSB OF MANTISSA
     820 167244 001571                  	BEQ	RETA1		; B IS ZERO SO ANSWER IS A
     821 167246 006301                  	ASL	R1		; SIGN INTO CARRY, EXPONENT IN UPPER BYTE
     822 167250 006016                  	ROR	(SP)		; RECORD SIGN
     823 167252 105001                  	CLRB	R1		; CLEAR MANTISSA BITS
     824 167254 000301                  	SWAB	R1		; EXPONENT IN LOW ORDER BYTE
     825 167256 152715  000200          	BISB	#200,(R5)	; SET HIDDEN BIT IN MSB OF MANTISSA
     826 167262 105065  000001          	CLRB	1(R5)		; CLEAR SIGN AND EXPONENT
     827                                ;
     828                                ; DETERMINE WHICH MANTISSA NEEDS TO BE SHIFTED RIGHT TO ALIGN DECIMAL POINTS
     829                                ;
     830 167266 010002                  	MOV	R0,R2		; COPY A'S EXPONENT
     831 167270 160100                  	SUB	R1,R0		; R0=AEXP-BEXP
     832 167272 100014                  	BPL	10$		; SHIFT B RIGHT
     833 167274 005400                  	NEG	R0		; MAKE EXPONENT DIFFERENCE POSITIVE
     834 167276 022700  000070          	CMP	#56.,R0		; ARE EXPONENTS TOO DIFFERENT?
     835 167302 002566                  	BLT	RETB2		; YES, SO JUST RETURN B
     836 167304 011646                  	MOV	(SP),-(SP)	; RESULT SIGN=SIGN OF B
     837 167306 010146                  	MOV	R1,-(SP)	; RESULT EXPONENT=EXPONENT OF B
     838 167310 062705  000006          	ADD	#6,R5		; POINT TO END OF B (B4)
     839 167314 010546                  	MOV	R5,-(SP)	; SAVE POINTER
     840 167316 010405                  	MOV	R4,R5		; POINT TO A1
     841 167320 000412                  	BR	20$		; ALIGN A
     842                                35$:
     843 167322 000565                  	BR	RETB1		; IT'S TOO FAR TO REACH
     844                                ;
     845                                ; SHIFT B RIGHT
     846                                ;
     847                                10$:
     848 167324 022700  000070          	CMP	#56.,R0		; EXPONENTS TOO DIFFERENT?
     849 167330 002536                  	BLT	RETA2		; YES, SO RETURN A
     850 167332 016646  000002          	MOV	2(SP),-(SP)	; RESULT SIGN=SIGN OF A
     851 167336 010246                  	MOV	R2,-(SP)	; RESULT EXPONENT=EXPONENT OF A
     852 167340 062704  000006          	ADD	#6,R4		; POINT TO END OF A (A4)
     853 167344 010446                  	MOV	R4,-(SP)	; SAVE POINTER TO OTHER MANTISSA
     854                                ;
     855                                ; R5 NOW POINTS TO MANTISSA TO SHIFT, SO THE MANTISSA BEING SHIFTED
     856                                ; RIGHT IS PICKED UP AND PLACED INTO R1-R4.  IN ORDER TO OBTAIN TWO
     857                                ; "GUARD" BITS, THE OTHER MANTISSA IS SHIFTED LEFT AT MOST THRICE.
     858                                ; THERE IS PLENTY OF ROOM IN THE BYTE OCCUPIED BY THE EXPONENT, AND
     859                                ; THE NORMALIZE ROUTINE WILL SHIFT THE RESULT RIGHT IF NECESSARY.
     860                                ;
     861                                20$:
     862 167346 005700                  	TST	R0		; ANY SHIFTING NECESSARY
     863 167350 001417                  	BEQ	25$		; NOPE
     864 167352 012701  000003          	MOV	#3,R1		; SHIFT A MAX OF 3 TIMES
     865 167356 020100                  	CMP	R1,R0		; LESS THAT 3 REQUIRED?
     866 167360 003401                  	BLE	22$		; NOPE
     867 167362 010001                  	MOV	R0,R1		; YES, SO USE EXACT COUNT
     868                                22$:
     869 167364 011604                  	MOV	(SP),R4		; POINT TO LARGER NUMBER
     870 167366 006314                  	ASL	(R4)		; SHIFT LEFT
     871 167370 006144                  	ROL	-(R4)
     872 167372 006144                  	ROL	-(R4)
     873 167374 006144                  	ROL	-(R4)
     874 167376 005366  000002          	DEC	2(SP)		; DECREMENT RESULT EXPONENT
     875 167402 005300                  	DEC	R0		; COUNT SHIFT FOR LATER TOO
     876 167404 005301                  	DEC	R1		; COUNT THE SHIFT
     877 167406 003366                  	BGT	22$		; AND LOOP
     878                                25$:
     879 167410 012501                  	MOV	(R5)+,R1	; PICK UP MSB
     880 167412 012502                  	MOV	(R5)+,R2
     881 167414 012503                  	MOV	(R5)+,R3
     882 167416 012504                  	MOV	(R5)+,R4	; LSB
     883                                .IF	NDF	TINYFP
     884                                ;
     885                                ; TEST IF SHIFTING MANTISSA MORE THAN 8 BITS.  IF SO, USE FAST BYTE
     886                                ; SHIFT OPERATIONS.
     887                                ;
     888                                30$:
     889 167420 022700  000010          	CMP	#8.,R0		; SHIFTING 8 OR MORE PLACES?
     890 167424 003016                  	BGT	40$		; NOPE
     891 167426 105004                  	CLRB	R4		; CLEAR BYTE 6
     892 167430 150304                  	BISB	R3,R4		; BYTE 4 TO BYTE 6
     893 167432 000304                  	SWAB	R4		; 4/7
     894 167434 105003                  	CLRB	R3		; CLEAR BYTE 4
     895 167436 150203                  	BISB	R2,R3		; BYTE 2 TO BYTE 4
     896 167440 000303                  	SWAB	R3		; 2/5
     897 167442 105002                  	CLRB	R2		; CLEAR BYTE 2
     898 167444 150102                  	BISB	R1,R2		; BYTE 0 TO BYTE 2
     899 167446 000302                  	SWAB	R2		; 3/2
     900 167450 105001                  	CLRB	R1		; CLEAR BYTE 0
     901 167452 000301                  	SWAB	R1		; ZERO/1
     902 167454 162700  000010          	SUB	#8.,R0		; COUNT 8 PLACES SHIFTED
     903 167460 000757                  	BR	30$		; AND LOOP
     904                                .ENDC
     905                                ;
     906                                ; IF LESS THAN 8 SHIFTS LEFT, DO BIT SHIFTS
     907                                ;
     908                                40$:
     909 167462 005700                  	TST	R0		; ANYTHING LEFT TO DO?
     910 167464 001407                  	BEQ	50$		; NOPE, OPERANDS ARE ALIGNED
     911                                45$:
     912 167466 000241                  	CLC			; SHIFT IN A ZERO
     913 167470 006001                  	ROR	R1		; MSB
     914 167472 006002                  	ROR	R2
     915 167474 006003                  	ROR	R3
     916 167476 006004                  	ROR	R4		; LSB
     917 167500 005300                  	DEC	R0		; COUNT THE SHIFT
     918 167502 003371                  	BGT	45$		; AND CONTINUE
     919                                ;
     920                                ; DETERMINE HOW TO DO ADDITION.  IF SIGNS OF A AND B ARE THE SAME THEN
     921                                ; DO ADDITION.  IF SIGNS DIFFER THEN DO SUBTRACTION AND POSSIBLY FIX
     922                                ; UP THE SIGN (A-B=-(B-A)).
     923                                ;
     924                                50$:
     925 167504 012605                  	MOV	(SP)+,R5	; POINT TO LARGER MANTISSA
     926 167506 026666  000004  000006  	CMP	4(SP),6(SP)	; COMPARE SIGNS OF B AND A
     927 167514 001013                  	BNE	70$		; ITS SOME KIND OF SUBTRACTION
     928                                ;
     929                                ; SIGNS ARE THE SAME SO WE CAN DO AN ADDITION ((-A)+(-B)=-(A+B))
     930                                ;
     931 167516 061504                  	ADD	(R5),R4		; ADD LSB'S
     932 167520 005503                  	ADC	R3		; RIPPLE CARRY
     933 167522 005502                  	ADC	R2
     934 167524 005501                  	ADC	R1
     935 167526 064503                  	ADD	-(R5),R3	; THIRD WORDS
     936 167530 005502                  	ADC	R2
     937 167532 005501                  	ADC	R1
     938 167534 064502                  	ADD	-(R5),R2	; SECOND WORDS
     939 167536 005501                  	ADC	R1
     940 167540 064501                  	ADD	-(R5),R1	; MSB (NO POSSIBLE CARRY)
     941 167542 000430                  	BR	100$		; GET EXPONENT AND NORMAIZE RESULT
     942                                ;
     943                                ; OPERAND SIGNS DIFFER, SO DO A SUBTRACTION
     944                                ;
     945                                70$:
     946 167544 005166  000002          	COM	2(SP)		; FIX UP RESULT'S SIGN
     947 167550 161504                  	SUB	(R5),R4		; SUBTRACT LSB'S
     948 167552 005603                  	SBC	R3		; RIPPLE BORROW
     949 167554 005602                  	SBC	R2
     950 167556 005601                  	SBC	R1
     951 167560 164503                  	SUB	-(R5),R3	; THIRD WORD
     952 167562 005602                  	SBC	R2
     953 167564 005601                  	SBC	R1
     954 167566 164502                  	SUB	-(R5),R2	; SECOND WORD
     955 167570 005601                  	SBC	R1
     956 167572 164501                  	SUB	-(R5),R1	; MSB (DON'T CARE ABOUT BORROW)
     957 167574 100013                  	BPL	100$		; RESULT IS POSITIVE!!
     958 167576 005101                  	COM	R1		; DO 4 WORD NEGATE
     959 167600 005102                  	COM	R2		; REMEMBER THE CIA
     960 167602 005103                  	COM	R3		; INSTRUCTION ON 8'S?
     961 167604 005104                  	COM	R4
     962 167606 062704  000001          	ADD	#1,R4		; ADD ONE TO LSB (WHY NOT INC R4?)
     963 167612 005503                  	ADC	R3		; RIPPLE CARRY
     964 167614 005502                  	ADC	R2
     965 167616 005501                  	ADC	R1
     966 167620 005166  000002          	COM	2(SP)		; SET CORRECT RESULT SIGN
     967                                100$:
     968 167624 000453                  	BR	$FNORM		; NORMALIZE RESULT AND EXIT
     969                                
     970                                ;
     971                                ; RETURN A AS THE RESULT BECAUSE B IS ZERO (OR SUFFICIENTLY CLOSE)
     972                                ;
     973                                RETA2:
     974 167626 010200                  	MOV	R2,R0		; GET EXPONENT OF A
     975                                RETA1:
     976 167630 011403                  	MOV	(R4),R3		; GET MANTISSA
     977 167632 005726                  	TST	(SP)+		; KILL B SIGN ON STACK
     978 167634 000300                  	SWAB	R0		; MOVE EXPONENT TO UPPER HALF
     979 167636 106303                  	ASLB	R3		; KILL HIDDEN BIT IN MANTISSA
     980 167640 050003                  	BIS	R0,R3		; SET EXPONENT IN WITH MANTISSA
     981 167642 006326                  	ASL	(SP)+		; PICK UP SIGN IN CARRY
     982 167644 006003                  	ROR	R3		; CREATE FINAL RESULT
     983 167646 010314                  	MOV	R3,(R4)		; STORE ORIGINAL WORD IN A1
     984 167650 016666  000014  000024  	MOV	14(SP),24(SP)	; MOVE RETURN ADDRESS INTO PLACE
     985 167656 000420                  	BR	$RETAB		; AND FALL THROUGH
     986                                ;
     987                                ; RETURN B AS THE RESULT BECAUSE A IS ZERO OR THERE ABOUTS
     988                                ;
     989                                RETB2:
     990 167660 011503                  	MOV	(R5),R3		; GET MANTISSA
     991 167662 000301                  	SWAB	R1		; MOVE EXPONENT TO UPPER HALF
     992 167664 106303                  	ASLB	R3		; KILL HIDDEN BIT
     993 167666 050103                  	BIS	R1,R3		; ADD EXPONENT TO MANTISSA
     994 167670 006326                  	ASL	(SP)+		; PICK UP SIGN IN CARRY
     995 167672 006003                  	ROR	R3		; GENERATE FINAL RESULT
     996 167674 010315                  	MOV	R3,(R5)		; AND STORE BACK ORIGINAL WORD
     997                                RETB1:
     998 167676 005726                  	TST	(SP)+		; KILL A SIGN ON STACK
     999 167700 010405                  	MOV	R4,R5		; POINT PAST B4 (A1)
    1000 167702 062705  000010          	ADD	#10,R5		; POINT PAST A4
    1001 167706 014445                  	MOV	-(R4),-(R5)	; COPY B4 TO A4
    1002 167710 014445                  	MOV	-(R4),-(R5)	; COPY B3 TO A3
    1003 167712 014445                  	MOV	-(R4),-(R5)	; COPY B2 TO A2
    1004 167714 014445                  	MOV	-(R4),-(R5)	; COPY B1 TO A1
    1005 167716 014445                  	MOV	-(R4),-(R5)	; COPY RETURN ADDRESS TO B4
    1006                                ;
    1007                                ; POP REGISTERS FROM STACK AND RETURN WITH RESULT ON THE STACK
    1008                                ;
    1009                                $RETAB::
    1010                                	POP	<R0,R1,R2,R3>
       1                                	.IRP	X,<R0,R1,R2,R3>
       2                                		MOV	(SP)+,X
       3                                	.ENDM
       1 167720 012600                  		MOV	(SP)+,R0
       2 167722 012601                  		MOV	(SP)+,R1
       3 167724 012602                  		MOV	(SP)+,R2
       4 167726 012603                  		MOV	(SP)+,R3
    1011 167730 012604                  	MOV	(SP)+,R4
    1012 167732 001004                  	BNE	1$
    1013 167734 016704  002134'         	MOV	SAVJMP,R4
    1014 167740 005067  002134'         	CLR	SAVJMP
    1015 167744 012605                  1$:	MOV	(SP)+,R5
    1016 167746 062706  000012          	ADD	#12,SP		; POINT TO MOVED RETURN ADDRESS (B4)
    1017 167752 000134                  	JMP	@(R4)+		; RETURN TO CALLER
    1018                                
    1019                                .SBTTL	$FNORM	FLOATING NORMALIZE
    1020                                ;
    1021                                ; THIS ROUTINE NORMALIZES THE FLOATING POINT MANTISSA IN R1-R4.
    1022                                ; THE STATE OF THE STACK IS SIMILAR TO THAT DESCRIBED ABOVE FOR
    1023                                ; FLOATING ADDITION, EXCEPT THAT THE RESULT EXPONENT IS ON TOP
    1024                                ; OF THE STACK.
    1025                                ;
    1026                                $FNORM::
    1027 167754 012600                  	MOV	(SP)+,R0	; GET RESULT EXPONENT
    1028                                2$:
    1029 167756 000241                  	CLC			; PREVENT ROUNDING PROBLEMS
    1030                                1$:
    1031 167760 032701  177400          	BIT	#177400,R1	; RIGHT SHIFT REQUIRED?
    1032 167764 001407                  	BEQ	5$		; NOPE
    1033 167766 000241                  	CLC			; SHIFT IN A ZERO
    1034 167770 006001                  	ROR	R1		; MSB
    1035 167772 006002                  	ROR	R2
    1036 167774 006003                  	ROR	R3
    1037 167776 006004                  	ROR	R4		; LSB (LOW BIT FALLS INTO BIT BUCKET)
    1038 170000 005200                  	INC	R0		; COUNT THE SHIFT
    1039 170002 000766                  	BR	1$		; CONTINUE MAX 8 TIMES
    1040                                5$:
    1041                                .IF	DF	ROUND		; ROUNDING?
    1042 170004 103005                  	BCC	8$		; NO ROUNDING
    1043 170006 005504                  	ADC	R4		; ADD IN ROUNDING BIT
    1044 170010 005503                  	ADC	R3		; RIPPLE CARRY
    1045 170012 005502                  	ADC	R2
    1046 170014 005501                  	ADC	R1		; MAY REQUIRE ONE MORE SHIFT
    1047 170016 000760                  	BR	1$		; SO CHECK AGAIN
    1048                                8$:
    1049                                .ENDC
    1050 170020 105701                  	TSTB	R1		; IS NUMBER NORMALIZED?
    1051 170022 100433                  	BMI	FNORM1		; YES!
    1052 170024 001024                  	BNE	20$		; NOPE, BUT SOME BITS ARE SET LOW BYTE
    1053 170026 010146                  	MOV	R1,-(SP)	; CHECK IF RESULT IS ZERO
    1054 170030 050216                  	BIS	R2,(SP)
    1055 170032 050316                  	BIS	R3,(SP)		; BY OR'ING TOGETHER
    1056 170034 050426                  	BIS	R4,(SP)+	; ALL THE WORDS
    1057 170036 001003                  	BNE	10$		; NOPE
    1058 170040 005000                  	CLR	R0		; YES, SO EXPONENT IS ZERO
    1059 170042 005016                  	CLR	(SP)		; AS IS THE SIGN
    1060 170044 000422                  	BR	FNORM1		; TAKE FAST EXIT
    1061                                ;
    1062                                ; NO BITS SET IN FIRST 8 BITS OF MSB OF MANTISSA, SO PERFORM
    1063                                ; FAST LEFT BITE-SIZED SHIFT.
    1064                                ;
    1065                                10$:
    1066                                .IF	NDF	TINYFP
    1067 170046 000302                  	SWAB	R2		; REVERSE BYTES 2/3
    1068 170050 150201                  	BISB	R2,R1		; BYTE 3 TO BYTE 0
    1069 170052 105002                  	CLRB	R2		; MAKE ROOM FOR NEXT BYTE
    1070 170054 000303                  	SWAB	R3		; REVERSE BYTE 4/5
    1071 170056 150302                  	BISB	R3,R2		; BYTE 5 TO BYTE 2
    1072 170060 105003                  	CLRB	R3		; MAKE ROOM FOR NEXT BYTE
    1073 170062 000304                  	SWAB	R4		; REVERSE BYTES 6/7
    1074 170064 150403                  	BISB	R4,R3		; BYTE 7 TO BYTE 4
    1075 170066 105004                  	CLRB	R4		; ZEROS INTO BYTE 6 (LSB)
    1076 170070 162700  000010          	SUB	#8.,R0		; COUNT 8 SHIFTS
    1077 170074 000730                  	BR	2$		; AND KEEP SHIFTING
    1078                                .ENDC
    1079                                20$:
    1080 170076 005300                  	DEC	R0		; COUNT ONE SHIFT
    1081 170100 006304                  	ASL	R4		; SHIFT LEFT LSB
    1082 170102 006103                  	ROL	R3		; SHIFT 4 WORDS
    1083 170104 006102                  	ROL	R2
    1084 170106 106101                  	ROLB	R1		; SHIFT LEFT MSB
    1085 170110 100372                  	BPL	20$		; NOT YET NORMALIZED
    1086                                ;
    1087                                ; MANTISSA IS NORMALIZED. ADD SIGN AND EXPONENT AND CHECK FOR
    1088                                ; OVERFLOW/UNDERFLOW.  THIS ENTRY POINT IS ALSO A FAST EXIT
    1089                                ; FROM THE ADD/SUBTRACT ROUTINE.
    1090                                ;
    1091                                FNORM1::
    1092 170112 000300                  	SWAB	R0		; PUT EXPONENT IN UPPER BYTE
    1093 170114 105700                  	TSTB	R0		; ANY GARBAGE LEFT FROM EXPONENT?
    1094 170116 001021                  	BNE	FLTERR		; YES!?! OVERFLOW/UNDERFLOW
    1095                                FNORM2:
    1096 170120 106301                  	ASLB	R1		; KILL HIDDEN BIT
    1097 170122 050001                  	BIS	R0,R1		; ADD EXPONENT TO UPPER BYTE
    1098 170124 006326                  	ASL	(SP)+		; GET SIGN OF RESULT IN CARRY
    1099 170126 006001                  	ROR	R1		; AND PRESTO!  WE HAVE FLOATING RESULT
    1100                                ;
    1101                                ; STORE RESULT INTO STACK ON TOP OF A AND EXIT TO RETA2 WHICH CLEARS
    1102                                ; STACK, RESTORES REGISTERS, AND LEAVES THE RESULT ON THE STACK.
    1103                                ;
    1104 170130 010605                  	MOV	SP,R5		; COPY STACK POINTER
    1105 170132 062705  000032          	ADD	#32,R5		; POINT TO RESULT SLOT (A1)
    1106 170136 010125                  	MOV	R1,(R5)+	; COPY SIGN, EXPONENT, MSB
    1107 170140 010225                  	MOV	R2,(R5)+
    1108 170142 010325                  	MOV	R3,(R5)+
    1109 170144 010425                  	MOV	R4,(R5)+	; LSB
    1110 170146 062706  000004          	ADD	#4,SP		; KILL SIGNS ON STACK
    1111 170152 016666  000014  000024  	MOV	14(SP),24(SP)	; COPY RETURN ADDRESS
    1112 170160 000657                  	BR	$RETAB		; AND EXIT
    1113                                FLTERR:
    1114 170162 104406                  	TRAP	6
    1115                                $FLZER::
    1116 170164 005000                  	CLR	R0		; UNDERFLOW MAKES NUMBER ZERO
    1117 170166 005001                  	CLR	R1
    1118 170170 005002                  	CLR	R2
    1119 170172 005003                  	CLR	R3
    1120 170174 005004                  	CLR	R4
    1121 170176 005016                  	CLR	(SP)		; POSITIVE ZERO!
    1122 170200 000747                  	BR	FNORM2
    1123                                ;
    1124                                .SBTTL	SUPPORT ENTRY $B3,	SIMULATE DOUBLE PRECISION REAL MULTIPLY
    1125                                .GLOBL	$FNORM,	$FLZER
    1126                                ;
    1127                                ; THIS ROUTINE SIMULATES A DOUBLE PRECISION FLOATING POINT MULTIPLY.
    1128                                ; THE TWO OPERANDS ARE ON THE STACK WHEN THIS ROUTINE IS CALLED. THE
    1129                                ; STATE OF THE STACK (AT ABOUT 10$) IS AS FOLLOWS:
    1130                                ;
    1131                                ; SP==> RESULT EXPONENT
    1132                                ;	RESULT SIGN
    1133                                ;	UNUSED (REQUIRED FOR NORMALIZE)
    1134                                ;	UNUSED (REQUIRED FOR NORMALIZE)
    1135                                ;	R0
    1136                                ;	R1
    1137                                ;	R2
    1138                                ;	R3	(REGISTERS SAVE AT CALL)
    1139                                ;	R4
    1140                                ;	R5
    1141                                ;	RETURN TO CALLER
    1142                                ;	B1
    1143                                ;	B2
    1144                                ;	B3	(B MANTISSA)
    1145                                ;	B4
    1146                                ;	A1
    1147                                ;	A2
    1148                                ;	A3
    1149                                ;	A4
    1150                                ;
    1151                                ; ALL REGISTERS ARE PRESERVED.  DURING CALCULATIONS, THE RESULT IS BUILT
    1152                                ; IN R1-R4.  R0 POINTS TO THE MULTIPLIER (OR MULTIPLICAND, I CAN NEVER
    1153                                ; REMEMBER WHICH IS WHICH) WHICH IS ARRANGED TO BE THE MANTISSA WITH
    1154                                ; THE FEWEST NUMBER OF SIGNIFICANT BITS.  R5 POINTS TO THE OTHER OPERAND
    1155                                ; WHICH GETS SHIFTED RIGHT AS THE MULTIPLICATION IS PERFORMED.
    1156                                ;
    1157                                ; SPECIAL CASE HANDLING OF MULTIPLY BY ZERO
    1158                                ;
    1159                                $ZERO::
    1160 170202 005046                  	CLR	-(SP)		; RESULT SIGN
    1161 170204 000167  170164'         	JMP	$FLZER		; RESULT IS ZERO
    1162                                ;
    1163                                ; ENTRY POINT FOR MULTIPLY
    1164                                ;
    1165                                $B3::				; SIMULATE DOUBLE REAL MULTIPLICATION
    1166                                $DMUL$::
    1167 170210 005746                  	TST	-(SP)
    1168 170212 010546                  	MOV	R5,-(SP)
    1169 170214 010446                  	MOV	R4,-(SP)
    1170 170216 005767  002134'         	TST	SAVJMP
    1171 170222 001003                  	BNE	1$
    1172 170224 010467  002134'         	MOV	R4,SAVJMP
    1173 170230 005016                  	CLR	@SP
    1174                                1$:	PUSH	<R3,R2,R1,R0>
       1                                	.IRP	X,<R3,R2,R1,R0>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 170232 010346                  		MOV	R3,-(SP)
       2 170234 010246                  		MOV	R2,-(SP)
       3 170236 010146                  		MOV	R1,-(SP)
       4 170240 010046                  		MOV	R0,-(SP)
    1175 170242 162706  000004          	SUB	#4,SP		; SKIP TWO WORDS (USED BY ADD/SUB)
    1176 170246 012703  000200          	MOV	#200,R3		; USEFUL CONSTANT
    1177                                ; .PAGE
    1178                                ;
    1179                                ; GET SIGN AND EXPONENT OF A
    1180                                ;
    1181 170252 005002                  	CLR	R2		; HOLDS RESULT SIGN
    1182 170254 010604                  	MOV	SP,R4		; COPY STACK POINTER
    1183 170256 062704  000032          	ADD	#32,R4		; POINT TO A MSB
    1184 170262 011400                  	MOV	(R4),R0		; PICK UP SIGN, EXPONENT, MSB OF MANTISSA
    1185 170264 001746                  	BEQ	$ZERO		; ZERO TIMES ANYTHING IS ZERO!
    1186 170266 006300                  	ASL	R0		; SHIFT SIGN INTO CARRY, BYTE ALIGN EXPONENT
    1187 170270 005502                  	ADC	R2		; SIGN TO LOW ORDER BIT
    1188 170272 105000                  	CLRB	R0		; CLEAR MSB OF MANTISSA
    1189 170274 000300                  	SWAB	R0		; MOVE EXPONENT TO LOW BYTE
    1190 170276 150314                  	BISB	R3,(R4)		; SET HIDDEN BIT IN MANTISSA
    1191 170300 105064  000001          	CLRB	1(R4)		; CLEAR SIGN/EXPONENT
    1192                                ;
    1193                                ; GET SIGN AND EXPONENT OF B
    1194                                ;
    1195 170304 010605                  	MOV	SP,R5		; COPY STACK POINTER
    1196 170306 062705  000022          	ADD	#22,R5		; POINT TO MANTISSA OF B
    1197 170312 011501                  	MOV	(R5),R1		; GET SIGN, EXPONENT AND MSB OF MANTISSA
    1198 170314 001732                  	BEQ	$ZERO		; RESULT IS ZERO!
    1199 170316 006301                  	ASL	R1		; SIGN INTO CARRY, BYTE ALIGN EXPONENT
    1200 170320 005502                  	ADC	R2		; XOR OF SIGNS IN LOW BIT
    1201 170322 006002                  	ROR	R2		; LOW BIT INTO CARRY
    1202 170324 006002                  	ROR	R2		; AND BACK INTO SIGN BIT
    1203 170326 010246                  	MOV	R2,-(SP)	; PUT RESULT SIGN ON STACK
    1204 170330 105001                  	CLRB	R1		; CLEAR MANTISSA PART
    1205 170332 000301                  	SWAB	R1		; EXPONENT TO LOW BYTE
    1206 170334 150315                  	BISB	R3,(R5)		; SET HIDDEN BIT
    1207 170336 105065  000001          	CLRB	1(R5)		; CLEAR SIGN AND EXPONENT
    1208                                ;
    1209                                ; CALCULATE RESULT EXPONENT
    1210                                ;
    1211 170342 060100                  	ADD	R1,R0		; RESULT EXPONENT IS SUM OF OPERAND EXPONENTS
    1212 170344 160300                  	SUB	R3,R0		; (AEXP+200)+(BEXP+200)-200=(AEXP+BEXP)+200
    1213 170346 010046                  	MOV	R0,-(SP)	; SAVE RESULT EXPONENT (OVERFLOW CHECKED LATER)
    1214                                ; .PAGE
    1215                                .IF	NDF	TINYFP
    1216                                ;
    1217                                ; DETERMINE WHICH OPERAND HAS THE FEWEST NUMBER OF SIGNIFICANT BITS
    1218                                ;
    1219 170350 005000                  	CLR	R0		; COUNT FOR A
    1220 170352 010402                  	MOV	R4,R2		; COPY POINTER TO A'S MANTISSA
    1221 170354 062702  000010          	ADD	#10,R2		; POINT PAST END OF A
    1222                                10$:
    1223 170360 005200                  	INC	R0		; COUNT A WORD
    1224 170362 005742                  	TST	-(R2)		; ANY BITS SET?
    1225 170364 001775                  	BEQ	10$		; NO, SO COUNT ANOTHER WORD
    1226 170366 005001                  	CLR	R1		; COUNT FOR B
    1227 170370 010503                  	MOV	R5,R3		; POINT TO B
    1228 170372 062703  000010          	ADD	#10,R3		; POINT PAST END OF B
    1229                                20$:
    1230 170376 005201                  	INC	R1		; COUNT A WORD
    1231 170400 005743                  	TST	-(R3)		; ANY BITS SET?
    1232 170402 001775                  	BEQ	20$		; NO, SO COUNT ONE MORE WORD
    1233 170404 020001                  	CMP	R0,R1		; WHICH HAS FEWER BITS
    1234 170406 002003                  	BGE	30$		; A DOES
    1235 170410 010500                  	MOV	R5,R0		; B DOES, SO USE B FOR LEFT SHIFTING
    1236 170412 010405                  	MOV	R4,R5		; USE A FOR RIGHT SHIFTING
    1237 170414 000401                  	BR	40$		; AND START CALCULATING
    1238                                .IFF
    1239                                	MOV	#56.,4(SP)	; SHIFT COUNT FOR TINY MULTIPLY
    1240                                .ENDC
    1241                                30$:
    1242 170416 010400                  	MOV	R4,R0		; COPY POINTER TO A
    1243                                40$:
    1244 170420 012701  000003          	MOV	#3,R1		; GET COUNT (3 GUARD BITS)
    1245                                45$:
    1246 170424 062705  000006          	ADD	#6,R5		; POINT TO END OF MULTIPLIER
    1247 170430 000241                  	CLC			; SHIFT IN A ZERO
    1248 170432 006115                  	ROL	(R5)		; ROTATE LEFT
    1249 170434 006145                  	ROL	-(R5)		; TO INCREASE
    1250 170436 006145                  	ROL	-(R5)		; ACCURACY IN CASE WE
    1251 170440 006145                  	ROL	-(R5)		; ROUND DURING NORMALIZATION
    1252 170442 005316                  	DEC	(SP)		; ADJUST EXPONENT
    1253 170444 005301                  	DEC	R1		; COUNT THIS SHIFT
    1254 170446 003366                  	BGT	45$		; KEEP SHIFTING TO INTRODUCE GUARD BITS
    1255                                ;
    1256                                ; CLEAR RESULT (R1-R4)
    1257                                ;
    1258 170450 005001                  	CLR	R1		; RESULT IS BUILT IN
    1259 170452 005002                  	CLR	R2		; THESE REGISTERS
    1260 170454 005003                  	CLR	R3
    1261 170456 005004                  	CLR	R4		; LSB
    1262                                ; .PAGE
    1263                                ;
    1264                                ; MAIN MULTIPLY LOOP.  AS THE MANTISSA POINTED TO BY R0 IS SHIFTED
    1265                                ; RIGHT, TESTS ARE MADE FOR POSSIBLE BYTE OR WORD SHIFTS.  SINCE
    1266                                ; WE PICKED THE SHORTER MANTISSA TO SHIFT RIGHT, THIS OPTIMIZATION
    1267                                ; MINIMIZES ITERATIONS THROUGH THIS LOOP.
    1268                                ;
    1269                                50$:
    1270                                .IF	NDF	TINYFP
    1271 170460 105760  000006          	TSTB	6(R0)		; LAST BYTE ZERO?
    1272 170464 001111                  	BNE	110$		; NOPE, SO DO SLOW MULTIPLY
    1273 170466 105760  000007          	TSTB	7(R0)		; NEXT TO LAST BYTE ALSO ZERO?
    1274 170472 001053                  	BNE	100$		; NOPE, DO BYTE SHIFT
    1275 170474 005760  000004          	TST	4(R0)		; THIRD WORD ZERO?
    1276 170500 001032                  	BNE	70$		; NO, SO DO WORD SHIFT
    1277 170502 005760  000002          	TST	2(R0)		; SECOND WORD ZERO?
    1278 170506 001012                  	BNE	60$		; NOPE, SO DO DOUBLE WORD SHIFT
    1279 170510 005710                  	TST	(R0)		; FIRST WORD ZERO?
    1280 170512 001527                  	BEQ	130$		; YES! ALL DONE!
    1281                                ;
    1282                                ; DO A THREE WORD RIGHT SHIFT OF MULTIPLIER AND RESULT
    1283                                ;
    1284 170514 011060  000006          	MOV	(R0),6(R0)	; FIRST WORD TO LAST WORD
    1285 170520 005010                  	CLR	(R0)		; ZEROS SHIFTED INTO FIRST WORD
    1286 170522 010104                  	MOV	R1,R4		; FIRST WORD TO LAST WORD
    1287 170524 005001                  	CLR	R1		; ZERO SHIFTED INTO
    1288 170526 005002                  	CLR	R2		; FIRST THREE
    1289 170530 005003                  	CLR	R3		; WORDS
    1290 170532 000752                  	BR	50$		; CONTINUE
    1291                                ;
    1292                                ; DO A TWO WORD RIGHT SHIFT
    1293                                ;
    1294                                60$:
    1295 170534 016060  000002  000006  	MOV	2(R0),6(R0)	; SECOND WORD TO LAST WORD
    1296 170542 011060  000004          	MOV	(R0),4(R0)	; FIRST WORD TO THIRD WORD
    1297 170546 005060  000002          	CLR	2(R0)		; ZEROES SHIFTED INTO FIRST
    1298 170552 005010                  	CLR	(R0)		; TWO WORDS
    1299 170554 010204                  	MOV	R2,R4		; SECOND WORD TO LAST WORD
    1300 170556 010103                  	MOV	R1,R3		; FIRST WORD TO THIRD WORD
    1301 170560 005001                  	CLR	R1		; ZEROES SHIFTED INTO FIRST
    1302 170562 005002                  	CLR	R2		; TWO WORDS
    1303 170564 000735                  	BR	50$		; CONTINUE
    1304                                ;
    1305                                ; SHIFT RIGHT ONE WORD
    1306                                ;
    1307                                70$:
    1308 170566 016060  000004  000006  	MOV	4(R0),6(R0)	; THIRD WORD TO LAST WORD
    1309 170574 016060  000002  000004  	MOV	2(R0),4(R0)	; SECOND WORD TO THIRD WORD
    1310 170602 011060  000002          	MOV	(R0),2(R0)	; FIRST WORD TO SECOND WORD
    1311 170606 005010                  	CLR	(R0)		; ZEROES SHIFTED INTO FIRST WORD
    1312 170610 010304                  	MOV	R3,R4		; THIRD WORD TO LAST WORD
    1313 170612 010203                  	MOV	R2,R3		; SECOND WORD TO THIRD WORD
    1314 170614 010102                  	MOV	R1,R2		; FIRST WORD TO SECOND WORD
    1315 170616 005001                  	CLR	R1		; ZEROES SHIFTED INTO FIRST WORD
    1316 170620 000717                  	BR	50$		; CONTINUE
    1317                                ; .PAGE
    1318                                ;
    1319                                ; SHIFT RIGHT ONE BYTE.  IT LOOKS UGLY, BUT IT'S MUCH FASTER THAN
    1320                                ; BIT SHIFTING!
    1321                                ;
    1322                                100$:
    1323 170622 116060  000004  000006  	MOVB	4(R0),6(R0)	; BYTE 4 TO BYTE 6
    1324 170630 000360  000006          	SWAB	6(R0)		; 4/7 IN LAST WORD
    1325 170634 116060  000002  000004  	MOVB	2(R0),4(R0)	; BYTE 2 TO BYTE 4
    1326 170642 000360  000004          	SWAB	4(R0)		; 2/5 IN THIRD WORD
    1327 170646 111060  000002          	MOVB	(R0),2(R0)	; BYTE 0 TO BYTE 2
    1328 170652 000360  000002          	SWAB	2(R0)		; 0/3 IN SECOND WORD
    1329 170656 105010                  	CLRB	(R0)		; ZEROES SHIFTED INTO LOW BYTE
    1330 170660 000310                  	SWAB	(R0)		; X/1 IN FIRST WORD
    1331 170662 105004                  	CLRB	R4		; CLEAR BYTE 6
    1332 170664 150304                  	BISB	R3,R4		; BYTE 4 TO BYTE 6
    1333 170666 000304                  	SWAB	R4		; 4/7 IN LAST WORD
    1334 170670 105003                  	CLRB	R3		; CLEAR BYTE 4
    1335 170672 150203                  	BISB	R2,R3		; BYTE 2 TO BYTE 4
    1336 170674 000303                  	SWAB	R3		; 2/5 IN THIRD WORD
    1337 170676 105002                  	CLRB	R2		; CLEAR BYTE 2
    1338 170700 150102                  	BISB	R1,R2		; BYTE 0 TO BYTE 2
    1339 170702 000302                  	SWAB	R2		; 0/3 IN SECOND WORD
    1340 170704 105001                  	CLRB	R1		; ZEROES SHIFTED INTO LOW BYTE
    1341 170706 000301                  	SWAB	R1		; X/1 IN FIRST WORD
    1342                                .IFF
    1343                                	CLC			; NEEDED BECAUSE NO TSTB 6(R0) WAS DONE
    1344                                .ENDC
    1345                                ;
    1346                                ; LAST BYTE CONTAINS INTERESTING BITS.  ROTATE MULTIPLICAND RIGHT AND
    1347                                ; CHECK IF ADDITION SHOULD BE DONE ON THIS PASS.
    1348                                ;
    1349                                110$:
    1350 170710 006020                  	ROR	(R0)+		; CARRY CLEARED BY TSTB AT 50$!
    1351 170712 006020                  	ROR	(R0)+		; MULTIPLE WORD SHIFT
    1352 170714 006020                  	ROR	(R0)+
    1353 170716 006010                  	ROR	(R0)		; LSB
    1354 170720 103014                  	BCC	120$		; ADDITION NOT NEEDED ON THIS PASS
    1355 170722 062705  000006          	ADD	#6,R5		; POINT TO LSB OF MULTIPLIER
    1356 170726 061504                  	ADD	(R5),R4		; LSB
    1357 170730 005503                  	ADC	R3		; RIPPLE CARRY
    1358 170732 005502                  	ADC	R2
    1359 170734 005501                  	ADC	R1
    1360 170736 064503                  	ADD	-(R5),R3	; THIRD WORD
    1361 170740 005502                  	ADC	R2
    1362 170742 005501                  	ADC	R1
    1363 170744 064502                  	ADD	-(R5),R2	; SECOND WORD
    1364 170746 005501                  	ADC	R1
    1365 170750 064501                  	ADD	-(R5),R1	; FIRST WORD (MSB) NO CARRY!
    1366                                ;
    1367                                ; SHIFT RESULT RIGHT ONE BIT
    1368                                ;
    1369                                120$:
    1370 170752 162700  000006          	SUB	#6,R0		; POINT BACK TO START OF MULTIPLICAND
    1371 170756 000241                  	CLC			; ZERO SHIFTED INTO MSB OF RESULT
    1372 170760 006001                  	ROR	R1		; MULTIPLE WORD SHIFT
    1373 170762 006002                  	ROR	R2
    1374 170764 006003                  	ROR	R3
    1375 170766 006004                  	ROR	R4		; LSB FALLS INTO BIT BUCKET
    1376                                .IF	NDF	TINYFP
    1377 170770 000633                  	BR	50$		; CONTINUE
    1378                                .IFF
    1379                                	DEC	4(SP)		; COUNT THIS LOOP
    1380                                	BGT	50$		; MORE TO DO
    1381                                .ENDC
    1382                                ;
    1383                                ; DONE MULTIPLYING.  PICK UP EXPONENT AND JUMP TO THE
    1384                                ; NORMALIZE ROUTINE WHICH CLEANS UP THE STACK AND RETURNS
    1385                                ; TO THE CALLER.
    1386                                ;
    1387                                130$:
    1388 170772 000167  167754'         	JMP	$FNORM		; NORMALIZE RESULT IN R1-R4
    1389                                .SBTTL	SUPPORT ENTRY $B1,	SIMULATE DOUBLE PRECISION REAL DIVISION
    1390                                .GLOBL	$FNORM,	$RETAB,	$ZERO
    1391                                ;
    1392                                ; SIMULATES DOUBLE PRECISION FLOATING POINT DIVISION.  THE
    1393                                ; TWO OPERANDS ARE ON THE STACK WHEN THIS ROUTINE IS CALLED. THE
    1394                                ; DIVISION PERFORMED IS A/B.  THE STATE OF THE STACK AT ABOUT 10$
    1395                                ; IS AS FOLLOWS:
    1396                                ;
    1397                                ; SP==> RESULT EXPONENT
    1398                                ;	RESULT SIGN
    1399                                ;	SHIFT COUNT
    1400                                ;	UNUSED	(REQUIRED FOR NORMALIZE)
    1401                                ;	R0
    1402                                ;	R1
    1403                                ;	R2
    1404                                ;	R3	(REGISTERS SAVED AT CALL)
    1405                                ;	R4
    1406                                ;	R5
    1407                                ;	RETURN TO CALLER
    1408                                ;	B1
    1409                                ;	B2
    1410                                ;	B3	(B MANTISSA)
    1411                                ;	B4
    1412                                ;	A1
    1413                                ;	A2
    1414                                ;	A3	(A MANTISSA)
    1415                                ;	A4
    1416                                ;
    1417                                ; ALL REGISTERS ARE PRESERVED.  DURING CALCULATIONS, R1-R4 HOLD THE
    1418                                ; CURRENT REMAINDER OF THE DIVISION.  THE QUOTIENT IS BUILT BIT BY
    1419                                ; BIT AT THE LOCATION POINTED TO BY R0.  THIS ALGORITHM USES A NON-
    1420                                ; RESTORING NORMAILZED DIVISION METHOD DESCRIBED IN THE FP11-B
    1421                                ; HARDWARE MANUAL.  R5 POINTS TO THE MANTISSA OF THE DIVISOR.
    1422                                ;
    1423                                ;
    1424                                ; ENTRY POINT FOR DIVISION
    1425                                ;
    1426                                $B1::				; SIMULATE REAL DIVISION
    1427                                $DDIV$::			; SAVE ALL REGISTERS
    1428 170776 005746                  	TST	-(SP)
    1429 171000 010546                  	MOV	R5,-(SP)
    1430 171002 010446                  	MOV	R4,-(SP)
    1431 171004 005767  002134'         	TST	SAVJMP
    1432 171010 001003                  	BNE	1$
    1433 171012 010467  002134'         	MOV	R4,SAVJMP
    1434 171016 005016                  	CLR	@SP
    1435                                1$:	PUSH	<R3,R2,R1,R0>
       1                                	.IRP	X,<R3,R2,R1,R0>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 171020 010346                  		MOV	R3,-(SP)
       2 171022 010246                  		MOV	R2,-(SP)
       3 171024 010146                  		MOV	R1,-(SP)
       4 171026 010046                  		MOV	R0,-(SP)
    1436 171030 005046                  	CLR	-(SP)		; UNUSED
    1437 171032 012746  000072          	MOV	#58.,-(SP)	; SHIFT COUNT (WITH 2 GUARD BITS)
    1438 171036 012703  000200          	MOV	#200,R3		; USEFUL CONSTANT
    1439                                ;
    1440                                ; PICK UP SIGN AND EXPONENT OF B (THE DIVISOR)
    1441                                ;
    1442 171042 005002                  	CLR	R2		; USED TO BUILD RESULT SIGN
    1443 171044 010605                  	MOV	SP,R5		; COPY STACK POINTER
    1444 171046 062705  000022          	ADD	#22,R5		; POINT TO MSB OF B
    1445 171052 011504                  	MOV	(R5),R4		; GET SIGN, EXPONENT, MSB
    1446 171054 001532                  	BEQ	ZERDIV		; DIVISION BY ZERO!?!
    1447 171056 006304                  	ASL	R4		; SIGN INTO CARRY, ALIGN EXPONENT
    1448 171060 005502                  	ADC	R2		; SIGN IN LSB OF R2
    1449 171062 105004                  	CLRB	R4		; ZAP MANTISSA BITS
    1450 171064 000304                  	SWAB	R4		; EXPONENT TO LOWER BYTE
    1451 171066 005404                  	NEG	R4		; REXP=(AEXP+200)-(BEXP+200)
    1452 171070 060304                  	ADD	R3,R4		;     +200=(AEXP-BEXP)+200
    1453 171072 005304                  	DEC	R4		; MINUS ONE FOR GUARD BITS
    1454 171074 150315                  	BISB	R3,(R5)		; SET HIDDEN BIT
    1455 171076 105065  000001          	CLRB	1(R5)		; KILL SIGN AND EXPONENT
    1456                                ;
    1457                                ; PICK UP SIGN AND EXPONENT OF A (THE DIVIDEND)
    1458                                ;
    1459 171102 010600                  	MOV	SP,R0		; COPY STACK POINTER
    1460 171104 062700  000032          	ADD	#32,R0		; POINT TO A MANTISSA
    1461 171110 011001                  	MOV	(R0),R1		; GET SIGN, EXPONENT, MSB
    1462 171112 001514                  	BEQ	ZER1		; RESULT IS ZERO
    1463 171114 006301                  	ASL	R1		; ALIGN EXPONENT
    1464 171116 005502                  	ADC	R2		; RESULT SIGN IN LSB
    1465 171120 006002                  	ROR	R2		; RESULT SIGN TO CARRY
    1466 171122 006002                  	ROR	R2		; RESULT SIGN IN SIGN BIT
    1467 171124 010246                  	MOV	R2,-(SP)	; STORE RESULT SIGN
    1468 171126 105001                  	CLRB	R1		; ZAP MANTISSA BITS
    1469 171130 000301                  	SWAB	R1		; EXPONENT TO LOWER BYTE
    1470 171132 060104                  	ADD	R1,R4		; CALCULATE RESULT EXPONENT
    1471 171134 010446                  	MOV	R4,-(SP)	; STORE RESULT EXPONENT
    1472 171136 150310                  	BISB	R3,(R0)		; SET HIDDEN BIT
    1473 171140 105060  000001          	CLRB	1(R0)		; KILL SIGN AND EXPONENT
    1474                                ;
    1475                                ; PICK UP DIVIDEND IN R1-R4 AND AT THE SAME TIME ZERO
    1476                                ; THE SLOT WHERE THE RESULT IS BUILT
    1477                                ;
    1478 171144 011001                  	MOV	(R0),R1		; MSB
    1479 171146 005020                  	CLR	(R0)+
    1480 171150 011002                  	MOV	(R0),R2		; SECOND WORD
    1481 171152 005020                  	CLR	(R0)+
    1482 171154 011003                  	MOV	(R0),R3		; THIRD WORD
    1483 171156 005020                  	CLR	(R0)+
    1484 171160 011004                  	MOV	(R0),R4		; LAST WORD
    1485 171162 005010                  	CLR	(R0)		; R0 POINTS TO LAST WORD OF RESULT
    1486 171164 000415                  	BR	20$
    1487                                ; .PAGE
    1488                                ;
    1489                                ; MAIN DIVISION LOOP.  IF REMAINDER IS POSITIVE THEN DIVISOR IS SUBTRACTED
    1490                                ; BUT IF REMAINDER IS NEGATIVE THEN DIVISOR IS ADDED TO CORRECT FOR THE
    1491                                ; PROBLEM IN THE PREVIOUS LOOP.  AFTER THE ARITHMETIC OPERATION, THE
    1492                                ; REMAINDER IS NORMALIZED IF NECESSARY, AND THE LOOP CONTINUES.
    1493                                ;
    1494                                10$:
    1495 171166 062705  000006          	ADD	#6,R5		; POINT TO LSB OF DIVISOR
    1496 171172 061504                  	ADD	(R5),R4		; MULTIPLE WORD ADD
    1497 171174 005503                  	ADC	R3		; RIPPLE CARRY
    1498 171176 005502                  	ADC	R2
    1499 171200 005501                  	ADC	R1
    1500 171202 064503                  	ADD	-(R5),R3	; THIRD WORD
    1501 171204 005502                  	ADC	R2
    1502 171206 005501                  	ADC	R1
    1503 171210 064502                  	ADD	-(R5),R2	; SECOND WORD
    1504 171212 005501                  	ADC	R1
    1505 171214 064501                  	ADD	-(R5),R1	; FIRST WORD (NO CARRY!)
    1506 171216 000414                  	BR	30$		; SHIFT LEFT AND GET RESULT BIT
    1507                                ;
    1508                                ; SUBTRACT DIVISOR FROM REMAINDER
    1509                                ;
    1510                                20$:
    1511 171220 062705  000006          	ADD	#6,R5		; POINT TO LSB OF DIVISOR
    1512 171224 161504                  	SUB	(R5),R4		; MULTIPLE WORD SUBTRACTION
    1513 171226 005603                  	SBC	R3		; RIPPLE BORROW
    1514 171230 005602                  	SBC	R2
    1515 171232 005601                  	SBC	R1
    1516 171234 164503                  	SUB	-(R5),R3	; THIRD WORD
    1517 171236 005602                  	SBC	R2
    1518 171240 005601                  	SBC	R1
    1519 171242 164502                  	SUB	-(R5),R2	; SECOND WORD
    1520 171244 005601                  	SBC	R1
    1521 171246 164501                  	SUB	-(R5),R1	; FIRST WORD (IGNORE BORROW)
    1522                                ;
    1523                                ; COMPLEMENT SIGN OF REMAINDER SO THAT IT SHIFTS LEFT INTO LSB
    1524                                ; OF RESULT.
    1525                                ;
    1526                                30$:
    1527 171250 062701  100000          	ADD	#100000,R1	; FLIP SIGN BIT
    1528                                ;
    1529                                ; SHIFT 8 WORDS LEFT.  MSB OF REMAINDER BECOMES LSB OF QUOTIENT
    1530                                ;
    1531                                40$:
    1532 171254 006304                  	ASL	R4		; ZERO INTO LSB OF REMAINDER
    1533 171256 006103                  	ROL	R3		; THIRD REMAINDER WORD
    1534 171260 006102                  	ROL	R2		; SECOND REMAINDER WORD
    1535 171262 006101                  	ROL	R1		; SIGN BIT INTO CARRY
    1536 171264 006110                  	ROL	(R0)		; SIGN BIT INTO LSB OF QUOTIENT
    1537 171266 006140                  	ROL	-(R0)		; THIRD QUOTIENT WORD
    1538 171270 006140                  	ROL	-(R0)		; SECOND QUOTIENT WORD
    1539 171272 006140                  	ROL	-(R0)		; FIRST QUOTIENT WORD
    1540 171274 062700  000006          	ADD	#6,R0		; POINT TO LAST QUOTIENT WORD
    1541 171300 005366  000004          	DEC	4(SP)		; COUNT THIS SHIFT
    1542 171304 001410                  	BEQ	60$		; DONE!
    1543                                ; .PAGE
    1544                                ;
    1545                                ; NORMALIZE REMAINDER
    1546                                ;
    1547 171306 005701                  	TST	R1		; REMAINDER POSITIVE?
    1548 171310 100403                  	BMI	50$		; NEGATIVE, SPECIAL NORMALIZE
    1549 171312 105701                  	TSTB	R1		; NORMALIZED?
    1550 171314 100741                  	BMI	20$		; YES!
    1551 171316 000756                  	BR	40$		; SHIFT LEFT TO NORMALIZE
    1552                                50$:
    1553 171320 105701                  	TSTB	R1		; NORMALIZED?
    1554 171322 100321                  	BPL	10$		; YES
    1555 171324 000753                  	BR	40$		; SHIFT LEFT TO NORMALIZE
    1556                                ;
    1557                                ; DONE WITH DIVISION.  PUT RESULT INTO R1-R4
    1558                                ; AND NORMAILZE RESULT.
    1559                                ;
    1560                                60$:
    1561 171326 011004                  	MOV	(R0),R4		; LSB OF RESULT
    1562 171330 014003                  	MOV	-(R0),R3	; THIRD WORD
    1563 171332 014002                  	MOV	-(R0),R2	; SECOND WORD
    1564 171334 014001                  	MOV	-(R0),R1	; MSB
    1565 171336 000167  167754'         	JMP	$FNORM		; NORMALIZE RESULT
    1566                                ZERDIV:
    1567 171342 104413                  	TRAP	11.
    1568                                ZER1:
    1569 171344 000167  170202'         	JMP	$ZERO		; RETURN ZERO AS A RESULT
    1570                                
    1571                                ;
    1572                                ; THIS ROUTINE CALCULATES THE DOUBLE PRECISION SQUARE ROOT OF THE
    1573                                ; ARGUMENT PASSED ON THE STACK.  THE ALGORITHM USED IS SQRT 0150
    1574                                ; FROM HART, "COMPUTER APPROXIMATIONS".
    1575                                ;
    1576                                .GLOBL	$DMUL$,	$DADD$,	$DDIV$,STAND
    1577                                $B91::
    1578 171350 010446                  	MOV	R4,-(SP)
    1579 171352 010046                  	MOV	R0,-(SP)	; SAVE R0
    1580                                ;
    1581                                ; FIRST, GET EXPONENT OF ARGUMENT
    1582                                ;
    1583 171354 016600  000004          	MOV	4(SP),R0	; GET MSB OF ARGUMENT
    1584 171360 100577                  	BMI	SQRERR		; SQUARE ROOT OF A NEGATIVE NUMBER!
    1585                                SQRTR:
    1586 171362 001555                  	BEQ	30$		; SQR(0) IS ZERO!
    1587 171364 010467  002134'         	MOV	R4,SAVJMP
    1588 171370 006300                  	ASL	R0		; ALIGN EXPONENT
    1589 171372 105000                  	CLRB	R0		; CLEAR MSB OF MANTISSA
    1590 171374 000300                  	SWAB	R0		; EXPONENT TO LOW BYTE
    1591 171376 162700  000200          	SUB	#200,R0		; CONVERT FROM EXCESS 200 TO BINARY
    1592 171402 010046                  	MOV	R0,-(SP)	; SAVE BINARY EXPONENT
    1593                                ;
    1594                                ; REDUCE RANGE OF ARGUMENT (N) SO THAT 0.5 < N <= 1.0
    1595                                ;
    1596                                	FPUSH	6(SP)		; COPY ARGUMENT
       1                                	.NTYPE	ATV,6(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	6(SP),-(SP)
       4                                		MOV	6(SP),-(SP)
       5                                		MOV	6(SP),-(SP)
       6                                		MOV	6(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+6(SP),-(SP)
      11                                	.ENDR
       1 171404 016646  000014          	MOV	6+6(SP),-(SP)
       1 171410 016646  000014          	MOV	6+6(SP),-(SP)
       1 171414 016646  000014          	MOV	6+6(SP),-(SP)
       1 171420 016646  000014          	MOV	6+6(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+6(SP),-(SP)
      14                                		MOV	4+6(SP),-(SP)
      15                                		MOV	2+6(SP),-(SP)
      16                                		MOV	6(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1597 171424 042716  177600          	BIC	#^C177,(SP)	; CLEAR EXPONENT (AND SIGN)
    1598 171430 052716  037700          	BIS	#^F0.5,(SP)	; REDUCE RANGE
    1599                                ;
    1600                                ; GENERATE INITIAL APPROXIMATION TO SQUARE ROOT (GOOD TO 2 PLACES)
    1601                                ;
    1602                                	FPUSH	SQRT0		; ADDITIVE CONSTANT
       1                                	.NTYPE	ATV,SQRT0
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	SQRT0,-(SP)
       4                                		MOV	SQRT0,-(SP)
       5                                		MOV	SQRT0,-(SP)
       6                                		MOV	SQRT0,-(SP)
       7                                	.IFF
       8 000001                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+SQRT0,-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 171434 016746  171736'         		MOV	6+SQRT0,-(SP)
      14 171440 016746  171734'         		MOV	4+SQRT0,-(SP)
      15 171444 016746  171732'         		MOV	2+SQRT0,-(SP)
      16 171450 016746  171730'         		MOV	SQRT0,-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1603                                	FPUSH	10(SP)		; N
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 171454 016646  000016          	MOV	6+10(SP),-(SP)
       1 171460 016646  000016          	MOV	6+10(SP),-(SP)
       1 171464 016646  000016          	MOV	6+10(SP),-(SP)
       1 171470 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1604                                	FPUSH	SQRT1		; MULTIPLIER
       1                                	.NTYPE	ATV,SQRT1
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	SQRT1,-(SP)
       4                                		MOV	SQRT1,-(SP)
       5                                		MOV	SQRT1,-(SP)
       6                                		MOV	SQRT1,-(SP)
       7                                	.IFF
       8 000001                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+SQRT1,-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 171474 016746  171746'         		MOV	6+SQRT1,-(SP)
      14 171500 016746  171744'         		MOV	4+SQRT1,-(SP)
      15 171504 016746  171742'         		MOV	2+SQRT1,-(SP)
      16 171510 016746  171740'         		MOV	SQRT1,-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1605 171514 004467  166552'         	JSR	R4,STAND
    1606 171520 170210                  	.WORD	$DMUL$		; X=N*0.59016206
    1607 171522 167144                  	.WORD	$DADD$		; X=N*0.59016206+0.41730759
    1608 171524 171526                  	.WORD	5$
    1609                                ;
    1610                                ; NOW DO THREE NEWTON ITERATIONS WHICH GIVE 18.125 PLACES OF
    1611                                ; ACCURACY.
    1612                                ;
    1613 171526 012700  000003          5$:	MOV	#3,R0		; LOOP COUNT
    1614                                10$:
    1615                                	FPUSH	10(SP)		; PUSH N
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 171532 016646  000016          	MOV	6+10(SP),-(SP)
       1 171536 016646  000016          	MOV	6+10(SP),-(SP)
       1 171542 016646  000016          	MOV	6+10(SP),-(SP)
       1 171546 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1616                                	FPUSH	10(SP)		; PUSH X
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 171552 016646  000016          	MOV	6+10(SP),-(SP)
       1 171556 016646  000016          	MOV	6+10(SP),-(SP)
       1 171562 016646  000016          	MOV	6+10(SP),-(SP)
       1 171566 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1617 171572 004467  166552'         	JSR	R4,STAND
    1618 171576 170776                  	.WORD	$DDIV$		; N/X
    1619 171600 167144                  	.WORD	$DADD$		; N/X+X
    1620 171602 171604                  	.WORD	15$
    1621 171604 162716  000200          15$:	SUB	#200,(SP)	; X=(N/X+X)/2
    1622 171610 005300                  	DEC	R0		; COUNT THIS LOOP
    1623 171612 003347                  	BGT	10$		; MORE TO DO
    1624                                ;
    1625                                ; CALCULATE FINAL ROOT FROM RANGE REDUCED ROOT
    1626                                ;
    1627 171614 016600  000020          	MOV	20(SP),R0	; GET ORIGINAL EXPONENT
    1628 171620 006200                  	ASR	R0		; DIVIDE BY 2
    1629 171622 103014                  	BCC	20$		; IS WAS EVEN POWER OF TWO
    1630                                	FPUSH	SQRT2		; SQR(2)
       1                                	.NTYPE	ATV,SQRT2
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	SQRT2,-(SP)
       4                                		MOV	SQRT2,-(SP)
       5                                		MOV	SQRT2,-(SP)
       6                                		MOV	SQRT2,-(SP)
       7                                	.IFF
       8 000001                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+SQRT2,-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 171624 016746  171756'         		MOV	6+SQRT2,-(SP)
      14 171630 016746  171754'         		MOV	4+SQRT2,-(SP)
      15 171634 016746  171752'         		MOV	2+SQRT2,-(SP)
      16 171640 016746  171750'         		MOV	SQRT2,-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1631 171644 004467  166552'         	JSR	R4,STAND
    1632 171650 170210                  	.WORD	$DMUL$		; X=X*SQR(2)
    1633 171652 171654                  	.WORD	20$
    1634                                20$:
    1635 171654 000300                  	SWAB	R0		; MOVE EXPONENT TO UPPER BYTE
    1636 171656 105000                  	CLRB	R0		; KILL JUNK IN LOW BYTE
    1637 171660 006000                  	ROR	R0		; SHIFT EXPONENT TO FIT
    1638 171662 060016                  	ADD	R0,(SP)		; MULTIPLY BY POWER OF TWO
    1639 171664 100002                  	BPL	25$		; RESULT IS POSITIVE
    1640 171666 062716  100000          	ADD	#100000,(SP)	; CORRECT BORROW FROM EXPONENT
    1641                                25$:
    1642                                	FPOP	24(SP)		; PUT INTO RESULT SLOT
       1                                	.REPT	4
       2                                		MOV	(SP)+,24(SP)
       3                                	.ENDR
       1 171672 012666  000024          		MOV	(SP)+,24(SP)
       1 171676 012666  000024          		MOV	(SP)+,24(SP)
       1 171702 012666  000024          		MOV	(SP)+,24(SP)
       1 171706 012666  000024          		MOV	(SP)+,24(SP)
    1643 171712 062706  000012          	ADD	#12,SP		; KILL JUNK ON STACK
    1644                                30$:
    1645 171716 012600                  	MOV	(SP)+,R0	; RESTORE R0
    1646 171720 012604                  	MOV	(SP)+,R4
    1647 171722 005067  002134'         	CLR	SAVJMP
    1648 171726 000134                  	JMP	@(R4)+
    1649                                
    1650                                ;
    1651                                ; CONSTANTS USED BY SQUARE ROOT ROUTINE
    1652                                ;
    1653                                SQRT0:
    1654 171730 037725  124527  023330  	.FLT4	0.41730759
         171736 055770                  
    1655                                SQRT1:
    1656 171740 040027  012334  055412  	.FLT4	0.59016206
         171746 036310                  
    1657                                SQRT2:
    1658 171750 040265  002363  031771  	.FLT4	1.41421356237309504880 ; SQR(2)
         171756 157150                  
    1659                                SQRERR:
    1660 171760 104405                  	TRAP	5
    1661                                ;
    1662                                .SBTTL	SUPPORT ENTRY $B99,	'EXP(REAL)' (DOUBLE PRECISION)
    1663                                ;
    1664                                ; CALCULATES DOUBLE PRECISION POWER OF E.  THE RATIONAL APPROXIMATION
    1665                                ; REQUIRES A RANGE REDUCTION TO 0<=X<1/64.  THE RESULT IS GOOD TO ABOUT
    1666                                ; 18 PLACES.
    1667                                ;
    1668                                ; THE STATE OF THE STACK AT ABOUT 20$ IS:
    1669                                ;
    1670                                ; SP==>	X1
    1671                                ;	X2
    1672                                ;	X3	(RANGE REDUCED ARG)
    1673                                ;	X4
    1674                                ;	SCALE COUNT
    1675                                ;	POWER OF 2
    1676                                ;	SIGN FLAG
    1677                                ;	R5
    1678                                ;	R4
    1679                                ;	R3
    1680                                ;	R2
    1681                                ;	R1	(SAVED AT CALL)
    1682                                ;	R0
    1683                                ;	RETURN
    1684                                ;	N1
    1685                                ;	N2
    1686                                ;	N3	(ARGUMENT)
    1687                                ;	N4
    1688                                ;
    1689                                .GLOBL	$DADD$,	$DMUL$,	$DDIV$,	$DSUB$,	$FRACT,STAND
    1690                                $B99::				; DOUBLE PRECISION EXPONENTIAL
    1691 171762 005716                  	TST	@SP
    1692 171764 100413                  	BMI	1$
    1693 171766 021627  041660          	CMP	@SP,#41660
    1694 171772 103423                  	BLO	2$
    1695 171774 101004                  	BHI	3$
    1696 171776 026627  000002  007463  	CMP	2(SP),#7463
    1697 172004 103416                  	BLO	2$
    1698 172006 005067  002134'         3$:	CLR	SAVJMP
    1699 172012 104406                  	TRAP	6
    1700 172014 021627  141660          1$:	CMP	@SP,#141660
    1701 172020 101410                  	BLOS	2$
    1702 172022 005016                  	CLR	@SP
    1703 172024 005066  000002          	CLR	2(SP)
    1704 172030 005066  000004          	CLR	4(SP)
    1705 172034 005066  000006          	CLR	6(SP)
    1706 172040 000134                  	JMP	@(4)+
    1707 172042 005746                  2$:	TST	-(SP)		; PRESERVE REGISTERS
    1708 172044 010546                  	MOV	R5,-(SP)
    1709 172046 010446                  	MOV	R4,-(SP)
    1710 172050 005767  002134'         	TST	SAVJMP
    1711 172054 001003                  	BNE	7$
    1712 172056 010467  002134'         	MOV	R4,SAVJMP
    1713 172062 005016                  	CLR	@SP
    1714                                7$:	PUSH	<R3,R2,R1,R0>
       1                                	.IRP	X,<R3,R2,R1,R0>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 172064 010346                  		MOV	R3,-(SP)
       2 172066 010246                  		MOV	R2,-(SP)
       3 172070 010146                  		MOV	R1,-(SP)
       4 172072 010046                  		MOV	R0,-(SP)
    1715 172074 005046                  	CLR	-(SP)		; SIGN FLAG
    1716 172076 005046                  	CLR	-(SP)		; POWER OF 2 REDUCTION
    1717 172100 005046                  	CLR	-(SP)		; SCALE COUNTER
    1718                                ;
    1719                                ; APPROXIMATION IS EXP(X)=2^(X/LN(2))
    1720                                ;
    1721                                	FPUSH	24(SP)		; PUSH ARG
       1                                	.NTYPE	ATV,24(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	24(SP),-(SP)
       4                                		MOV	24(SP),-(SP)
       5                                		MOV	24(SP),-(SP)
       6                                		MOV	24(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+24(SP),-(SP)
      11                                	.ENDR
       1 172102 016646  000032          	MOV	6+24(SP),-(SP)
       1 172106 016646  000032          	MOV	6+24(SP),-(SP)
       1 172112 016646  000032          	MOV	6+24(SP),-(SP)
       1 172116 016646  000032          	MOV	6+24(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+24(SP),-(SP)
      14                                		MOV	4+24(SP),-(SP)
      15                                		MOV	2+24(SP),-(SP)
      16                                		MOV	24(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1722                                	FPUSH	LN2IN		; LN(2)
       1                                	.NTYPE	ATV,LN2IN
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	LN2IN,-(SP)
       4                                		MOV	LN2IN,-(SP)
       5                                		MOV	LN2IN,-(SP)
       6                                		MOV	LN2IN,-(SP)
       7                                	.IFF
       8 000001                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+LN2IN,-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 172122 016746  173016'         		MOV	6+LN2IN,-(SP)
      14 172126 016746  173014'         		MOV	4+LN2IN,-(SP)
      15 172132 016746  173012'         		MOV	2+LN2IN,-(SP)
      16 172136 016746  173010'         		MOV	LN2IN,-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1723 172142 004467  166552'         	JSR	R4,STAND	; X=X*1/LN(2)
    1724 172146 170210                  	.WORD	$DMUL$
    1725 172150 172152                  	.WORD	$EXP1
    1726                                ;
    1727                                ; DO RANGE REDUCTION TO GET 0<=X<1/64
    1728                                ;
    1729                                $EXP1:
    1730 172152 011601                  	MOV	(SP),R1	;	 GET SIGN/EXPONENT/MSB OF MANTISSA
    1731 172154 010166  000014          	MOV	R1,14(SP)	; SET SIGN FLAG
    1732 172160 042701  100000          	BIC	#100000,R1	;TAKE ABSOLUTE VALUE
    1733 172164 022701  036777          	CMP	#36777,R1	; (1/64)*.99999....
    1734 172170 002024                  	BGE	20$		; ARG IS IN RANGE!
    1735 172172 022701  040177          	CMP	#40177,R1	; IS X<=1.0
    1736 172176 002011                  	BGE	10$		; YES, DO FAST RANGE REDUCTION
    1737 172200 004467  166552'         	JSR	R4,STAND	; GET FRACTION PART, INTEGER PART TO R5
    1738 172204 175740                  	.WORD	$FRACT
    1739 172206 172210                  	.WORD	5$
    1740 172210 010566  000012          5$:	MOV	R5,12(SP)	; SAVE INTEGER PART
    1741 172214 042716  100000          	BIC	#100000,(SP)	; GET ABSOLUTE VALUE
    1742 172220 011601                  	MOV	(SP),R1		; GET MSB OF FRACTION PART
    1743                                10$:
    1744 172222 022701  036777          	CMP	#36777,R1	; (1/64)*.99999.....
    1745 172226 002005                  	BGE	20$		; X IS IN RANGE NOW
    1746 172230 162701  000200          	SUB	#200,R1		; DIVIDE X BY 2
    1747 172234 005266  000010          	INC	10(SP)		; COUNT DIVISION
    1748 172240 000770                  	BR	10$		; KEEP REDUCING
    1749                                20$:
    1750 172242 010116                  	MOV	R1,(SP)		; SAVE MSB OF REDUCED ARG
    1751 172244 010601                  	MOV	SP,R1		; COPY STACK POINTER
    1752 172246 062701  000010          	ADD	#10,R1		; POINT PAST X
    1753                                ;
    1754                                ; Y=X*X
    1755                                ;
    1756                                	FPUSH	-(R1)		; X
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 172252 014146                  		MOV	-(R1),-(SP)
       4 172254 014146                  		MOV	-(R1),-(SP)
       5 172256 014146                  		MOV	-(R1),-(SP)
       6 172260 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1757                                	FPUSH	-(R1)		; X
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 172262 014146                  		MOV	-(R1),-(SP)
       4 172264 014146                  		MOV	-(R1),-(SP)
       5 172266 014146                  		MOV	-(R1),-(SP)
       6 172270 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1758 172272 004467  166552'         	JSR	R4,STAND
    1759 172276 170210                  	.WORD	$DMUL$
    1760 172300 172336                  	.WORD	21$
    1761 172302 170210                  	.WORD	$DMUL$
    1762 172304 172374                  	.WORD	22$
    1763 172306 167144                  	.WORD	$DADD$
    1764 172310 172406                  	.WORD	23$
    1765 172312 170210                  	.WORD	$DMUL$
    1766 172314 172430                  	.WORD	24$
    1767 172316 167144                  	.WORD	$DADD$
    1768 172320 172462                  	.WORD	25$
    1769 172322 167144                  	.WORD	$DADD$
    1770 172324 172524                  	.WORD	26$
    1771 172326 167124                  	.WORD	$DSUB$
    1772 172330 172566                  	.WORD	27$
    1773 172332 170776                  	.WORD	$DDIV$
    1774 172334 172616                  	.WORD	28$
    1775                                ;
    1776                                ; P=X*(P1*Y+P0)
    1777                                ;
    1778 172336 012701  173050          21$:	MOV	#EXPTAB,R1	; POINT TO COEFFICIENT TABLE
    1779                                	FPUSH	0(SP)		; Y
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 172342 016646  000006          	MOV	6+0(SP),-(SP)
       1 172346 016646  000006          	MOV	6+0(SP),-(SP)
       1 172352 016646  000006          	MOV	6+0(SP),-(SP)
       1 172356 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1780                                	FPUSH	-(R1)		; P1
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 172362 014146                  		MOV	-(R1),-(SP)
       4 172364 014146                  		MOV	-(R1),-(SP)
       5 172366 014146                  		MOV	-(R1),-(SP)
       6 172370 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1781 172372 000134                  	JMP	@(R4)+
    1782                                22$:	FPUSH	-(R1)		; P0
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 172374 014146                  		MOV	-(R1),-(SP)
       4 172376 014146                  		MOV	-(R1),-(SP)
       5 172400 014146                  		MOV	-(R1),-(SP)
       6 172402 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1783 172404 000134                  	JMP	@(R4)+
    1784                                23$:	FPUSH	20(SP)		; X
       1                                	.NTYPE	ATV,20(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	20(SP),-(SP)
       4                                		MOV	20(SP),-(SP)
       5                                		MOV	20(SP),-(SP)
       6                                		MOV	20(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+20(SP),-(SP)
      11                                	.ENDR
       1 172406 016646  000026          	MOV	6+20(SP),-(SP)
       1 172412 016646  000026          	MOV	6+20(SP),-(SP)
       1 172416 016646  000026          	MOV	6+20(SP),-(SP)
       1 172422 016646  000026          	MOV	6+20(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+20(SP),-(SP)
      14                                		MOV	4+20(SP),-(SP)
      15                                		MOV	2+20(SP),-(SP)
      16                                		MOV	20(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1785 172426 000134                  	JMP	@(R4)+
    1786                                ;
    1787                                ; Q=Y+Q0
    1788                                ;
    1789                                24$:	FPUSH	10(SP)		; Y
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 172430 016646  000016          	MOV	6+10(SP),-(SP)
       1 172434 016646  000016          	MOV	6+10(SP),-(SP)
       1 172440 016646  000016          	MOV	6+10(SP),-(SP)
       1 172444 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1790                                	FPUSH	-(R1)		; Q0
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 172450 014146                  		MOV	-(R1),-(SP)
       4 172452 014146                  		MOV	-(R1),-(SP)
       5 172454 014146                  		MOV	-(R1),-(SP)
       6 172456 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1791 172460 000134                  	JMP	@(R4)+
    1792                                25$:	FPUSH	0(SP)		; Q
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 172462 016646  000006          	MOV	6+0(SP),-(SP)
       1 172466 016646  000006          	MOV	6+0(SP),-(SP)
       1 172472 016646  000006          	MOV	6+0(SP),-(SP)
       1 172476 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1793                                	FPUSH	20(SP)		; P
       1                                	.NTYPE	ATV,20(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	20(SP),-(SP)
       4                                		MOV	20(SP),-(SP)
       5                                		MOV	20(SP),-(SP)
       6                                		MOV	20(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+20(SP),-(SP)
      11                                	.ENDR
       1 172502 016646  000026          	MOV	6+20(SP),-(SP)
       1 172506 016646  000026          	MOV	6+20(SP),-(SP)
       1 172512 016646  000026          	MOV	6+20(SP),-(SP)
       1 172516 016646  000026          	MOV	6+20(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+20(SP),-(SP)
      14                                		MOV	4+20(SP),-(SP)
      15                                		MOV	2+20(SP),-(SP)
      16                                		MOV	20(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1794 172522 000134                  	JMP	@(R4)+
    1795                                26$:	FPUSH	10(SP)		; Q
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 172524 016646  000016          	MOV	6+10(SP),-(SP)
       1 172530 016646  000016          	MOV	6+10(SP),-(SP)
       1 172534 016646  000016          	MOV	6+10(SP),-(SP)
       1 172540 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1796                                	FPUSH	30(SP)		; P
       1                                	.NTYPE	ATV,30(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	30(SP),-(SP)
       4                                		MOV	30(SP),-(SP)
       5                                		MOV	30(SP),-(SP)
       6                                		MOV	30(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+30(SP),-(SP)
      11                                	.ENDR
       1 172544 016646  000036          	MOV	6+30(SP),-(SP)
       1 172550 016646  000036          	MOV	6+30(SP),-(SP)
       1 172554 016646  000036          	MOV	6+30(SP),-(SP)
       1 172560 016646  000036          	MOV	6+30(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+30(SP),-(SP)
      14                                		MOV	4+30(SP),-(SP)
      15                                		MOV	2+30(SP),-(SP)
      16                                		MOV	30(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1797 172564 000134                  	JMP	@(R4)+
    1798                                ;
    1799                                ; IF ARG < 0 THEN EXP=(Q-P)/(Q+P)
    1800                                ;
    1801 172566 005766  000064          27$:	TST	64(SP)		; SIGN FLAG
    1802 172572 100022                  	BPL	30$		; ARG WAS POSITIVE
    1803                                	FPUSH	10(SP)		; Q+P
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 172574 016646  000016          	MOV	6+10(SP),-(SP)
       1 172600 016646  000016          	MOV	6+10(SP),-(SP)
       1 172604 016646  000016          	MOV	6+10(SP),-(SP)
       1 172610 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1804 172614 000134                  	JMP	@(R4)+
    1805                                28$:	FPOP	6(SP)		; ADJUST STACK
       1                                	.REPT	4
       2                                		MOV	(SP)+,6(SP)
       3                                	.ENDR
       1 172616 012666  000006          		MOV	(SP)+,6(SP)
       1 172622 012666  000006          		MOV	(SP)+,6(SP)
       1 172626 012666  000006          		MOV	(SP)+,6(SP)
       1 172632 012666  000006          		MOV	(SP)+,6(SP)
    1806 172636 000404                  	BR	40$
    1807                                ;
    1808                                ; IF ARG>0 THEN EXP=(Q+P)/(Q-P)
    1809                                ;
    1810                                30$:
    1811 172640 004467  166552'         	JSR	R4,STAND	; (Q+P)/(Q-P)
    1812 172644 170776                  	.WORD	$DDIV$
    1813 172646 172650                  	.WORD	40$
    1814                                40$:
    1815 172650 016600  000050          	MOV	50(SP),R0	; GET SCALE FACTOR
    1816 172654 001416                  	BEQ	60$		; NO SCALING NEEDED
    1817                                ;
    1818                                ; BECAUSE OF RANGE REDUCTION, EXP=EXP^(SCALE FACTOR)
    1819                                ;
    1820                                50$:
    1821                                	FPUSH	0(SP)
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 172656 016646  000006          	MOV	6+0(SP),-(SP)
       1 172662 016646  000006          	MOV	6+0(SP),-(SP)
       1 172666 016646  000006          	MOV	6+0(SP),-(SP)
       1 172672 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1822 172676 004467  166552'         	JSR	R4,STAND	; SQUARE RESULT
    1823 172702 170210                  	.WORD	$DMUL$
    1824 172704 172706                  	.WORD	51$
    1825 172706 005300                  51$:	DEC	R0		; COUNT IT
    1826 172710 003362                  	BGT	50$		; MORE TO DO
    1827                                ;
    1828                                ; NOW MULTIPLY BY POWER OF 2
    1829                                ;
    1830                                60$:
    1831 172712 016600  000052          	MOV	52(SP),R0	; GET POWER
    1832 172716 000300                  	SWAB	R0		; MOVE TO UPPER BYTE
    1833 172720 105700                  	TSTB	R0		; TOO BIG?
    1834 172722 001401                  	BEQ	70$		; NOPE
    1835 172724 105000                  	CLRB	R0		; CLEAR -1 IN LOW BYTE
    1836                                70$:
    1837 172726 006200                  	ASR	R0		; SHIFT TO EXPONENT SLOT
    1838 172730 060016                  	ADD	R0,(SP)		; MULTIPLY BY 2^POWER
    1839                                	FPOP	72(SP)		; PUT RESULT IN RESULT SLOT
       1                                	.REPT	4
       2                                		MOV	(SP)+,72(SP)
       3                                	.ENDR
       1 172732 012666  000072          		MOV	(SP)+,72(SP)
       1 172736 012666  000072          		MOV	(SP)+,72(SP)
       1 172742 012666  000072          		MOV	(SP)+,72(SP)
       1 172746 012666  000072          		MOV	(SP)+,72(SP)
    1840 172752 062706  000046          	ADD	#46,SP		; KILL JUNK ON STACK
    1841                                				; POP REGS
    1842                                	POP	<R0,R1,R2,R3>
       1                                	.IRP	X,<R0,R1,R2,R3>
       2                                		MOV	(SP)+,X
       3                                	.ENDM
       1 172756 012600                  		MOV	(SP)+,R0
       2 172760 012601                  		MOV	(SP)+,R1
       3 172762 012602                  		MOV	(SP)+,R2
       4 172764 012603                  		MOV	(SP)+,R3
    1843 172766 012604                  	MOV	(SP)+,R4
    1844 172770 001004                  	BNE	9$
    1845 172772 016704  002134'         	MOV	SAVJMP,R4
    1846 172776 005067  002134'         	CLR	SAVJMP
    1847 173002 012605                  9$:	MOV	(SP)+,R5
    1848 173004 005726                  	TST	(SP)+		; 
    1849 173006 000134                  	JMP	@(R4)+
    1850                                ;
    1851                                ; CONSTANTS USED IN APPROXIMATION
    1852                                ;
    1853                                LN2IN:
    1854 173010 040270  125073  024534  	.FLT4	1.44269504088896	; 1/LN(2)
         173016 013570                  
    1855                                OQ0:
    1856 173020 041246  101162  074105  	.FLT4	.208136948963436784218221E2
         173026 137350                  
    1857                                OP0:
    1858 173030 040746  152315  123024  	.FLT4	.72134769672177719062488E1
         173036 144570                  
    1859                                OP1:
    1860 173040 037154  114015  001423  	.FLT4	.577621944696111185E-1
         173046 021300                  
    1861                                EXPTAB:					; EXP COEFFICIENTS
    1862                                ;
    1863                                .SBTTL	SUPPORT ENTRY $B103,	'LN(REAL)' (DOUBLE PRECISION)
    1864                                ;
    1865                                ; THIS ROUTINE CALCULATES THE DOUBLE PRECISION NATURAL LOG OF THE
    1866                                ; ARGUMENT PASSED ON THE STACK. AFTER A RANGE REDUCTION TO
    1867                                ; 1/SQR(2) <= X <= SQR(2), ALGORITHM LOGE 2705 FROM HART, "COMPUTER
    1868                                ; APPROXIMATIONS" IS USED TO CALCULATE LN(X) TO 18 PLACES.
    1869                                ;
    1870                                ; AT ABOUT 10$: THE STATE OF THE STACK IS:
    1871                                ;
    1872                                ; SP==>	POWER OF 2 OF ARG
    1873                                ;	R2
    1874                                ;	R1
    1875                                ;	R0
    1876                                ;	RETURN ADDRESS
    1877                                ;	N1
    1878                                ;	N2
    1879                                ;	N3	(ARGUMENT)
    1880                                ;	N4
    1881                                ;
    1882                                .GLOBL	$DMUL$,	$DDIV$,	$DADD$,	$DSUB$,	$APPRX,STAND
    1883                                BADLOG:
    1884 173050 104405                  	TRAP	5
    1885                                $B103::				; NATURAL LOG
    1886 173052 010446                  	MOV	R4,-(SP)
    1887 173054 005767  002134'         	TST	SAVJMP
    1888 173060 001003                  	BNE	1$
    1889 173062 010467  002134'         	MOV	R4,SAVJMP
    1890 173066 005016                  	CLR	@SP
    1891                                1$:	PUSH	<R0,R1,R2>	; SAVE SOME REGS
       1                                	.IRP	X,<R0,R1,R2>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 173070 010046                  		MOV	R0,-(SP)
       2 173072 010146                  		MOV	R1,-(SP)
       3 173074 010246                  		MOV	R2,-(SP)
    1892                                ;
    1893                                ; PUT EXPONENT OF ARG ON STACK AND REDUCE RANGE TO 0.5 <= X < 1
    1894                                ;
    1895 173076 016601  000010          	MOV	10(SP),R1	; GET SIGN/EXPONENT/MSB OF MANTISSA
    1896 173102 001762                  	BEQ	BADLOG		; LOG OF ZERO!!!!!
    1897 173104 006301                  	ASL	R1		; BYTE ALIGN EXPONENT
    1898 173106 103760                  	BCS	BADLOG		; OOPS!  LOG OF NEGATIVE NUMBER
    1899 173110 000301                  	SWAB	R1		; EXPONENT TO LOW BYTE
    1900 173112 005000                  	CLR	R0		; TARGET OF EXPONENT
    1901 173114 150100                  	BISB	R1,R0		; MOVE EXPONENT TO R0
    1902 173116 105001                  	CLRB	R1		; ZAP EXPONENT
    1903 173120 152701  000200          	BISB	#200,R1		; SET EXPONENT TO ZERO (EXCESS 200)
    1904 173124 000301                  	SWAB	R1		; EXPONENT TO UPPER BYTE
    1905 173126 000241                  	CLC			; ZERO TO SIGN
    1906 173130 006001                  	ROR	R1		; MAKE INTO FLOATING POINT FORMAT
    1907 173132 162700  000200          	SUB	#200,R0		; CONVERT EXPONENT FROM EXCESS 200
    1908 173136 010046                  	MOV	R0,-(SP)	; SAVE BINARY EXPONENT
    1909                                ;
    1910                                ; REDUCE RANGE TO 1/SQR(2) <= X <= SQR(2)
    1911                                ;
    1912 173140 022701  040065          	CMP	#40065,R1	; 1/SQR(2)  (APPROX)
    1913 173144 002403                  	BLT	10$		; ARG IS IN RANGE
    1914 173146 062701  000200          	ADD	#200,R1		; MULTIPLY ARG BY 2
    1915 173152 005316                  	DEC	(SP)		; ADJUST BINARY EXPONENT
    1916                                ;
    1917                                ; BUILD PARAMETERS USED IN RATIONAL APPROXIMATION
    1918                                ;
    1919                                10$:
    1920 173154 010600                  	MOV	SP,R0		; POINT PAST WHERE X WILL BE PUSHED
    1921                                	FPUSH	12(SP)		; PUSH ARG
       1                                	.NTYPE	ATV,12(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	12(SP),-(SP)
       4                                		MOV	12(SP),-(SP)
       5                                		MOV	12(SP),-(SP)
       6                                		MOV	12(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+12(SP),-(SP)
      11                                	.ENDR
       1 173156 016646  000020          	MOV	6+12(SP),-(SP)
       1 173162 016646  000020          	MOV	6+12(SP),-(SP)
       1 173166 016646  000020          	MOV	6+12(SP),-(SP)
       1 173172 016646  000020          	MOV	6+12(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+12(SP),-(SP)
      14                                		MOV	4+12(SP),-(SP)
      15                                		MOV	2+12(SP),-(SP)
      16                                		MOV	12(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1922 173176 010116                  	MOV	R1,(SP)		; CALCULATE X (REDUCED RANGE)
    1923                                	FPUSH	-(R0)		; PUSH X, POINT PAST WHERE Z GOES
       1                                	.NTYPE	ATV,-(R0)
       2 000000                         	.IF	EQ,ATV&60-40
       3 173200 014046                  		MOV	-(R0),-(SP)
       4 173202 014046                  		MOV	-(R0),-(SP)
       5 173204 014046                  		MOV	-(R0),-(SP)
       6 173206 014046                  		MOV	-(R0),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R0),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R0),-(SP)
      14                                		MOV	4+-(R0),-(SP)
      15                                		MOV	2+-(R0),-(SP)
      16                                		MOV	-(R0),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1924 173210 005046                  	CLR	-(SP)		; PUSH 1.0
    1925 173212 005046                  	CLR	-(SP)
    1926 173214 005046                  	CLR	-(SP)
    1927 173216 012746  040100          	MOV	#^F1.0,-(SP)	; 1.0
    1928 173222 004467  166552'         	JSR	R4,STAND	; X-1
    1929 173226 167124                  	.WORD	$DSUB$
    1930 173230 173244                  	.WORD	12$
    1931 173232 167144                  	.WORD	$DADD$
    1932 173234 170776                  	.WORD	$DDIV$
    1933 173236 173300                  	.WORD	14$
    1934 173240 176460                  	.WORD	$APPRX
    1935 173242 173306                  	.WORD	16$
    1936                                12$:	FPUSH	10(SP)		; X
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 173244 016646  000016          	MOV	6+10(SP),-(SP)
       1 173250 016646  000016          	MOV	6+10(SP),-(SP)
       1 173254 016646  000016          	MOV	6+10(SP),-(SP)
       1 173260 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1937 173264 005046                  	CLR	-(SP)		; 1.0
    1938 173266 005046                  	CLR	-(SP)
    1939 173270 005046                  	CLR	-(SP)
    1940 173272 012746  040100          	MOV	#^F1.0,-(SP)	; 1.0
    1941 173276 000134                  	JMP	@(R4)+
    1942                                ;
    1943                                ; CALCUALTE Z*P(Z^2)/Q(Z^2)
    1944                                ;
    1945 173300 012700  173564          14$:	MOV	#LOGTAB,R0	; POINT TO COEFFICIENTS
    1946 173304 000134                  	JMP	@(R4)+
    1947                                ;
    1948                                ; IF RANGE REDUCTION THEN MULTIPLY RESULT BY N*LN(2) WHERE
    1949                                ; ARGUMENT=2^N*X
    1950                                ;
    1951 173306 016600  000020          16$:	MOV	20(SP),R0	; GET POWER OF 2 OF ARG
    1952 173312 001440                  	BEQ	50$		; NO RANGE REDUCTION HAPPENED
    1953 173314 010046                  	MOV	R0,-(SP)		; RECORD SIGN
    1954 173316 100001                  	BPL	20$		; POWER IS POSITIVE
    1955 173320 005400                  	NEG	R0		; GET ABSOLUTE VALUE
    1956                                ;
    1957                                ; CONVERT POWER OF 2 TO FLOATING POINT NUMBER
    1958                                ;
    1959                                20$:
    1960 173322 012701  000010          	MOV	#8.,R1		; ASSUMED EXPONENT
    1961                                30$:
    1962 173326 106300                  	ASLB	R0		; NORMALIZED?
    1963 173330 103402                  	BCS	40$		; YES
    1964 173332 005301                  	DEC	R1		; NOPE, ADJUST EXPONENT
    1965 173334 000774                  	BR	30$		; AND CONTINUE NORMALIZATION
    1966                                ; .PAGE
    1967                                ;
    1968                                ; MULTIPLY POWER OF 2 BY LN(2)
    1969                                ;
    1970                                40$:
    1971 173336 062701  000200          	ADD	#200,R1		; CONVERT TO EXCESS 200 NOTATION
    1972 173342 000301                  	SWAB	R1		; EXPONENT TO UPPER BYTE
    1973 173344 050100                  	BIS	R1,R0		; SET EXPONENT
    1974 173346 006326                  	ASL	(SP)+		; PICK UP SIGN IN CARRY
    1975 173350 006000                  	ROR	R0		; CONVERT TO FLOATING POINT FORMAT
    1976 173352 005046                  	CLR	-(SP)		; PUSH NUMBER ON STACK
    1977 173354 005046                  	CLR	-(SP)
    1978 173356 005046                  	CLR	-(SP)
    1979 173360 010046                  	MOV	R0,-(SP)	; POWER OF 2
    1980                                	FPUSH	LN2		; LN(2)
       1                                	.NTYPE	ATV,LN2
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	LN2,-(SP)
       4                                		MOV	LN2,-(SP)
       5                                		MOV	LN2,-(SP)
       6                                		MOV	LN2,-(SP)
       7                                	.IFF
       8 000001                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+LN2,-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 173362 016746  173472'         		MOV	6+LN2,-(SP)
      14 173366 016746  173470'         		MOV	4+LN2,-(SP)
      15 173372 016746  173466'         		MOV	2+LN2,-(SP)
      16 173376 016746  173464'         		MOV	LN2,-(SP)
      17                                	.ENDC
      18                                	.ENDC
    1981 173402 004467  166552'         	JSR	R4,STAND
    1982 173406 170210                  	.WORD	$DMUL$		; N*LN(2)
    1983 173410 167144                  	.WORD	$DADD$		; ADJUST FOR INITIAL RANGE REDUCTION
    1984 173412 173414                  	.WORD	50$
    1985                                ;
    1986                                ; PUT ANSWER IN RESULT SLOT AND EXIT
    1987                                ;
    1988                                50$:
    1989                                	FPOP	30(SP)		; MOVE RESULT
       1                                	.REPT	4
       2                                		MOV	(SP)+,30(SP)
       3                                	.ENDR
       1 173414 012666  000030          		MOV	(SP)+,30(SP)
       1 173420 012666  000030          		MOV	(SP)+,30(SP)
       1 173424 012666  000030          		MOV	(SP)+,30(SP)
       1 173430 012666  000030          		MOV	(SP)+,30(SP)
    1990 173434 062706  000012          	ADD	#12,SP		; WIPE OUT JUNK
    1991                                LOGEX:				; RESTORE REGS
    1992                                	POP	<R2,R1,R0>
       1                                	.IRP	X,<R2,R1,R0>
       2                                		MOV	(SP)+,X
       3                                	.ENDM
       1 173440 012602                  		MOV	(SP)+,R2
       2 173442 012601                  		MOV	(SP)+,R1
       3 173444 012600                  		MOV	(SP)+,R0
    1993 173446 012604                  	MOV	(SP)+,R4
    1994 173450 001004                  	BNE	1$
    1995 173452 016704  002134'         	MOV	SAVJMP,R4
    1996 173456 005067  002134'         	CLR	SAVJMP
    1997 173462 000134                  1$:	JMP	@(R4)+
    1998                                ;
    1999                                ; CONSTANTS USED IN THE APPROXIMATION
    2000                                ;
    2001                                LN2:
    2002 173464 040061  071027  173721  	.FLT4	.6931471805599453094172321
         173472 147570                  
    2003                                IQ0:
    2004 173474 141100  016201  002154  	.FLT4	-.120069589779605254717525E2
         173502 010220                  
    2005                                IQ1:
    2006 173504 041233  154404  136454  	.FLT4	.19480966070088973051623E2
         173512 022150                  
    2007                                IQ2:
    2008 173514 141016  111747  007541  	.FLT4	-.89111090279378312337E1
         173522 052530                  
    2009                                IP0:
    2010 173524 141300  016201  002154  	.FLT4	-.240139179559210509868484E2
         173532 010220                  
    2011                                IP1:
    2012 173534 041367  124211  021611  	.FLT4	.30957292821537650062264E2
         173542 114440                  
    2013                                IP2:
    2014 173544 141032  031773  064222  	.FLT4	-.96376909336868659324E1
         173552 040260                  
    2015                                IP3:
    2016 173554 037727  114303  110107  	.FLT4	.4210873712179797145
         173562 114150                  
    2017                                LOGTAB:
    2018 173564    003     003          	.BYTE	3,3		; TABLE OF LOG COEFFICIENTS
    2019                                ;
    2020                                ; DOUBLE PRECISION SINE AND COSINE APPROXIMATIONS.  THIS ROUTINE USES
    2021                                ; ALGORITHM NUMBER 3345 IN HART, "COMPUTER APPROXIMATIONS".  THE ARGUEMENT
    2022                                ; IS REDUCED TO 0 <= X <= PI/2, AND THEN A SIMPLE POLYNOMIAL IS USED
    2023                                ; TO APPROXIMATE THE DESIRED FUNCTION.
    2024                                ;
    2025                                ; THE STATE OF THE STACK AT ABOUT 10$: IS AS FOLLOWS:
    2026                                ;
    2027                                ; SP==> A1
    2028                                ;	A2
    2029                                ;	A3	( WORK AREA )
    2030                                ;	A4
    2031                                ;	R5
    2032                                ;	R4
    2033                                ;	R3
    2034                                ;	R2	( REGISTERS SAVED AT CALL )
    2035                                ;	R1
    2036                                ;	R0
    2037                                ;	QUADRANT/SIGN FLAG
    2038                                ;	RETURN ADDRESS
    2039                                ;	N1
    2040                                ;	N2
    2041                                ;	N3	( ARGUMENT/RESULT )
    2042                                ;	N4
    2043                                ;
    2044                                .GLOBL	$DMUL$,	$DSUB$,	$APPRX,	$FRACT,STAND
    2045                                $B95::					; DOUBLE PRECISION COSINE
    2046 173566 005746                  	TST	-(SP)
    2047 173570 005046                  	CLR	-(SP)			; CLEAR QUADRANT FLAG
    2048 173572 006366  000004          	ASL	4(SP)			; SIGN OF ARGUMENT INTO CARRY
    2049 173576 001402                  	BEQ	ONE			; COS(0.0)=1.0
    2050 173600 000261                  	SEC				; COS(X)=SIN(PI/2 + X)
    2051 173602 000412                  	BR	SINCOS			; FALL INTO COMMON CODE
    2052                                ONE:
    2053 173604 012766  040100  000004  	MOV	#^F1.0,4(SP)		; FAST RETURN FOR COS(0)
    2054 173612 000562                  	BR	SCEXI			; THAT WAS EASY!
    2055                                $B93::					; DOUBLE PRECISION SINE
    2056 173614 005746                  	TST	-(SP)
    2057 173616 005046                  	CLR	-(SP)			; CLEAR QUADRANT/SIGN FLAG
    2058 173620 006366  000004          	ASL	4(SP)			; SIGN OF ARGUMENT INTO CARRY
    2059 173624 001555                  	BEQ	SCEXI			; SIN(0.0)=0.0
    2060 173626 006116                  	ROL	(SP)			; SIGN FLAG TO LOW BIT OF QUADRANT FLAG
    2061                                SINCOS:
    2062 173630 006116                  	ROL	(SP)			; QUADRANT/SIGN NOW KNOWN. (ZERO INTO CARRY)
    2063 173632 006066  000004          	ROR	4(SP)			; TAKE ABSOLUTE VALUE OF ARGUMENT
    2064                                ;
    2065                                ; SAVE ALL THE REGISTERS
    2066                                ;
    2067 173636 010546                  	MOV	R5,-(SP)
    2068 173640 010446                  	MOV	R4,-(SP)
    2069 173642 005767  002134'         	TST	SAVJMP
    2070 173646 001003                  	BNE	1$
    2071 173650 010467  002134'         	MOV	R4,SAVJMP
    2072 173654 005016                  	CLR	@SP
    2073                                1$:	PUSH	<R3,R2,R1,R0>
       1                                	.IRP	X,<R3,R2,R1,R0>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 173656 010346                  		MOV	R3,-(SP)
       2 173660 010246                  		MOV	R2,-(SP)
       3 173662 010146                  		MOV	R1,-(SP)
       4 173664 010046                  		MOV	R0,-(SP)
    2074                                ;
    2075                                ; REDUCE RANGE TO FIRST QUADRANT
    2076                                ;
    2077                                	FPUSH	20(SP)			; X
       1                                	.NTYPE	ATV,20(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	20(SP),-(SP)
       4                                		MOV	20(SP),-(SP)
       5                                		MOV	20(SP),-(SP)
       6                                		MOV	20(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+20(SP),-(SP)
      11                                	.ENDR
       1 173666 016646  000026          	MOV	6+20(SP),-(SP)
       1 173672 016646  000026          	MOV	6+20(SP),-(SP)
       1 173676 016646  000026          	MOV	6+20(SP),-(SP)
       1 173702 016646  000026          	MOV	6+20(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+20(SP),-(SP)
      14                                		MOV	4+20(SP),-(SP)
      15                                		MOV	2+20(SP),-(SP)
      16                                		MOV	20(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2078                                	FPUSH	TWODPI			; 2/PI
       1                                	.NTYPE	ATV,TWODPI
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	TWODPI,-(SP)
       4                                		MOV	TWODPI,-(SP)
       5                                		MOV	TWODPI,-(SP)
       6                                		MOV	TWODPI,-(SP)
       7                                	.IFF
       8 000001                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+TWODPI,-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 173706 016746  174304'         		MOV	6+TWODPI,-(SP)
      14 173712 016746  174302'         		MOV	4+TWODPI,-(SP)
      15 173716 016746  174300'         		MOV	2+TWODPI,-(SP)
      16 173722 016746  174276'         		MOV	TWODPI,-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2079 173726 004467  166552'         	JSR	R4,STAND		; X=X/(PI/2)
    2080 173732 170210                  	.WORD	$DMUL$
    2081 173734 175740                  	.WORD	$FRACT			; GET FRACTION PART, INTEGER PART IN R5
    2082 173736 173744                  	.WORD	5$
    2083 173740 167124                  	.WORD	$DSUB$
    2084 173742 173772                  	.WORD	10$
    2085 173744 060566  000024          5$:	ADD	R5,24(SP)		; ADD QUADRANT TO QUADRANT FLAG WORD
    2086 173750 006266  000024          	ASR	24(SP)			; IS ANGLE IN AN ODD QUADRANT?
    2087 173754 103006                  	BCC	10$			; NOPE
    2088 173756 005046                  	CLR	-(SP)			; YES, SO X=X-1 (SUBTRACT PI/2 FROM ORIGINAL X)
    2089 173760 005046                  	CLR	-(SP)
    2090 173762 005046                  	CLR	-(SP)
    2091 173764 012746  040100          	MOV	#^F1.0,-(SP)		; 1.0
    2092 173770 000134                  	JMP	@(R4)+
    2093                                10$:
    2094 173772 042716  100000          	BIC	#100000,(SP)		; TAKE ABSOLUTE VALUE OF X
    2095 173776 001436                  	BEQ	20$			; X=0.0
    2096 174000 022716  025160          	CMP	#^F1E-13,(SP)		; IS ARGUMENT TOO SMALL?
    2097 174004 103414                  	BLO	14$			; NUMBER IS REASONABLE
    2098                                ;
    2099                                ; SPECIAL CASE OF X VERY TINY.  LIM (X-->0) SIN(X)==X
    2100                                ;
    2101                                	FPUSH	C0			; QUICK EVALUATION OF POLYNOMIAL
       1                                	.NTYPE	ATV,C0
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	C0,-(SP)
       4                                		MOV	C0,-(SP)
       5                                		MOV	C0,-(SP)
       6                                		MOV	C0,-(SP)
       7                                	.IFF
       8 000001                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+C0,-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 174006 016746  174172'         		MOV	6+C0,-(SP)
      14 174012 016746  174170'         		MOV	4+C0,-(SP)
      15 174016 016746  174166'         		MOV	2+C0,-(SP)
      16 174022 016746  174164'         		MOV	C0,-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2102 174026 004467  166552'         	JSR	R4,STAND		; AND EXIT
    2103 174032 170210                  	.WORD	$DMUL$
    2104 174034 174074                  	.WORD	20$
    2105                                ;
    2106                                ; EVALUATE POLYNOMIAL
    2107                                ;
    2108                                14$:
    2109                                	FPUSH	0(SP)			; COPY X
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 174036 016646  000006          	MOV	6+0(SP),-(SP)
       1 174042 016646  000006          	MOV	6+0(SP),-(SP)
       1 174046 016646  000006          	MOV	6+0(SP),-(SP)
       1 174052 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2110 174056 012700  174274          	MOV	#SCTAB,R0		; POINT TO COEFFICIENTS
    2111 174062 004467  166552'         	JSR	R4,STAND		; DO SIMPLE POLYNOMIAL APPROXIMATION P(X^2)
    2112 174066 176460                  	.WORD	$APPRX
    2113 174070 170210                  	.WORD	$DMUL$			; SIN=X*P(X^2)
    2114 174072 174074                  	.WORD	20$
    2115                                ;
    2116                                ; CALCULATE SIGN OF RESULT
    2117                                ;
    2118                                20$:
    2119 174074 006316                  	ASL	(SP)			; SIGN TO CARRY
    2120 174076 001405                  	BEQ	30$			; RESULT IS 0.0
    2121 174100 005566  000024          	ADC	24(SP)			; PROPAGATE SIGN
    2122 174104 006266  000024          	ASR	24(SP)			; SIGN FLAG TO CARRY
    2123 174110 006016                  	ROR	(SP)			; SIGN TO RESULT
    2124                                30$:
    2125                                	FPOP	26(SP)			; POP RESULT INTO RESULT SLOT
       1                                	.REPT	4
       2                                		MOV	(SP)+,26(SP)
       3                                	.ENDR
       1 174112 012666  000026          		MOV	(SP)+,26(SP)
       1 174116 012666  000026          		MOV	(SP)+,26(SP)
       1 174122 012666  000026          		MOV	(SP)+,26(SP)
       1 174126 012666  000026          		MOV	(SP)+,26(SP)
    2126                                ;
    2127                                ; CLEAN UP STACK AND EXIT
    2128                                ;
    2129                                	POP	<R0,R1,R2,R3>
       1                                	.IRP	X,<R0,R1,R2,R3>
       2                                		MOV	(SP)+,X
       3                                	.ENDM
       1 174132 012600                  		MOV	(SP)+,R0
       2 174134 012601                  		MOV	(SP)+,R1
       3 174136 012602                  		MOV	(SP)+,R2
       4 174140 012603                  		MOV	(SP)+,R3
    2130 174142 012604                  	MOV	(SP)+,R4
    2131 174144 001004                  	BNE	2$
    2132 174146 016704  002134'         	MOV	SAVJMP,R4
    2133 174152 005067  002134'         	CLR	SAVJMP
    2134 174156 012605                  2$:	MOV	(SP)+,R5
    2135                                SCEXI:
    2136 174160 022626                  	CMP	(SP)+,(SP)+		; QUADRANT/SIGN FLAG
    2137 174162 000134                  	JMP	@(R4)+
    2138                                ;
    2139                                ; COEFFICIENTS USED TO APPROXIMATE SIN/COS FUNCTIONS
    2140                                ;
    2141                                C0:
    2142 174164 040311  007732  121041  	.FLT4	0.15707963267948966188272E1
         174172 064300                  
    2143 174174 140045  056747  030455  	.FLT4	-0.64596409750624619108547
         174202 171220                  
    2144 174204 037243  032743  035655  	.FLT4	 0.7969262624616543562977E-1
         174212 051560                  
    2145 174214 136231  064546  071423  	.FLT4	-0.468175413530264260121E-2
         174222 125030                  
    2146 174224 035050  036032  041214  	.FLT4	 0.1604411847068220716E-3
         174232 103130                  
    2147 174234 133561  101646  167216  	.FLT4	-0.359884300720869272E-5
         174242 134020                  
    2148 174244 032164  074657  047254  	.FLT4	 0.5692134872719023E-7
         174252 154740                  
    2149 174254 130467  136273  103054  	.FLT4	-0.66843217206396E-9
         174262 123150                  
    2150 174264 026716  106703  045277  	.FLT4	 0.587061098171E-11
         174272 146360                  
    2151                                SCTAB:
    2152 174274 000010                  	.WORD	8.			; ORDER OF POLYNOMIAL
    2153                                TWODPI:
    2154 174276 040042  174603  067116  	.FLT4	.63661977236758134307553505349	 ; 2/PI
         174304 042030                  
    2155                                ;
    2156                                ; THIS ROUTINE PROVEDES THE DOUBLE PRECISION TANGENT OF THE
    2157                                ; ARGUMENT PASSED ON THE STACK.
    2158                                ;
    2159                                $TAN::
    2160 174306 010446                  	MOV	R4,-(SP)
    2161 174310 010467  002134'         	MOV	R4,SAVJMP
    2162                                	FPUSH	2(SP)
       1                                	.NTYPE	ATV,2(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	2(SP),-(SP)
       4                                		MOV	2(SP),-(SP)
       5                                		MOV	2(SP),-(SP)
       6                                		MOV	2(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+2(SP),-(SP)
      11                                	.ENDR
       1 174314 016646  000010          	MOV	6+2(SP),-(SP)
       1 174320 016646  000010          	MOV	6+2(SP),-(SP)
       1 174324 016646  000010          	MOV	6+2(SP),-(SP)
       1 174330 016646  000010          	MOV	6+2(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+2(SP),-(SP)
      14                                		MOV	4+2(SP),-(SP)
      15                                		MOV	2+2(SP),-(SP)
      16                                		MOV	2(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2163 174334 004467  166552'         	JSR	R4,STAND
    2164 174340 173614                  	.WORD	$B93
    2165 174342 174354                  	.WORD	1$
    2166 174344 173566                  	.WORD	$B95
    2167 174346 174376                  	.WORD	2$
    2168 174350 170776                  	.WORD	$DDIV$
    2169 174352 174404                  	.WORD	3$
    2170                                1$:	FPUSH	12(SP)
       1                                	.NTYPE	ATV,12(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	12(SP),-(SP)
       4                                		MOV	12(SP),-(SP)
       5                                		MOV	12(SP),-(SP)
       6                                		MOV	12(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+12(SP),-(SP)
      11                                	.ENDR
       1 174354 016646  000020          	MOV	6+12(SP),-(SP)
       1 174360 016646  000020          	MOV	6+12(SP),-(SP)
       1 174364 016646  000020          	MOV	6+12(SP),-(SP)
       1 174370 016646  000020          	MOV	6+12(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+12(SP),-(SP)
      14                                		MOV	4+12(SP),-(SP)
      15                                		MOV	2+12(SP),-(SP)
      16                                		MOV	12(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2171 174374 000134                  4$:	JMP	@(R4)+
    2172 174376 005716                  2$:	TST	@SP
    2173 174400 001375                  	BNE	4$
    2174 174402 104405                  	TRAP	5
    2175                                3$:	FPOP	10(SP)
       1                                	.REPT	4
       2                                		MOV	(SP)+,10(SP)
       3                                	.ENDR
       1 174404 012666  000010          		MOV	(SP)+,10(SP)
       1 174410 012666  000010          		MOV	(SP)+,10(SP)
       1 174414 012666  000010          		MOV	(SP)+,10(SP)
       1 174420 012666  000010          		MOV	(SP)+,10(SP)
    2176 174424 012604                  	MOV	(SP)+,R4
    2177 174426 005067  002134'         	CLR	SAVJMP
    2178 174432 000134                  	JMP	@(R4)+
    2179                                ;
    2180                                ; THIS ROUTINE PROVEDES THE DOUBLE PRECISION INVERSE TANGENT OF
    2181                                ; THE ARGUMENT PASSED ON THE STACK.  THE ALGORITHM USED IS
    2182                                ; ARCTN 5076 FROM HART, "COMPUTER APPROXIMATIONS".
    2183                                ;
    2184                                ; THE STATE OF THE STACK AT ABOUT 10$: IS AS FOLLOWS:
    2185                                ;
    2186                                ; SP==>	SIGN FLAG
    2187                                ;	R3
    2188                                ;	R2
    2189                                ;	R1
    2190                                ;	R0
    2191                                ;	RETURN ADDRESS
    2192                                ;	N1
    2193                                ;	N2	(ARGUMENT)
    2194                                ;	N3
    2195                                ;	N4
    2196                                .GLOBL	$DDIV$,	$DSUB$,	$DADD$,	$APPRX, STAND
    2197                                $B97::				; DOUBLE PRECISION ARC-TANGENT
    2198 174434 010446                  	MOV	R4,-(SP)
    2199 174436 005767  002134'         	TST	SAVJMP
    2200 174442 001003                  	BNE	1$
    2201 174444 010467  002134'         	MOV	R4,SAVJMP
    2202 174450 005016                  	CLR	@SP
    2203                                1$:	PUSH	<R3,R2,R1,R0>
       1                                	.IRP	X,<R3,R2,R1,R0>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 174452 010346                  		MOV	R3,-(SP)
       2 174454 010246                  		MOV	R2,-(SP)
       3 174456 010146                  		MOV	R1,-(SP)
       4 174460 010046                  		MOV	R0,-(SP)
    2204 174462 005046                  	CLR	-(SP)		; ASSUME POSITIVE ARG
    2205 174464 005001                  	CLR	R1		; ASSUME NO RANGE REDUCTION
    2206                                	FPUSH	14(SP)		; PUSH ARG
       1                                	.NTYPE	ATV,14(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	14(SP),-(SP)
       4                                		MOV	14(SP),-(SP)
       5                                		MOV	14(SP),-(SP)
       6                                		MOV	14(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+14(SP),-(SP)
      11                                	.ENDR
       1 174466 016646  000022          	MOV	6+14(SP),-(SP)
       1 174472 016646  000022          	MOV	6+14(SP),-(SP)
       1 174476 016646  000022          	MOV	6+14(SP),-(SP)
       1 174502 016646  000022          	MOV	6+14(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+14(SP),-(SP)
      14                                		MOV	4+14(SP),-(SP)
      15                                		MOV	2+14(SP),-(SP)
      16                                		MOV	14(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2207 174506 011600                  	MOV	(SP),R0		; GET SIGN/EXPONENT/MSB OF MANTISSA
    2208 174510 100007                  	BPL	10$		; ARG IS POSITIVE
    2209 174512 005166  000010          	COM	10(SP)		; SET NEGATIVE FLAG
    2210 174516 042700  100000          	BIC	#100000,R0	; CLEAR FOR RANGE COMPARES
    2211 174522 010016                  	MOV	R0,(SP)		; TAKE ABSOLUTE VALUE OF ARG
    2212 174524 010066  000024          	MOV	R0,24(SP)	; TAKE ABSOLUTE VALUE OF ORIGINAL ARG
    2213                                ;
    2214                                ; CHECK IF RANGE REDUCTION NECESSARY
    2215                                ;
    2216                                10$:
    2217 174530 022700  037724          	CMP	#37724,R0	; TAN(PI/8) (APPROX)
    2218 174534 003065                  	BGT	30$		; X<TAN(PI/8) SO NO RANGE REDUCTION
    2219 174536 022700  040432          	CMP	#40432,R0	; TAN(3*PI/8) (APPROX)
    2220 174542 003435                  	BLE	20$		; X>TAN(3*PI/8)
    2221                                ;
    2222                                ; TAN(PI/8) <= X < TAN(3*PI/8)  SO X=(X-1)/(X+1)
    2223                                ;
    2224 174544 005046                  	CLR	-(SP)		; PUSH 1.0
    2225 174546 005046                  	CLR	-(SP)
    2226 174550 005046                  	CLR	-(SP)
    2227 174552 012746  040100          	MOV	#^F1.0,-(SP)	; 1.0
    2228 174556 004467  166552'         	JSR	R4,STAND
    2229 174562 167124                  	.WORD	$DSUB$
    2230 174564 174574                  	.WORD	11$
    2231 174566 167144                  	.WORD	$DADD$
    2232 174570 170776                  	.WORD	$DDIV$
    2233 174572 174630                  	.WORD	12$
    2234                                11$:	FPUSH	24(SP)		; X
       1                                	.NTYPE	ATV,24(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	24(SP),-(SP)
       4                                		MOV	24(SP),-(SP)
       5                                		MOV	24(SP),-(SP)
       6                                		MOV	24(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+24(SP),-(SP)
      11                                	.ENDR
       1 174574 016646  000032          	MOV	6+24(SP),-(SP)
       1 174600 016646  000032          	MOV	6+24(SP),-(SP)
       1 174604 016646  000032          	MOV	6+24(SP),-(SP)
       1 174610 016646  000032          	MOV	6+24(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+24(SP),-(SP)
      14                                		MOV	4+24(SP),-(SP)
      15                                		MOV	2+24(SP),-(SP)
      16                                		MOV	24(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2235 174614 005046                  	CLR	-(SP)
    2236 174616 005046                  	CLR	-(SP)
    2237 174620 005046                  	CLR	-(SP)
    2238 174622 012746  040100          	MOV	#^F1.0,-(SP)	; 1.0
    2239 174626 000134                  	JMP	@(R4)+
    2240 174630 012701  175044          12$:	MOV	#PIDV4,R1	; POINT TO PI/4
    2241 174634 000425                  	BR	30$		; DO APPROXIMATION
    2242                                ;
    2243                                ; X >= TAN(3*PI/8) SO X=-1/X
    2244                                ;
    2245                                20$:
    2246 174636 062706  000010          	ADD	#10,SP		; WIPE OUT ARG ON STACK
    2247 174642 005046                  	CLR	-(SP)		; PUSH -1.0
    2248 174644 005046                  	CLR	-(SP)
    2249 174646 005046                  	CLR	-(SP)
    2250 174650 012746  140100          	MOV	#^F-1.0,-(SP)	; -1.0
    2251                                	FPUSH	24(SP)		; X
       1                                	.NTYPE	ATV,24(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	24(SP),-(SP)
       4                                		MOV	24(SP),-(SP)
       5                                		MOV	24(SP),-(SP)
       6                                		MOV	24(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+24(SP),-(SP)
      11                                	.ENDR
       1 174654 016646  000032          	MOV	6+24(SP),-(SP)
       1 174660 016646  000032          	MOV	6+24(SP),-(SP)
       1 174664 016646  000032          	MOV	6+24(SP),-(SP)
       1 174670 016646  000032          	MOV	6+24(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+24(SP),-(SP)
      14                                		MOV	4+24(SP),-(SP)
      15                                		MOV	2+24(SP),-(SP)
      16                                		MOV	24(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2252 174674 004467  166552'         	JSR	R4,STAND
    2253 174700 170776                  	.WORD	$DDIV$
    2254 174702 174704                  	.WORD	21$
    2255 174704 012701  175054          21$:	MOV	#PIDV2,R1	; POINT TO PI/2
    2256                                ;
    2257                                ; APPROXIMATE ATN(X) WHERE X <= TAN(PI/8)
    2258                                ;
    2259                                30$:
    2260 174710 012700  175174          	MOV	#ATNTAB,R0	; POINT TO COEFFICIENT TABLE
    2261 174714 004467  166552'         	JSR	R4,STAND	; PERFORM RATIONAL APROXIMATION
    2262 174720 176460                  	.WORD	$APPRX
    2263 174722 174724                  	.WORD	31$
    2264                                ;
    2265                                ; FIX UP SIGN AND ANY RANGE REDUCTION
    2266                                ;
    2267 174724 005701                  31$:	TST	R1		; RANGE REDUCTION?
    2268 174726 001414                  	BEQ	40$		; NOPE
    2269                                	FPUSH	0(R1)		; PUSH CORRECTION FACTOR
       1                                	.NTYPE	ATV,0(R1)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(R1),-(SP)
       4                                		MOV	0(R1),-(SP)
       5                                		MOV	0(R1),-(SP)
       6                                		MOV	0(R1),-(SP)
       7                                	.IFF
       8 177773                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 174730 016146  000006          		MOV	6+0(R1),-(SP)
      14 174734 016146  000004          		MOV	4+0(R1),-(SP)
      15 174740 016146  000002          		MOV	2+0(R1),-(SP)
      16 174744 016146  000000          		MOV	0(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2270 174750 004467  166552'         	JSR	R4,STAND
    2271 174754 167144                  	.WORD	$DADD$
    2272 174756 174760                  	.WORD	40$
    2273                                40$:
    2274 174760 005766  000010          	TST	10(SP)		; SIGN CORRECT?
    2275 174764 100002                  	BPL	50$		; YES
    2276 174766 062716  100000          	ADD	#100000,(SP)	; NOPE FLIP SIGN
    2277                                50$:
    2278                                	FPOP	22(SP)		; PUT ANSWER IN RESULT SLOT
       1                                	.REPT	4
       2                                		MOV	(SP)+,22(SP)
       3                                	.ENDR
       1 174772 012666  000022          		MOV	(SP)+,22(SP)
       1 174776 012666  000022          		MOV	(SP)+,22(SP)
       1 175002 012666  000022          		MOV	(SP)+,22(SP)
       1 175006 012666  000022          		MOV	(SP)+,22(SP)
    2279 175012 062706  000002          	ADD	#2,SP		; KILL JUNK ON STACK
    2280                                	POP	<R0,R1,R2,R3>	; POP REGS
       1                                	.IRP	X,<R0,R1,R2,R3>
       2                                		MOV	(SP)+,X
       3                                	.ENDM
       1 175016 012600                  		MOV	(SP)+,R0
       2 175020 012601                  		MOV	(SP)+,R1
       3 175022 012602                  		MOV	(SP)+,R2
       4 175024 012603                  		MOV	(SP)+,R3
    2281 175026 012604                  	MOV	(SP)+,R4
    2282 175030 001004                  	BNE	2$
    2283 175032 016704  002134'         	MOV	SAVJMP,R4
    2284 175036 005067  002134'         	CLR	SAVJMP
    2285 175042 000134                  2$:	JMP	@(R4)+
    2286                                ;
    2287                                ; CONSTANTS USED IN APPROXIMATION
    2288                                ;
    2289                                PIDV4:
    2290 175044 040111  007732  121041  	.FLT4	.78539816339744830961566	; PI/4
         175052 064300                  
    2291                                PIDV2:
    2292 175054 040311  007732  121041  	.FLT4	1.57079632679489661923132	; PI/2
         175062 064300                  
    2293                                Q0:
    2294 175064 041462  025125  006152  	.FLT4	.445413400592906804445595E2
         175072 126070                  
    2295                                Q1:
    2296 175074 041670  123114  051576  	.FLT4	.92324801072300974840693E2
         175102 075020                  
    2297                                Q2:
    2298 175104 041573  053776  025372  	.FLT4	.62835930511032376833267E2
         175112 071530                  
    2299                                Q3:
    2300 175114 041170  010112  141724  	.FLT4	.1550397755142198752523E2
         175122 064330                  
    2301                                P0:
    2302 175124 041462  025125  006152  	.FLT4	.445413400592906803197511E2
         175132 126070                  
    2303                                P1:
    2304 175134 041632  172223  076027  	.FLT4	.77477687719204208616481E2
         175142 056650                  
    2305                                P2:
    2306 175144 041443  160206  172714  	.FLT4	.40969264832102256374186E2
         175152 025440                  
    2307                                P3:
    2308 175154 040725  021566  115517  	.FLT4	.666057901700926265753E1
         175162 050310                  
    2309                                P4:
    2310 175164 037442  145026  075504  	.FLT4	.1589740288482307048
         175172 015620                  
    2311                                ATNTAB:
    2312 175174    004     004          	.BYTE	4,4		; TABLE OF COEFFICIENTS
    2313                                	.TITLE	$FRACT AND RND
    2314                                ;
    2315                                ; 	THIS ROUTINE RETURNS TNE RANDOM VALUE
    2316                                ;
    2317                                ;
    2318                                RAN::
    2319 175176 010467  002134'         	MOV	R4,SAVJMP
    2320 175202 005716                  	TST	@SP
    2321 175204 001523                  	BEQ	1$		; PREVIOUS VALUE
    2322 175206 100012                  	BPL	2$		; NEXT VALUE
    2323 175210 005067  002070'         	CLR	RNDSAV
    2324 175214 012700  175054          	MOV	#PIDV2,R0
    2325 175220 012705  002060          	MOV	#III,R5
    2326                                	.REPT	4
    2327                                	MOV	(0)+,(5)+
    2328                                	.ENDR
       1 175224 012025                  	MOV	(0)+,(5)+
       1 175226 012025                  	MOV	(0)+,(5)+
       1 175230 012025                  	MOV	(0)+,(5)+
       1 175232 012025                  	MOV	(0)+,(5)+
    2329 175234 012705  002060          2$:	MOV	#III,R5
    2330 175240 012500                  	MOV	(5)+,R0
    2331 175242 012501                  	MOV	(5)+,R1
    2332 175244 012502                  	MOV	(5)+,R2
    2333 175246 012503                  	MOV	(5)+,R3
    2334 175250 001436                  	BEQ	22$
    2335 175252 006303                  	ASL	R3
    2336 175254 006102                  	ROL	R2
    2337 175256 006101                  	ROL	R1
    2338 175260 006100                  	ROL	R0
    2339 175262 162705  000010          	SUB	#10,R5
    2340 175266 062500                  	ADD	(5)+,R0
    2341 175270 062501                  	ADD	(5)+,R1
    2342 175272 005500                  	ADC	R0
    2343 175274 062502                  	ADD	(5)+,R2
    2344 175276 005501                  	ADC	R1
    2345 175300 061503                  	ADD	@R5,R3
    2346 175302 005502                  	ADC	R2
    2347 175304 062500                  	ADD	(5)+,R0
    2348 175306 100002                  	BPL	23$
    2349 175310 062700  100000          	ADD	#100000,R0
    2350 175314 010345                  23$:	MOV	R3,-(5)
    2351 175316 010245                  	MOV	R2,-(5)
    2352 175320 010145                  	MOV	R1,-(5)
    2353 175322 010045                  	MOV	R0,-(5)
    2354 175324 012705  000201          	MOV	#201,R5
    2355 175330 006303                  24$:	ASL	R3
    2356 175332 006102                  	ROL	R2
    2357 175334 006101                  	ROL	R1
    2358 175336 006100                  	ROL	R0
    2359 175340 103406                  	BCS	25$
    2360 175342 005305                  	DEC	R5
    2361 175344 000771                  	BR	24$
    2362 175346 012703  000003          22$:	MOV	#3,R3
    2363 175352 005200                  	INC	R0
    2364 175354 000757                  	BR	23$
    2365 175356 105003                  25$:	CLRB	R3
    2366 175360 150203                  	BISB	R2,R3
    2367 175362 000303                  	SWAB	R3
    2368 175364 105002                  	CLRB	R2
    2369 175366 150102                  	BISB	R1,R2
    2370 175370 000302                  	SWAB	R2
    2371 175372 105001                  	CLRB	R1
    2372 175374 150001                  	BISB	R0,R1
    2373 175376 000301                  	SWAB	R1
    2374 175400 105000                  	CLRB	R0
    2375 175402 150500                  	BISB	R5,R0
    2376 175404 000300                  	SWAB	R0
    2377 175406 006000                  	ROR	R0
    2378 175410 006001                  	ROR	R1
    2379 175412 006002                  	ROR	R2
    2380 175414 006003                  	ROR	R3
    2381 175416 005767  002070'         	TST	RNDSAV
    2382 175422 001432                  	BEQ	9$
    2383 175424 010605                  	MOV	SP,R5
    2384 175426 010025                  	MOV	R0,(5)+
    2385 175430 010125                  	MOV	R1,(5)+
    2386 175432 010225                  	MOV	R2,(5)+
    2387 175434 010325                  	MOV	R3,(5)+
    2388 175436 010600                  8$:	MOV	SP,R0
    2389 175440 012705  002070          	MOV	#RNDSAV,R5
    2390                                	.REPT	4
    2391                                	MOV	(0)+,(5)+
    2392                                	.ENDR
       1 175444 012025                  	MOV	(0)+,(5)+
       1 175446 012025                  	MOV	(0)+,(5)+
       1 175450 012025                  	MOV	(0)+,(5)+
       1 175452 012025                  	MOV	(0)+,(5)+
    2393 175454 016716  002070'         1$:	MOV	RNDSAV,@SP
    2394 175460 016766  002072' 000002  	MOV	RNDSAV+2,2(SP)
    2395 175466 016766  002074' 000004  	MOV	RNDSAV+4,4(SP)
    2396 175474 016766  002076' 000006  	MOV	RNDSAV+6,6(SP)
    2397 175502 005067  002134'         	CLR	SAVJMP
    2398 175506 000134                  	JMP	@(4)+
    2399                                9$:	PUSH	<R3,R2,R1,R0>
       1                                	.IRP	X,<R3,R2,R1,R0>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 175510 010346                  		MOV	R3,-(SP)
       2 175512 010246                  		MOV	R2,-(SP)
       3 175514 010146                  		MOV	R1,-(SP)
       4 175516 010046                  		MOV	R0,-(SP)
    2400 175520 010400                  	MOV	R4,R0
    2401 175522 005001                  	CLR	R1		; SIGNAL REGISTER
    2402                                	FPUSH	10(SP)
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 175524 016646  000016          	MOV	6+10(SP),-(SP)
       1 175530 016646  000016          	MOV	6+10(SP),-(SP)
       1 175534 016646  000016          	MOV	6+10(SP),-(SP)
       1 175540 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2403 175544 042716  100000          	BIC	#100000,@SP
    2404 175550 022716  040200          13$:	CMP	#40200,@SP
    2405 175554 002401                  	BLT	10$
    2406 175556 003007                  	BGT	11$
    2407 175560 005301                  10$:	DEC	R1
    2408 175562 002033                  	BGE	15$
    2409 175564 004467  166552'         	JSR	R4,STAND
    2410 175570 175636                  	.WORD	12$
    2411 175572 170776                  	.WORD	$DDIV$
    2412 175574 175550                  	.WORD	13$
    2413 175576 010602                  11$:	MOV	SP,R2
    2414                                	.REPT	4
    2415                                	MOV	(2)+,16(R2)
    2416                                	.ENDR
       1 175600 012262  000016          	MOV	(2)+,16(R2)
       1 175604 012262  000016          	MOV	(2)+,16(R2)
       1 175610 012262  000016          	MOV	(2)+,16(R2)
       1 175614 012262  000016          	MOV	(2)+,16(R2)
    2417 175620 005201                  	INC	R1
    2418 175622 003413                  	BLE	15$
    2419 175624 004467  166552'         	JSR	R4,STAND
    2420 175630 175636                  	.WORD	12$
    2421 175632 170210                  	.WORD	$DMUL$
    2422 175634 175550                  	.WORD	13$
    2423 175636 005046                  12$:	CLR	-(SP)
    2424 175640 005046                  	CLR	-(SP)
    2425 175642 005046                  	CLR	-(SP)
    2426 175644 012746  041040          	MOV	#41040,-(SP)
    2427 175650 000134                  	JMP	@(4)+
    2428 175652 062706  000010          15$:	ADD	#10,SP
    2429 175656 004467  166552'         	JSR	R4,STAND
    2430 175662 175636                  	.WORD	12$
    2431 175664 170776                  	.WORD	$DDIV$
    2432 175666 175676                  	.WORD	16$
    2433 175670 167144                  	.WORD	$DADD$
    2434 175672 167124                  	.WORD	$DSUB$
    2435 175674 175712                  	.WORD	17$
    2436 175676 005046                  16$:	CLR	-(SP)
    2437 175700 005046                  	CLR	-(SP)
    2438 175702 005046                  	CLR	-(SP)
    2439 175704 012746  040200          	MOV	#40200,-(SP)
    2440 175710 000134                  	JMP	@(4)+
    2441 175712 042716  100000          17$:	BIC	#100000,@SP
    2442 175716 010601                  	MOV	SP,R1
    2443 175720 012702  002060          	MOV	#III,R2
    2444                                	.REPT	4
    2445                                	MOV	(1)+,(2)+
    2446                                	.ENDR
       1 175724 012122                  	MOV	(1)+,(2)+
       1 175726 012122                  	MOV	(1)+,(2)+
       1 175730 012122                  	MOV	(1)+,(2)+
       1 175732 012122                  	MOV	(1)+,(2)+
    2447 175734 010004                  	MOV	R0,R4
    2448 175736 000637                  	BR	8$
    2449                                ;
    2450                                ;
    2451                                ; THIS ROUTINE RETURNS THE FRACTIONAL PART OF THE ARGUMENT PASSED ON THE
    2452                                ; STACK.  THE LAST PART OF THE INTEGER IS RETURNED IN R5, AND THE FRACTIONAL
    2453                                ; PART OF THE ARG IS RETURNED ON THE STACK.  THIS ROUTINE IS CALLED BY
    2454                                ; THE TRIG FUNCTIONS AND THE EXP ROUTINE TO PERFORM RANGE REDUCTION.  NO
    2455                                ; REGISTERS ARE PRESERVED, AND ALL REGISTERS ARE DESTROYED.
    2456                                ;
    2457                                $FRACT::			; RETURN FRACTION PART
    2458 175740 010446                  	MOV	R4,-(SP)
    2459 175742 016601  000002          	MOV	2(SP),R1	; PICK UP NUMBER
    2460 175746 016602  000004          	MOV	4(SP),R2
    2461 175752 016603  000006          	MOV	6(SP),R3
    2462 175756 016604  000010          	MOV	10(SP),R4
    2463                                ;
    2464                                ; GET SIGN OF INTEGER PART AND SPLIT UP EXPONENT AND MANTISSA
    2465                                ;
    2466 175762 005005                  	CLR	R5		; ASSUME NO INTEGER PART
    2467 175764 010100                  	MOV	R1,R0		; COPY SIGN/EXPONENT/MSB OF MANTISSA
    2468 175766 010046                  	MOV	R0,-(SP)	; REMEMBER THE SIGN
    2469 175770 006300                  	ASL	R0		; BYTE ALIGN EXPONENT
    2470 175772 105000                  	CLRB	R0		; WIPE OUT MANTISSA BITS
    2471 175774 000300                  	SWAB	R0		; EXPONENT TO LOW BYTE
    2472 175776 042701  177400          	BIC	#177400,R1	; CLEAR EXPONENT BITS
    2473 176002 052701  000200          	BIS	#200,R1		; SET "HIDDEN" BIT
    2474                                ;
    2475                                ; DETERMINE IF NUMBER IS ALREADY A FRACTION OR IF INTEGER PART IS TOO
    2476                                ; BIG TO HAVE A FRACTIONAL PART.
    2477                                ;
    2478 176006 162700  000200          	SUB	#200,R0		; CONVERT FROM EXCESS 200 TO BINARY
    2479 176012 003472                  	BLE	60$		; NUMBER IS ALREADY FRACTION
    2480 176014 022700  000070          	CMP	#56.,R0		; NUMBER TOO BIG?
    2481 176020 003013                  	BGT	20$		; NO
    2482                                ;
    2483                                ; NUMBER IS TOO BIG, SO IT HAS NO FRACTIONAL PART.  RETURN
    2484                                ; ZERO AS THE FRACTION.
    2485                                ;
    2486 176022 012705  077770          	MOV	#77770,R5	; SET BIG INTEGER
    2487                                10$:
    2488 176026 005066  000004          	CLR	4(SP)		; ZERO THE RESULT
    2489 176032 005066  000006          	CLR	6(SP)
    2490 176036 005066  000010          	CLR	10(SP)
    2491 176042 005066  000012          	CLR	12(SP)
    2492 176046 000454                  	BR	60$		; RETURN TO CALLER
    2493                                ;
    2494                                ; SHIFT NUMBER LEFT TO PUT INTEGER PART TO LEFT OF IMPLIED BINARY
    2495                                ; POINT WITH FRACTION PART TO THE RIGHT.  R5 IS USED TO HOLD
    2496                                ; OVERFLOW WHICH SHIFTS OUT OF R1.  THIS OVERFLOW IS EITHER NOT
    2497                                ; SIGNIFICANT (FOR QUADRANT DETERMINATION) OR AN ERROR (FOR EXP).
    2498                                ;
    2499                                20$:
    2500 176050 006304                  	ASL	R4		; SHIFT LEFT ONE PLACE
    2501 176052 006103                  	ROL	R3
    2502 176054 006102                  	ROL	R2
    2503 176056 006101                  	ROL	R1
    2504 176060 006105                  	ROL	R5		; OVERFLOW INTO R5
    2505 176062 005505                  	ADC	R5		; RECORD MORE OVERFLOW
    2506 176064 005300                  	DEC	R0		; COUNT SHIFT IN EXPONENT
    2507 176066 003370                  	BGT	20$		; MORE SHIFTING TO DO
    2508                                ;
    2509                                ; SAVE LOWER BITS OF INTEGER PART IN R5 AND PREPARE TO NORMALIZE REMAINING
    2510                                ; FRACTION.
    2511                                ;
    2512 176070 000305                  	SWAB	R5		; MAKE ROOM IN LOW BYTE
    2513 176072 000301                  	SWAB	R1		; MOVE INTEGER TO LOW BYTE
    2514 176074 150105                  	BISB	R1,R5		; MOVE INTEGER BITS
    2515 176076 005716                  	TST	(SP)		; NEGATIVE NUMBER?
    2516 176100 100001                  	BPL	30$		; NOPE
    2517 176102 005405                  	NEG	R5		; YES, RECORD THIS FACT
    2518                                30$:
    2519 176104 105001                  	CLRB	R1		; KILL INTEGER BITS
    2520 176106 000301                  	SWAB	R1		; MOVE MANTISSA TO LOW BYTE
    2521                                ;
    2522                                ; TEST IF FRACTION NEEDS TO BE NORMALIZED.  IF REMAINING BITS ARE ZERO,
    2523                                ; NO NORMALIZE IS NEEDED, OR THE NUMBER MIGHT ALREADY BE NORMALIZED
    2524                                ; (50% CHANCE)
    2525                                ;
    2526 176110 105701                  	TSTB	R1		; NUMBER NORMALIZED?
    2527 176112 100414                  	BMI	50$		; YES, TAKE FAST EXIT
    2528 176114 010146                  	MOV	R1,-(SP)	; CHECK IF FRACTION IS ZERO
    2529 176116 050216                  	BIS	R2,(SP)		; BY OR'ING TOGETHER
    2530 176120 050316                  	BIS	R3,(SP)		; ALL THE BITS
    2531 176122 050426                  	BIS	R4,(SP)+	; ANY BITS SET?
    2532 176124 001740                  	BEQ	10$		; RESULT IS ZERO
    2533                                ;
    2534                                ; NORMALIZE FRACTION
    2535                                ;
    2536                                40$:
    2537 176126 006304                  	ASL	R4		; SHIFT NUMBER 1 PLACE LEFT
    2538 176130 006103                  	ROL	R3
    2539 176132 006102                  	ROL	R2
    2540 176134 006101                  	ROL	R1
    2541 176136 005300                  	DEC	R0		; COUNT SHIFT IN EXPONENT
    2542 176140 105701                  	TSTB	R1		; NUMBER NORMALIZED YET?
    2543 176142 100371                  	BPL	40$		; NOPE
    2544                                ;
    2545                                ; CONVERT BACK TO FLOATING POINT FORMAT
    2546                                ;
    2547                                50$:
    2548 176144 062700  000200          	ADD	#200,R0		; EXCESS 200 NOTATION FOR EXPONENT
    2549 176150 000300                  	SWAB	R0		; MOVE EXPONENT TO UPPER BYTE
    2550 176152 106301                  	ASLB	R1		; ALIGN MANTISSA, KILL HIDDEN BIT
    2551 176154 050001                  	BIS	R0,R1		; FILL IN EXPONENT
    2552 176156 006001                  	ROR	R1		; CHANGE TO FLOATING FORMAT
    2553 176160 010166  000004          	MOV	R1,4(SP)	; STORE NUMBER IN RESULT SLOT
    2554 176164 010266  000006          	MOV	R2,6(SP)
    2555 176170 010366  000010          	MOV	R3,10(SP)
    2556 176174 010466  000012          	MOV	R4,12(SP)
    2557                                60$:
    2558 176200 005726                  	TST	(SP)+		; POP SIGN ARG
    2559 176202 012604                  	MOV	(SP)+,R4
    2560 176204 042716  100000          	BIC	#100000,@SP	; FRACTION ALWAYS POSITIVE
    2561 176210 000134                  	JMP	@(R4)+
    2562                                ;
    2563                                ; THIS ROUTINE RETURNS INTEGER PART OF THE ARGUMENT PASSED ON
    2564                                ; THE STACK.ALL REGISTERS ARE DESTROYED.
    2565                                ;
    2566                                $FIX::
    2567 176212 010467  002134'         	MOV	R4,SAVJMP
    2568 176216 010446                  	MOV	R4,-(SP)	; SAVE RETURN REGISTRE
    2569                                	FPUSH	2(SP)		; PUSH ARGUMENT ON STACK
       1                                	.NTYPE	ATV,2(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	2(SP),-(SP)
       4                                		MOV	2(SP),-(SP)
       5                                		MOV	2(SP),-(SP)
       6                                		MOV	2(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+2(SP),-(SP)
      11                                	.ENDR
       1 176220 016646  000010          	MOV	6+2(SP),-(SP)
       1 176224 016646  000010          	MOV	6+2(SP),-(SP)
       1 176230 016646  000010          	MOV	6+2(SP),-(SP)
       1 176234 016646  000010          	MOV	6+2(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+2(SP),-(SP)
      14                                		MOV	4+2(SP),-(SP)
      15                                		MOV	2+2(SP),-(SP)
      16                                		MOV	2(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2570                                $FIX1:	FPUSH	0(SP)
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 176240 016646  000006          	MOV	6+0(SP),-(SP)
       1 176244 016646  000006          	MOV	6+0(SP),-(SP)
       1 176250 016646  000006          	MOV	6+0(SP),-(SP)
       1 176254 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2571 176260 004467  166552'         	JSR	R4,STAND
    2572 176264 175740                  	.WORD	$FRACT
    2573 176266 176274                  	.WORD	1$
    2574 176270 167144                  	.WORD	$DADD$
    2575 176272 176310                  	.WORD	2$
    2576 176274 005766  000010          1$:	TST	10(SP)
    2577 176300 003402                  	BLE	3$
    2578 176302 052716  100000          	BIS	#100000,@SP
    2579 176306 000134                  3$:	JMP	@(R4)+
    2580                                2$:	FPOP	10(SP)		; POP REZULT ON THE STACK
       1                                	.REPT	4
       2                                		MOV	(SP)+,10(SP)
       3                                	.ENDR
       1 176310 012666  000010          		MOV	(SP)+,10(SP)
       1 176314 012666  000010          		MOV	(SP)+,10(SP)
       1 176320 012666  000010          		MOV	(SP)+,10(SP)
       1 176324 012666  000010          		MOV	(SP)+,10(SP)
    2581 176330 012604                  	MOV	(SP)+,R4
    2582 176332 005067  002134'         	CLR	SAVJMP
    2583 176336 000763                  	BR	3$
    2584                                ;
    2585                                ; THIS ROUTINE RETURNS THE HIGHEST INTEGER VALUE LESS THEN
    2586                                ; ARGUMENT PASSED ON THE STACK.
    2587                                ;
    2588                                $INT::
    2589 176340 005716                  	TST	@SP
    2590 176342 100323                  	BPL	$FIX
    2591 176344 010467  002134'         	MOV	R4,SAVJMP
    2592 176350 010446                  	MOV	R4,-(SP)
    2593                                	FPUSH	2(SP)
       1                                	.NTYPE	ATV,2(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	2(SP),-(SP)
       4                                		MOV	2(SP),-(SP)
       5                                		MOV	2(SP),-(SP)
       6                                		MOV	2(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+2(SP),-(SP)
      11                                	.ENDR
       1 176352 016646  000010          	MOV	6+2(SP),-(SP)
       1 176356 016646  000010          	MOV	6+2(SP),-(SP)
       1 176362 016646  000010          	MOV	6+2(SP),-(SP)
       1 176366 016646  000010          	MOV	6+2(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+2(SP),-(SP)
      14                                		MOV	4+2(SP),-(SP)
      15                                		MOV	2+2(SP),-(SP)
      16                                		MOV	2(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2594                                	FPUSH	0(SP)
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 176372 016646  000006          	MOV	6+0(SP),-(SP)
       1 176376 016646  000006          	MOV	6+0(SP),-(SP)
       1 176402 016646  000006          	MOV	6+0(SP),-(SP)
       1 176406 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2595 176412 004467  166552'         	JSR	R4,STAND
    2596 176416 175740                  	.WORD	$FRACT
    2597 176420 176426                  	.WORD	1$
    2598 176422 167144                  	.WORD	$DADD$
    2599 176424 176240                  	.WORD	$FIX1
    2600 176426 005716                  1$:	TST	@SP
    2601 176430 001410                  	BEQ	2$
    2602 176432 062706  000010          	ADD	#10,SP
    2603 176436 005046                  	CLR	-(SP)
    2604 176440 005046                  	CLR	-(SP)
    2605 176442 005046                  	CLR	-(SP)
    2606 176444 012746  140200          	MOV	#140200,-(SP)
    2607 176450 000134                  	JMP	@(R4)+
    2608 176452 062706  000010          2$:	ADD	#10,SP
    2609 176456 000670                  	BR	$FIX1
    2610                                ; THIS ROUTINE IS CALLED BY THE TRANCENDENTAL FUNCTIONS TO EVALUATE
    2611                                ; A RATIONAL APPROXIMATION OF THE FORM X*P(X^2)/Q(X^2) WHERE X IS
    2612                                ; THE ARGUMENT PASSED ON THE STACK.  R0 POINTS PAST THE TABLE OF
    2613                                ; COEFFICIENTS TO USE IN THE APPROXIMATION.  R0 POINTS TO TWO BYTES
    2614                                ; OF INFORMATION. THE FIRST BYTE IS THE ORDER OF P AND THE SECOND BYTE
    2615                                ; IS THE ORDER OF Q.  DURING THE COMPUTATION, THE STATE OF THE STACK
    2616                                ; IS AS FOLLOWS:  (ITEMS IN PARENTHESES ARE QUAD WORD FLOATING POINT
    2617                                ; NUMBERS)
    2618                                ;
    2619                                ; SP==>	(Q)
    2620                                ;	(P)
    2621                                ;	(X^2)
    2622                                ;	(X)
    2623                                ;	R4
    2624                                ;	R3	REGISTERS SAVED AT CALL
    2625                                ;	R2
    2626                                ;	R1
    2627                                ;	UNUSED
    2628                                ;	(X)
    2629                                ;
    2630                                ;
    2631                                ; THE ALGORITHM USES HORNER'S METHOD TO EVALUATE THE POLYNOMIALS
    2632                                ;
    2633                                .GLOBL	$DSUB$,	$DADD$,	$DMUL$,	$DDIV$,STAND
    2634                                
    2635                                $APPRX::			; RATIONAL APPROXIMATION
    2636 176460 005746                  	TST	-(SP)
    2637                                	PUSH	<R1,R2,R3,R4,R5>	; SAVE REGISTERS
       1                                	.IRP	X,<R1,R2,R3,R4,R5>
       2                                		MOV	X,-(SP)
       3                                	.ENDM
       1 176462 010146                  		MOV	R1,-(SP)
       2 176464 010246                  		MOV	R2,-(SP)
       3 176466 010346                  		MOV	R3,-(SP)
       4 176470 010446                  		MOV	R4,-(SP)
       5 176472 010546                  		MOV	R5,-(SP)
    2638                                ;
    2639                                ; COPY X AND CALCULATE X^2
    2640                                ;
    2641 176474 010603                  	MOV	SP,R3		; POINT PAST WHERE X WILL BE BUILT
    2642                                	FPUSH	14(SP)		; PUSH X
       1                                	.NTYPE	ATV,14(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	14(SP),-(SP)
       4                                		MOV	14(SP),-(SP)
       5                                		MOV	14(SP),-(SP)
       6                                		MOV	14(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+14(SP),-(SP)
      11                                	.ENDR
       1 176476 016646  000022          	MOV	6+14(SP),-(SP)
       1 176502 016646  000022          	MOV	6+14(SP),-(SP)
       1 176506 016646  000022          	MOV	6+14(SP),-(SP)
       1 176512 016646  000022          	MOV	6+14(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+14(SP),-(SP)
      14                                		MOV	4+14(SP),-(SP)
      15                                		MOV	2+14(SP),-(SP)
      16                                		MOV	14(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2643 176516 010605                  	MOV	SP,R5		; POINT PAST WHERE X^2 WILL BE BUILT
    2644                                	FPUSH	-(R3)		; PUSH X
       1                                	.NTYPE	ATV,-(R3)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176520 014346                  		MOV	-(R3),-(SP)
       4 176522 014346                  		MOV	-(R3),-(SP)
       5 176524 014346                  		MOV	-(R3),-(SP)
       6 176526 014346                  		MOV	-(R3),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R3),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R3),-(SP)
      14                                		MOV	4+-(R3),-(SP)
      15                                		MOV	2+-(R3),-(SP)
      16                                		MOV	-(R3),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2645                                	FPUSH	-(R3)		; PUSH X
       1                                	.NTYPE	ATV,-(R3)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176530 014346                  		MOV	-(R3),-(SP)
       4 176532 014346                  		MOV	-(R3),-(SP)
       5 176534 014346                  		MOV	-(R3),-(SP)
       6 176536 014346                  		MOV	-(R3),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R3),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R3),-(SP)
      14                                		MOV	4+-(R3),-(SP)
      15                                		MOV	2+-(R3),-(SP)
      16                                		MOV	-(R3),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2646 176540 004467  166552'         	JSR	R4,STAND
    2647 176544 170210                  	.WORD 	$DMUL$
    2648 176546 176550                  	.WORD	5$
    2649                                ;
    2650                                ; PICK UP POLYNOMIAL ORDERS AND CALCULATE X*P(X^2)
    2651                                ;
    2652 176550 111002                  5$:	MOVB	(R0),R2		; ORDER OF P
    2653 176552 116003  000001          	MOVB	1(R0),R3	; ORDER OF Q
    2654 176556 000404                  	BR	1$
    2655 176560 000000  000000  000000  	.WORD	0,0,0,0
         176566 000000                  
    2656                                1$:	FPUSH	-(R0)		; PUSH P(N)
       1                                	.NTYPE	ATV,-(R0)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176570 014046                  		MOV	-(R0),-(SP)
       4 176572 014046                  		MOV	-(R0),-(SP)
       5 176574 014046                  		MOV	-(R0),-(SP)
       6 176576 014046                  		MOV	-(R0),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R0),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R0),-(SP)
      14                                		MOV	4+-(R0),-(SP)
      15                                		MOV	2+-(R0),-(SP)
      16                                		MOV	-(R0),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2657                                
    2658 176600 010501                  10$:	MOV	R5,R1		; COPY POINTER PAST X^2
    2659                                	FPUSH	-(R1)		; X^2
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176602 014146                  		MOV	-(R1),-(SP)
       4 176604 014146                  		MOV	-(R1),-(SP)
       5 176606 014146                  		MOV	-(R1),-(SP)
       6 176610 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2660 176612 004467  166552'         	JSR	R4,STAND
    2661 176616 170210                  	.WORD	$DMUL$
    2662 176620 176622                  	.WORD	11$
    2663                                11$:	FPUSH	-(R0)		; P(N-1) (ETC)
       1                                	.NTYPE	ATV,-(R0)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176622 014046                  		MOV	-(R0),-(SP)
       4 176624 014046                  		MOV	-(R0),-(SP)
       5 176626 014046                  		MOV	-(R0),-(SP)
       6 176630 014046                  		MOV	-(R0),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R0),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R0),-(SP)
      14                                		MOV	4+-(R0),-(SP)
      15                                		MOV	2+-(R0),-(SP)
      16                                		MOV	-(R0),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2664 176632 004467  166552'         	JSR	R4,STAND
    2665 176636 167144                  	.WORD	$DADD$
    2666 176640 176642                  	.WORD	12$
    2667 176642 005302                  12$:	DEC	R2		; DONE YET?
    2668 176644 003355                  	BGT	10$		; NOPE
    2669 176646 005703                  	TST	R3		; JUST A SINGLE POLYNOMIAL EVALUATION?
    2670 176650 001450                  	BEQ	40$		; YES
    2671                                	FPUSH	0(R5)		; X
       1                                	.NTYPE	ATV,0(R5)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(R5),-(SP)
       4                                		MOV	0(R5),-(SP)
       5                                		MOV	0(R5),-(SP)
       6                                		MOV	0(R5),-(SP)
       7                                	.IFF
       8 177777                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(R5),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13 176652 016546  000006          		MOV	6+0(R5),-(SP)
      14 176656 016546  000004          		MOV	4+0(R5),-(SP)
      15 176662 016546  000002          		MOV	2+0(R5),-(SP)
      16 176666 016546  000000          		MOV	0(R5),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2672 176672 004467  166552'         	JSR	R4,STAND
    2673 176676 170210                  	.WORD	$DMUL$
    2674 176700 176702                  	.WORD	13$
    2675                                ;
    2676                                ; CALCULATE Q(X^2)
    2677                                ;
    2678 176702 010501                  13$:	MOV	R5,R1		; POINT PAST X^2
    2679                                	FPUSH	-(R1)		; X^2
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176704 014146                  		MOV	-(R1),-(SP)
       4 176706 014146                  		MOV	-(R1),-(SP)
       5 176710 014146                  		MOV	-(R1),-(SP)
       6 176712 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2680                                20$:	FPUSH	-(R0)		; Q(N)
       1                                	.NTYPE	ATV,-(R0)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176714 014046                  		MOV	-(R0),-(SP)
       4 176716 014046                  		MOV	-(R0),-(SP)
       5 176720 014046                  		MOV	-(R0),-(SP)
       6 176722 014046                  		MOV	-(R0),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R0),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R0),-(SP)
      14                                		MOV	4+-(R0),-(SP)
      15                                		MOV	2+-(R0),-(SP)
      16                                		MOV	-(R0),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2681 176724 004467  166552'         	JSR	R4,STAND
    2682 176730 167144                  	.WORD	$DADD$
    2683 176732 176734                  	.WORD	21$
    2684 176734 005303                  21$:	DEC	R3		; DONE?
    2685 176736 003411                  	BLE	30$		; YES
    2686 176740 010501                  	MOV	R5,R1		; POINT PAST X^2
    2687                                	FPUSH	-(R1)		; X^2
       1                                	.NTYPE	ATV,-(R1)
       2 000000                         	.IF	EQ,ATV&60-40
       3 176742 014146                  		MOV	-(R1),-(SP)
       4 176744 014146                  		MOV	-(R1),-(SP)
       5 176746 014146                  		MOV	-(R1),-(SP)
       6 176750 014146                  		MOV	-(R1),-(SP)
       7                                	.IFF
       8                                	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+-(R1),-(SP)
      11                                	.ENDR
      12                                	.IFF
      13                                		MOV	6+-(R1),-(SP)
      14                                		MOV	4+-(R1),-(SP)
      15                                		MOV	2+-(R1),-(SP)
      16                                		MOV	-(R1),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2688 176752 004467  166552'         	JSR	R4,STAND
    2689 176756 170210                  	.WORD	$DMUL$
    2690 176760 176714                  	.WORD	20$
    2691                                ;
    2692                                ; CALCUALTE X*P(X^2)/Q(X^2), POP RESULT, RESTORE REGISTERS AND EXIT
    2693                                ;
    2694 176762 004467  166552'         30$:	JSR	R4,STAND	; 
    2695 176766 170776                  	.WORD	$DDIV$
    2696 176770 176772                  	.WORD	40$
    2697                                40$:	FPOP	42(SP)		; STORE RESULT
       1                                	.REPT	4
       2                                		MOV	(SP)+,42(SP)
       3                                	.ENDR
       1 176772 012666  000042          		MOV	(SP)+,42(SP)
       1 176776 012666  000042          		MOV	(SP)+,42(SP)
       1 177002 012666  000042          		MOV	(SP)+,42(SP)
       1 177006 012666  000042          		MOV	(SP)+,42(SP)
    2698 177012 062706  000020          	ADD	#20,SP		; KILL JUNK
    2699                                	POP	<R5,R4,R3,R2,R1>	; RESTORE REGS
       1                                	.IRP	X,<R5,R4,R3,R2,R1>
       2                                		MOV	(SP)+,X
       3                                	.ENDM
       1 177016 012605                  		MOV	(SP)+,R5
       2 177020 012604                  		MOV	(SP)+,R4
       3 177022 012603                  		MOV	(SP)+,R3
       4 177024 012602                  		MOV	(SP)+,R2
       5 177026 012601                  		MOV	(SP)+,R1
    2700 177030 005726                  	TST	(SP)+
    2701 177032 000134                  	JMP	@(R4)+
    2702                                .SBTTL	SUPPORT ENTRY $B85,	DOUBLE FLOATING COMPARE
    2703                                ;
    2704                                ; THIS ROUTINE COMPARES THE TWO DOUBLE PRECISION REAL NUMBERS ON THE
    2705                                ; STACK AND RETURNS THE RESULT OF THE COMPARISON IN THE CONDITION
    2706                                ; CODES.
    2707                                ;
    2708                                DCMP::
    2709                                $B85:				; DOUBLE PRECISION COMPARE
    2710 177034 026616  000010          	CMP	10(SP),@SP	; COMPARE FIRST WORDS
    2711 177040 103423                  	BLO	10$
    2712 177042 101025                  	BHI	20$
    2713 177044 026666  000012  000002  	CMP	12(SP),2(SP)	; COMPARE SECOND WORDS
    2714 177052 103416                  	BLO	10$
    2715 177054 101020                  	BHI	20$
    2716 177056 026666  000014  000004  	CMP	14(SP),4(SP)	; THIRD WORDS
    2717 177064 103411                  	BLO	10$
    2718 177066 101013                  	BHI	20$
    2719 177070 026666  000016  000006  	CMP	16(SP),6(SP)	; FOURTH WORDS
    2720 177076 103404                  	BLO	10$
    2721 177100 101006                  	BHI	20$
    2722                                ;
    2723                                ; VALUES ARE EQUAL
    2724                                ;
    2725 177102 005066  000010          	CLR	10(SP)		;RETURN EQUAL COMPARISION
    2726 177106 000403                  	BR	20$
    2727                                ;
    2728                                ; FIRST ARG LOWER THAN SECOND ARG.  RESULT IS NEGATED SECOND ARG
    2729                                ;
    2730                                10$:
    2731 177110 005416                  	NEG	@SP			;NEGATE SIGN OF SECOND ARG.
    2732 177112 011666  000010          	MOV	@SP,10(SP)		;MOV THAT WORD TO FIRST ARG.
    2733                                ;
    2734                                ; FIRST ARG HIGHER THAN SECOND ARG.  RESULT IS FIRST ARG
    2735                                ;
    2736                                20$:
    2737 177116 016666  000010  000016  	MOV	10(SP),16(SP)	;MOV FIRST WORD OF FIRST ARG. BEFORE RETURN
    2738 177124 062706  000016          	ADD	#16,SP		;WIPE OUT JUNK ON STACK
    2739 177130 012600                  	MOV	(SP)+,R0	;SET CONDITION CODES
    2740 177132 000134                  	JMP	@(R4)+		;RETURN WITH COPARISION IN CONDITION CODES
    2741                                .SBTTL	POWER
    2742                                ;
    2743                                ; THIS ROUTINE RISE REAL NUMBER TO INTEGER POWER
    2744                                ;
    2745 177134 011646                  POW::	MOV	@SP,-(SP)
    2746 177136 002005                  	BGE	1$
    2747 177140 005416                  	NEG	@SP
    2748 177142 005766  000004          	TST	4(SP)
    2749 177146 001001                  	BNE	1$
    2750 177150 104413                  	TRAP	11.
    2751 177152 010446                  1$:	MOV	R4,-(SP)
    2752 177154 010467  002134'         	MOV	R4,SAVJMP
    2753 177160 006266  000002          	ASR	2(SP)
    2754 177164 103014                  	BCC	13$
    2755                                	FPUSH	6(SP)
       1                                	.NTYPE	ATV,6(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	6(SP),-(SP)
       4                                		MOV	6(SP),-(SP)
       5                                		MOV	6(SP),-(SP)
       6                                		MOV	6(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+6(SP),-(SP)
      11                                	.ENDR
       1 177166 016646  000014          	MOV	6+6(SP),-(SP)
       1 177172 016646  000014          	MOV	6+6(SP),-(SP)
       1 177176 016646  000014          	MOV	6+6(SP),-(SP)
       1 177202 016646  000014          	MOV	6+6(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+6(SP),-(SP)
      14                                		MOV	4+6(SP),-(SP)
      15                                		MOV	2+6(SP),-(SP)
      16                                		MOV	6(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2756 177206 005766  000012          	TST	12(SP)
    2757 177212 001501                  	BEQ	POW18
    2758 177214 000410                  	BR	POW14
    2759 177216 005046                  13$:	CLR	-(SP)
    2760 177220 005046                  	CLR	-(SP)
    2761 177222 005046                  	CLR	-(SP)
    2762 177224 012746  040200          	MOV	#40200,-(SP)
    2763 177230 005766  000012          	TST	12(SP)
    2764 177234 001470                  	BEQ	POW18
    2765                                POW14:	FPUSH	16(SP)
       1                                	.NTYPE	ATV,16(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	16(SP),-(SP)
       4                                		MOV	16(SP),-(SP)
       5                                		MOV	16(SP),-(SP)
       6                                		MOV	16(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+16(SP),-(SP)
      11                                	.ENDR
       1 177236 016646  000024          	MOV	6+16(SP),-(SP)
       1 177242 016646  000024          	MOV	6+16(SP),-(SP)
       1 177246 016646  000024          	MOV	6+16(SP),-(SP)
       1 177252 016646  000024          	MOV	6+16(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+16(SP),-(SP)
      14                                		MOV	4+16(SP),-(SP)
      15                                		MOV	2+16(SP),-(SP)
      16                                		MOV	16(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2766                                POW16:	FPUSH	0(SP)
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 177256 016646  000006          	MOV	6+0(SP),-(SP)
       1 177262 016646  000006          	MOV	6+0(SP),-(SP)
       1 177266 016646  000006          	MOV	6+0(SP),-(SP)
       1 177272 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2767 177276 004467  166552'         	JSR	R4,STAND
    2768 177302 170210                  	.WORD	$DMUL$
    2769 177304 177306                  	.WORD	POW15
    2770 177306 006266  000022          POW15:	ASR	22(SP)
    2771 177312 103361                  	BCC	POW16
    2772                                	FPUSH	10(SP)
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 177314 016646  000016          	MOV	6+10(SP),-(SP)
       1 177320 016646  000016          	MOV	6+10(SP),-(SP)
       1 177324 016646  000016          	MOV	6+10(SP),-(SP)
       1 177330 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2773                                	FPUSH	10(SP)
       1                                	.NTYPE	ATV,10(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	10(SP),-(SP)
       4                                		MOV	10(SP),-(SP)
       5                                		MOV	10(SP),-(SP)
       6                                		MOV	10(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+10(SP),-(SP)
      11                                	.ENDR
       1 177334 016646  000016          	MOV	6+10(SP),-(SP)
       1 177340 016646  000016          	MOV	6+10(SP),-(SP)
       1 177344 016646  000016          	MOV	6+10(SP),-(SP)
       1 177350 016646  000016          	MOV	6+10(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+10(SP),-(SP)
      14                                		MOV	4+10(SP),-(SP)
      15                                		MOV	2+10(SP),-(SP)
      16                                		MOV	10(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2774 177354 004467  166552'         	JSR	R4,STAND
    2775 177360 170210                  	.WORD	$DMUL$
    2776 177362 177364                  	.WORD	17$
    2777                                17$:	FPOP	16(SP)
       1                                	.REPT	4
       2                                		MOV	(SP)+,16(SP)
       3                                	.ENDR
       1 177364 012666  000016          		MOV	(SP)+,16(SP)
       1 177370 012666  000016          		MOV	(SP)+,16(SP)
       1 177374 012666  000016          		MOV	(SP)+,16(SP)
       1 177400 012666  000016          		MOV	(SP)+,16(SP)
    2778 177404 005766  000022          	TST	22(SP)
    2779 177410 001322                  	BNE	POW16
    2780 177412 062706  000010          	ADD	#10,SP
    2781 177416 005766  000014          POW18:	TST	14(SP)
    2782 177422 002025                  	BGE	19$
    2783 177424 010600                  	MOV	SP,R0
    2784                                	FPUSH	0(SP)
       1                                	.NTYPE	ATV,0(SP)
       2 000020                         	.IF	EQ,ATV&60-40
       3                                		MOV	0(SP),-(SP)
       4                                		MOV	0(SP),-(SP)
       5                                		MOV	0(SP),-(SP)
       6                                		MOV	0(SP),-(SP)
       7                                	.IFF
       8 000000                         	.IF	EQ	ATV&7-6
       9                                	.REPT 4
      10                                	MOV	6+0(SP),-(SP)
      11                                	.ENDR
       1 177426 016646  000006          	MOV	6+0(SP),-(SP)
       1 177432 016646  000006          	MOV	6+0(SP),-(SP)
       1 177436 016646  000006          	MOV	6+0(SP),-(SP)
       1 177442 016646  000006          	MOV	6+0(SP),-(SP)
      12                                	.IFF
      13                                		MOV	6+0(SP),-(SP)
      14                                		MOV	4+0(SP),-(SP)
      15                                		MOV	2+0(SP),-(SP)
      16                                		MOV	0(SP),-(SP)
      17                                	.ENDC
      18                                	.ENDC
    2785 177446 012720  040200          	MOV	#40200,(0)+
    2786 177452 005020                  	CLR	(0)+
    2787 177454 005020                  	CLR	(0)+
    2788 177456 005020                  	CLR	(0)+
    2789 177460 005716                  	TST	@SP
    2790 177462 001001                  	BNE	2$
    2791 177464 104406                  	TRAP	6
    2792 177466 004467  166552'         2$:	JSR	R4,STAND
    2793 177472 170776                  	.WORD	$DDIV$
    2794 177474 177476                  	.WORD	19$
    2795                                19$:	FPOP	14(SP)
       1                                	.REPT	4
       2                                		MOV	(SP)+,14(SP)
       3                                	.ENDR
       1 177476 012666  000014          		MOV	(SP)+,14(SP)
       1 177502 012666  000014          		MOV	(SP)+,14(SP)
       1 177506 012666  000014          		MOV	(SP)+,14(SP)
       1 177512 012666  000014          		MOV	(SP)+,14(SP)
    2796 177516 012604                  	MOV	(SP)+,R4
    2797 177520 022626                  	CMP	(SP)+,(SP)+
    2798 177522 005067  002134'         	CLR	SAVJMP
    2799 177526 000134                  	JMP	@(4)+
    2800                                ;
    2801                                ENDIMG::
    2802                                	.END
    2802                                
